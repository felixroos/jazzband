parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"hWfO":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(t){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"7X4a":[function(require,module,exports) {
var process = require("process");
var t=require("process"),e="undefined"!=typeof window,i={toleranceLate:.1,toleranceEarly:.001},s=function(t,e,i){this.clock=t,this.func=i,this._cleared=!1,this.toleranceLate=t.toleranceLate,this.toleranceEarly=t.toleranceEarly,this._latestTime=null,this._earliestTime=null,this.deadline=null,this.repeatTime=null,this.schedule(e)};s.prototype.clear=function(){return this.clock._removeEvent(this),this._cleared=!0,this},s.prototype.repeat=function(t){if(0===t)throw new Error("delay cannot be 0");return this.repeatTime=t,this.clock._hasEvent(this)||this.schedule(this.deadline+this.repeatTime),this},s.prototype.tolerance=function(t){return"number"==typeof t.late&&(this.toleranceLate=t.late),"number"==typeof t.early&&(this.toleranceEarly=t.early),this._refreshEarlyLateDates(),this.clock._hasEvent(this)&&(this.clock._removeEvent(this),this.clock._insertEvent(this)),this},s.prototype.isRepeated=function(){return null!==this.repeatTime},s.prototype.schedule=function(t){this._cleared=!1,this.deadline=t,this._refreshEarlyLateDates(),this.clock.context.currentTime>=this._earliestTime?this._execute():this.clock._hasEvent(this)?(this.clock._removeEvent(this),this.clock._insertEvent(this)):this.clock._insertEvent(this)},s.prototype.timeStretch=function(t,e){this.isRepeated()&&(this.repeatTime=this.repeatTime*e);var i=t+e*(this.deadline-t);if(this.isRepeated())for(;this.clock.context.currentTime>=i-this.toleranceEarly;)i+=this.repeatTime;this.schedule(i)},s.prototype._execute=function(){!1!==this.clock._started&&(this.clock._removeEvent(this),this.clock.context.currentTime<this._latestTime?this.func(this):(this.onexpired&&this.onexpired(this),console.warn("event expired")),this.clock._hasEvent(this)||!this.isRepeated()||this._cleared||this.schedule(this.deadline+this.repeatTime))},s.prototype._refreshEarlyLateDates=function(){this._latestTime=this.deadline+this.toleranceLate,this._earliestTime=this.deadline-this.toleranceEarly};var r=module.exports=function(t,e){e=e||{},this.tickMethod=e.tickMethod||"ScriptProcessorNode",this.toleranceEarly=e.toleranceEarly||i.toleranceEarly,this.toleranceLate=e.toleranceLate||i.toleranceLate,this.context=t,this._events=[],this._started=!1};r.prototype.setTimeout=function(t,e){return this._createEvent(t,this._absTime(e))},r.prototype.callbackAtTime=function(t,e){return this._createEvent(t,e)},r.prototype.timeStretch=function(t,e,i){return e.forEach(function(e){e.timeStretch(t,i)}),e},r.prototype.start=function(){if(!1===this._started){var e=this;if(this._started=!0,this._events=[],"ScriptProcessorNode"===this.tickMethod){this._clockNode=this.context.createScriptProcessor(256,1,1),this._clockNode.connect(this.context.destination),this._clockNode.onaudioprocess=function(){t.nextTick(function(){e._tick()})}}else if("manual"!==this.tickMethod)throw new Error("invalid tickMethod "+this.tickMethod)}},r.prototype.stop=function(){!0===this._started&&(this._started=!1,this._clockNode.disconnect())},r.prototype._tick=function(){for(var t=this._events.shift();t&&t._earliestTime<=this.context.currentTime;)t._execute(),t=this._events.shift();t&&this._events.unshift(t)},r.prototype._createEvent=function(t,e){return new s(this,e,t)},r.prototype._insertEvent=function(t){this._events.splice(this._indexByTime(t._earliestTime),0,t)},r.prototype._removeEvent=function(t){var e=this._events.indexOf(t);-1!==e&&this._events.splice(e,1)},r.prototype._hasEvent=function(t){return-1!==this._events.indexOf(t)},r.prototype._indexByTime=function(t){for(var e,i=0,s=this._events.length;i<s;)e=Math.floor((i+s)/2),this._events[e]._earliestTime<t?i=e+1:s=e;return i},r.prototype._absTime=function(t){return t+this.context.currentTime},r.prototype._relTime=function(t){return t-this.context.currentTime};
},{"process":"hWfO"}],"f5ea":[function(require,module,exports) {
var e=require("./lib/WAAClock");module.exports=e,"undefined"!=typeof window&&(window.WAAClock=e);
},{"./lib/WAAClock":"7X4a"}],"hEkM":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var e=t(require("waaclock")),i=function(){function t(t){void 0===t&&(t={}),this.defaults={bpm:120,cycle:4,delay:0},this.events=[],this.callbackAtTime=!1,this.props=Object.assign({},this.defaults,t),this.context=this.props.context||new AudioContext,this.clock=this.props.clock||new e.default(this.context,{toleranceEarly:.1,toleranceLate:.1})}return t.prototype.getMeasureLength=function(t,e){return void 0===t&&(t=this.props.bpm),void 0===e&&(e=this.props.cycle),60/t*e},t.prototype.arrayPulse=function(t,e,i,r,n,s){var o=this;if(void 0===e&&(e=1),void 0===i&&(i=[]),void 0===r&&(r=0),!Array.isArray(t)){if(0===t)return 0;var c={value:t,length:e,path:i,start:r,pulse:this,cycle:this.props.cycle,timeout:null};return r+=this.props.delay,this.callbackAtTime?(r+=s||this.context.currentTime,c.timeout=this.clock.callbackAtTime(function(t){return n(Object.assign(c,{event:t,deadline:t.deadline}))},r)):(r+=(s||this.context.currentTime)-this.context.currentTime,c.timeout=this.clock.setTimeout(function(t){return n(Object.assign(c,{event:t,deadline:t.deadline}))},r)),this.events.push(c.timeout),c}var a=e/t.length;return{length:e,children:t.map(function(t,e){return o.arrayPulse(t,a,i.concat([e]),r+e*a,n,s)})}},t.prototype.tickArray=function(t,e,i,r){var n=this;t.push(1);var s=r||this.getMeasureLength()*t.length;return this.start(),new Promise(function(r,o){n.arrayPulse(t,s,[],0,function(i,n){i.path[0]===t.length-1?r(i):e(i,n)},i)})},t.prototype.start=function(){this.events.length>6e3&&console.warn("more than ",6e3,'events received. Consider using less "times" to keep the timing precies'),this.clock.start()},t.prototype.stop=function(){this.clock.stop()},t.prototype.changeTempo=function(t,e){var i=this;void 0===e&&(e=.2);var r=this.props.bpm/t;this.props.bpm=t;var n=this.events.filter(function(t){return t.deadline-i.context.currentTime>e});this.clock.timeStretch(this.context.currentTime,n,r)},t}();exports.Pulse=i;
},{"waaclock":"f5ea"}],"e7fp":[function(require,module,exports) {
"use strict";function e(e){return"string"==typeof e?{chords:[e]}:Array.isArray(e)?{chords:[].concat(e)}:Object.assign({},e)}function s(t,r){var n=e(r[t]);return"x"===n.chords[0]?s(t-1,r):n}function t(s,r){var n;for(r=Object.assign({index:0,measures:[],openRepeats:[],repeated:[],end:s.length-1,house:0,houseStart:0,houses:{}},r);r.index<=r.end;){var o=e(s[r.index]),u=o.signs||[];if(u.includes("{")&&r.openRepeats.unshift(r.index),o.house&&(r.house=o.house,1===o.house&&(r.houseStart=r.openRepeats[0]||0)),!(r.house&&r.houses[r.houseStart]&&r.house!==r.houses[r.houseStart]))if(r.measures.push(o),u.includes("}")&&!r.repeated.includes(r.index)){var a=r.openRepeats[0]||0;r.openRepeats.shift(),r.houses[a]=(r.houses[a]||1)+1,r.measures=r.measures.concat(t(s,{index:a,repeated:[r.index],end:r.index,houses:(n={},n[a]=r.houses[a],n)}))}r.index+=1}return r.measures}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getMeasure=e,exports.getLatestMeasure=s,exports.renderSheet=t;
},{}],"OKGr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Pulse"),t=require("./Song"),s=function(){function s(e){var t=void 0===e?{}:e,s=t.context,n=t.musicians,r=t.onMeasure;this.defaults={cycle:4,division:3,transpose:0,style:"Medium Swing"},this.context=s||new AudioContext,this.onMeasure=r,this.musicians=n||[]}return s.prototype.addMember=function(e){this.musicians=this.musicians.concat(e)},s.prototype.ready=function(){return Promise.all([this.resume()].concat(this.musicians.map(function(e){return e.ready})))},s.prototype.resume=function(){var e=this;return this.context.resume().then(function(){return e.context})},s.prototype.comp=function(e,s){this.pulse&&this.pulse.stop();var n=t.renderSheet(e);n=n.concat(n),s=Object.assign(this.defaults,s,{context:this.context}),this.play(n,s)},s.prototype.play=function(t,s){var n=this;this.ready().then(function(){n.pulse=s.pulse||new e.Pulse(s),n.onMeasure&&n.pulse.tickArray(t.map(function(e){return{measure:e}}),function(e){return n.onMeasure(e.value.measure,e)}),t=t.map(function(e){return e.chords?e.chords:e}),console.log("Band#play",s),(s.musicians||n.musicians).forEach(function(e){return e.play({pulse:n.pulse,measures:t,settings:s})}),n.pulse.start()})},s}();exports.default=s;
},{"./Pulse":"hEkM","./Song":"e7fp"}],"W+c/":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r="C C# Db D D# Eb E F F# Gb G G# Ab A A# Bb B".split(" "),t=function(t){return"string"!=typeof t?r.slice():r.filter(function(r){var n=r[1]||" ";return-1!==t.indexOf(n)})},n=t(" #"),e=t(" b"),o=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function u(r){"string"!=typeof r&&(r="");var t=o.exec(r);return[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]}var i=Object.freeze({pc:null,name:null,step:null,alt:null,oct:null,octStr:null,chroma:null,midi:null,freq:null}),l=[0,2,4,5,7,9,11],c=function(r){var t=u(r);if(""===t[0]||""!==t[3])return i;var n=t[0],e=t[1],o=t[2],c={letter:n,acc:e,octStr:o,pc:n+e,name:n+e+o,step:(n.charCodeAt(0)+3)%7,alt:"b"===e[0]?-e.length:e.length,oct:o.length?+o:null,chroma:0,midi:null,freq:null};return c.chroma=(l[c.step]+c.alt+120)%12,c.midi=null!==c.oct?l[c.step]+c.alt+12*(c.oct+1):null,c.freq=x(c.midi),Object.freeze(c)},f=function(r,t){return void 0===t&&(t={}),function(n){return t[n]||(t[n]=r(n))}},a=f(c),p=function(r){return a(r).name},s=function(r){return a(r).pc},m=function(r){return r>=0&&r<=127},d=function(r){if("number"!=typeof r&&"string"!=typeof r)return null;var t=a(r).midi,n=t||0===t?t:+r;return m(n)?n:null},x=function(r,t){return void 0===t&&(t=440),"number"==typeof r?Math.pow(2,(r-69)/12)*t:null},v=function(r){return a(r).freq||x(r)},b=Math.log(2),h=Math.log(440),g=function(r){var t=12*(Math.log(r)-h)/b+69;return Math.round(100*t)/100},y=function(r){return a(r).chroma},M=function(r){return a(r).oct},A="CDEFGAB",q=function(r){return A[r]},j=function(r,t){return Array(t+1).join(r)},C=function(r,t){return"number"!=typeof r?"":t(r)},G=function(r){return C(r,function(r){return r<0?j("b",-r):j("#",r)})},O=function(r,t){void 0===r&&(r={}),void 0===t&&(t=null);var n=t?Object.assign({},a(t),r):r,e=n.step,o=n.alt,u=n.oct;if("number"!=typeof e)return null;var i=q(e);if(!i)return null;var l=i+G(o);return u||0===u?l+u:l},D=O;function F(r,t){return void 0===t&&(t=!1),r=Math.round(r),(!0===t?n:e)[r%12]+(Math.floor(r/12)-1)}var T=function(r,t){void 0===t&&(t=!0);var n=a(r),e=n.alt,o=n.chroma,u=n.midi;if(null===o)return null;var i=!1===t?e<0:e>0;return null===u?s(F(o,i)):F(u,i)},z=function(r){return T(r,!1)};exports.names=t,exports.tokenize=u,exports.props=a,exports.name=p,exports.pc=s,exports.midi=d,exports.midiToFreq=x,exports.freq=v,exports.freqToMidi=g,exports.chroma=y,exports.oct=M,exports.stepToLetter=q,exports.altToAcc=G,exports.from=O,exports.build=D,exports.fromMidi=F,exports.simplify=T,exports.enharmonic=z;
},{}],"XBB2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.permutations=exports.shuffle=exports.compact=void 0,exports.range=e,exports.rotate=o,exports.sort=c,exports.unique=s;var r=require("tonal-note");function t(r,t){for(var n=[];t--;n[t]=t+r);return n}function n(r,t){for(var n=[];t--;n[t]=r-t);return n}function e(r,e){return null===r||null===e?[]:r<e?t(r,e-r+1):n(r,r-e+1)}function o(r,t){var n=t.length,e=(r%n+n)%n;return t.slice(e,n).concat(t.slice(0,e))}var u=exports.compact=function(r){return r.filter(function(r){return 0===r||r})},i=function(t){var n=(0,r.props)(t).midi;return null!==n?n:(0,r.props)(t+"-100").midi};function c(t){return u(t.map(r.name)).sort(function(r,t){return i(r)>i(t)})}function s(r){return c(r).filter(function(r,t,n){return 0===t||r!==n[t-1]})}var a=exports.shuffle=function(r,t){var n,e;void 0===t&&(t=Math.random);for(var o=r.length;o;)n=t()*o--|0,e=r[o],r[o]=r[n],r[n]=e;return r},f=exports.permutations=function(r){return 0===r.length?[[]]:f(r.slice(1)).reduce(function(t,n){return t.concat(r.map(function(t,e){var o=n.slice();return o.splice(e,0,r[0]),o}))},[])};
},{"tonal-note":"W+c/"}],"JYnb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",n="(AA|A|P|M|m|d|dd)([-+]?\\d+)",e=new RegExp("^"+t+"|"+n+"$"),r=[0,2,4,5,7,9,11],u="PMMPPMM",o=[0,1,2,3,4,5,6,5,4,3,2,1],l="1P 2m 2M 3m 3M 4P 5P 6m 6M 7m 7M 8P".split(" "),i=function(t){return"string"!=typeof t?l.slice():l.filter(function(n){return-1!==t.indexOf(n[1])})},s=function(t){var n=e.exec(""+t);return null===n?null:n[1]?[n[1],n[2]]:[n[4],n[3]]},m=Object.freeze({name:null,num:null,q:null,step:null,alt:null,dir:null,type:null,simple:null,semitones:null,chroma:null,oct:null}),p=function(t,n){return Array(Math.abs(n)+1).join(t)},a=function(t,n){return"M"===n&&"M"===t?0:"P"===n&&"P"===t?0:"m"===n&&"M"===t?-1:/^A+$/.test(n)?n.length:/^d+$/.test(n)?"P"===t?-n.length:-n.length-1:null},c=function(t,n){return 0===n?"M"===t?"M":"P":-1===n&&"M"===t?"m":n>0?p("A",n):n<0?p("d","P"===t?n:n+1):null},f=function(t){return(Math.abs(t)-1)%7},M=function(t){var n=s(t);if(null===n)return m;var e={num:0,q:"d",name:"",type:"M",step:0,dir:-1,simple:1,alt:0,oct:0,semitones:0,chroma:0,ic:0};return e.num=+n[0],e.q=n[1],e.step=f(e.num),e.type=u[e.step],"M"===e.type&&"P"===e.q?m:(e.name=""+e.num+e.q,e.dir=e.num<0?-1:1,e.simple=8===e.num||-8===e.num?e.num:e.dir*(e.step+1),e.alt=a(e.type,e.q),e.oct=Math.floor((Math.abs(e.num)-1)/7),e.semitones=e.dir*(r[e.step]+e.alt+12*e.oct),e.chroma=(e.dir*(r[e.step]+e.alt)%12+12)%12,Object.freeze(e))},d={};function P(t){return"string"!=typeof t?m:d[t]||(d[t]=M(t))}var v=function(t){return P(t).num},x=function(t){return P(t).name},h=function(t){return P(t).semitones},y=function(t){return P(t).chroma},b=function(t){return"string"==typeof t&&(t=P(t).chroma),"number"==typeof t?o[t%12]:null},q=function(t){var n=void 0===t?{}:t,e=n.num,r=n.step,o=n.alt,l=n.oct,i=void 0===l?1:l,s=n.dir;if(void 0!==r&&(e=r+1+7*i),void 0===e)return null;if("number"!=typeof o)return null;var m="number"!=typeof s?"":s<0?"-":"",p=u[f(e)];return m+e+c(p,o)},A=function(t){var n=P(t);if(n===m)return null;var e=n;return e.simple+e.q},g=function(t){var n=P(t);if(n===m)return null;var e=n,r=(7-e.step)%7,u="P"===e.type?-e.alt:-(e.alt+1);return q({step:r,alt:u,oct:e.oct,dir:e.dir})},j=[1,2,2,3,3,4,5,5,6,6,7,7],O="P m M m M P d P m M m M".split(" "),z=function(t){var n=t<0?-1:1,e=Math.abs(t),r=e%12,u=Math.floor(e/12);return n*(j[r]+7*u)+O[r]};exports.names=i,exports.tokenize=s,exports.qToAlt=a,exports.altToQ=c,exports.props=P,exports.num=v,exports.name=x,exports.semitones=h,exports.chroma=y,exports.ic=b,exports.build=q,exports.simplify=A,exports.invert=g,exports.fromSemitones=z;
},{}],"9+ru":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.transpose=v,exports.trFifths=h,exports.fifths=d,exports.transposeBy=g,exports.addIntervals=b,exports.add=M,exports.subtract=q,exports.interval=y,exports.semitones=_;var n=require("tonal-note"),r=require("tonal-interval"),t=[0,2,4,-1,1,3,5],u=function(n){return Math.floor(7*n/12)},e=t.map(u),l=function(n){var r=n.step,u=n.alt,l=n.oct,o=n.dir;void 0===o&&(o=1);var i=t[r]+7*u;return null===l?[o*i]:[o*i,o*(l-e[r]-4*u)]},o=[3,0,4,1,5,2,6];function i(n){var r=(n+1)%7;return r<0?7+r:r}var f=function(n,r,t){var u=o[i(n)],l=Math.floor((n+1)/7);return void 0===r?{step:u,alt:l,dir:t}:{step:u,alt:l,oct:r+4*l+e[u],dir:t}},a=function(n,r){return void 0===r&&(r={}),function(t){return r[t]||(r[t]=n(t))}},c=function(n){return a(function(r){var t=n(r);return null===t.name?null:l(t)})},s=c(n.props),p=c(r.props);function v(r,t){if(1===arguments.length)return function(n){return v(r,n)};var u=s(r),e=p(t);if(null===u||null===e)return null;var l=1===u.length?[u[0]+e[0]]:[u[0]+e[0],u[1]+e[1]];return(0,n.build)(f(l[0],l[1]))}function h(r,t){if(1===arguments.length)return function(n){return h(r,n)};var u=s(r);return null===u?null:(0,n.build)(f(u[0]+t))}function d(n,r){if(1===arguments.length)return function(r){return d(n,r)};var t=s(n),u=s(r);return null===u||null===t?null:u[0]-t[0]}function g(n,r){return 1===arguments.length?function(r){return v(r,n)}:v(r,n)}var m=function(n){return 7*n[0]+12*n[1]<0},x=function(n){return m(n)?f(-n[0],-n[1],-1):f(n[0],n[1],1)};function b(n,t,u){var e=p(n),l=p(t);if(null===e||null===l)return null;var o=[e[0]+u*l[0],e[1]+u*l[1]];return(0,r.build)(x(o))}function M(n,r){return 1===arguments.length?function(r){return M(n,r)}:b(n,r,1)}function q(n,r){return 1===arguments.length?function(r){return M(n,r)}:b(n,r,-1)}function y(n,t){if(1===arguments.length)return function(r){return y(n,r)};var u=s(n),e=s(t);if(null===u||null===e||u.length!==e.length)return null;var l=1===u.length?[e[0]-u[0],-Math.floor(7*(e[0]-u[0])/12)]:[e[0]-u[0],e[1]-u[1]];return(0,r.build)(x(l))}function _(r,t){if(1===arguments.length)return function(n){return _(r,n)};var u=(0,n.props)(r),e=(0,n.props)(t);return null!==u.midi&&null!==e.midi?e.midi-u.midi:null!==u.chroma&&null!==e.chroma?(e.chroma-u.chroma+12)%12:null}
},{"tonal-note":"W+c/","tonal-interval":"JYnb"}],"2NAS":[function(require,module,exports) {
module.exports={chromatic:["1P 2m 2M 3m 3M 4P 4A 5P 6m 6M 7m 7M"],lydian:["1P 2M 3M 4A 5P 6M 7M"],major:["1P 2M 3M 4P 5P 6M 7M",["ionian"]],mixolydian:["1P 2M 3M 4P 5P 6M 7m",["dominant"]],dorian:["1P 2M 3m 4P 5P 6M 7m"],aeolian:["1P 2M 3m 4P 5P 6m 7m",["minor"]],phrygian:["1P 2m 3m 4P 5P 6m 7m"],locrian:["1P 2m 3m 4P 5d 6m 7m"],"melodic minor":["1P 2M 3m 4P 5P 6M 7M"],"melodic minor second mode":["1P 2m 3m 4P 5P 6M 7m"],"lydian augmented":["1P 2M 3M 4A 5A 6M 7M"],"lydian dominant":["1P 2M 3M 4A 5P 6M 7m",["lydian b7"]],"melodic minor fifth mode":["1P 2M 3M 4P 5P 6m 7m",["hindu","mixolydian b6M"]],"locrian #2":["1P 2M 3m 4P 5d 6m 7m",["half-diminished"]],altered:["1P 2m 3m 3M 5d 6m 7m",["super locrian","diminished whole tone","pomeroy"]],"harmonic minor":["1P 2M 3m 4P 5P 6m 7M"],"phrygian dominant":["1P 2m 3M 4P 5P 6m 7m",["spanish","phrygian major"]],"half-whole diminished":["1P 2m 3m 3M 4A 5P 6M 7m",["dominant diminished"]],diminished:["1P 2M 3m 4P 5d 6m 6M 7M",["whole-half diminished"]],"major pentatonic":["1P 2M 3M 5P 6M",["pentatonic"]],"lydian pentatonic":["1P 3M 4A 5P 7M",["chinese"]],"mixolydian pentatonic":["1P 3M 4P 5P 7m",["indian"]],"locrian pentatonic":["1P 3m 4P 5d 7m",["minor seven flat five pentatonic"]],"minor pentatonic":["1P 3m 4P 5P 7m"],"minor six pentatonic":["1P 3m 4P 5P 6M"],"minor hexatonic":["1P 2M 3m 4P 5P 7M"],"flat three pentatonic":["1P 2M 3m 5P 6M",["kumoi"]],"flat six pentatonic":["1P 2M 3M 5P 6m"],"major flat two pentatonic":["1P 2m 3M 5P 6M"],"whole tone pentatonic":["1P 3M 5d 6m 7m"],"ionian pentatonic":["1P 3M 4P 5P 7M"],"lydian #5P pentatonic":["1P 3M 4A 5A 7M"],"lydian dominant pentatonic":["1P 3M 4A 5P 7m"],"minor #7M pentatonic":["1P 3m 4P 5P 7M"],"super locrian pentatonic":["1P 3m 4d 5d 7m"],"in-sen":["1P 2m 4P 5P 7m"],iwato:["1P 2m 4P 5d 7m"],hirajoshi:["1P 2M 3m 5P 6m"],kumoijoshi:["1P 2m 4P 5P 6m"],pelog:["1P 2m 3m 5P 6m"],"vietnamese 1":["1P 3m 4P 5P 6m"],"vietnamese 2":["1P 3m 4P 5P 7m"],prometheus:["1P 2M 3M 4A 6M 7m"],"prometheus neopolitan":["1P 2m 3M 4A 6M 7m"],ritusen:["1P 2M 4P 5P 6M"],scriabin:["1P 2m 3M 5P 6M"],piongio:["1P 2M 4P 5P 6M 7m"],"major blues":["1P 2M 3m 3M 5P 6M"],"minor blues":["1P 3m 4P 5d 5P 7m",["blues"]],"composite blues":["1P 2M 3m 3M 4P 5d 5P 6M 7m"],augmented:["1P 2A 3M 5P 5A 7M"],"augmented heptatonic":["1P 2A 3M 4P 5P 5A 7M"],"dorian #4":["1P 2M 3m 4A 5P 6M 7m"],"lydian diminished":["1P 2M 3m 4A 5P 6M 7M"],"whole tone":["1P 2M 3M 4A 5A 7m"],"leading whole tone":["1P 2M 3M 4A 5A 7m 7M"],"lydian minor":["1P 2M 3M 4A 5P 6m 7m"],"locrian major":["1P 2M 3M 4P 5d 6m 7m",["arabian"]],neopolitan:["1P 2m 3m 4P 5P 6m 7M"],"neopolitan minor":["1P 2m 3m 4P 5P 6m 7M"],"neopolitan major":["1P 2m 3m 4P 5P 6M 7M",["dorian b2"]],"neopolitan major pentatonic":["1P 3M 4P 5d 7m"],"romanian minor":["1P 2M 3m 5d 5P 6M 7m"],"double harmonic lydian":["1P 2m 3M 4A 5P 6m 7M"],"harmonic major":["1P 2M 3M 4P 5P 6m 7M"],"double harmonic major":["1P 2m 3M 4P 5P 6m 7M",["gypsy"]],egyptian:["1P 2M 4P 5P 7m"],"hungarian minor":["1P 2M 3m 4A 5P 6m 7M"],"hungarian major":["1P 2A 3M 4A 5P 6M 7m"],oriental:["1P 2m 3M 4P 5d 6M 7m"],"spanish heptatonic":["1P 2m 3m 3M 4P 5P 6m 7m"],flamenco:["1P 2m 3m 3M 4A 5P 7m"],balinese:["1P 2m 3m 4P 5P 6m 7M"],"todi raga":["1P 2m 3m 4A 5P 6m 7M"],"malkos raga":["1P 3m 4P 6m 7m"],"kafi raga":["1P 3m 3M 4P 5P 6M 7m 7M"],"purvi raga":["1P 2m 3M 4P 4A 5P 6m 7M"],persian:["1P 2m 3M 4P 5d 6m 7M"],bebop:["1P 2M 3M 4P 5P 6M 7m 7M"],"bebop dominant":["1P 2M 3M 4P 5P 6M 7m 7M"],"bebop minor":["1P 2M 3m 3M 4P 5P 6M 7m"],"bebop major":["1P 2M 3M 4P 5P 5A 6M 7M"],"bebop locrian":["1P 2m 3m 4P 5d 5P 6m 7m"],"minor bebop":["1P 2M 3m 4P 5P 6m 7m 7M"],"mystery #1":["1P 2m 3M 5d 6m 7m"],enigmatic:["1P 2m 3M 5d 6m 7m 7M"],"minor six diminished":["1P 2M 3m 4P 5P 6m 6M 7M"],"ionian augmented":["1P 2M 3M 4P 5A 6M 7M"],"lydian #9":["1P 2m 3M 4A 5P 6M 7M"],ichikosucho:["1P 2M 3M 4P 5d 5P 6M 7M"],"six tone symmetric":["1P 2m 3M 4P 5A 6M"]};
},{}],"2Fez":[function(require,module,exports) {
module.exports={4:["1P 4P 7m 10m",["quartal"]],64:["5P 8P 10M"],5:["1P 5P"],M:["1P 3M 5P",["Major",""]],"M#5":["1P 3M 5A",["augmented","maj#5","Maj#5","+","aug"]],"M#5add9":["1P 3M 5A 9M",["+add9"]],M13:["1P 3M 5P 7M 9M 13M",["maj13","Maj13"]],"M13#11":["1P 3M 5P 7M 9M 11A 13M",["maj13#11","Maj13#11","M13+4","M13#4"]],M6:["1P 3M 5P 13M",["6"]],"M6#11":["1P 3M 5P 6M 11A",["M6b5","6#11","6b5"]],M69:["1P 3M 5P 6M 9M",["69"]],"M69#11":["1P 3M 5P 6M 9M 11A"],"M7#11":["1P 3M 5P 7M 11A",["maj7#11","Maj7#11","M7+4","M7#4"]],"M7#5":["1P 3M 5A 7M",["maj7#5","Maj7#5","maj9#5","M7+"]],"M7#5sus4":["1P 4P 5A 7M"],"M7#9#11":["1P 3M 5P 7M 9A 11A"],M7add13:["1P 3M 5P 6M 7M 9M"],M7b5:["1P 3M 5d 7M"],M7b6:["1P 3M 6m 7M"],M7b9:["1P 3M 5P 7M 9m"],M7sus4:["1P 4P 5P 7M"],M9:["1P 3M 5P 7M 9M",["maj9","Maj9"]],"M9#11":["1P 3M 5P 7M 9M 11A",["maj9#11","Maj9#11","M9+4","M9#4"]],"M9#5":["1P 3M 5A 7M 9M",["Maj9#5"]],"M9#5sus4":["1P 4P 5A 7M 9M"],M9b5:["1P 3M 5d 7M 9M"],M9sus4:["1P 4P 5P 7M 9M"],Madd9:["1P 3M 5P 9M",["2","add9","add2"]],Maj7:["1P 3M 5P 7M",["maj7","M7"]],Mb5:["1P 3M 5d"],Mb6:["1P 3M 13m"],Msus2:["1P 2M 5P",["add9no3","sus2"]],Msus4:["1P 4P 5P",["sus","sus4"]],Maddb9:["1P 3M 5P 9m"],7:["1P 3M 5P 7m",["Dominant","Dom"]],9:["1P 3M 5P 7m 9M",["79"]],11:["1P 5P 7m 9M 11P"],13:["1P 3M 5P 7m 9M 13M",["13_"]],"11b9":["1P 5P 7m 9m 11P"],"13#11":["1P 3M 5P 7m 9M 11A 13M",["13+4","13#4"]],"13#9":["1P 3M 5P 7m 9A 13M",["13#9_"]],"13#9#11":["1P 3M 5P 7m 9A 11A 13M"],"13b5":["1P 3M 5d 6M 7m 9M"],"13b9":["1P 3M 5P 7m 9m 13M"],"13b9#11":["1P 3M 5P 7m 9m 11A 13M"],"13no5":["1P 3M 7m 9M 13M"],"13sus4":["1P 4P 5P 7m 9M 13M",["13sus"]],"69#11":["1P 3M 5P 6M 9M 11A"],"7#11":["1P 3M 5P 7m 11A",["7+4","7#4","7#11_","7#4_"]],"7#11b13":["1P 3M 5P 7m 11A 13m",["7b5b13"]],"7#5":["1P 3M 5A 7m",["+7","7aug","aug7"]],"7#5#9":["1P 3M 5A 7m 9A",["7alt","7#5#9_","7#9b13_"]],"7#5b9":["1P 3M 5A 7m 9m"],"7#5b9#11":["1P 3M 5A 7m 9m 11A"],"7#5sus4":["1P 4P 5A 7m"],"7#9":["1P 3M 5P 7m 9A",["7#9_"]],"7#9#11":["1P 3M 5P 7m 9A 11A",["7b5#9"]],"7#9#11b13":["1P 3M 5P 7m 9A 11A 13m"],"7#9b13":["1P 3M 5P 7m 9A 13m"],"7add6":["1P 3M 5P 7m 13M",["67","7add13"]],"7b13":["1P 3M 7m 13m"],"7b5":["1P 3M 5d 7m"],"7b6":["1P 3M 5P 6m 7m"],"7b9":["1P 3M 5P 7m 9m"],"7b9#11":["1P 3M 5P 7m 9m 11A",["7b5b9"]],"7b9#9":["1P 3M 5P 7m 9m 9A"],"7b9b13":["1P 3M 5P 7m 9m 13m"],"7b9b13#11":["1P 3M 5P 7m 9m 11A 13m",["7b9#11b13","7b5b9b13"]],"7no5":["1P 3M 7m"],"7sus4":["1P 4P 5P 7m",["7sus"]],"7sus4b9":["1P 4P 5P 7m 9m",["susb9","7susb9","7b9sus","7b9sus4","phryg"]],"7sus4b9b13":["1P 4P 5P 7m 9m 13m",["7b9b13sus4"]],"9#11":["1P 3M 5P 7m 9M 11A",["9+4","9#4","9#11_","9#4_"]],"9#11b13":["1P 3M 5P 7m 9M 11A 13m",["9b5b13"]],"9#5":["1P 3M 5A 7m 9M",["9+"]],"9#5#11":["1P 3M 5A 7m 9M 11A"],"9b13":["1P 3M 7m 9M 13m"],"9b5":["1P 3M 5d 7m 9M"],"9no5":["1P 3M 7m 9M"],"9sus4":["1P 4P 5P 7m 9M",["9sus"]],m:["1P 3m 5P"],"m#5":["1P 3m 5A",["m+","mb6"]],m11:["1P 3m 5P 7m 9M 11P",["_11"]],"m11A 5":["1P 3m 6m 7m 9M 11P"],m11b5:["1P 3m 7m 12d 2M 4P",["h11","_11b5"]],m13:["1P 3m 5P 7m 9M 11P 13M",["_13"]],m6:["1P 3m 4P 5P 13M",["_6"]],m69:["1P 3m 5P 6M 9M",["_69"]],m7:["1P 3m 5P 7m",["minor7","_","_7"]],"m7#5":["1P 3m 6m 7m"],m7add11:["1P 3m 5P 7m 11P",["m7add4"]],m7b5:["1P 3m 5d 7m",["half-diminished","h7","_7b5"]],m9:["1P 3m 5P 7m 9M",["_9"]],"m9#5":["1P 3m 6m 7m 9M"],m9b5:["1P 3m 7m 12d 2M",["h9","-9b5"]],mMaj7:["1P 3m 5P 7M",["mM7","_M7"]],mMaj7b6:["1P 3m 5P 6m 7M",["mM7b6"]],mM9:["1P 3m 5P 7M 9M",["mMaj9","-M9"]],mM9b6:["1P 3m 5P 6m 7M 9M",["mMaj9b6"]],mb6M7:["1P 3m 6m 7M"],mb6b9:["1P 3m 6m 9m"],o:["1P 3m 5d",["mb5","dim"]],o7:["1P 3m 5d 13M",["diminished","m6b5","dim7"]],o7M7:["1P 3m 5d 6M 7M"],oM7:["1P 3m 5d 7M"],sus24:["1P 2M 4P 5P",["sus4add9"]],"+add#9":["1P 3M 5A 9A"],madd4:["1P 3m 4P 5P"],madd9:["1P 3m 5P 9M"]};
},{}],"Hkza":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.chroma=i,exports.chromas=a,exports.modes=f,exports.isChroma=l,exports.intervals=m,exports.isEqual=h,exports.isSubsetOf=x,exports.isSupersetOf=v,exports.includes=g,exports.filter=d;var r=require("tonal-note"),n=require("tonal-interval"),t=require("tonal-array"),e=function(t){return(0,r.chroma)(t)||(0,n.chroma)(t)||0},u=function(r){return parseInt(i(r),2)},o=function(r){return r.replace(/0/g,"").length};function i(r){if(l(r))return r;if(!Array.isArray(r))return"";var n=[0,0,0,0,0,0,0,0,0,0,0,0];return r.map(e).forEach(function(r){n[r]=1}),n.join("")}var c=null;function a(r){return c=c||(0,t.range)(2048,4095).map(function(r){return r.toString(2)}),"number"==typeof r?c.filter(function(n){return o(n)===r}):c.slice()}function f(r,n){n=!1!==n;var e=i(r).split("");return(0,t.compact)(e.map(function(r,u){var o=(0,t.rotate)(u,e);return n&&"0"===o[0]?null:o.join("")}))}var s=/^[01]{12}$/;function l(r){return s.test(r)}var p="1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M".split(" ");function m(r){return l(r)?(0,t.compact)(r.split("").map(function(r,n){return"1"===r?p[n]:null})):[]}function h(r,n){return 1===arguments.length?function(n){return h(r,n)}:i(r)===i(n)}function x(r,n){return arguments.length>1?x(r)(n):(r=u(r),function(n){return(n=u(n))!==r&&(n&r)===n})}function v(r,n){return arguments.length>1?v(r)(n):(r=u(r),function(n){return(n=u(n))!==r&&(n|r)===n})}function g(r,n){return arguments.length>1?g(r)(n):(r=i(r),function(n){return"1"===r[e(n)]})}function d(r,n){return 1===arguments.length?function(n){return d(r,n)}:n.filter(g(r))}
},{"tonal-note":"W+c/","tonal-interval":"JYnb","tonal-array":"XBB2"}],"5SFq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pcset=exports.chord=exports.scale=exports.combine=exports.dictionary=void 0;var e=require("./data/scales.json"),r=s(e),t=require("./data/chords.json"),n=s(t),o=require("tonal-pcset");function s(e){return e&&e.__esModule?e:{default:e}}var c=exports.dictionary=function(e){var r=Object.keys(e).sort(),t=[],n=[],s=function(e,r,o){t[e]=r,n[o]=n[o]||[],n[o].push(e)};r.forEach(function(r){var t=e[r][0].split(" "),n=e[r][1],c=(0,o.chroma)(t);s(r,t,c),n&&n.forEach(function(e){return s(e,t,c)})});var c=Object.keys(t).sort(),u=function(e){return t[e]};return u.names=function(e){return"string"==typeof e?(n[e]||[]).slice():(!0===e?c:r).slice()},u},u=exports.combine=function(e,r){var t=function(t){return e(t)||r(t)};return t.names=function(t){return e.names(t).concat(r.names(t))},t},a=exports.scale=c(r.default),i=exports.chord=c(n.default),p=exports.pcset=u(a,i);
},{"./data/scales.json":"2NAS","./data/chords.json":"2Fez","tonal-pcset":"Hkza"}],"lYMn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subsets=exports.supersets=exports.toScale=exports.chords=exports.modeNames=exports.intervals=exports.names=exports.props=void 0,exports.notes=p,exports.exists=f,exports.tokenize=m;var e=require("tonal-note"),r=require("tonal-pcset"),t=require("tonal-distance"),n=require("tonal-dictionary"),s=require("tonal-array"),o=Object.freeze({name:null,intervals:[],names:[],chroma:null,setnum:null}),a=function(e){var t=(0,n.scale)(e);if(!t)return o;var s={intervals:t,name:e};return s.chroma=(0,r.chroma)(t),s.setnum=parseInt(s.chroma,2),s.names=n.scale.names(s.chroma),Object.freeze(s)},u=function(e,r){return function(t){return r[t]||(r[t]=e(t))}},i=exports.props=u(a,{}),c=exports.names=n.scale.names,l=exports.intervals=function(e){var r=m(e);return i(r[1]).intervals};function p(e,r){var n=m(e);return r=r||n[1],l(r).map((0,t.transpose)(n[0]))}function f(e){var r=m(e);return void 0!==(0,n.scale)(r[1])}function m(r){if("string"!=typeof r)return["",""];var t=r.indexOf(" "),n=(0,e.name)(r.substring(0,t))||(0,e.name)(r)||"",s=""!==n?r.substring(n.length+1):r;return[n,s.length?s:""]}var v=exports.modeNames=function(e){var t=l(e),s=p(e);return(0,r.modes)(t).map(function(e,r){var o=n.scale.names(e)[0];if(o)return[s[r]||t[r],o]}).filter(function(e){return e})},x=exports.chords=function(e){var t=(0,r.isSubsetOf)(l(e));return n.chord.names().filter(function(e){return t((0,n.chord)(e))})},d=exports.toScale=function(r){var t=(0,s.compact)(r.map(e.pc));if(!t.length)return t;var n=t[0],o=(0,s.unique)(t);return(0,s.rotate)(o.indexOf(n),o)},h=exports.supersets=function(e){if(!l(e).length)return[];var t=(0,r.isSupersetOf)(l(e));return n.scale.names().filter(function(e){return t((0,n.scale)(e))})},b=exports.subsets=function(e){var t=(0,r.isSubsetOf)(l(e));return n.scale.names().filter(function(e){return t((0,n.scale)(e))})};
},{"tonal-note":"W+c/","tonal-pcset":"Hkza","tonal-distance":"9+ru","tonal-dictionary":"5SFq","tonal-array":"XBB2"}],"bRH8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subsets=exports.supersets=exports.exists=exports.intervals=exports.props=exports.names=void 0,exports.notes=p,exports.tokenize=x;var e=require("tonal-note"),r=require("tonal-distance"),t=require("tonal-dictionary"),n=require("tonal-pcset"),s=exports.names=t.chord.names,o=Object.freeze({name:null,names:[],intervals:[],chroma:null,setnum:null}),u=function(e){var r=(0,t.chord)(e);if(!r)return o;var s={intervals:r,name:e};return s.chroma=(0,n.chroma)(r),s.setnum=parseInt(s.chroma,2),s.names=t.chord.names(s.chroma),s},a=function(e,r){return void 0===r&&(r={}),function(t){return r[t]||(r[t]=e(t))}},i=exports.props=a(u),c=exports.intervals=function(e){return i(x(e)[1]).intervals};function p(e,t){if(t)return i(t).intervals.map((0,r.transpose)(e));var n=x(e),s=n[0],o=n[1];return i(o).intervals.map((0,r.transpose)(s))}var l=exports.exists=function(e){return void 0!==(0,t.chord)(x(e)[1])},f=exports.supersets=function(e){if(!c(e).length)return[];var r=(0,n.isSupersetOf)(c(e));return t.chord.names().filter(function(e){return r((0,t.chord)(e))})},m=exports.subsets=function(e){var r=(0,n.isSubsetOf)(c(e));return t.chord.names().filter(function(e){return r((0,t.chord)(e))})},v=/^(6|64|7|9|11|13)$/;function x(r){var t=(0,e.tokenize)(r);return""===t[0]?["",r]:"A"===t[0]&&"ug"===t[3]?["","aug"]:v.test(t[2])?[t[0]+t[1],t[2]+t[3]]:[t[0]+t[1]+t[2],t[3]]}
},{"tonal-note":"W+c/","tonal-distance":"9+ru","tonal-dictionary":"5SFq","tonal-pcset":"Hkza"}],"PUgG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.scale=exports.chord=exports.freq=exports.midi=exports.note=exports.interval=exports.transpose=exports.Dictionary=exports.PcSet=exports.Chord=exports.Scale=exports.Distance=exports.Interval=exports.Note=exports.Array=void 0;var e=require("tonal-array"),r=f(e),t=require("tonal-note"),o=f(t),s=require("tonal-interval"),p=f(s),a=require("tonal-distance"),n=f(a),i=require("tonal-dictionary"),x=f(i),l=require("tonal-scale"),c=f(l),u=require("tonal-chord"),d=f(u),q=require("tonal-pcset"),v=f(q);function f(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}exports.Array=r,exports.Note=o,exports.Interval=p,exports.Distance=n,exports.Scale=c,exports.Chord=d,exports.PcSet=v,exports.Dictionary=x;const y=exports.transpose=n.transpose,h=exports.interval=n.interval,D=exports.note=o.props,P=exports.midi=o.midi,S=exports.freq=o.freq,_=exports.chord=x.chord,m=exports.scale=x.scale;
},{"tonal-array":"XBB2","tonal-note":"W+c/","tonal-interval":"JYnb","tonal-distance":"9+ru","tonal-dictionary":"5SFq","tonal-scale":"lYMn","tonal-chord":"bRH8","tonal-pcset":"Hkza"}],"XZf0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util"),e=function(){function e(t){var e=void 0===t?{}:t,n=e.context,i=e.gain,o=e.mix,a=e.onTrigger,r=e.midiOffset;this.midiOffset=0,this.gain=1,this.activeEvents=[],this.onTrigger=a,this.midiOffset=r||this.midiOffset,this.gain=i||this.gain,this.init({context:n,mix:o})}return e.prototype.init=function(t){var e=t.context,n=t.mix;e||n&&n.context?(this.context=e||n.context,this.mix=n||this.context.destination):console.warn("you should pass a context or a mix (gainNode) to a new Instrument. \n            You can also Call init with {context,mix} to setup the Instrument later")},e.prototype.playNotes=function(e,n){var i=this;void 0===n&&(n={});var o=n.deadline||this.context.currentTime;if((n=Object.assign({duration:2e3,gain:1},n,{deadline:o})).interval)return e.map(function(t,e){i.playNotes([t],Object.assign({},n,{interval:0,deadline:o+e*n.interval}))});var a=e.map(function(e){return t.getMidi(e,i.midiOffset)}),r=n.deadline+n.duration/1e3,s=e.map(function(t,e){return{note:t,midi:a[e],gain:n.gain,noteOff:r,deadline:n.deadline}});return n.pulse&&this.onTrigger&&n.pulse.clock.callbackAtTime(function(t){i.activeEvents=i.activeEvents.concat(s),i.onTrigger({on:s,off:[],active:i.activeEvents})},n.deadline),n.duration&&n.pulse&&n.pulse.clock.callbackAtTime(function(t){var n=e.filter(function(e){return!i.activeEvents.find(function(n){var i=e===n.note&&n.noteOff>t;return i&&console.log("keep",e),i})}).map(function(t){return i.activeEvents.find(function(e){return e.note===t})});i.activeEvents=i.activeEvents.filter(function(t){return!n.includes(t)}),i.onTrigger&&i.onTrigger({on:[],off:n,active:i.activeEvents})},r),this.playKeys(a,n)},e.prototype.playKeys=function(t,e){},e}();exports.Instrument=e;
},{"../util":"BHXf"}],"uWN9":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Instrument"),n=require("tonal"),r=require("../util"),i=function(e){function i(t){var n=e.call(this,t)||this;return n.duration=200,n.type="sine",n.gain=.9,n.attack=.05,n.decay=.05,n.sustain=.4,n.release=.1,n.duration=t.duration||n.duration,n.type=t.type||n.type,n.gain=t.gain||n.gain,n}return t(i,e),i.prototype.getVoice=function(t,e,r){void 0===t&&(t="sine"),void 0===e&&(e=0);var i=n.Note.freq(r),o=this.context.createOscillator();o.type=t;var a=this.context.createGain();return o.connect(a),a.gain.value="number"==typeof e?e:.8,a.connect(this.mix),o.frequency.value=i,{oscNode:o,gainNode:a,key:r,frequency:i}},i.prototype.lowestGain=function(t,e){return t.gain.gain.value<e.gain.gain.value?-1:0},i.prototype.startKeys=function(t,e){void 0===e&&(e={})},i.prototype.playKeys=function(t,n){var i=this;void 0===n&&(n={}),e.prototype.playKeys.call(this,t,n);var o=n.deadline||this.context.currentTime,a=n.interval||0;return t.map(function(t,e){var s=e*a,c=[n.endless,n.attack||i.attack,n.decay||i.decay,n.sustain||i.sustain,n.release||i.release,(n.duration||i.duration)/1e3,(n.gain||1)*i.gain],u=c[0],p=c[1],y=c[2],d=c[3],l=c[4],f=c[5],v=c[6],g=i.getVoice(i.type,0,t);return r.adsr({attack:p,decay:y,sustain:d,release:l,gain:v,duration:f,endless:u},o+s,g.gainNode.gain),g.oscNode.start(n.deadline+s),g})},i.prototype.stopVoice=function(t,e){if(void 0===e&&(e={}),t){var n=e.deadline||this.context.currentTime;t.gainNode.gain.setTargetAtTime(0,n,e.release||this.release)}},i.prototype.stopVoices=function(t,e){var n=this;t.forEach(function(t){n.stopVoice(t,e)})},i}(e.Instrument);exports.Synthesizer=i;
},{"./Instrument":"XZf0","tonal":"PUgG","../util":"BHXf"}],"AFmE":[function(require,module,exports) {
"use strict";var o=this&&this.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(null!=o)for(var n in o)Object.hasOwnProperty.call(o,n)&&(s[n]=o[n]);return s.default=o,s};Object.defineProperty(exports,"__esModule",{value:!0});var s=o(require("tonal-chord")),n=o(require("tonal-scale"));function t(o){return function(s){var n=Math.max(s.groups.filter(function(o){return-1!==exports.levels.indexOf(o)}).map(function(o){return exports.levels.indexOf(o)+1}));return-1!==(n>0?Array.from(new Set(exports.levels.slice(n).concat(s.groups))):s.groups).indexOf(o)}}function r(o){return void 0===o&&(o="Basic"),o&&"All"!==o?exports.scales.filter(t(o)).map(function(o){return o.symbol}):n.names()}function i(o){return void 0===o&&(o="Basic"),o&&"All"!==o?exports.chords.filter(t(o)).map(function(o){return o.symbol}):s.names()}function e(){return Array.from(new Set(exports.levels.concat(exports.scales.concat(exports.chords).map(function(o){return o.groups}).reduce(function(o,s){return o.concat(s)})))).concat(["All"])}function a(o,s,n){var t=exports.symbols[o+"s"].find(function(o){return o.symbol===s});return t&&(n?t.long:t.short)||s}function c(o,s){return void 0===s&&(s=!1),a("scale",o,s)}function m(o,s){return void 0===s&&(s=!1),a("chord",o,s)}function l(o){return o[Math.floor(Math.random()*o.length)]}function p(o){return l(r(o))}function u(o){return l(i(o))}exports.chords=[{symbol:"m",long:"minor",short:"-",groups:["Basic","Triads"]},{symbol:"M",long:"major",short:"△",groups:["Basic","Triads"]},{symbol:"o",groups:["Basic","Symmetric","Triads"],long:"Vermindert"},{symbol:"M#5",groups:["Advanced","Symmetric","Triads"],short:"△#5"},{symbol:"Msus4",groups:["Advanced","Symmetric"],short:"sus4"},{symbol:"Msus2",groups:["Advanced","Symmetric"],short:"sus2"},{symbol:"7",groups:["Basic","Diatonic","Modes"],long:"Dominantsept"},{symbol:"7#11",groups:["Advanced","Diatonic","Modes"],long:"Dominant #11"},{symbol:"M6",groups:["Advanced"],long:"major 6",short:"6"},{symbol:"o7",groups:["Advanced","Symmetric","Diatonic"],long:"Vermindert 7"},{symbol:"m7",groups:["Basic","Diatonic","Modes"],long:"minor 7",short:"-7"},{symbol:"oM7",groups:["Expert"],long:"diminished major 7",short:"o△7"},{symbol:"m7b5",groups:["Basic","Diatonic","Modes"],long:"Halbvermindert",short:"-7b5"},{symbol:"7#5",groups:["Advanced","Symmetric"],long:"Dominantsept #5"},{symbol:"Maj7",groups:["Basic","Diatonic","Modes"],long:"Major 7",short:"△7"},{symbol:"mMaj7",short:"-△7",groups:["Advanced","Diatonic"]},{symbol:"M7#5",groups:["Advanced","Diatonic"],short:"△7#5"},{symbol:"7sus4",groups:["Advanced"]},{symbol:"9",groups:["Advanced"]},{symbol:"M9",groups:["Advanced"],short:"△9"}],exports.scales=[{symbol:"major pentatonic",groups:["Basic","Pentatonic"]},{symbol:"minor pentatonic",groups:["Basic","Pentatonic"]},{symbol:"minor blues",groups:["Basic"]},{symbol:"major",groups:["Basic","Diatonic","Modes"]},{symbol:"dorian",groups:["Basic","Diatonic","Modes"]},{symbol:"phrygian",groups:["Basic","Diatonic","Modes"]},{symbol:"lydian",groups:["Basic","Diatonic","Modes"]},{symbol:"mixolydian",groups:["Basic","Diatonic","Modes"]},{symbol:"aeolian",groups:["Basic","Diatonic","Modes"]},{symbol:"locrian",groups:["Basic","Diatonic","Modes"]},{symbol:"whole tone",groups:["Advanced","Symmetric"]},{symbol:"diminished",groups:["Advanced","Symmetric"]},{symbol:"augmented",groups:["Advanced","Symmetric"]},{symbol:"chromatic",groups:["Expert","Symmetric"]},{symbol:"harmonic minor",groups:["Advanced","Diatonic"]},{symbol:"ionian augmented",groups:["Expert","Diatonic"]},{symbol:"dorian #4",groups:["Expert","Diatonic"]},{symbol:"spanish",groups:["Advanced","Diatonic"]},{symbol:"melodic minor",groups:["Advanced","Diatonic"]},{symbol:"melodic minor second mode",groups:["Expert","Diatonic"]},{symbol:"lydian augmented",groups:["Expert","Diatonic"]},{symbol:"lydian dominant",groups:["Advanced","Diatonic"],long:"mixolydian #11"},{symbol:"melodic minor fifth mode",groups:["Expert","Diatonic"]},{symbol:"locrian #2",groups:["Expert","Diatonic"]},{symbol:"altered",groups:["Advanced","Diatonic"]},{symbol:"kumoijoshi",groups:["Exotic","Pentatonic"]},{symbol:"iwato",groups:["Exotic","Pentatonic"]},{symbol:"pelog",groups:["Exotic","Pentatonic"]},{symbol:"egyptian",groups:["Exotic","Pentatonic"]},{symbol:"in-sen",groups:["Exotic","Pentatonic"]},{symbol:"scriabin",groups:["Exotic","Pentatonic"]},{symbol:"ritusen",groups:["Exotic","Pentatonic"]},{symbol:"hirajoshi",groups:["Exotic","Pentatonic"]},{symbol:"malkos raga",groups:["Exotic","Pentatonic"]},{symbol:"vietnamese 1",groups:["Exotic","Pentatonic"]},{symbol:"lydian pentatonic",groups:["Pentatonic"]},{symbol:"mixolydian pentatonic",groups:["Pentatonic"]},{symbol:"ionian pentatonic",groups:["Pentatonic"]},{symbol:"locrian pentatonic",groups:["Pentatonic"]},{symbol:"flat six pentatonic",groups:["Pentatonic"]},{symbol:"minor six pentatonic",groups:["Pentatonic"]},{symbol:"minor #7M pentatonic",groups:["Pentatonic"]},{symbol:"lydian #5P pentatonic",groups:["Pentatonic"]},{symbol:"whole tone pentatonic",groups:["Pentatonic","Symmetric"]},{symbol:"flat three pentatonic",groups:["Pentatonic"]},{symbol:"super locrian pentatonic",groups:["Pentatonic"]},{symbol:"major flat two pentatonic",groups:["Pentatonic"]},{symbol:"lydian dominant pentatonic",groups:["Pentatonic"]},{symbol:"neopolitan major pentatonic",groups:["Pentatonic"]}],exports.symbols={chords:exports.chords,scales:exports.scales},exports.levels=["Basic","Advanced","Expert"],exports.groupFilter=t,exports.scaleNames=r,exports.chordNames=i,exports.groupNames=e,exports.symbolName=a,exports.scaleName=c,exports.chordName=m,exports.randomItem=l,exports.randomScale=p,exports.randomChord=u;
},{"tonal-chord":"bRH8","tonal-scale":"lYMn"}],"BHXf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("tonal"),e=require("./instruments/Synthesizer"),n=require("./symbols");function r(t){return Math.floor(Math.random()*t)}function o(t){return t.reduce(function(t,e){return t+e},0)}function i(t,e){if(!e)return t[r(t.length)];var n=r(o(e))+1,i=e.reduce(function(t,e,n){return t.concat(e+(t.length?t[n-1]:0))},[]);return t[i.indexOf(i.find(function(t,e){return t>=n}))]}function a(t){for(var e,n=t.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1));e=[t[r],t[n]],t[n]=e[0],t[r]=e[1]}return t}function s(e){e=e.replace("-","m").replace("^","M").replace("h7","m7b5").replace("h","dim");var n=t.Chord.tokenize(e),r=n[1].split("/");return n[0]+(r[0]||"M")}function u(e,n){return t.Note.props(e).midi-n}function c(t,e,n){return void 0===n&&(n=[]),Array.isArray(e[t[0]])&&1!==t.length?this.getPath(t.slice(1),e[t[0]],n.concat(t[0])):e[Math.min(t[0],e.length-1)]}function f(t,e,n){return void 0===e&&(e=1),void 0===n&&(n=1),e*t.reduce(function(t,e){return t/e},1e3)*n}function p(t,e,n,r){var o=this;if(void 0===r&&(r=[]),Array.isArray(t))return r=[].concat(r,[t.length]),t.map(function(t,i){return o.resolveChords(t,e,n.concat([i]),r)});if(0===t)return 0;var i=f(r,t);return 0===i&&console.warn("fraction is 0",t),{chord:this.getPath(n,e),pattern:t,path:n,divisions:r,fraction:i}}function l(t,e){return void 0===e&&(e=3),Array.isArray(t)&&t.length===e&&0!==t[e-1]}function d(t){var e=this;return function(n,r,o){var i=o>0?n[o-1]:null;return i&&e.hasOff(i[t.cycle-1],t.division)&&(i[t.cycle-1][t.division-1]=r[0],r[0]=0),n.concat([r])}}function v(e){var n={"1A":"-8d","-1A":"8d"};return n[e]?n[e]:t.Interval.semitones(e)<0?t.Interval.invert(e.slice(1)):"-"+t.Interval.invert(e)}function m(e){var n={"8P":"1P","-8P":"1P","0A":"1P","-0A":"1P","8d":"-1A","-8d":"1A"};return n[e=t.Interval.simplify(e)||"1P"]?n[e]:e}function h(e,n){return"up"===n&&t.Interval.semitones(e)<0||"down"===n&&t.Interval.semitones(e)>0?v(e):e}function x(e,n,r){if(void 0===n&&(n="up"),e=m(e),!r){var o=v(e);Math.abs(t.Interval.semitones(o))<Math.abs(t.Interval.semitones(e))&&(e=o)}return n&&r?h(e,n):e}function g(t,e){return void 0===t&&(t="up"),function(n){return x(n,t,e)}}function D(e){return void 0===e&&(e="up"),function(n,r){var o=Math.abs(t.Interval.semitones(n))-Math.abs(t.Interval.semitones(r));return 0===o?"up"===e?-1:1:o}}function M(e,n,r,o){void 0===o&&(o=!!r);var i=x(t.Distance.interval(t.Note.pc(e),n),r,o);return t.Distance.transpose(e,i)}function I(e,n,r,o,i){void 0===r&&(r="down"),void 0===o&&(o=!1),void 0===i&&(i=!1);var a=n.map(function(n){return t.Distance.interval(t.Note.pc(e),n)}).map(g(r,o)).sort(D(r));return i&&(a=a.reverse()),a.map(function(n){return t.Distance.transpose(e,n)})}function P(e,n){return n.map(function(n){return e.map(function(e){return t.Distance.interval(e,n)}).map(function(t){return x(t)})})}function y(t,n,r){void 0===n&&(n=["sine","triangle","square","sawtooth"]),void 0===r&&(r={});var o=i(n);return new e.Synthesizer(Object.assign({gain:{sine:.9,triangle:.8,square:.2,sawtooth:.3}[o],type:o,mix:t},r))}function b(t,e,n){var r=t.attack,o=t.decay,i=t.sustain,a=t.release,s=t.gain,u=t.duration,c=t.endless;n.linearRampToValueAtTime(s,e+r),n.setTargetAtTime(i*s,e+Math.min(r+o,u),o),c||n.setTargetAtTime(0,e+Math.max(u-r-o,r+o,u),a)}function A(t){return Math.random()*t*2/1e3}function S(e,n){return t.Distance.semitones(e,n[0])<=0&&t.Distance.semitones(e,n[1])>=0}function C(e,n){return e.map(function(e){return t.Distance.transpose(e,n)})}function N(e,n,r){return void 0===r&&(r=0),r>10?e:e.find(function(e){return t.Distance.semitones(e,n[0])>0})?N(e=e.map(function(e){return t.Distance.transpose(e,"8P")}),n,++r):e.find(function(e){return t.Distance.semitones(e,n[1])<0})?N(e=e.map(function(e){return t.Distance.transpose(e,"-8P")}),n,++r):e}function T(t){return"number"==typeof t&&t<0&&(t="b"+-1*t),t+""}exports.randomNumber=r,exports.arraySum=o,exports.randomElement=i,exports.shuffleArray=a,exports.getTonalChord=s,exports.getMidi=u,exports.getPath=c,exports.getDuration=f,exports.resolveChords=p,exports.hasOff=l,exports.offbeatReducer=d,exports.invertInterval=v,exports.simplifyInterval=m,exports.forceDirection=h,exports.minInterval=x,exports.mapMinInterval=g,exports.sortMinInterval=D,exports.getNearestNote=M,exports.getNearestTargets=I,exports.intervalMatrix=P,exports.randomSynth=y,exports.adsr=b,exports.randomDelay=A,exports.isInRange=S,exports.transposeNotes=C,exports.transposeToRange=N,exports.getStep=T;var w={"1P":["1","8"],"2m":["b9","b2"],"2M":["9","2"],"2A":["#9","#2"],"3m":["b3"],"3M":["3"],"4P":["11","4"],"4A":["#11","#4"],"5D":["b5"],"5P":["5"],"6m":["b13","b6"],"6M":["13","6"],"7m":["b7"],"7M":["7","^7","maj7"]};function k(t){t=T(t);var e=Object.keys(w).find(function(e){return w[e].includes(t)});return e}function O(e,r){void 0===r&&(r="Diatonic");var o=t.Chord.tokenize(s(e)),i=t.PcSet.isSupersetOf(t.Chord.intervals(o[1]));return n.scaleNames(r).filter(function(e){return i(t.Scale.intervals(e))})}function z(t,e){void 0===e&&(e="Diatonic");var n=O(t);if(n.length)return n[0];console.warn("cannot pick chord scale: no scales found for chord "+t+" in group "+e)}function q(t,e){return e.find(function(e){return e.includes(T(t))||e===k(t)})}function R(t,e){return!!q(t,e)}function j(t,e){return t.reduce(function(t,n){return t&&R(n,e)},!0)}function F(e,n){return q(e,t.Scale.intervals(n))}function _(e,n,r){return H(t.Distance.interval(t.Chord.tokenize(s(n))[0],t.Note.pc(e)))}function B(t,e){return t.map(function(t){return F(t,e)})}function E(e,n){return e.map(function(e){return t.Distance.transpose(n,e)})}function G(t,e){return E(t.map(function(t){return k(t)}),e)}function V(t,e){return e.map(function(e){return q(e,t)})}function H(t){return w[t]?w[t][0]:0}function J(e,n){n=s(n);var r,o=t.Chord.intervals(n),i=t.Chord.tokenize(n);if(j(e,o))r=V(o,e);else{var a=z(n);r=V(t.Scale.intervals(a),e)}return i[0]?E(r,i[0]):r}function K(e){e=s(e);var n=t.Chord.intervals(e);return n.includes("3m")?[1,3,4,5]:n.includes("3M")?[1,2,3,5]:[1,1,1,1]}function L(t){return J(K(t),t)}function Q(t){return J([3,7],t=s(t))}function U(e,n){var r=[t.Distance.semitones(n[0],e),t.Distance.semitones(n[0],n[1])];return r[0]/r[1]}function W(t,e){return 0===t.slice(e).reduce(function(t,e){return t+e},0)}function X(t){return W(t,1)}function Y(t){return W(t,0)}function Z(t){return 0!==t[2]}function $(t,e){return"up"===t?"down":"down"===t?"up":e}function tt(t){return t.replace(/\n/g,"|").split("|").map(function(t){return t.split(/\s/)}).map(function(t){return t.filter(function(t){return!!t})}).map(function(t){return 1===t.length?t[0]:t}).filter(function(t){return!t||t.length})}exports.getIntervalFromStep=k,exports.getChordScales=O,exports.pickChordScale=z,exports.findDegree=q,exports.hasDegree=R,exports.hasAllDegrees=j,exports.getScaleDegree=F,exports.getDegreeInChord=_,exports.getScalePattern=B,exports.renderIntervals=E,exports.renderSteps=G,exports.permutateIntervals=V,exports.getDegreeFromInterval=H,exports.getPatternInChord=J,exports.getDigitalPattern=K,exports.renderDigitalPattern=L,exports.getGuideTones=Q,exports.getRangePosition=U,exports.isFirstInPath=W,exports.isBarStart=X,exports.isFormStart=Y,exports.isOffbeat=Z,exports.otherDirection=$,exports.parseChords=tt;
},{"tonal":"PUgG","./instruments/Synthesizer":"uWN9","./symbols":"AFmE"}],"I2+J":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t){this.name="Musician",this.gain=1,t||console.warn("musician has no instrument",this),this.instrument=t,this.ready=this.instrument?this.instrument.ready:Promise.resolve()}return t.prototype.play=function(t){var n=t.pulse,i=t.measures,e=t.settings;console.log("play..",n,i,e)},t.prototype.getGain=function(t){return void 0===t&&(t=1),t*this.gain*this.instrument.gain},t}();exports.Musician=t;
},{}],"F3aX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=require("../util"),e=function(){return n.randomElement([0,[0,0,2]],[6,1])},r=function(){return n.randomElement([[1,0,1],1,[0,0,1,1]],[4,2,1])},t=function(){return n.randomElement([[1,0,1],[0,0,1]],[4,1])},o=function(){return n.randomElement([[2,0],[[2,0,2],[0,2,0]],[1,1,1,1]],[2,1,1])};exports.swing={name:"Swing",tempo:130,chords:function(r){var t=r.measure,o=r.settings,u=Math.random()>.5?.6:0,m=o.cycle+"/"+t.length;return"4/1"===m?n.randomElement([[[1,0],[0,0,7],0,0],[1,[0,0,2],0,e()],[[0,0,1],0,2,0],[[0,0,4],0,1,0],[2,0,0,0],[3,0,0,0],[1,0,u,e()],[[0,0,2],0,u,0],[1.5,[0,0,2],0,e()]]):"4/2"===m?n.randomElement([[[1,0],[0,0,7],0,0],[1,[0,0,3],0,0],[1,0,2,0],[2,0,1,0],[1,0,.7,e()],[[1,0,0],0,.7,e()],[[4,0,0],[0,0,2.8],0,e()]]):"4/3"===m?[1,[0,0,2],[0,0,4],0]:n.randomElement([[1,1,1,1],[[1,0,2],[0,0,2],0,1]])},bass:function(){return n.randomElement([[1,1,1,1]])},crash:function(n){var e=n.measures,r=n.index;return 0!==r&&r%e.length==0?[4,0,0,0]:[0,0,0,0]},ride:function(e){e.measures,e.index;return n.randomElement([[.6,[.9,0,1],.6,[.9,0,1]],[.6,[.4,0,1],.8,[0,0,1]],[.6,.9,[.6,0,1],1],[.6,.9,.6,[.9,0,1]]],[3,2,1,2])},hihat:function(){return[0,.8,0,1]},solo:function(){return n.randomElement([[r(),r(),r(),r()],[r(),2,0,r()],[0,0,r(),r()],[[1,0,4],0,r(),r()],[3,0,0,r()],o().concat(o()),[t(),t(),t(),t()]])}};
},{"../util":"BHXf"}],"Dn4f":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var t=require("tonal"),n=require("tonal"),r=require("../util"),i=require("./Musician"),o=require("../grooves/swing"),a=function(i){function a(e,t){void 0===t&&(t={});var n=i.call(this,e)||this;return n.name="Pianist",n.playedNotes=[],n.playedPatterns=[],n.playedChords=[],n.defaults={intelligentVoicings:!0,groove:o.swing,noTonic:!0},n.min=Math.min,n.rollFactor=3,n.range=["C3","G5"],n.props=Object.assign({},n.defaults,t||{}),n}return e(a,i),a.prototype.play=function(e){var t=this,n=e.pulse,i=e.measures,o=e.settings,a=o.groove||this.defaults.groove;if(o.exact||!a||!a.chords)return a.chords||console.warn("Groove has no chords, Pianist will play exact.",a),n.tickArray(i,function(e){var r=n.getMeasureLength();t.playChord(e.value,{deadline:e.deadline,duration:r*e.fraction,pulse:n})});var s=a.chords;i=i.map(function(e){return s({measures:i,pulse:n,measure:e,settings:o}).slice(0,Math.floor(o.cycle))}).map(function(e,t){return r.resolveChords(e,i,[t])}).reduce(r.offbeatReducer(o),[]),n.tickArray(i,function(e){var r=e.path,i=e.value,a=e.deadline,s=n.getMeasureLength(),l=o.bpm/(t.rollFactor||1),c=o.arpeggio?s/o.cycle:Math.random()/(20*l);r[0]%2!=0||r[1]||r[2]||(c=Math.random()/l);var u=o.arpeggio?c:i.fraction*s,p=o.arpeggio?Math.ceil(i.fraction/1e3*4):null,d=t.getGain(i.gain);t.playChord(i.chord,{deadline:a,gain:d,duration:u,interval:c,slice:p,pulse:n})},o.deadline)},a.prototype.getLastVoicing=function(){return this.playedNotes.length?this.playedNotes[this.playedNotes.length-1]:null},a.prototype.getVoicing=function(e,i,o){if(!i)return e;var a=r.intervalMatrix(i,e).map(function(e,n){var o=[].concat(e).sort(r.sortMinInterval())[0];return t.Distance.transpose(i[e.indexOf(o)],o)||console.warn("ALARM",i[e.indexOf(o)],o,e),t.Distance.transpose(i[e.indexOf(o)],o)}).filter(function(e){return!!e}).filter(function(e){return n.Note.simplify(e,!0)});return a&&a.length?a:e},a.prototype.playNotes=function(e,t){var n=t.tonic,i=t.deadline,o=t.interval,a=t.gain,s=t.duration,l=t.pulse;this.props.intelligentVoicings&&this.getLastVoicing()&&(e=this.getVoicing(e,this.getLastVoicing(),n)),e=r.transposeToRange(e,this.range),this.playedNotes.push([].concat(e)),this.instrument.playNotes(e,{deadline:i,interval:o,gain:a,duration:s,pulse:l})},a.prototype.playChord=function(e,i){if("x"===e&&(e=this.playedChords[this.playedChords.length-1]),e&&"0"!==e){this.playedChords.push(e),e=n.Chord.tokenize(r.getTonalChord(e));var o=n.Chord.intervals(e[1]).map(function(e){return e.replace("13","6")}).map(function(n){return t.Distance.transpose(e[0]+"3",n)});o.length>3&&i.noTonic&&(o=o.slice(this.props.noTonic?1:0)),i.slice&&(o=o.slice(0,i.slice?i.slice:o.length)),i.deadline+=.02+r.randomDelay(5),this.playNotes(o,i)}else this.playedChords.push("")},a}(i.Musician);exports.default=a;
},{"tonal":"PUgG","../util":"BHXf","./Musician":"I2+J","../grooves/swing":"F3aX"}],"Hr6C":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./Musician"),r=require("../grooves/swing"),n=require("../util"),i=function(t){function i(e){var n=t.call(this,e)||this;return n.name="Drummer",n.set={kick:0,snare:1,hihat:2,ride:3,crash:4,rimshot:5},n.defaults={groove:r.swing},n}return e(i,t),i.prototype.play=function(e){var t=this,r=e.measures,i=e.pulse,o=e.settings,s=o.groove||this.defaults.groove;Object.keys(s).filter(function(e){return Object.keys(t.set).includes(e)}).forEach(function(e){var u=r.map(function(t,n){return s[e]({measures:r,index:n,measure:t,settings:o,pulse:i}).slice(0,Math.floor(o.cycle))});i.tickArray(u,function(r){var i=r.deadline,o=r.value;i+=n.randomDelay(5),t.instrument.playKeys([t.set[e]],{deadline:i,gain:t.getGain(o)})},o.deadline)})},i}(t.Musician);exports.default=i;
},{"./Musician":"I2+J","../grooves/swing":"F3aX","../util":"BHXf"}],"IXiI":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util"),r=require("./Musician"),n=require("tonal"),o=require("../grooves/swing"),s=function(r){function s(e){var t=r.call(this,e)||this;return t.name="Bassist",t.defaults={groove:o.swing},t.playedChords=[],t}return e(s,r),s.prototype.play=function(e){var r=this,n=e.measures,o=e.pulse,s=e.settings,a=s.groove||this.defaults.groove,i=a.bass;i?(n=n.map(function(e){return i({measures:n,measure:e,settings:s,pulse:o}).slice(0,Math.floor(s.cycle))}).map(function(e,r){return t.resolveChords(e,n,[r])}),o.tickArray(n,function(e){r.playBass(e,n,o)},s.deadline)):console.warn("no bass pattern found in groove",a)},s.prototype.getStep=function(e,r,o){void 0===o&&(o=2);var s=n.Chord.tokenize(t.getTonalChord(r)),a=n.Chord.intervals(s[1]).find(function(t){return parseInt(t[0])===e});return n.Distance.transpose(s[0]+o,a)},s.prototype.playBass=function(e,r,n){var o=e.value,s=(e.cycle,e.path),a=e.deadline,i=e.interval,u=o.chord;if("N.C."!==u)if("x"===u&&(u=this.playedChords[this.playedChords.length-1]),u&&"0"!==u){var l;this.playedChords.push(u);var p=[1,t.randomElement([3,5]),1,t.randomElement([3,5])];l=1===o.value&&u.split("/").length>1?u.split("/")[1]+2:this.getStep(p[s[1]],t.getTonalChord(u),2);var c=o.fraction*n.getMeasureLength();a+=t.randomDelay(10),this.instrument.playNotes([l],{deadline:a,interval:i,gain:this.getGain(),duration:c,pulse:n})}else this.playedChords.push("")},s}(r.Musician);exports.default=s;
},{"../util":"BHXf","./Musician":"I2+J","tonal":"PUgG","../grooves/swing":"F3aX"}],"bsa5":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Instrument"),r=require("../util"),n=function(e){function n(t){void 0===t&&(t={});var r=e.call(this,t)||this;return r.buffers={},r.duration=1e4,r.type="sine",r.gain=1,r.attack=0,r.decay=0,r.sustain=1,r.release=.2,r.gain=t.gain||r.gain,r.gainNode=r.context.createGain(),r.gainNode.connect(r.context.destination),r.duration=t.duration||r.duration,t.samples&&(r.sources=t.samples,r.ready=r.loadSources(t.samples)),r}return t(n,e),n.prototype.getBuffer=function(t,e){var r=this;return void 0===e&&(e=this.context),this.buffers[t]&&this.buffers[t].context===e?Promise.resolve(this.buffers[t].buffer):fetch(t).then(function(t){return t.arrayBuffer()}).then(function(n){return new Promise(function(o,i){e.decodeAudioData(n,function(n){r.buffers[t]={buffer:n,context:e},o(n)})})})},n.prototype.getSource=function(t,e){var r=this.context.createBufferSource();return e=e||this.gainNode,r.buffer=t,r.connect(e),r},n.prototype.getSources=function(t,e){var r=this;return void 0===e&&(e=this.context),this.hasLoaded(t)?t.map(function(t){return r.getSource(r.buffers[t].buffer)}):(console.error("not all sources loaded!!!"),[])},n.prototype.loadSource=function(t,e){var r=this;return void 0===e&&(e=this.context),this.getBuffer(t,e).then(function(t){return r.getSource(t)})},n.prototype.loadSources=function(t,e){var r=this;return void 0===e&&(e=this.context),t.forEach(function(t,e){t||console.warn("note at index "+e+" cannot be played!")}),Promise.all(t.filter(function(t){return!!t}).map(function(t){return r.loadSource(t,e)}))},n.prototype.hasLoaded=function(t,e){var r=this;return void 0===e&&(e=this.context),t.reduce(function(t,n){return t&&r.buffers[n]&&r.buffers[n].context===e},!0)},n.prototype.playSounds=function(t,e,r){void 0===e&&(e=this.context.currentTime),void 0===r&&(r=0),t.forEach(function(t,n){return t.start(e+r*n)})},n.prototype.playSource=function(t,e){var n=this.context.createGain();if(this.buffers[t]){var o=this.getSource(this.buffers[t].buffer,n),i=[e.attack||this.attack,e.decay||this.decay,e.sustain||this.sustain,e.release||this.release,(e.duration||this.duration)/1e3,(e.gain||1)*this.gain],u=i[0],a=i[1],s=i[2],c=i[3],f=i[4],d=i[5],h=e.deadline||this.context.currentTime;n.connect(this.mix),r.adsr({attack:u,decay:a,sustain:s,release:c,gain:d,duration:f},h,n.gain),this.playSounds([o],h)}else console.warn("no buffer found for source",t)},n.prototype.playKeys=function(t,r){var n=this;e.prototype.playKeys.call(this,t,r),t.forEach(function(t,e){r.delay&&(r.deadline+=r.delay),n.playSource(n.sources[t],r)})},n}(e.Instrument);exports.Sampler=n;
},{"./Instrument":"XZf0","../util":"BHXf"}],"7tBp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t){this.context=t}return t.prototype.setup=function(){this.osc=this.context.createOscillator(),this.gain=this.context.createGain(),this.osc.connect(this.gain),this.gain.connect(this.context.destination)},t.prototype.trigger=function(t){this.setup(),this.osc.frequency.setValueAtTime(150,t),this.gain.gain.setValueAtTime(1,t),this.osc.frequency.exponentialRampToValueAtTime(.01,t+.5),this.gain.gain.exponentialRampToValueAtTime(.01,t+.5),this.osc.start(t),this.osc.stop(t+.5)},t}();exports.Kick=t;
},{}],"Ad3Q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e){this.context=e}return e.prototype.noiseBuffer=function(){for(var e=this.context.sampleRate,t=this.context.createBuffer(1,e,this.context.sampleRate),s=t.getChannelData(0),n=0;n<e;n++)s[n]=2*Math.random()-1;return t},e.prototype.setup=function(){this.noise=this.context.createBufferSource(),this.noise.buffer=this.noiseBuffer();var e=this.context.createBiquadFilter();e.type="highpass",e.frequency.value=1e3,this.noise.connect(e),this.noiseEnvelope=this.context.createGain(),e.connect(this.noiseEnvelope),this.noiseEnvelope.connect(this.context.destination),this.osc=this.context.createOscillator(),this.osc.type="triangle",this.oscEnvelope=this.context.createGain(),this.osc.connect(this.oscEnvelope),this.oscEnvelope.connect(this.context.destination)},e.prototype.trigger=function(e){this.setup(),this.noiseEnvelope.gain.setValueAtTime(1,e),this.noiseEnvelope.gain.exponentialRampToValueAtTime(.01,e+.2),this.noise.start(e),this.osc.frequency.setValueAtTime(100,e),this.oscEnvelope.gain.setValueAtTime(.7,e),this.oscEnvelope.gain.exponentialRampToValueAtTime(.01,e+.1),this.osc.start(e),this.osc.stop(e+.2),this.noise.stop(e+.2)},e}();exports.Snare=e;
},{}],"+ZT4":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Instrument"),r=require("./Kick"),n=require("./Snare"),o=function(e){function o(t){var o=e.call(this,t)||this;return o.keys=[new r.Kick(o.context),new n.Snare(o.context)],o}return t(o,e),o.prototype.playKeys=function(t,e){var r=this,n=e.deadline,o=(e.gain,e.value,t.filter(function(t){return!!r.keys[t]}).map(function(t){return r.keys[t]}));if(o.length<t.length){var i=t.filter(function(t){return!r.keys[t]});console.warn("PlasticDrums missing keys:",i)}o.forEach(function(t){return t.trigger(n)})},o}(e.Instrument);exports.PlasticDrums=o;
},{"./Instrument":"XZf0","./Kick":"7tBp","./Snare":"Ad3Q"}],"t9V7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./instruments/Synthesizer"),t=function(){function t(t){this.synth=new e.Synthesizer({type:"sine",gain:1,mix:t}),this.ready=this.synth.ready}return t.prototype.count=function(e,t){var r=this;void 0===t&&(t=1);var n=new Array(t).fill([new Array(e.props.cycle).fill(1)]);return e.tickArray(n,function(e){var t=e.path,n=e.deadline;r.synth.playKeys([0===t[2]?90:78],{deadline:n,duration:.01,attack:.01,release:.01,decay:.01,sustain:1})})},t}();exports.Metronome=t;
},{"./instruments/Synthesizer":"uWN9"}],"vY8k":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t){this.rules=t,this.cache={}}return t.prototype.get=function(t,e){if(void 0===e&&(e=!1),e)return this.cache[t];var r=this.rules[t];return void 0===r&&console.error("could not resolve key",t,"!"),"function"==typeof r&&(r=r(this.getRuleFactories(t))),this.cache[t]=r,r},t.prototype.enhance=function(e){return new t(Object.assign({},this.rules,e))},t.prototype.mutate=function(t){return this.rules=Object.assign({},this.rules,t(this.getRuleFactories())),this},t.prototype.getRuleFactories=function(t){var e=this;return Object.keys(this.rules).map(function(t){return{key:t,factory:function(){return e.get(t)}}}).reduce(function(r,n){var o,i,s=n.key,u=n.factory;return Object.assign({},r,((o={})[s]=u,o),t?((i={})[t]=function(){return e.cache[t]},i):{})},{})},t}();exports.Improvisation=t;
},{}],"HbOx":[function(require,module,exports) {
"use strict";var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../grooves/swing"),r=require("tonal"),n=require("../util"),a=require("./Improvisation");exports.permutator=new a.Improvisation({groove:t.swing,groovePattern:function(e){return(0,e.groove)().solo||function(e){return e.measure.map(function(){return[1]})}},octave:4,reach:1,lineBreaks:!1,direction:null,force:!1,flip:!1,playedNotes:[],fixRange:!0,startRandom:!1,range:["Bb3","Bb5"],firstNoteInPattern:function(e){var t=e.pattern,r=e.chord;return n.getPatternInChord([t()[0]],r())},firstNote:function(e){var t=e.randomNote,r=e.firstNoteInPattern,n=e.startRandom,a=e.octave;return n()?t():r()+a()},lastNote:function(e){var t=e.playedNotes;return t().length?t()[0]:null},material:function(e){var t=e.pattern,r=e.chord;return n.getPatternInChord(t(),r())},randomNote:function(e){var t=e.material,r=e.octave;return n.randomElement(t())+r()},nextNotes:function(e){var t,a=e.fixRange,o=e.firstNote,i=e.chord,u=e.reach,c=e.lineBreaks,d=e.lastNote,s=e.range,l=e.material,p=e.direction,f=e.force,g=e.flip;if(!d()||c())t=o();else{if(!l().length)return void console.warn("no choice..");var v=n.getNearestTargets(d(),l(),p(),f(),g());v=v.slice(0,u()),t=n.randomElement(v),t=r.Note.simplify(t,!0)}a()&&(t=n.transposeToRange([t],s())[0]);n.getDegreeInChord(t,i());return[t]}});var o=function(e,t){return void 0===t&&(t=4),new Array(t).fill(new Array(Math.ceil(e/t)).fill(1))},i=function(e,t){return void 0===t&&(t=4),{groove:null,groovePattern:function(){return function(r){return o(e,t)}}}},u=function(e,t){return void 0===t&&(t=4),{groove:null,groovePattern:function(){return function(r){return r.measure.map(function(){return o(e,t)})}}}},c=function(e,t,r){return void 0===e&&(e="up"),void 0===t&&(t=!1),void 0===r&&(r=.4),{exclude:1,force:!t||function(e){var t=e.lastNote,r=e.range,a=n.getRangePosition(t(),r());return a<0||a>1},fixRange:!1,direction:function(t){var a=t.lastNote,o=t.range,i=t.direction,u=t.barNumber,c=t.isBarStart,d=n.getRangePosition(a(),o()),s=d>r&&d<1-r;return d<=0&&"down"===i()||d>=1&&"up"===i()||s&&c()&&u()%1==0?n.otherDirection(i(),e):i()||e}}},d=function(e){var t=e.pattern,r=e.on,n=e.off,a=e.barStart;return{beatPattern:function(e){var o=e.isBarStart,i=e.isOffbeat;return o()?a||r||t:i()?n||t:r||t},pattern:function(e){return(0,e.beatPattern)()}}},s=function(t){return e({},u(1,t))},l=function(t,r,a){return void 0===t&&(t="up"),void 0===r&&(r=4),void 0===a&&(a=!1),e({},i(r),{firstNoteInPattern:function(e){var r=e.pattern,a=e.chord;return n.getPatternInChord("up"===t?[r()[0]]:r().slice(-1),a())},direction:t,force:!0,fixRange:!1,lineBreaks:function(e){var t=e.isBarStart;return!!a&&t()},exclude:1,reach:1})};exports.advancedPermutator=exports.permutator.enhance({drill:.5,direction:function(e){return(0,e.drill)()>0?"up":"down"},force:function(e){var t=e.drill;return Math.random()*Math.abs(t())>.5},exclude:1,reach:1,material:function(e){var t=e.pattern,a=e.chord,o=e.playedNotes,i=e.exclude,u=n.getPatternInChord(t(),a());if(!o().length)return u;var c=o().slice(0,i()).map(function(e){return r.Note.pc(e)});return u.filter(function(e){return!c.includes(e)})}}),exports.guideTones=exports.advancedPermutator.enhance(e({name:"Guide Lines"},s(1),c("down",!0),{pattern:[3,7],exclude:0})),exports.guideTonesFlipped=exports.guideTones.enhance({name:"Distant Guide Tones",flip:!0}),exports.chordTones=exports.advancedPermutator.enhance({name:"Only Chord Tones",pattern:[1,3,5,7],drill:.75,direction:function(e){return(0,e.drill)()>0?"up":"down"}}),exports.fullScale=exports.advancedPermutator.enhance(e({name:"Heptatonic"},d({on:[1,3,5,7],off:[1,2,3,4,5,6,7]}),c())),exports.scalePendulum=exports.advancedPermutator.enhance(e({name:"Heptatonic Pendulum"},d({pattern:[1,2,3,4,5,6,7]}),c(),i(8))),exports.digitalPattern=exports.advancedPermutator.enhance(e({name:"Digital Patterns",pattern:function(e){var t=e.chord;return n.getDigitalPattern(t())}},c("up",!0,.2),{exclude:2,reach:3})),exports.digitalPendulum=exports.advancedPermutator.enhance(e({name:"Digital Pendulum",pattern:function(e){var t=e.chord;return n.getDigitalPattern(t())}},c("up",!1,1),i(8),{exclude:1,reach:1})),exports.digitalWalker=exports.advancedPermutator.enhance(e({name:"Digital Fourths",pattern:function(e){var t=e.chord;return n.getDigitalPattern(t())}},c("up",!0,.4),i(4),{lineBreaks:!1,exclude:2,reach:2})),exports.digitalPractiseUp=exports.advancedPermutator.enhance(e({name:"Digital Practise Up"},l("up",4,!0),{pattern:function(e){var t=e.chord;return n.getDigitalPattern(t())}})),exports.digitalPractiseDown=exports.advancedPermutator.enhance(e({name:"Digital Practise Down"},l("down",4,!0),{pattern:function(e){var t=e.chord;return n.getDigitalPattern(t())}})),exports.heptatonicPractise=exports.advancedPermutator.enhance(e({name:"Heptatonic Practise"},l("up",8,!1),d({barStart:[1],on:[3,5,7],off:[1,2,3,4,5,6,7]}))),exports.defaultMethod=exports.guideTones,exports.improvisationMethods={guideTones:exports.guideTones,guideTonesFlipped:exports.guideTonesFlipped,chordTones:exports.chordTones,digitalPattern:exports.digitalPattern,digitalPendulum:exports.digitalPendulum,digitalWalker:exports.digitalWalker,fullScale:exports.fullScale,scalePendulum:exports.scalePendulum,digitalPractiseUp:exports.digitalPractiseUp,digitalPractiseDown:exports.digitalPractiseDown};
},{"../grooves/swing":"F3aX","tonal":"PUgG","../util":"BHXf","./Improvisation":"vY8k"}],"eIgm":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../util"),r=require("./Musician"),o=require("../grooves/swing"),n=require("../improvisation/methods"),i=function(r){function i(t,e){var o=r.call(this,t)||this;return o.name="Improvisor",o.defaultMethod=n.defaultMethod,e=e||o.defaultMethod,o.method=e,o}return t(i,r),i.prototype.useMethod=function(t){this.method=t},i.prototype.play=function(t){var r=this,n=t.measures,i=t.pulse,a=t.settings;a.method&&this.useMethod(a.method);var s=a.groove||o.swing;this.method.mutate(function(){return{groove:s,playedNotes:[]}});var u=this.method.get("groovePattern");n=n.map(function(t){return u({measures:n,measure:t,settings:a,pulse:i})}).map(function(t,r){return e.resolveChords(t,n,[r])}),i.tickArray(n,function(t){r.improvise(t,n,i)},a.deadline)},i.prototype.improvise=function(t,r,o){var n=this,i=t.value,a=t.deadline,s=t.interval,u=i.chord;"N.C."!==u&&this.method.mutate(function(){return{chord:u,isFormStart:e.isFormStart(i.path),isBarStart:e.isBarStart(i.path),isOffbeat:e.isOffbeat(i.path),barNumber:i.path[0]}}).mutate(function(t){var e=t.nextNotes,r=t.playedNotes,u=e(),p=i.fraction*o.getMeasureLength();return n.instrument.playNotes(u,{deadline:a,interval:s,gain:n.getGain(),duration:p,pulse:o}),{playedNotes:[].concat(u,r())}})},i}(r.Musician);exports.default=i;
},{"../util":"BHXf","./Musician":"I2+J","../grooves/swing":"F3aX","../improvisation/methods":"HbOx"}],"I96A":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var n=require("./util"),r=e(require("./Band")),s=e(require("./musicians/Pianist")),i=e(require("./musicians/Bassist")),o=e(require("./musicians/Drummer")),u=require("./instruments/PlasticDrums"),a=require("./Metronome"),p=require("./Pulse"),c=e(require("./musicians/Improvisor")),m=function(e){function r(t){var n=t.context,r=t.piano,u=t.bass,p=t.drums,m=t.onMeasure,l=t.solo,d=e.call(this,{context:n,onMeasure:m})||this;d.mix=d.setupMix(d.context);var f=d.setupInstruments({piano:r,bass:u,drums:p});return d.pianist=new s.default(f.piano),d.bassist=new i.default(f.bass),d.drummer=new o.default(f.drums),d.musicians=[d.pianist,d.bassist,d.drummer],l&&(d.soloist=new c.default(f.piano),d.musicians.push(d.soloist)),d.metronome=new a.Metronome(d.mix),d}return t(r,e),r.prototype.setupMix=function(t){var e=t.createGain();return e.gain.value=.9,e.connect(t.destination),e},r.prototype.setupInstruments=function(t){var e=t.piano,r=t.bass,s=t.drums;return r=r||n.randomSynth(this.mix),{piano:e=e||n.randomSynth(this.mix),bass:r,drums:s=s||new u.PlasticDrums({mix:this.mix})}},r.prototype.play=function(t,n){var r=this;return this.pulse=n.pulse||new p.Pulse(n),this.count(this.pulse,n.metronome?null:0).then(function(s){n.deadline=s.deadline,e.prototype.play.call(r,t,n)})},r.prototype.count=function(t,e){return void 0===e&&(e=1),t.getMeasureLength()<1.5&&(e*=2),this.metronome.count(t,e)},r}(r.default);exports.Trio=m;
},{"./util":"BHXf","./Band":"OKGr","./musicians/Pianist":"Dn4f","./musicians/Bassist":"IXiI","./musicians/Drummer":"Hr6C","./instruments/PlasticDrums":"+ZT4","./Metronome":"t9V7","./Pulse":"hEkM","./musicians/Improvisor":"eIgm"}],"hz7D":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Song"),r=function(){function r(r){return this.chordRegex=/^([ A-GW][b#]?)((?:sus|[\+\-\^\dhob#])*)(\*.+?\*)*(\/[A-G][#b]?)?(\(.*?\))?/,this.regExps=[/^\*[a-zA-Z]/,/^T\d\d/,/^N./,/^<.*?>/,/^ \(.*?\)/,this.chordRegex,/^LZ/,/^XyQ/,/^Kcl/],this.replacements={LZ:[" ","|"],XyQ:[" "," "," "],Kcl:["|","x"," "]},this.raw=r,this.tokens=this.parse(r),this.sheet=this.getSheet(this.tokens),this.measures=e.renderSheet(this.sheet),r}return r.prototype.getChord=function(e){return e.note+e.modifiers+(e.over?"/"+this.getChord(e.over):"")},r.prototype.getSheet=function(e){var r=this,s=e.reduce(function(e,s,t,n){var u=["{","|","[","||"].includes(s.bars||s.token),a=s.annots||[],o="{"===(s.bars||s.token),c="}"===(s.bars||s.token);o&&a.push("{"),c&&a.push("}"),u&&(e.measure&&e.measures.push(e.measure),e.measure={chords:[]});var h=a.find(function(e){return e.match(/^\*[a-zA-Z]/)});h&&(a=a.filter(function(e){return e!==h}),e.measure.section=h.replace("*","")),a.includes("Q")&&(a=a.filter(function(e){return"Q"!==e}),e.measure.coda=!0);var i=a.find(function(e){return!!e.match(/^N./)});i&&(a=a.filter(function(e){return e!==i}),e.measure.house=parseInt(i.replace("N","")));var l=a.find(function(e){return e.match(/^T\d\d/)});l&&(a=a.filter(function(e){return e!==l}),e.measure.time=l.replace("T","")),s.chord?e.measure.chords.push(r.getChord(s.chord)):"n"===s.token&&e.measure.chords.push(0);var m=e.measures[e.measures.length-1];return m&&"r"===m.chords[0]&&(m.chords=e.measures[e.measures.length-3].chords,e.measure.chords=e.measures[e.measures.length-2].chords),m&&"x"===e.measure.chords[0]&&(e.measure.chords=[].concat(m.chords),e.measure.idle=!0),a.length&&(e.measure.signs=(e.measure.signs||[]).concat(a)),s.comments.length&&(e.measure.comments=(e.measure.comments||[]).concat(s.comments.map(function(e){return e.trim()}))),e},{measure:null,signs:null,measures:[]});return s.measure.chords.length&&s.measures.push(s.measure),s.measures},r.prototype.parse=function(e){var r,t=e,n=[];for(t=t.trim();t;){var u=!1;for(r=0;r<this.regExps.length;r++){var a=this.regExps[r].exec(t);if(a){if(u=!0,a.length<=2){var o=a[0],c=this.replacements[o];n=n.concat(c||[o]),t=t.substr(o.length)}else n.push(a),t=t.substr(a[0].length);break}}u||(","!==t[0]&&n.push(t[0]),t=t.substr(1))}var h=[],i=this.newToken(h);for(r=0;r<n.length;r++){var l=n[r];switch(l instanceof Array&&(i.chord=this.parseChord(l),l=" "),l[0]){case",":l=null;break;case"S":case"T":case"Q":case"N":case"U":case"s":case"l":case"f":case"*":i.annots.push(l),l=null;break;case"Y":i.spacer++,l=null;break;case"r":case"x":case"W":i.chord=new s(l,"",null,null);break;case"<":l=(l=l.substr(1,l.length-2)).replace(/XyQ/g,"   "),i.comments.push(l),l=null}l&&("]}Z".indexOf(n[r+1])>=0&&(i.bars+=n[++r]),"{[|".indexOf(l)>=0&&(i.bars+=l,l=null)),l&&r<n.length-1&&(i.token=l,i=this.newToken(h))}return h},r.prototype.parseChord=function(e){var r=e[1]||" ",t=e[2]||"",n=e[3]||"";n&&(t+=n.substr(1,n.length-2).replace("XyQ","   "));var u=e[4]||"";"/"===u[0]&&(u=u.substr(1));var a=e[5]||null;if(a&&(e=this.chordRegex.exec(a.substr(1,a.length-2)),a=e?this.parseChord(e):null)," "===r&&!a&&!u)return null;if(u){var o="#"===u[1]||"b"===u[1]?2:1;u=new s(u.substr(0,o),u.substr(o),null,null)}else u=null;return new s(r,t,u,a)},r.prototype.newToken=function(e){var r=new t;return e.push(r),r},r}();exports.RealParser=r;var s=function(){return function(e,r,s,t){this.note=e,this.modifiers=r,this.over=s,this.alternate=t}}(),t=function(){return function(){this.annots=[],this.comments=[],this.bars="",this.spacer=0,this.chord=null}}();
},{"./Song":"e7fp"}],"YepV":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(o,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)o.hasOwnProperty(n)&&(t[n]=o[n])})(o,n)};return function(o,n){function i(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var o=require("./Instrument"),n=function(o){function n(t){var n=o.call(this,t)||this;return n.gain=.9,n.output="Scarlett 6i6 USB",n.gain=t.gain||n.gain,navigator.requestMIDIAccess?(navigator.requestMIDIAccess().then(function(t){return n.midiInit(t)},n.midiFail),n):(console.warn("This browser does not support WebMIDI!"),n)}return t(n,o),n.prototype.midiInit=function(t){var o=this;console.log("midi init",t),console.log(t.outputs.size,"outputs"),console.log(t.inputs.size,"inputs"),this.midi=t,t.outputs.forEach(function(t){console.log("ouput",t)}),t.inputs.forEach(function(t){console.log("input",t),t.onmidimessage=o.getMidiMessage}),this.onTrigger=function(t){var n=t.on,i=t.off;n.forEach(function(t){var n=t.midi,i=t.gain,e=t.deadline;o.noteOn(n,Math.round(127*i),e)}),i.forEach(function(t){o.noteOff(t.midi,Math.round(127*t.gain))})}},n.prototype.midiFail=function(){console.warn("could not get midi access!")},n.prototype.getMidiMessage=function(t){console.log("midi data",t.data,"message",t)},n.prototype.send=function(t,o){this.midi?(console.log("send",t,o),this.midi.outputs.forEach(function(o){o.send(t)})):console.warn("tried to play keys but midi was not ready")},n.prototype.noteOn=function(t,o,n){void 0===o&&(o=127),void 0===n&&(n=0),this.send([144,t,127],n)},n.prototype.noteOff=function(t,o,n){void 0===o&&(o=127),void 0===n&&(n=0),this.send([144,t,0],n)},n.prototype.playKeys=function(t,o){void 0===o&&(o={})},n}(o.Instrument);exports.MidiOut=n;
},{"./Instrument":"XZf0"}],"qiEQ":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../util"),r=require("./Musician"),n=require("../grooves/swing"),o=function(r){function o(e){var t=r.call(this,e)||this;return t.defaults={groove:n.swing},t.playedChords=[],t}return e(o,r),o.prototype.play=function(e){var r=this,n=e.measures,o=e.pulse,i=e.settings,s=(i.groove||this.defaults.groove).solo||function(e){return e.measure.map(function(e){return[1,1,1,1]})};n=n.map(function(e){return s({measures:n,measure:e,settings:i,pulse:o}).slice(0,Math.floor(i.cycle))}).map(function(e,r){return t.resolveChords(e,n,[r])}),o.tickArray(n,function(e){r.playPermutations(e,n,o)},i.deadline)},o.prototype.playPermutations=function(e,r,n){var o=e.value,i=(e.cycle,e.path,e.deadline),s=e.interval,a=o.chord;if("N.C."!==a)if("x"===a&&(a=this.playedChords[this.playedChords.length-1]),a&&"0"!==a){this.playedChords.push(a);var u=t.renderDigitalPattern(a),l=t.randomElement(u)+"5",p=o.fraction*n.getMeasureLength();this.instrument.playNotes([l],{deadline:i,interval:s,gain:1,duration:p,pulse:n})}else this.playedChords.push("")},o}(r.Musician);exports.default=o;
},{"../util":"BHXf","./Musician":"I2+J","../grooves/swing":"F3aX"}],"7QCb":[function(require,module,exports) {
"use strict";var r=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}},e=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e};Object.defineProperty(exports,"__esModule",{value:!0});var t=r(require("./Band"));exports.Band=t.default;var s=r(require("./musicians/Pianist"));exports.Pianist=s.default;var i=r(require("./musicians/Drummer"));exports.Drummer=i.default;var u=r(require("./musicians/Bassist"));exports.Bassist=u.default;var a=require("./instruments/Instrument");exports.Instrument=a.Instrument;var n=require("./musicians/Musician");exports.Musician=n.Musician;var o=require("./instruments/Synthesizer");exports.Synthesizer=o.Synthesizer;var l=require("./instruments/Sampler");exports.Sampler=l.Sampler;var m=require("./instruments/PlasticDrums");exports.PlasticDrums=m.PlasticDrums;var p=require("./Trio");exports.Trio=p.Trio;var v=e(require("./util"));exports.util=v;var c=require("./Pulse");exports.Pulse=c.Pulse;var d=require("./RealParser");exports.RealParser=d.RealParser;var x=require("./instruments/MidiOut");exports.MidiOut=x.MidiOut;var q=r(require("./musicians/Permutator"));exports.Permutator=q.default;
},{"./Band":"OKGr","./musicians/Pianist":"Dn4f","./musicians/Drummer":"Hr6C","./musicians/Bassist":"IXiI","./instruments/Instrument":"XZf0","./musicians/Musician":"I2+J","./instruments/Synthesizer":"uWN9","./instruments/Sampler":"bsa5","./instruments/PlasticDrums":"+ZT4","./Trio":"I96A","./util":"BHXf","./Pulse":"hEkM","./RealParser":"hz7D","./instruments/MidiOut":"YepV","./musicians/Permutator":"qiEQ"}]},{},["7QCb"], null)
//# sourceMappingURL=/index.map