{"version":3,"sources":["../node_modules/ireal-reader/unscramble.js","../node_modules/ireal-reader/Music.js","../node_modules/ireal-reader/Song.js","../node_modules/ireal-reader/Playlist.js","../node_modules/ireal-reader/index.js","../../../.nvm/versions/node/v8.11.1/lib/node_modules/parcel/node_modules/process/browser.js","../node_modules/waaclock/lib/WAAClock.js","../node_modules/waaclock/index.js","../lib/Pulse.js","../lib/sheet/Measure.js","../lib/sheet/Sheet.js","../node_modules/tonal-note/build/es6.js","../node_modules/tonal-array/build/es6.js","../node_modules/tonal-interval/build/es6.js","../node_modules/tonal-distance/build/es6.js","../node_modules/tonal-pcset/build/es6.js","../node_modules/tonal-dictionary/build/es6.js","../node_modules/tonal-scale/build/es6.js","../node_modules/tonal-chord/build/es6.js","../node_modules/tonal/index.js","../lib/harmony/Harmony.js","../lib/instruments/Instrument.js","../lib/symbols.js","../lib/util/util.js","../lib/instruments/Synthesizer.js","../lib/Metronome.js","../node_modules/diff/dist/diff.js","../lib/sheet/Snippet.js","../lib/util/Permutation.js","../lib/harmony/Voicing.js","../lib/util/Logger.js","../lib/Band.js","../lib/musicians/Musician.js","../lib/grooves/swing.js","../lib/musicians/Pianist.js","../lib/musicians/Drummer.js","../lib/musicians/Bassist.js","../lib/instruments/Sampler.js","../lib/instruments/Kick.js","../lib/instruments/Snare.js","../lib/instruments/PlasticDrums.js","../lib/improvisation/Improvisation.js","../lib/improvisation/methods.js","../lib/musicians/Improvisor.js","../lib/Trio.js","../lib/sheet/RealParser.js","../lib/instruments/MidiOut.js","../lib/musicians/Permutator.js","../lib/index.js","../src/harmony/Harmony.js","../src/instruments/Instrument.js","../src/instruments/Synthesizer.js","../src/symbols.js","../src/util/util.js","../src/grooves/bossa.js","../src/grooves/funk.js","../src/grooves/swing.js","../src/sheet/Sheet.js","../src/sheet/Measure.js","../src/sheet/RealParser.js","../src/util/Permutation.js","../src/sheet/Snippet.js","../src/util/Logger.js","../src/harmony/Voicing.js","../samples/drumset.js","../samples/piano.js","demo.js"],"names":["process","module","exports","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","setTimeout","e","clearTimeout","runTimeout","fun","call","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","nextTick","args","Array","arguments","i","push","Item","array","prototype","apply","title","browser","env","argv","version","versions","noop","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","__importDefault","mod","__esModule","Object","defineProperty","value","waaclock_1","require","Pulse","props","defaults","bpm","cycle","delay","events","callbackAtTime","assign","context","AudioContext","clock","default","toleranceEarly","toleranceLate","getMeasureLength","beatsPerMeasure","arrayPulse","children","path","start","callback","deadline","_this","isArray","item_1","pulse","currentTime","event","childLength","map","el","tickArray","l","Promise","resolve","reject","tick","criticalEvents","console","warn","stop","changeTempo","newTempo","factor","filter","timeStretch","Sheet_1","Measure","from","measure","chords","hasSign","sign","signs","includes","hasHouse","number","house","undefined","getJumpSign","s","keys","Sheet","jumpSigns","hasJumpSign","reduce","match","current","__assign","t","n","p","hasOwnProperty","Measure_1","render","sheet","options","state","measures","forms","nested","fallbackToZero","firstTime","newForm","runs","index","nextMeasure","nextSection","nextIndex","nextForm","_a","jumps","shouldJump","braces","getJumpDestination","wipeKeys","visits","lastTime","force","section","getNextSectionIndex","readyForFineOrCoda","next","getNextHouseIndex","findPair","pairs","move","stack","findMatch","find","fine","pair","getBracePair","destination","m","relatedHouse","getRelatedHouse","canVisitHouse","houses","visited","step","numberMap","range","wiped","parseInt","forEach","latestHouse","isFirstHouse","getAllowedJumps","times","backJump","validator","allowedJumps","timesJumped","NAMES","split","names","accTypes","slice","acc","indexOf","SHARPS","FLATS","REGEX","tokenize","str","exec","toUpperCase","replace","NO_NOTE","freeze","pc","alt","oct","octStr","chroma","midi","freq","SEMI","properties","tokens","letter","charCodeAt","midiToFreq","memo","fn","cache","isMidiRange","note","tuning","Math","pow","L2","log","L440","freqToMidi","v","round","LETTERS","stepToLetter","fillStr","join","numToStr","num","op","altToAcc","fromProps","baseNote","build","fromMidi","sharps","pcs","o","floor","simplify","sameAcc","alteration","useSharps","enharmonic","rotate","sort","unique","ascR","b","a","descR","arr","compact","height","src","shuffle","rnd","random","permutations","perm","pos","newPerm","splice","IVL_TNL","IVL_STR","RegExp","SIZES","TYPES","CLASSES","types","NO_IVL","q","type","simple","semitones","abs","qToAlt","test","altToQ","numToStep","ic","ivl","_b","_c","d","intervalProps","invert","IN","IQ","fromSemitones","c","transpose","trFifths","fifths","transposeBy","addIntervals","add","subtract","interval","FIFTHS","fOcts","f","FIFTH_OCTS","encode","ref","STEPS","unaltered","decode","encoder","encodeNote","noteProps","encodeIvl","iprops","tr","to","isDescending","decodeIvl","ivl1","ivl2","i1","i2","chromas","modes","isChroma","intervals","isEqual","isSubsetOf","isSupersetOf","chr","pcsetNum","set","clen","all","toString","normalize","binary","_","r","IVLS","s1","s2","notes","dictionary","raw","data","ivls","key","alias","allKeys","dict","combine","scale","sdata","chord","cdata","pcset","exists","NO_SCALE","setnum","memoize","nameOrTonic","tonic","substring","modeNames","tonics","x","inScale","toScale","supersets","isSuperset","subsets","isSubset","NO_CHORD","NUM_TYPES","Note","Interval","Distance","Dictionary","Scale","Chord","PcSet","tonal_1","tonal_2","tonal_3","tonal_4","Harmony","isBlack","isSameNote","noteA","noteB","getTonalChord","getBassNote","getMidi","offset","intervalComplement","fix","fixIndex","invertInterval","positive","complement","isNegative","fixInterval","forceDirection","direction","noUnison","minInterval","inversion","minIntervals","chordA","chordB","mapMinInterval","sortMinInterval","preferredDirection","accessor","diff","getNearestNote","getNearestTargets","targets","flip","target","intervalMatrix","Harmony_1","Instrument","gain","mix","onTrigger","midiOffset","activeEvents","init","playNotes","settings","duration","noteOff","notesOn","active","notesOff","keep","playKeys","__importStar","result","k","symbol","long","short","groups","scales","symbols","levels","groupFilter","group","item","level","max","Set","scaleNames","chordNames","groupNames","symbolName","pool","scaleName","chordName","randomItem","randomScale","randomChord","Synthesizer_1","symbols_1","steps","randomNumber","arraySum","randomElement","weighted","total","w","shuffleArray","j","getPath","traveled","min","getDuration","divisions","noteLength","measureLength","resolveChords","pattern","fraction","NaN","hasOff","division","offbeatReducer","bar","last","randomSynth","allowed","gains","sine","triangle","square","sawtooth","wave","Synthesizer","adsr","time","param","attack","decay","sustain","release","endless","linearRampToValueAtTime","setTargetAtTime","randomDelay","maxMs","isInRange","transposeNotes","transposeToRange","getAverageMidi","sum","getDistancesToRangeEnds","rangeMidi","getRangePosition","getRangeDirection","defaultDirection","border","position","getStep","getIntervalFromStep","getStepsFromDegree","degree","getStepInChord","getStepFromInterval","getChordScales","pickChordScale","findDegree","degreeOrStep","intervalsOrSteps","isInterval","degree_1","error","getDegreeFromStep","hasDegree","hasAllDegrees","degrees","res","getScaleDegree","getScalePattern","renderIntervals","root","renderSteps","permutateIntervals","getDegreeFromInterval","fixed","getDegreeInChord","getPatternInChord","permutation","getDigitalPattern","renderDigitalPattern","getGuideTones","isFirstInPath","isBarStart","isFormStart","isOffbeat","otherDirection","totalDiff","weight","added","count","removed","kept","balance","changes","sortByDegree","diffDegrees","chain","closest","unshift","reverse","renderAbsoluteNotes","octave","absolute","getIntervals","smallestInterval","sortNotes","analyzeVoicing","sortedIntervals","maxInterval","spread","semitoneDifference","semitoneMovement","longestChild","isPitchClass","mapTree","tree","modifier","siblings","subtree","flattenTree","flat","expandTree","chordHasIntervals","has","isOptional","isForbidden","isDominantChord","isMajorChord","isMinorChord","isMinorTonic","getChordType","getChordNotes","validate","validateWithoutRoot","getVoicing","voices","previousVoicing","omitRoot","quartal","semitoneDistance","noteArray","slots","fill","factorial","__extends","extendStatics","setPrototypeOf","__proto__","__","constructor","create","Instrument_1","util_1","_super","getVoice","frequency","oscNode","createOscillator","gainNode","createGain","connect","lowestGain","startKeys","voice","stopVoice","stopVoices","Metronome","synth","ready","bars","webpackUniversalModuleDefinition","factory","define","amd","modules","installedModules","__webpack_require__","moduleId","id","loaded","canonicalize","convertChangesToXML","convertChangesToDMP","merge","parsePatch","applyPatches","applyPatch","createPatch","createTwoFilesPatch","structuredPatch","diffArrays","diffJson","diffCss","diffSentences","diffTrimmedLines","diffLines","diffWordsWithSpace","diffWords","diffChars","Diff","_base","_base2","_interopRequireDefault","_character","_word","_line","_sentence","_css","_json","_array","_apply","_parse","_merge","_create","_dmp","_xml","obj","oldString","newString","self","done","castInput","removeEmpty","newLen","oldLen","editLength","maxEditLength","bestPath","newPos","components","oldPos","extractCommon","execEditLength","diagonalPath","basePath","addPath","removePath","_oldPos","canAdd","canRemove","clonePath","pushComponent","buildValues","useLongestToken","ret","commonCount","equals","left","right","comparator","ignoreCase","toLowerCase","chars","componentPos","componentLen","component","oldValue","tmp","lastComponent","pop","characterDiff","oldStr","newStr","wordDiff","_params","extendedWordChars","reWhitespace","ignoreWhitespace","generateOptions","lineDiff","retLines","linesAndNewlines","line","newlineIsToken","trim","sentenceDiff","cssDiff","jsonDiff","_typeof","Symbol","iterator","objectPrototypeToString","_options","undefinedReplacement","_options$stringifyRep","stringifyReplacer","JSON","stringify","oldObj","newObj","replacementStack","replacer","canonicalizedObj","toJSON","sortedKeys","_key","arrayDiff","oldArr","newArr","_distanceIterator","_distanceIterator2","source","uniDiff","lines","delimiters","hunks","compareLine","lineNumber","operation","patchContent","errorCount","fuzzFactor","minLine","removeEOFNL","addEOFNL","hunkFits","hunk","toPos","content","substr","maxLine","oldLines","localOffset","oldStart","diffOffset","_i","_hunk","_toPos","newLines","delimiter","linedelimiters","previousOperation","_k","currentIndex","processIndex","complete","loadFile","err","updatedContent","patched","diffstr","list","parseIndex","header","parseFileHeader","parseHunk","strict","fileHeader","keyPrefix","fileName","chunkHeaderIndex","chunkHeaderLine","chunkHeader","newStart","addCount","removeCount","wantForward","backwardExhausted","forwardExhausted","calcLineCount","_toConsumableArray","arr2","_calcOldNewLineCount","calcOldNewLineCount","mine","theirs","base","loadPatch","newFileName","fileNameChanged","oldFileName","oldHeader","newHeader","selectField","mineIndex","theirsIndex","mineOffset","theirsOffset","mineCurrent","Infinity","theirsCurrent","hunkBefore","cloneHunk","mergedHunk","mergeLines","patch","conflict","check","mineLines","theirOffset","theirLines","their","insertLeading","theirCurrent","mutualChange","_hunk$lines","collectChange","_hunk$lines2","removal","insertTrailing","myChanges","theirChanges","allRemoves","arrayStartsWith","skipRemoveSuperset","_hunk$lines3","_hunk$lines4","arrayEqual","_hunk$lines5","swap","collectContext","merged","_hunk$lines6","insert","matchChanges","matchIndex","contextChanges","conflicted","change","prev","removeChanges","delta","changeContent","myCount","theirCount","contextLines","entry","oldRangeStart","newRangeStart","curRange","oldLine","newLine","_loop","_curRange","_curRange2","_curRange3","contextSize","oldEOFNewline","newEOFNewline","escapeHTML","JsDiff","Snippet","snippet","parsed","parse","wrapPipes","string","formatForDiff","minify","format","linebreaks","houses_1","h","chars_1","pipeIndex_1","char","urlsafe","formatted","nest","parse2","testFormat","repeatStart","repeatEnd","expand","rendered","expanded","snippetA","snippetB","diffFormat","Permutation","permutateElements","isValid","combinations","subcombinations","permutationComplexity","validations","permutateArray","combineValidators","validators","binomial","combs","head","tailcombs","Permutation_1","Logger_1","Voicing","getNextVoicing","rangeBorders","maxVoices","maxDistance","minBottomDistance","minTopDistance","noTopDrop","noTopAdd","noBottomDrop","noBottomAdd","logging","sortChoices","filterChoices","getAllVoicePermutations","exit","pick","Logger","logVoicing","combination","firstNote","firstPick","firstNoteInRange","pick_1","choices","getAllChoices","choice","dropped","topNotes","difference","bestPick","getDesiredDirection","pick_2","movement","voicingOptions","getAllNoteSelections","getVoicePermutations","validatePermutation","voicingValidator","minDistance","notesAtPositionValidator","bottomNotes","validateInterval","required","getRequiredNotes","optional","getOptionalNotes","selection","getAvailableTensions","getAllTensions","requiredSteps","req","lastPitches","bottomInterval","bottomNote","leads","voiceLeading","origin","analyzeVoiceLeading","more","less","voicingIntervals","oblique","similar","parallel","topInterval","contrary","containsNote","voicing","selected","remaining","hasTonic","thresholds","distances","Snippet_1","Voicing_1","logCustom","logFn","logLegend","groupCollapsed","table","emoji","groupEnd","logSheet","composer","tempo","style","logLabel","icon","logChoice","logNotes","activeNotes","idleNotes","addedNotes","span","allNotes","keyboard","idle","black","css","konsole","movedUp","movedDown","equilibrium","bestMatch","lucky","wrong","topAdded","topRemoved","bottomRemoved","bottomAdded","rootless","noOblique","noChange","fewCombinations","description","Pulse_1","Metronome_1","Band","musicians","onMeasure","setupMix","metronome","addMember","musician","resume","then","comp","play","Musician","instrument","getGain","eightFour","eightOff","halfTriplet","swing","bass","crash","ride","hihat","solo","Musician_1","swing_1","Pianist","playedNotes","playedChords","groove","rollFactor","grooveKey","voicings","exact","playChord","concurrency","arpeggio","ceil","getLastVoicing","scorenotes","Drummer","kick","snare","rimshot","patterns","Bassist","playBass","Sampler","buffers","samples","sources","loadSources","getBuffer","buffer","fetch","arrayBuffer","decodeAudioData","decodedData","getSource","createBufferSource","getSources","hasLoaded","loadSource","allLoaded","playSounds","sounds","sound","playSource","Kick","setup","osc","trigger","setValueAtTime","exponentialRampToValueAtTime","Snare","noiseBuffer","bufferSize","sampleRate","createBuffer","output","getChannelData","noise","noiseFilter","createBiquadFilter","noiseEnvelope","oscEnvelope","Kick_1","Snare_1","PlasticDrums","missing","Improvisation","rules","get","fromCache","rule","getRuleFactories","enhance","mutate","reducer","originKey","factories","Improvisation_1","permutator","groovePattern","reach","lineBreaks","fixRange","startRandom","firstNoteInPattern","randomNote","lastNote","material","nextNotes","getStraightBar","straightNotes","fixedNotesPerChord","pendulum","softForce","comfort","exclude","barNumber","comfortSwitchBars","isComfortZone","beatPattern","barStart","notesPerChord","patternPractise","advancedPermutator","drill","excludeNotes","guideTones","guideTonesFlipped","chordTones","fullScale","scalePendulum","digitalPattern","digitalPendulum","digitalWalker","digitalPractiseUp","digitalPractiseDown","heptatonicPractise","defaultMethod","improvisationMethods","methods_1","Improvisor","method","useMethod","improvise","Band_1","Pianist_1","Bassist_1","Drummer_1","PlasticDrums_1","Improvisor_1","Trio","piano","drums","instruments","setupInstruments","pianist","bassist","drummer","soloist","RealParser","getChord","iRealChord","modifiers","over","parseSheet","getSheet","token","lastBarEnded","annots","sectionStart","hasCodaSign","codaSign","houseStart","comments","text","headers","found","regExps","replacement","repl","replacements","out","newToken","parseChord","spacer","comment","alternate","chordRegex","iRealToken","MidiOut","navigator","midiInit","midiFail","outputs","size","inputs","input","onmidimessage","getMidiMessage","noteOn","message","send","velocity","Permutator","playPermutations","Sampler_1","Trio_1","util","RealParser_1","MidiOut_1","Permutator_1","one","bossa","funk","rs","drumset","drumSamples","C1","Db1","D1","Eb1","E1","F1","Gb1","G1","Ab1","A1","Bb1","B1","C2","Db2","D2","Eb2","E2","F2","Gb2","G2","Ab2","A2","Bb2","B2","C3","Db3","D3","Eb3","E3","F3","Gb3","G3","Ab3","A3","Bb3","B3","C4","Db4","D4","Eb4","E4","F4","Gb4","G4","Ab4","A4","Bb4","B4","C5","Db5","D5","Eb5","E5","F5","Gb5","G5","Ab5","A5","Bb5","B5","C6","Db6","D6","Eb6","E6","F6","Gb6","G6","Ab6","A6","Bb6","B6","C7","Db7","D7","Eb7","E7","F7","Gb7","G7","Ab7","A7","Bb7","B7","playlist","iRealReader","decodeURI","link","band","getStandard","standard","songs","music","window","onload","playJazz","document","getElementById","playFunk","playBossa","slower","faster","randomInstruments","addEventListener","jazz","lastVoicing","voiceChord","innerHTML","g","chordInput"],"mappings":"AiDAA,AGAA,AQAA;;AXCA,AGAA,AQAA+D,IXAI0E,AGAAqU,GQAG9Y,QXAS,IGAI,EQApB,CAAsB9D,CXAE,IGAI,CHACuI,CWA7B,EAA+B,CRAEqU,IHAlB,IAA2B,GWA1C,CRAmB,CQA0B,EAAE7Y,CRAG,IHAI,EWAA,IRAMJ,AQAf,EAA7C,CRAkD,EAAe;AHC7D4E,AGAA,AQAJ,IAAIg0B,IRAI54B,OHAOE,AGAAF,GQAG,CRACC,GHAGc,MAAP,CGAX,EAA2B,AQAE,CXAD,MGAMf,GAAP,CHAU6E,CAAT,AWAa,EXAD;AACpC,AGAJ,AQAA,QRAIqU,KHAK,AWAA0f,IXAIx0B,AGAA,CHAJ,CGAT,CHAgBlG,IAAI,AWApB,CXAS,EAAc4G,AWAA,CACtB,GXD0B7G,UAAUT,MAAjC,EAAyCU,IAAI4G,CAA7C,EAAgD5G,GAAhD,EAAqD;AACjDkG,AGAR,AQCAw0B,QRDI54B,OAAO,CHAC/B,AWCA46B,GRDZ,EAAiB,KHAK36B,AGAA,CHAV,CAAJ,EGAkBib,CAAT,EQCjB,ERD+BnZ,CQCC,ERDf,QQCyB3B,KAAV,EAAiBslB,QAAjB,EAA2BjiB,IAA3B,EAAiC;AXAzD,AGD4B,AQEhC,YRFoCxB,AQEhCwB,KXDK,EGDkCsD,EHC9BD,AWCA,CXDT,IAAcX,AWCA,CXDd,AWCJ,EAAqB,IRFe,CAAsBpH,IAAtB,CAA2BgD,GAA3B,EAAgCmZ,CAAhC,CAAJ,EAAwCD,OAAOC,CAAP,IAAYnZ,IAAImZ,CAAJ,CAAZ;AHCnD,AGDR,AQEUzX,KRD3BwX,OAAO,OQC2B,CXDLhZ,CGA7B,AQC2B,IRDPF,EHAgB1B,CGApC,QHA6B,CAAiB0G,cAAjB,CAAgChI,IAAhC,CAAqCoH,CAArC,EAAwCW,CAAxC,CAAJ,EACbF,EAAEE,CAAF,IAAOX,EAAEW,CAAF,CAAP;AADJ,AGCR,AQAuC,WRAhCmU,MAAP;AHCK,AGAR,AQAO,CRNR,WQMY4f,UAAU,SAAVA,OAAU,CAAUhyB,IAAV,EAAgB;AXC9B,AGAR5G,AQDwC,ORCjCC,QHAQ0E,CAAP,GWDuC,CAAC8e,CRChD,CAAsBtnB,MQDyB,CRC/C,EAA+B,CQD6BsnB,SAASjiB,ERCrE,EAA6C,AQDe,ERCbtB,AQD4B0G,IAAf,EAAqBzI,CRC3B,IAAT,AQDe,CAApB,CRCxC;AHCK,AGAL,AQF0F,IREtFiX,CHPA,IWKI,GREI2D,aAAa3Y,QAAQ,aAAR,CAAb,CAAZ;AHCI,AGAJ,AQFQ,IREJ+U,OHAOzQ,CGACqU,AQFA5a,MAAMb,EXEEe,IWFR,CXED,AGAc+B,CHAC,GWFG,CXElB,AWFH,EXEwBrC,AWFA,CREC,QHAtB,CAAP,IGAqB,CAAb,CAAZ;AHCC,AGAD5B,AQFY,CXRZ,OGUQqH,MAAR,GAAiB,CACb,CQHeo1B,QAAQz6B,MAAM,CAAN,CAAR,IAAoBA,KAApB,GAA4B,EAAnC;AXGZ6B,AGCQkZ,AQHC,OXEFjZ,KGCS,GADZ,MHAJ,CAAsB9D,OAAtB,EAA+B,YAA/B,EAA6C,EAAE+D,OAAO,IAAT,EAA7C;AACA,AGCQiZ,AQHA,IXEJ7D,MGCU,IHDAlV,CWFCjC,ERCX,IQDiB+E,CXEC,KWFP,CAAa01B,CXEd,CAAd,KWFe,EAAsBr0B,MAAtB,CAA6B,UAAUs0B,YAAV,EAAwBz2B,EAAxB,EAA4B;AXGxE,AGCQgX,AQJkE,IXGtE7D,OGCW,GHDDnV,AGFV,KQD6Ey4B,GXG3D,OAAR,CAAd,EWH8Ft7B,MAAb,CAAoBm7B,YAAYC,iBAAZ,CAA8Bx6B,MAAM+E,MAAN,CAAa,UAAUxG,CAAV,EAAa;AXI7J,AGCQ2c,AQLuJ,IXI3J7D,QGCY,CAAC,CHDHpV,MGCE,EHDM,AGCI,CQL4I1D,MXIxJ,AWJ8J0F,CXI5K,AGCgB,CQL+I;AXK/J,AGJI,AQD6K,CRAhK,EAOb,CHFAqT,SWL+H,CXKrHrV,AWLuF,EAA+EqjB,MXK9J,EWL+E,EAAyFjiB,GXKhL,CAAd,CWLmMjE,MAAL,CAAY,CAAC6E,EAAD,CAAZ,CAAzF,EAA4GD,GAA5G,CAAgH,UAAU22B,eAAV,EAA2B;AXMhP,AGEQ5f,AQR0O,IXM9OxD,QGEY,EHFF,CGCV,QQPqP,CAC7OtT,EAD6O,CXM5N,CWJnB7E,MAF+O,CAExOu7B,IXIwB,WWNgN,CAAP;AXO9O,AGEI3f,AQP4B,UROtB,GHFDzD,AWPwF,CAApB,CAAP,EROtE,GHAA,GAAmB,CAClB;AACDA,AGCI0D,AQRiC,SAF1B,ERUA,AQR4B,CXO/BzD,CWTG,CROX,AQPI,KXSJ,GAAkB,UAAU7K,IAAV,EAAgB;AAC9B,AGCAuO,AQRH,KATD,ORiBY,CAAC,EHDF/D,KGCC,EAAU,CHDHP,IAAR,CAAazU,EGCZ,GHDD,CAAmBwK,IAAnB,EAAyB7B,GAAzB,KAAiC,EAAxC;AACH,AGJD,AQHAyvB,CRJa,EAab,EHJA,WWLYK,qBAAZ,GAAoC,UAAU56B,KAAV,EAAiBslB,QAAjB,EAA2BjiB,IAA3B,EAAiC;AXQrEkU,AGEIwD,AQTA,YXOItD,AGEI,AQTJpU,GRQR,MQRiB,CXOjB,GAAqB,CWPC,CAAlB,EAAqB,MXOMqU,KAAV,EAAiBC,KAAjB,EAAwB;AACzC,AGEAuD,AQVuB7X,YRUf,CAAC,EHFF8T,IWRuB,CRUtB,CQVe,CRUL,CHFHP,IAAR,CAAa7K,IAAb,CAAkB2L,AGEjB,EAAuB,GHFxB,KGEC,CHF4BP,AGAxC,QHAgDP,IAAR,CAAa7K,IAAb,CAAkB4L,KAAlB,CAApC;AACH,AGEGqD,AQXmC,KXOvC,KGIU;AHDVzD,AGEI,AQXA,YXSIK,AWTAijB,aXSR,CWTsB,CAAlB,CXSoB,UAAUtlB,KAAV,EAAiB;AACrC,AGHJ,AQNIglB,CRPS,EAmBb,SHHQ,CAAChlB,KAAL,EAAY,AWTAilB,iBAAZ,CAA8Bx6B,KAA9B,EAAqC,UAAUqD,IAAV,EAAgBoF,IAAhB,EAAsBzI,KAAtB,EAA6B;AXU9D,AGGJ+a,AQZI,YRYI,EQZF8f,GRWV,EHFe,IAAP,EWTA;AXUH,AGGD3f,AQZI,YRYI,CAAC,MQZE,CAACoK,GRYJ,EAAa,GQZV,IAAaA,IRYhB,EAA0B,GQZDjiB,IAAT,CRYhB,CAFZ,AQV2CoF,IAAf,EAAqBzI,KAArB,CAApB;AXUJuV,AGGA0F,AQZC,SAHD,EReO,AQZJ5X,IAHH,CXYQkS,MACHhK,OADG,CACK,mBADL,EAC0B,OAD1B,EAEHA,OAFG,CAEK,GAFL,EAEU,GAFV,EAGHA,OAHG,CAGK,GAHL,EAGU,GAHV,EAIHA,OAJG,CAIK,IAJL,EAIW,MAJX,EAKHA,OALG,CAKK,GALL,EAKU,KALV,CAAR;AAMA,AGNJ,AQRI,CRXS,EAwBb,YQbWsvB,WAAP;ARcA9f,AQbH,KARD,ORqBY,OADZ;AAEIG,AQbJqf,YRaY,CAAC,GQbDO,ORaA,EAAa,KQbzB,GAA6B,GRajB,CAFZ,MQXuC96B,KAAV,EAAiB;ARc1Cib,AQbA,WRaO,CQbHjb,MAAMb,MAAN,KAAiB,CAArB,EAAwB;ARU5B,AQTQ,CRfK,EA6Bb,gBQdea,KAAP;AReJ+a,AQdC,YRcO,OADZ;AHEI,AGAAG,AQdA,YXcI/O,AGAI,CAAC,EQdFnM,MXcMoX,AWdAhR,ERcL,EAAa,EQdd,CAAa,CXcC6Q,KAAR,CAAc9L,CGAnB,CAFZ,CQZkCuvB,KXcjB,CAAuBnlB,KAAvB,CAAb,AWdoB,EAAwBtR,EAAxB,EAA4B;AXehD,AGAAgX,AQfkD,WRe3C,CHAHlV,IAAIoG,GWfiDuuB,IXe1C,CAAP,EAAUhwB,KAAV,CAAgB,AWf8CtL,GXe9D,CAAR,EWfyD,CAAoBm7B,YAAYO,cAAZ,CAA2B96B,MAAM+E,MAAN,CAAa,UAAUxG,CAAV,EAAa;AXgBlI,AGJJ,AQZwI,CRjB3H,cHiCF4N,OAAO,CAAP,AWhBoI5N,KXgBvHwH,CWhB6H9B,CXgB3H,CAAF,AWhBgH,KXgBxG,GAArB,CAAP;AACH,AGAD,AQjB0J,KXF1J,QWE4G,CAA3B,EACxED,GADwE,CACpE,UAAU22B,eAAV,EAA2B;AXiBxCpjB,AGAA,AQjB0C,YXiBlCM,WAAR,AWjBkD,CAAC5T,EXiB7B,AWjB4B,EAAK7E,MAAL,CAAYu7B,CXiB9BplB,KAAV,EAAiB,OWjBW,CAAR;AXkBtC,AGAAwF,AQlB8E,YXkB1E,AGAI,CHAHxF,AWnBwE,CAApB,CRkB7D,AQlBsD,GXmBlD,EAAY;AACR,AGAJ2F,AQnBmF,SAD5E,EAC8E,CRmB7E,CAAC,AQpBF,CAAP,KXoBW,CGAH,EAAU,CHAd,SGAI,EAAsB,OAAtB,CAFZ;AHGK,AGADF,AQnBH,KAND,KRyBU;AHCN,AGJJ,AQfA,CRpBa,EAwCb,SHDQzF,MAAM9P,QAAN,CAAe,GAAf,CAAJ,EAAyB;AACrB,AGCJsV,AQpBJwf,YRoBY,IQpBAQ,ERmBZ,CHAexlB,MAAM7K,KAAN,CAAY,EWnB3B,CXmBe,EAAiB,AWnBA,CXmBjB,CAAP,UWnBoC;AXoBvC,AGCDwQ,AQpBA,YRoBQ,AQpBJ8f,CRoBK,UAAD,EAAa,AQpBJ,EAAjB,QRoBQ,EAAyB,OAAzB,CAFZ;AHEI,AGCAhgB,AQpBA,URoBM,GQpBD,EXmBEzF,EWnBEgc,IXmBIlrB,CWnBC,CAAd,EAAiBkrB,CXmBV,CAAa,GWnBE3xB,UXmBf,AWnByBT,EXmBI,CAA7B,CAAP,EWnBA,EAAwCoyB,IAAxC,EAA8C;AXoBjD,AGHD,AQhBQyJ,CRxBK,EA6Cb,EHVA,kBWXmBzJ,EAAX,IAAiB3xB,UAAU2xB,EAAV,CAAjB;AXoBRha,AGEIwD,AQrBC,YXmBGjD,AGEI,IADZ,GHDA,GAAkB,UAAUnL,IAAV,EAAgBoL,MAAhB,EAAwB;AACtC,AGEAmD,AQrBA,YXmBInD,AGEI,CAAC,EQrBF,QXmBQ,AGEP,CAFZ,CQnBqB1U,GXmBG,CAApB,AWnBO,EXmBgB,AWnBAoF,IAAhB,EAAsBzI,KAAtB,EAA6B;AXmBX+X,AGGzBiD,AQtBsC,URsBhC,SAHV,AQnBiDggB,EXmBX,CAAT,QWlBpB50B,MADwC,CACjC,UAAUyU,MAAV,EAAkBvQ,SAAlB,EAA6B;AXkBH,AGItC2Q,AQtB2C,WRsBpC,YQtB2CJ,UAAUvQ,UAAUjH,IAAV,EAAgBoF,IAAhB,EAAsBzI,KAAtB,CAAjB;AXmB3C,AGDJ,AQlB+F,CR3BlF,EAmDb,UQzBiD,EXoBtCmX,AWnBsF,IADhD,CAAP,GXoBvBP,IAAR,CAAa7K,IAAb,CAAkBY,IAAlB,IAA0BoL,MAAjC;AACH,AGKGgD,AQzBqG,KXiBzG,IWlBI,GR0BQ,IADZ;AHHAxD,AGKI2D,AQzBH,KAPD,OX2BQlD,AGKI,CAAC,UAAD,EAAa,KHLzB,GAA6B,GGKjB,EAA0B,KHLChG,KGK3B,CAFZ,EHH6B,EAAoB;AAC7C,AGKAgJ,AQzBJ,URyBU,EHLF/C,MAAM;AACN,AGCR,AQrBAsiB,CR9Ba,EAwDb,aQ1BYG,EXoBE,IADA,MWnBd,GAA2B,UAAU16B,KAAV,EAAiB;AXqBpC,AGMJ+a,AQ1BA,YR0BQ,AQ1BJ5b,IRyBR,EHLc,GWpBGa,CXkBH,KWlBSb,MAAnB;AXqBI,AGMJ+b,AQ3BA,YR2BQ,AQ3BmBL,CR2BlB,KHNC,EGMF,CQ3B4B,CXkB1B,AGSQ,AQ3BmB7a,MAAM6K,IR2BnC,CQ3B6B,CR2BP,CQ3BM,CAApC,KR2BQ,CAFZ;AHHQ,AGMJmQ,AQ5BA,UR4BM,EQ5B+CxJ,IAAI,EXsB/C,CGGd,CQzBiE7R,EXkBnD,GWlB+C,CAAUR,MAAV,EAAkB6mB,IAAlB,CAAuB,CAAvB,CAAzD;AXuBI,AGMJ/K,AQ7BA,WR6BO,CQ7B6Epb,IAAI,CAAxF,CXuBU;AALA,AGOd,AQzBI,CR/BS,EA8Db,MHbI,GWlB2Fib,CAA3F;AXyBA,AGOAC,AQhCA,YXyBI7C,AGOI,AQhCsFxR,CAA9F,IR+BJ,MHNmB7E,OAAOmE,IAAP,CAAYiS,GAAZ,EAAiBjP,IAAjB,CAAsB,UAAUgM,GAAV,EAAe;AAAE,AGQtDkG,AQhCA,YRgCQ,CAAC,EQhCFrb,IXwBsDmS,AWxBlD7S,ERgCH,CAFZ,GQ9BI,EAAmB,CXwBmDkH,KAAT,CAAe2O,GAAf,CAAP;AAA6B,AGSnFgG,AQhCI,SXuBW,CAAf,AGSM,MQhCExJ,EAAE3R,CAAF,IAAOA,CAAX,EAAc,IR6BtB;AHLI,AGSAob,AQhCQH,WRgCD,CHTH5C,QAAJ,AWvBYrY,EXuBE,EWvBE,CAAJ,IAAS2R,EAAE3R,CAAF,CAAb;AXwBJ,AGIR,AQ3BY6G,CRnCC,EAoEb,gBHVeuR,CWvBCjY,GXuBGkY,GWvBGrY,CAAN,CAAJ,GXuBG,CAAP;AACH,AGUDkb,AQjCQ/a,YRiCA,MADZ,IQhCkBH,CAAN,IAAWG,MAAM8a,CAAN,CAAX;AXwBR,AGUAI,AQjCQlb,YRiCA,CAAC,EHVFqX,KGUC,EAAU,AQjCJyD,CXuBCjE,AWvBP,IAAWnQ,CAAX,GXuBD,CAAiB0K,AGUhB,EAAsB,IHVvB,CAAwBY,EGUvB,CAFZ,KHRW,CAAP;AACH,AGUGgJ,AQjCQ,KXUZ,KGuBU,QQjCIxJ,EAAE3R,CAAF,CAAF,IR8BZ;AHNA0X,AGUI0D,AQjCQpb,WRiCD,CHVHsY,QWvBQ,CAAJ,KXuBZ,GAAyB,UAAUnG,QAAV,EAAoB;AACzC,AGKJ,AQ5BY6I,CRxCC,EA0Eb,SHXQ,CAAC7I,QAAL,EAAe,AWvBAlS,IAAP,CAAYE,MAAM6K,KAAN,EAAZ;AXwBJ,AGWJkQ,AQlCK,YRkCG,CQ1CJ,IRyCR,EHVe,AWtBF,IXsBL;AACH,AGWDG,AQjCQ1J,YRiCA,CAAC,KQjCC3R,CAAF,IRiCA,AQjCO,CAAP,CRiCa,WAAb,CAFZ;AHRI,AGWAmb,AQjCQ,URiCF,EHXF5C,MWtBMvY,CAAF,IXsBOmS,SAASzG,OAAT,CAAiB,GAAjB,EAAsB,EAAtB,CAAf;AACA,AGOJ,AQ7BS,CR7CI,EA+Eb,SHZQ8M,aAAad,QAAQS,kBAAR,CAA2BI,QAA3B,CAAjB;AACA,AGYA2C,AQlCC,YXsBGzC,AGYI,MADZ,OHXqBtG,SAAS7S,MAAT,GAAkBiZ,SAASjZ,MAA5C;AACA,AGYA+b,AQlCA,YRkCQ,CAAC,EHZF,AWtBAL,CXsBCvC,IGYA,CQlCR,CRkCkB,OHZG,EAAb,CGYA,EHZkB,AGYI,GHZvB,IAA0BD,AGYzB,CAFZ,SHVI;AACH,AGYG2C,AQlCH,KXcD,AWhCA,KRoDU,SAHV;AHRA,AGYIC,AQlCJ,WRkCW;AHXX1D,AGOA,AQ7BAgjB,CRlDa,EAqFb,SHbQhiB,IWtBI0iB,OXsBZ,CWtBA,EXsBsB,CWtBC,SXsBSjpB,CWtBCgC,GAAV,EAAe8G,CAAf,CXsBD,CWtBmB,CXsBCzM,QAApB,EAA8B;AAChD,AGaA0M,AQnCA,YXsBI/I,AGaI,AQnCJnS,CAAJ,EAAOmd,CAAP,EAAUke,CRkCd,IQlCI,EXsBiB,AWtBAC,IAAjB,CXsBsB,CAAtB,AWtBuBC,EXsBE,OWtBzB;AXsB2BppB,AGc3BiJ,AQnCA,WRmCO,KAFX,OHZ0C,EAAX;AAAgB,AGe3CC,AQnCA,YRmCQ,CAAC,UAAD,EAAa,UAAb;AHdR,AGWJ,AQ/BI,CRtDS,EA0Fb,SHhBQ7M,AWpBAyM,IAAI9G,IAAI7U,KXoBK,CWpBb,IXoBkB,AWpBA2b,CXoBtB,EAAyB,EWpBE,CAA3B,EAA8B;AXoBHzM,AGiB3B0M,AQpCI,YRoCI,MADZ,CQnCe,EAAP,EXmBkC,KAAX;AAAmB,AGkB9CG,AQpCC,YRoCO,CAAC,UAAD,EAAa,UAAb,CAFZ;AHfI,AGkBAD,AQpCA,WRoCO,CHlBHhD,MAAM;AACN,AGcR,AQhCI,CR1DS,EA+Fb,SQrCQ6C,KAAK9G,CXkBC,GWlBG7U,CXiBH,KWjBV,EAAqB;AXmBjB,AGmBJ4b,AQrCI,YRqCI,OHnBG,AGkBf,AQpCe,CAAC/G,GAAD,CAAP;AXgBM,AGsBVkH,AQrCC,SXeD,GGsBQ,CAAC,UAAD;AHlBR,AGgBJ,AQlCI,CR7DS,EAmGb,SHpBQ7M,QAAJ,EAAc;AACV4J,AGoBJ8C,AQtCA,YRsCQ,AQtCJD,GRqCR,EQrCa,CXkBCvU,AWlBV,EAAY,OXkBO,EAAT,EAAa0R,GAAb,EAAkB,EAAE,MAAM,IAAR,EAAc,OAAO,IAArB,EAAlB,CAAN;AACAjG,AGoBJkJ,AQtCIggB,YRsCI,CAAC,OQtCG,EAAR,CXkBW7jB,AGoBP,QHpBeR,QAAR,CAAiBxI,QAAjB,CAA0B2D,QAA1B,CAAX;AACH,AGiBL,AQnCQ,CRhEK,EAuGb,cQvCanS,IAAI,CAAT,EAAYA,IAAImU,IAAI7U,MAApB,EAA4BU,GAA5B,EAAiC;AXmBrC,AGqBAkb,AQvCQmgB,YXkBJr5B,AGqBI,IADZ,GHpBemE,GWlBGlG,CXkBV,CAAYmY,EWlBR,CXkBJ,AWlBe,CAACjE,CXkBCvO,GWlBG5F,CAAJ,CAAD,CAAX,EXkBJ,CAA0BmS,QAA1B,CAAJ,EAAyC;AACrC,AGqBJkJ,AQvCK,YRuCG,CAAC,MHrBEjD,IAAIjG,AGqBP,CAFZ,OHnBe,CAAP;AACH,AGqBDiJ,AQvCI,WRuCG,QQvCIigB,KAAP;AXmBJ,AGiBJ,AQnCK,CRpEQ,EA4Gb,YHtBWlpB,QAAP;AACH,AGsBG+I,AQxCA,KXGJ,OGqCY,KADZ;AHpBA,AGsBIG,AQxCA,YRwCQ,CAAC,UAAD,CAFZ;AHnBA3D,AGsBI0D,AQxCA,WRwCO,CHtBHzC,cAAR,GAAyB,UAAUxG,QAAV,EAAoByG,SAApB,EAA+BC,QAA/B,EAAyC;AAC9D,AGuBJ,AQzCI,YXkBIA,aAAa,KAAK,CAAtB,EAAyB;AjDrGjC,AiDqGmCA,AWjB3B,uBXiBsC,KAAX;AjDpGnC,AiDoGsD,AWhB9C;A5DnFR,AiDoGQ,AWhBA,YXgBIlI,YAAY6G,QAAQR,QAAR,CAAiBrG,SAAjB,CAA2BwB,QAA3B,CAAhB;AjDnGR,AiDoGQ,AWhBA,YXgBKyG,cAAc,IAAd,IAAsBjI,YAAY,CAAnC,IACCiI,cAAc,MAAd,IAAwBjI,YAAY,CADzC,EAC6C;AjDpGrD,AiDqGY,AWjBJ,mBXiBW+G,QAAQY,cAAR,CAAuBnG,QAAvB,CAAP;AjDpGZ,AiDqGS,AGaL,AQ9BI,CR9ES,CAAjB;ApDLA,AiDqGQ,AGwBRhU,AQzCQ,QRyCAmd,IHxBInJ,EGwBZ,GAAiB,CACb,OHzBqB,IAAb,IAAqB0G,QAAzB,EAAmC;AjDpG3C,AiDqGY,AGyBJqC,AQ1CA,YR0CQ,OHzBG,CAACtC,UGwBhB,IHxB8B,MAAd,GAAuB,GAAvB,GAA6B,EAA9B,IAAoC,IAA3C;AjDpGZ,AiDqGS,AGyBDyC,AQ1CA,YR0CQ,CAAC,OAAD,EAAU,YAAV;ApD7HhB,AiDqGQ,AGsBJ,AQvCI,CRsCS,EAKb,YH1BWlJ,QAAP;AjDpGR,AiDqGK,AG0BG+I,AQ3CA,KXMJ,OGqCY,kBADZ;ApD7HJ,AiDqGI,AG0BIG,AQ3CA,YR2CQ,CAAC,OAAD,EAAU,YAAV;ApD9HhB,AiDqGI3D,AGuBA,AQxCI,CRmCS,EASb,SH3BQoB,WAAR,GAAsB,UAAU3G,QAAV,EAAoByG,SAApB,EAA+BC,QAA/B,EAAyC;AjDpGnE,AiDqGQ1G,AG2BA+I,AQ5CA,YR4CQ,OH3BGxD,MG0Bf,EH1BuBgB,WAAR,CAAoBvG,QAApB,EAA8B,IAA9B,CAAX;AjDpGR,AiDqGQ,AG2BAkJ,AQ5CAggB,YXiBIziB,AG2BI,CAAC,GQ5CD,EAAR,ER4CQ,CH3BR,EAAe;AjDpGvB,AiDqGY,AGwBR,AQzCI,CRgCS,YQhCJ5Y,IAAI,CAAT,CXiBW0X,CWjBC1X,IAAImU,GXiBGwE,CWjBCrZ,MAAJ,GAAa2b,CAAb,GXiBL,AWjBsB,CXiBC9I,AWjBlC,EAAoCnS,GAApC,EAAyC,CXiB9B,EAAiC4Y,SAAjC,EAA4CC,QAA5C,CAAP;AjDpGZ,AiDqGS,AG2BL,AQ5CQ;A5DnFZ,AiDqGQ,AG2BJ,AQ5CQyiB,YXiBAviB,OWjBO5E,IAAInJ,CXiBC0M,IWjBL,CAAU1X,CAAV,EXiBasY,AWjBAtY,IAAI,CAAjB,CAAP,QXiBY,CAAuBmS,QAAvB,CAAhB;AjDpGR,AiDqGQ,AG2BA+I,AQ5CI,YXiBAlO,AG2BI,KH3BC4D,EG0Bb,CH1BQ,CAAS4G,QAAQR,QAAR,CAAiBrG,SAAjB,CAA2BoI,SAA3B,CAAT,IAAkD/L,KAAK4D,GAAL,CAAS4G,QAAQR,QAAR,CAAiBrG,SAAjB,CAA2BwB,QAA3B,CAAT,CAAtD,EAAsG;AjDpG9G,AiDqGYA,AG2BJkJ,AQ5CIkgB,YR4CI,CAAC,OAAD,EAAU,CH3BHxiB,CWjBC2hB,QXiBZ,AG2BI,EAAsB,EQ5CFU,KR4CpB,GQ5CQ,CAAqBjnB,IAAInJ,KAAJ,CAAUhL,IAAI,CAAd,CAArB,EAAuCib,IAAI,CAA3C,CAAZ;A5DnFZ,AiDqGS,AGwBL,AQzCQ,CR2BK,EAkBb;ApDhIJ,AiDqGQ,AG4BAC,AQ7CI,YR6CI,GH5BD/I,KG2BX,GH3BI;AjDpGR,AiDqGK,AG4BGkJ,AQ7CI,KXOR,OGsCY,CAAC,IQ7CA8B,GR6CD,CQ7CK,CR6CK,AQ7Cd,EAAYA,IAAIoe,IR6CZ,EAAsB,IQ7CAj8B,GR6CtB,GQ7CJ,EAAkC6d,GAAlC,EAAuC;A5DnFnD,AiDqGI,AGyBA,AQ1CYke,CRwBC,EAsBb,mBQ9CkBp7B,IAAN,CAAWq7B,KAAK/7B,MAAL,CAAYg8B,UAAUpe,CAAV,CAAZ,CAAX;A5DnFhB,AiDqGIzF,AG6BIwD,AQ9CK,YXiBDlC,AG6BI,UADZ,EH5BA,GAAuB,UAAUC,MAAV,EAAkBC,MAAlB,EAA0B;AjDpGrD,AiDqGQ,AG6BAmC,AQ9CC,YR8CO,CAAC,EH7BFpC,KG6BC,EH7BM9U,AG6BI,GH7BX,CAAW,MG6BV,EAAsB,EH7BFyC,CAAV,EAAa5G,CAAb,CG6BV,CH7B0B;AjDpG1C,AiDoG4C,AG2BxC,AQ3CI,CRqBS,EA0Bb,YQ/CWq7B,IXgBoC3jB,CWhB3C,OXgBmDoB,WAAR,CAAoBrB,QAAQR,QAAR,CAAiB9E,QAAjB,CAA0BvL,CAA1B,EAA6BsS,OAAOlZ,CAAP,CAA7B,CAApB,CAAP;AjDnG5C,AiDmGkH,AGgC1Gkb,AQ/CH,KAlDD,IXiEW,CAAP,EGgCQ,QADZ;ApDjIJ,AiDmGK,AGgCGG,AQ/CJ,KXaA,MWbOqf,CR+CK,CAAC,OAAD,EAAU,AQ/CtB,UR+CY,EAAsB,OAAtB;ApDlIhB,AiDmGIhjB,AG6BA,AQ5CH,CRkBgB,AQjIgB,ER+J7B,AQ/JJ,SX8HYyB,cAAR,GAAyB,UAAUP,SAAV,EAAqB;AjDlGlD,AiDmGQ,AGiCAsC,AQhDR/c,QAAQu8B,IRgDQ,GHjCD,IWff,GAAsBA,ER+ClB,CHhCqBvoB,QAAV,AWff,EXemC;AjDlGnC,AiDkGqC,AGkC7BkJ,YAAQ,CAAC,MHlC2B3D,CGkC5B,EAAU,KHlC0BoB,KGkCpC,EAAsB,IHlCM,CAAoB3G,EGkChD,MHlC4B,EAA8ByG,SAA9B,CAAP;AjDjGrC,AiDiGuF,AGgCnF,CA9Ba,EAkCb,MHpCI;AjDhGR,AiDiGK,AGoCGsC,KHtCJ,OGsCY,SADZ;ApDnIJ,AiDiGI,AGoCIG,YAAQ,CAAC,OAAD,EAAU,UAAV,EAAsB,OAAtB;AHnCZ3D,AGiCA,CAlCa,EAsCb,SHrCQ0B,eAAR,GAA0B,UAAUC,kBAAV,EAA8BC,QAA9B,EAAwC;AhDpItE,AgDqIQ,AGqCA4B,YHrCI7B,AGqCI,SADZ,cHpC+B,KAAK,CAAhC,EAAmC;AhDpI3C,AgDoI6CA,AGsCrCgC,YAAQ,CAAC,OAAD,EAAU,UAAV,CHtCkD,CGsC5B,GHtCO,IGsC7B;AnDzKhB,AgDmIyE,AGoCrE,CAtCa,EA0Cb;AnD1KJ,AgDmIQ,AGwCAH,YHxCI5B,AGwCI,YADZ,CHvCqB,KAAK,CAAtB,EAAyB;AhDlIjC,AgDkImCA,AGyC3B+B,YAAQ,CAAC,UHzC8B,AGyC/B,EAAa,WAAb,KHzCyCrb,CAAV,EAAa;AhDjI5D,AgDiI8D,AGuC1D,CA1Ca,EA8Cb,oBH3CiEA,CAAP;AhDhI9D,AgDgIyE,AG4CjEkb,YAAQ,CH5CmB,WG2C/B;AnD1KJ,AgD+H6E,AG6CrEG,YAAQ,CA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;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzOA;AACA;AACA;AACA;AACA;;ACJA;;AACA,IAAIC,kBAAmB,QAAQ,KAAKA,eAAd,IAAkC,UAAUC,GAAV,EAAe;AACnE,WAAQA,OAAOA,IAAIC,UAAZ,GAA0BD,GAA1B,GAAgC,EAAE,WAAWA,GAAb,EAAvC;AACH,CAFD;AAGAE,OAA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","file":"demo.c3860e96.map","sourceRoot":"..","sourcesContent":["'use strict';\n\n//unscrambling hints from https://github.com/ironss/accompaniser/blob/master/irealb_parser.lua\n//strings are broken up in 50 character segments. each segment undergoes character substitution addressed by obfusc50()\nexports.ireal = function(s){\n  let r = '', p;\n\n  while(s.length > 50){\n    p = s.substring(0, 50);\n    s = s.substring(50)\n    if(s.length < 2){\n      r = r + p;\n    }else{\n      r = r + obfusc50(p);\n    }\n  }\n  r = r + s;\n  return r;\n}\n\nfunction obfusc50 (s){\n  //the first 5 characters are switched with the last 5\n  let newString = s.split('');\n  for(let i = 0; i < 5; i++){\n    newString[49 - i] = s[i];\n    newString[i] = s[49 - i];\n  }\n  //characters 10-24 are also switched\n  for(let i = 10; i < 24; i++){\n    newString[49 - i] = s[i];\n    newString[i] = s[49 - i];\n  }\n  return newString.join('');\n}\n","'use strict';\n\n//regex:\n//  letters A-G and W (W is an invisible slash chord)\n//  {1} only one of the aforementioned letters\n//  followed by zero or more of these: + - ^ h o # b digit\n//  followed by an optional group (to catch slash chords)\n//    that starts with a slash\n//    followed by A-G\n//    followed by optional # or b\n\nconst chordRegex = /[A-GW]{1}[\\+\\-\\^\\dhob#suad]*(\\/[A-G][#b]?)?/g;\nconst musicPrefix = \"1r34LbKcu7\";\nconst unscramble = require('./unscramble');\n\nclass Music {\n  constructor(data){\n    const parts = data.split(musicPrefix);\n    this.raw = unscramble.ireal(parts[1]);\n    //TODO: read the time signature\n    this.timeSignature = 'T44';\n    const musicData = removeNonMusicalInfo(this.raw);\n    this.measures = getMeasures(musicData)\n  }\n}\nmodule.exports = Music;\n\nfunction getMeasures(data){\n  let measures = data.split(/\\||LZ|K|Z|\\{|\\}|\\[|\\]/g)//measures are delimited by |, LZ, {, } (repeat markers), [, ] (double barlines). Also splitting on K because Kcl seems to indicate a repeat of the previous measure. Z is the end of a song usually.\n\n  measures = fillSingleRepeats(measures);\n  measures = fillDoubleRepeats(measures);\n\n  measures = measures.map((x, index, array) => x.match(chordRegex))\n    .filter(x => !!x)  //filter out blank measures. if empty measures like N.C. are needed this has to be modified\n\n  measures = fillInvisibleSlashChords(measures);\n\n  return measures;\n}\n\nfunction removeNonMusicalInfo(data){\n  //remove all the non-musical information\n  data = removeFromString(data, /<.*?>/); //comments delimited by carets < ... >, non-greedy match. do this first as these may contain other symbols that we look for later on.\n  data = removeFromString(data, /\\*\\s*\\*/); //stars with empty space in between *  *\n  data = removeFromString(data, /\\*\\w/); //section markers *A, *B, *C\n  data = removeFromString(data, /T\\d+/); //time signatures T44, T34\n  data = removeFromString(data, /N\\d/); //repeat markers N1, N2, ...\n  data = removeFromString(data, /Y+/); //vertical spacers\n  data = removeFromString(data, 'XyQ'); //empty space\n  data = removeFromString(data, /[npUSQ]/); //n: N.C, p: pause slash, U: END, S: Segno, Q: Coda, \n  //s: small (consider using s when implementing chord duration)\n  return data;\n}\n\nfunction fillDoubleRepeats(measures){\n  const r = m => m.indexOf('r') >= 0;\n\n  //an 'r' becomes the two previous measures (drawn as a double angled bar)\n  let repeatMeasureIdx = measures.findIndex(r);\n  while(repeatMeasureIdx != -1){\n    measures.splice(repeatMeasureIdx, 1, measures[repeatMeasureIdx - 2], measures[repeatMeasureIdx - 1]);\n    repeatMeasureIdx = measures.findIndex(r);\n  }\n  return measures;\n}\n\nfunction fillSingleRepeats(measures){\n  //the repeat marker is Kcl but we've already split on K, so only cl is left over\n  //x appears in its own measure, (drawn as a single angled bar)\n  const xcl = m => m.indexOf('x') >= 0 || m.indexOf('cl') >= 0;\n\n  let repeatMeasureIdx = measures.findIndex(xcl);\n  while(repeatMeasureIdx != -1){\n    measures[repeatMeasureIdx] = measures[repeatMeasureIdx - 1];\n    repeatMeasureIdx = measures.findIndex(xcl);\n  }\n  return measures;\n}\n\nfunction fillInvisibleSlashChords(measures){\n  const W = m => m.some(c => c[0] === 'W');\n\n  let invisibleMeasureIdx = measures.findIndex(W);\n  while(invisibleMeasureIdx != -1){\n    const curMeasure = measures[invisibleMeasureIdx];\n    const invisibleChordIdx = curMeasure.findIndex(c => c[0] === 'W')\n\n    if(invisibleChordIdx > 0){\n      const previousChord = curMeasure[invisibleChordIdx - 1].split(\"/\")[0];\n      curMeasure[invisibleChordIdx] = curMeasure[invisibleChordIdx].replace('W', previousChord);\n    }else{\n      const previousMeasure = measures[invisibleMeasureIdx - 1];\n      const previousChord = previousMeasure[previousMeasure.length - 1].split(\"/\")[0];\n      curMeasure[invisibleChordIdx] = curMeasure[invisibleChordIdx].replace('W', previousChord);\n    }\n    invisibleMeasureIdx = measures.findIndex(W);\n  }\n  return measures;\n}\n\nfunction removeFromString(string, toRemove){\n  return string.split(toRemove).join('');\n}\n\n","'use strict';\n\nconst Music = require('./Music');\nconst musicPrefix = \"1r34LbKcu7\";\n\nclass Song {\n  constructor(data){\n    const parts = data.split(/=+/).filter(x => x != \"\"); //split on one or more equal signs, remove the blanks\n    let offset = 0\n    this.title = parts[0];\n    this.composer = parts[1];\n    this.style = parts[2];\n    this.key = parts[3];\n    this.transpose = null;\n    if(parts[4].indexOf(musicPrefix) !== 0){\n      offset = 1;\n      this.transpose = parseInt(parts[4]) || null;\n    }\n    this.music = new Music(parts[4 + offset]);\n    this.compStyle = parts[5 + offset] || null;\n    this.bpm = parseInt(parts[6 + offset]) || null;\n    this.repeats = parseInt(parts[7 + offset]) || null;\n  }\n}\n\nmodule.exports = Song;","'use strict';\n\nconst Song = require('./Song');\nconst regex = /.*?irealb:\\/\\/([^\"]*)/;\n\nclass Playlist {\n  constructor(data){\n    const percentEncoded = regex.exec(data);\n    const percentDecoded = decodeURIComponent(percentEncoded[1]);\n    const parts = percentDecoded.split(\"===\");  //songs are separated by ===\n    if(parts.length > 1) this.name = parts.pop();  //playlist name\n    this.songs = parts.map(x => new Song(x));\n  }\n}\n\nmodule.exports = Playlist;","'use strict';\n\nconst Playlist = require('./Playlist');\n\n//class hierarchy: Playlist has many Songs. Song has one Music.\n\nmodule.exports = Playlist;","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","var isBrowser = (typeof window !== 'undefined')\n\nvar CLOCK_DEFAULTS = {\n  toleranceLate: 0.10,\n  toleranceEarly: 0.001\n}\n\n// ==================== Event ==================== //\nvar Event = function(clock, deadline, func) {\n  this.clock = clock\n  this.func = func\n  this._cleared = false // Flag used to clear an event inside callback\n\n  this.toleranceLate = clock.toleranceLate\n  this.toleranceEarly = clock.toleranceEarly\n  this._latestTime = null\n  this._earliestTime = null\n  this.deadline = null\n  this.repeatTime = null\n\n  this.schedule(deadline)\n}\n\n// Unschedules the event\nEvent.prototype.clear = function() {\n  this.clock._removeEvent(this)\n  this._cleared = true\n  return this\n}\n\n// Sets the event to repeat every `time` seconds.\nEvent.prototype.repeat = function(time) {\n  if (time === 0)\n    throw new Error('delay cannot be 0')\n  this.repeatTime = time\n  if (!this.clock._hasEvent(this))\n    this.schedule(this.deadline + this.repeatTime)\n  return this\n}\n\n// Sets the time tolerance of the event.\n// The event will be executed in the interval `[deadline - early, deadline + late]`\n// If the clock fails to execute the event in time, the event will be dropped.\nEvent.prototype.tolerance = function(values) {\n  if (typeof values.late === 'number')\n    this.toleranceLate = values.late\n  if (typeof values.early === 'number')\n    this.toleranceEarly = values.early\n  this._refreshEarlyLateDates()\n  if (this.clock._hasEvent(this)) {\n    this.clock._removeEvent(this)\n    this.clock._insertEvent(this)\n  }\n  return this\n}\n\n// Returns true if the event is repeated, false otherwise\nEvent.prototype.isRepeated = function() { return this.repeatTime !== null }\n\n// Schedules the event to be ran before `deadline`.\n// If the time is within the event tolerance, we handle the event immediately.\n// If the event was already scheduled at a different time, it is rescheduled.\nEvent.prototype.schedule = function(deadline) {\n  this._cleared = false\n  this.deadline = deadline\n  this._refreshEarlyLateDates()\n\n  if (this.clock.context.currentTime >= this._earliestTime) {\n    this._execute()\n  \n  } else if (this.clock._hasEvent(this)) {\n    this.clock._removeEvent(this)\n    this.clock._insertEvent(this)\n  \n  } else this.clock._insertEvent(this)\n}\n\nEvent.prototype.timeStretch = function(tRef, ratio) {\n  if (this.isRepeated())\n    this.repeatTime = this.repeatTime * ratio\n\n  var deadline = tRef + ratio * (this.deadline - tRef)\n  // If the deadline is too close or past, and the event has a repeat,\n  // we calculate the next repeat possible in the stretched space.\n  if (this.isRepeated()) {\n    while (this.clock.context.currentTime >= deadline - this.toleranceEarly)\n      deadline += this.repeatTime\n  }\n  this.schedule(deadline)\n}\n\n// Executes the event\nEvent.prototype._execute = function() {\n  if (this.clock._started === false) return\n  this.clock._removeEvent(this)\n\n  if (this.clock.context.currentTime < this._latestTime)\n    this.func(this)\n  else {\n    if (this.onexpired) this.onexpired(this)\n    console.warn('event expired')\n  }\n  // In the case `schedule` is called inside `func`, we need to avoid\n  // overrwriting with yet another `schedule`.\n  if (!this.clock._hasEvent(this) && this.isRepeated() && !this._cleared)\n    this.schedule(this.deadline + this.repeatTime) \n}\n\n// Updates cached times\nEvent.prototype._refreshEarlyLateDates = function() {\n  this._latestTime = this.deadline + this.toleranceLate\n  this._earliestTime = this.deadline - this.toleranceEarly\n}\n\n// ==================== WAAClock ==================== //\nvar WAAClock = module.exports = function(context, opts) {\n  var self = this\n  opts = opts || {}\n  this.tickMethod = opts.tickMethod || 'ScriptProcessorNode'\n  this.toleranceEarly = opts.toleranceEarly || CLOCK_DEFAULTS.toleranceEarly\n  this.toleranceLate = opts.toleranceLate || CLOCK_DEFAULTS.toleranceLate\n  this.context = context\n  this._events = []\n  this._started = false\n}\n\n// ---------- Public API ---------- //\n// Schedules `func` to run after `delay` seconds.\nWAAClock.prototype.setTimeout = function(func, delay) {\n  return this._createEvent(func, this._absTime(delay))\n}\n\n// Schedules `func` to run before `deadline`.\nWAAClock.prototype.callbackAtTime = function(func, deadline) {\n  return this._createEvent(func, deadline)\n}\n\n// Stretches `deadline` and `repeat` of all scheduled `events` by `ratio`, keeping\n// their relative distance to `tRef`. In fact this is equivalent to changing the tempo.\nWAAClock.prototype.timeStretch = function(tRef, events, ratio) {\n  events.forEach(function(event) { event.timeStretch(tRef, ratio) })\n  return events\n}\n\n// Removes all scheduled events and starts the clock \nWAAClock.prototype.start = function() {\n  if (this._started === false) {\n    var self = this\n    this._started = true\n    this._events = []\n\n    if (this.tickMethod === 'ScriptProcessorNode') {\n      var bufferSize = 256\n      // We have to keep a reference to the node to avoid garbage collection\n      this._clockNode = this.context.createScriptProcessor(bufferSize, 1, 1)\n      this._clockNode.connect(this.context.destination)\n      this._clockNode.onaudioprocess = function () {\n        process.nextTick(function() { self._tick() })\n      }\n    } else if (this.tickMethod === 'manual') null // _tick is called manually\n\n    else throw new Error('invalid tickMethod ' + this.tickMethod)\n  }\n}\n\n// Stops the clock\nWAAClock.prototype.stop = function() {\n  if (this._started === true) {\n    this._started = false\n    this._clockNode.disconnect()\n  }  \n}\n\n// ---------- Private ---------- //\n\n// This function is ran periodically, and at each tick it executes\n// events for which `currentTime` is included in their tolerance interval.\nWAAClock.prototype._tick = function() {\n  var event = this._events.shift()\n\n  while(event && event._earliestTime <= this.context.currentTime) {\n    event._execute()\n    event = this._events.shift()\n  }\n\n  // Put back the last event\n  if(event) this._events.unshift(event)\n}\n\n// Creates an event and insert it to the list\nWAAClock.prototype._createEvent = function(func, deadline) {\n  return new Event(this, deadline, func)\n}\n\n// Inserts an event to the list\nWAAClock.prototype._insertEvent = function(event) {\n  this._events.splice(this._indexByTime(event._earliestTime), 0, event)\n}\n\n// Removes an event from the list\nWAAClock.prototype._removeEvent = function(event) {\n  var ind = this._events.indexOf(event)\n  if (ind !== -1) this._events.splice(ind, 1)\n}\n\n// Returns true if `event` is in queue, false otherwise\nWAAClock.prototype._hasEvent = function(event) {\n return this._events.indexOf(event) !== -1\n}\n\n// Returns the index of the first event whose deadline is >= to `deadline`\nWAAClock.prototype._indexByTime = function(deadline) {\n  // performs a binary search\n  var low = 0\n    , high = this._events.length\n    , mid\n  while (low < high) {\n    mid = Math.floor((low + high) / 2)\n    if (this._events[mid]._earliestTime < deadline)\n      low = mid + 1\n    else high = mid\n  }\n  return low\n}\n\n// Converts from relative time to absolute time\nWAAClock.prototype._absTime = function(relTime) {\n  return relTime + this.context.currentTime\n}\n\n// Converts from absolute time to relative time \nWAAClock.prototype._relTime = function(absTime) {\n  return absTime - this.context.currentTime\n}","var WAAClock = require('./lib/WAAClock')\n\nmodule.exports = WAAClock\nif (typeof window !== 'undefined') window.WAAClock = WAAClock\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar waaclock_1 = __importDefault(require(\"waaclock\"));\nvar Pulse = /** @class */ (function () {\n    function Pulse(props) {\n        if (props === void 0) { props = {}; }\n        this.defaults = {\n            bpm: 120,\n            cycle: 4,\n            delay: 0\n        };\n        this.events = [];\n        this.callbackAtTime = false;\n        this.props = Object.assign({}, this.defaults, props);\n        this.context = this.props.context || new AudioContext();\n        this.clock = this.props.clock || new waaclock_1.default(this.context, { toleranceEarly: 0.1, toleranceLate: 0.1 });\n    }\n    Pulse.prototype.getMeasureLength = function (bpm, beatsPerMeasure) {\n        if (bpm === void 0) { bpm = this.props.bpm; }\n        if (beatsPerMeasure === void 0) { beatsPerMeasure = this.props.cycle; }\n        return 60 / bpm * beatsPerMeasure;\n    };\n    Pulse.prototype.arrayPulse = function (children, length, path, start, callback, deadline) {\n        var _this = this;\n        if (length === void 0) { length = 1; }\n        if (path === void 0) { path = []; }\n        if (start === void 0) { start = 0; }\n        //TODO: return promise on next one (for chaining)\n        if (!Array.isArray(children)) {\n            if (children === 0) {\n                return 0;\n            }\n            var item_1 = {\n                value: children,\n                length: length,\n                path: path,\n                start: start,\n                pulse: this,\n                cycle: this.props.cycle,\n                timeout: null\n            };\n            start += this.props.delay; // TODO: be able to add delay from arrayPulse fn directly\n            if (this.callbackAtTime) {\n                start += deadline ? deadline : this.context.currentTime;\n                item_1.timeout = this.clock.callbackAtTime(function (event) {\n                    return callback(Object.assign(item_1, { event: event, deadline: event.deadline }));\n                }, start);\n            }\n            else {\n                start += (deadline || this.context.currentTime) - this.context.currentTime;\n                item_1.timeout = this.clock.setTimeout(function (event) {\n                    return callback(Object.assign(item_1, { event: event, deadline: event.deadline }));\n                }, start);\n            }\n            this.events.push(item_1.timeout);\n            return item_1;\n        }\n        var childLength = length / children.length;\n        return {\n            length: length,\n            children: children.map(function (el, i) {\n                return _this.arrayPulse(el, childLength, path.concat([i]), start + i * childLength, callback, deadline);\n            })\n        };\n    };\n    Pulse.prototype.tickArray = function (array, callback, deadline, length) {\n        var _this = this;\n        array.push(1);\n        var l = length || this.getMeasureLength() * array.length;\n        this.start();\n        return new Promise(function (resolve, reject) {\n            _this.arrayPulse(array, l, [], 0, function (tick, start) {\n                if (tick.path[0] === array.length - 1) {\n                    resolve(tick);\n                }\n                else {\n                    callback(tick, start);\n                }\n            }, deadline);\n        });\n    };\n    Pulse.prototype.start = function () {\n        // console.log('start with', this.events.length, 'events');\n        var criticalEvents = 6000;\n        if (this.events.length > criticalEvents) {\n            console.warn('more than ', criticalEvents, 'events received. Consider using less \"times\" to keep the timing precies');\n        }\n        this.clock.start();\n    };\n    Pulse.prototype.stop = function () {\n        this.clock.stop();\n    };\n    Pulse.prototype.changeTempo = function (newTempo, timeout) {\n        var _this = this;\n        if (timeout === void 0) { timeout = 0.2; }\n        var factor = this.props.bpm / newTempo;\n        this.props.bpm = newTempo;\n        var events = this.events.filter(function (e) {\n            return e.deadline - _this.context.currentTime > timeout;\n        });\n        // TODO: stretch durations?!\n        this.clock.timeStretch(this.context.currentTime, events, factor);\n    };\n    return Pulse;\n}());\nexports.Pulse = Pulse;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Sheet_1 = require(\"./Sheet\");\n;\nvar Measure = /** @class */ (function () {\n    function Measure() {\n    }\n    Measure.from = function (measure) {\n        if (typeof measure === 'string') {\n            return {\n                chords: [measure]\n            };\n        }\n        if (Array.isArray(measure)) {\n            return {\n                chords: [].concat(measure)\n            };\n        }\n        return Object.assign({}, measure);\n        // return measure;\n    };\n    Measure.hasSign = function (sign, measure) {\n        measure = Measure.from(measure);\n        return !!measure.signs && measure.signs.includes(sign);\n    };\n    Measure.hasHouse = function (measure, number) {\n        measure = Measure.from(measure);\n        var house = measure.house;\n        if (!house) {\n            return false;\n        }\n        else if (number === undefined) {\n            return true;\n        }\n        if (!Array.isArray(house)) {\n            house = [house];\n        }\n        return house.includes(number);\n    };\n    Measure.getJumpSign = function (measure) {\n        var signs = (Measure.from(measure).signs || [])\n            .filter(function (s) { return Object.keys(Sheet_1.Sheet.jumpSigns).includes(s); });\n        if (signs.length > 1) {\n            console.warn('measure cannot contain more than one repeat sign', measure);\n        }\n        return Sheet_1.Sheet.jumpSigns[signs[0]];\n    };\n    Measure.hasJumpSign = function (measure) {\n        return Object.keys(Sheet_1.Sheet.jumpSigns)\n            .reduce(function (match, current) { return match || Measure.hasSign(current, measure); }, false);\n    };\n    return Measure;\n}());\nexports.Measure = Measure;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Measure_1 = require(\"./Measure\");\nvar Sheet = /** @class */ (function () {\n    function Sheet() {\n    }\n    Sheet.render = function (sheet, options) {\n        if (options === void 0) { options = {}; }\n        var state = __assign({ sheet: sheet, measures: [], forms: 1, nested: true, fallbackToZero: true, firstTime: true }, options);\n        state = __assign({}, state, Sheet.newForm(state));\n        var runs = 0;\n        while (runs < 100 && state.index < sheet.length) {\n            runs++;\n            state = Sheet.nextMeasure(state);\n        }\n        return state.measures /* .map(m => Measure.from(m)) */;\n    };\n    Sheet.nextMeasure = function (state) {\n        state = __assign({}, state, Sheet.nextSection(state)); // moves to the right house (if any)\n        var sheet = state.sheet, index = state.index, measures = state.measures;\n        state = __assign({}, state, { measures: measures.concat([__assign({}, Measure_1.Measure.from(sheet[index]), { index: index // add index for mapping\n                 })]) }, Sheet.nextIndex(state));\n        return Sheet.nextForm(state);\n    };\n    Sheet.nextIndex = function (state) {\n        var _a;\n        var sheet = state.sheet, index = state.index, jumps = state.jumps, nested = state.nested, fallbackToZero = state.fallbackToZero;\n        if (!Sheet.shouldJump({ sheet: sheet, index: index, jumps: jumps })) {\n            return {\n                index: index + 1\n            };\n        }\n        var braces = [Sheet.getJumpDestination({ sheet: sheet, index: index, fallbackToZero: fallbackToZero, nested: nested }), index];\n        jumps = Sheet.wipeKeys(jumps, [braces[0], braces[1] - 1]); // wipes indices inside braces\n        return {\n            index: braces[0],\n            jumps: __assign({}, jumps, (_a = {}, _a[braces[1]] = (jumps[braces[1]] || 0) + 1, _a))\n        };\n    };\n    Sheet.newForm = function (state) {\n        return __assign({}, state, { index: 0, jumps: {}, visits: {}, lastTime: state.forms === 1 });\n    };\n    Sheet.nextForm = function (state, force) {\n        if (force === void 0) { force = false; }\n        var sheet = state.sheet, index = state.index, forms = state.forms;\n        if (force || (index >= sheet.length && forms > 1)) {\n            return Sheet.newForm(__assign({}, state, { firstTime: false, forms: forms - 1 }));\n        }\n        return state;\n    };\n    // moves the index to the current house (if any)\n    Sheet.nextSection = function (state) {\n        var _a;\n        var sheet = state.sheet, index = state.index, visits = state.visits, firstTime = state.firstTime, lastTime = state.lastTime;\n        // skip intro when not firstTime\n        if (!firstTime && Measure_1.Measure.from(sheet[index]).section === 'IN') {\n            return {\n                index: Sheet.getNextSectionIndex({ sheet: sheet, index: index }),\n            };\n        }\n        // skip coda when not last time\n        if (Measure_1.Measure.hasSign('Coda', sheet[index]) && !Sheet.readyForFineOrCoda(state)) {\n            return Sheet.nextForm(state, true);\n        }\n        if (!Measure_1.Measure.hasHouse(sheet[index], 1)) {\n            return {};\n        }\n        var next = Sheet.getNextHouseIndex({ sheet: sheet, index: index, visits: visits });\n        if (next === -1) {\n            next = index;\n            visits = {}; // reset visits\n        }\n        return {\n            visits: __assign({}, visits, (_a = {}, _a[next] = (visits[next] || 0) + 1, _a)),\n            index: next\n        };\n    };\n    /** Starts at a given index, stops when the pair functions returned equally often */\n    Sheet.findPair = function (sheet, index, pairs, move, stack) {\n        if (move === void 0) { move = 1; }\n        if (stack === void 0) { stack = 0; }\n        var match = -1; // start with no match\n        while (match === -1 && index >= 0 && index < sheet.length) {\n            if (pairs[0](sheet[index], { sheet: sheet, index: index })) { // same sign\n                stack++;\n            }\n            if (pairs[1](sheet[index], { sheet: sheet, index: index })) { // pair sign\n                stack--;\n            }\n            if (stack === 0) { // all pairs resolved > match!\n                match = index;\n            }\n            else {\n                index += move;\n            }\n        }\n        return match;\n    };\n    Sheet.findMatch = function (sheet, index, find, move) {\n        if (move === void 0) { move = 1; }\n        var match = -1; // start with no match\n        while (match === -1 && index >= 0 && index < sheet.length) {\n            if (find(sheet[index], { sheet: sheet, index: index })) {\n                match = index;\n            }\n            else {\n                index += move;\n            }\n        }\n        return match;\n    };\n    // simple matching for brace start, ignores nested repeats\n    Sheet.getJumpDestination = function (state) {\n        var sheet = state.sheet, index = state.index, fallbackToZero = state.fallbackToZero, nested = state.nested;\n        var sign = Measure_1.Measure.getJumpSign(sheet[index]);\n        // if fine > jump till end\n        if (sign.fine) {\n            return sheet.length;\n        }\n        // if no pair given => da capo\n        if (!sign.pair) {\n            return 0;\n        }\n        // if nested mode on and opening brace is searched, use getBracePair..\n        if (nested !== false && sign.pair === '{') {\n            return Sheet.getBracePair({ sheet: sheet, index: index, fallbackToZero: fallbackToZero });\n        }\n        var destination = Sheet.findMatch(sheet, index, function (m) { return Measure_1.Measure.hasSign(sign.pair, m); }, sign.move || -1); // default move back\n        if (fallbackToZero) {\n            // default to zero when searching repeat start (could be forgotten)\n            return destination === -1 ? 0 : destination;\n        }\n        return destination;\n    };\n    // returns the index of the repeat sign that pairs with the given index\n    Sheet.getBracePair = function (_a) {\n        var sheet = _a.sheet, index = _a.index, fallbackToZero = _a.fallbackToZero;\n        if (fallbackToZero === undefined) {\n            fallbackToZero = true;\n        }\n        if (Measure_1.Measure.hasSign('{', sheet[index])) {\n            return Sheet.findPair(sheet, index, [\n                function (m) { return Measure_1.Measure.hasSign('{', m); },\n                function (m) { return Measure_1.Measure.hasSign('}', m); },\n            ], 1);\n        }\n        else if (Measure_1.Measure.hasSign('}', sheet[index])) {\n            var pair = Sheet.findPair(sheet, index, [\n                function (m, state) {\n                    // this logic could be infinitely complex, having many side effects and interpretations\n                    // the current behaviour is similar to musescore or ireal handling braces\n                    if (!Measure_1.Measure.hasSign('}', m)) {\n                        return false;\n                    }\n                    if (index === state.index) {\n                        return true;\n                    }\n                    var relatedHouse = Sheet.getRelatedHouse({ sheet: sheet, index: state.index });\n                    return relatedHouse === -1;\n                },\n                function (m) { return Measure_1.Measure.hasSign('{', m); }\n            ], -1);\n            if (fallbackToZero) {\n                return pair === -1 ? 0 : pair; // default to zero when searching repeat start (could be forgotten)\n            }\n            return pair;\n        }\n        return -1;\n    };\n    // returns true if the house at the given index has not been visited enough times\n    Sheet.canVisitHouse = function (_a) {\n        var sheet = _a.sheet, index = _a.index, visits = _a.visits;\n        var houses = sheet[index].house;\n        if (houses === undefined) {\n            return false;\n        }\n        if (!Array.isArray(houses)) {\n            houses = [houses];\n        }\n        var visited = visits[index] || 0;\n        return visited < houses.length;\n    };\n    // returns the next house that can be visited (from the given index)\n    Sheet.getNextHouseIndex = function (_a, move) {\n        var sheet = _a.sheet, index = _a.index, visits = _a.visits;\n        if (move === void 0) { move = 1; }\n        return Sheet.findMatch(sheet, index, function (m, step) { return Measure_1.Measure.hasHouse(m) && Sheet.canVisitHouse({ sheet: sheet, index: step.index, visits: visits }); }, move);\n    };\n    Sheet.getNextSectionIndex = function (_a, move) {\n        var sheet = _a.sheet, index = _a.index;\n        if (move === void 0) { move = 1; }\n        return Sheet.findMatch(sheet, index + 1, function (m) { return Measure_1.Measure.from(m).section !== undefined; }, 1);\n    };\n    // wipes all keys in the given range\n    Sheet.wipeKeys = function (numberMap, range) {\n        var wiped = {};\n        Object.keys(numberMap)\n            .map(function (i) { return parseInt(i); })\n            .filter(function (i) { return i < range[0] || i > range[1]; })\n            .forEach(function (i) { return wiped[i] = numberMap[i]; });\n        return wiped;\n    };\n    Sheet.getRelatedHouse = function (_a) {\n        var sheet = _a.sheet, index = _a.index;\n        var latestHouse = Sheet.findPair(sheet, index, [\n            function (m, state) { return index === state.index || Measure_1.Measure.hasSign('}', m); },\n            function (m) { return Measure_1.Measure.hasHouse(m); }\n        ], -1);\n        return latestHouse;\n    };\n    Sheet.isFirstHouse = function (_a) {\n        var sheet = _a.sheet, index = _a.index;\n        return Measure_1.Measure.hasHouse(sheet[index], 1);\n    };\n    Sheet.getAllowedJumps = function (_a) {\n        var sheet = _a.sheet, index = _a.index;\n        if (!Measure_1.Measure.hasJumpSign(sheet[index])) {\n            return 0;\n        }\n        var measure = Measure_1.Measure.from(sheet[index]);\n        if (measure.times !== undefined) {\n            return measure.times;\n        }\n        return 1;\n    };\n    Sheet.readyForFineOrCoda = function (_a) {\n        var sheet = _a.sheet, index = _a.index, jumps = _a.jumps, lastTime = _a.lastTime;\n        var signs = Object.keys(Sheet.jumpSigns)\n            .filter(function (s) { return s.includes('DC') || s.includes('DS'); });\n        var backJump = Sheet.findMatch(sheet, index, function (m) { return signs.reduce(function (match, sign) { return match || Measure_1.Measure.hasSign(sign, m); }, false); });\n        if (backJump === -1) {\n            return lastTime; // last time\n        }\n        return jumps[backJump] > 0;\n    };\n    Sheet.shouldJump = function (_a) {\n        var sheet = _a.sheet, index = _a.index, jumps = _a.jumps;\n        if (!Measure_1.Measure.hasJumpSign(sheet[index])) {\n            return false;\n        }\n        var sign = Measure_1.Measure.getJumpSign(sheet[index]);\n        if (sign.validator && !sign.validator({ sheet: sheet, index: index, jumps: jumps })) {\n            return false;\n        }\n        var allowedJumps = Sheet.getAllowedJumps({ sheet: sheet, index: index });\n        var timesJumped = jumps[index] || 0;\n        return timesJumped < allowedJumps;\n    };\n    Sheet.jumpSigns = {\n        '}': { pair: '{', move: -1 },\n        'DC': {},\n        'DS': { pair: 'Segno', move: -1 },\n        'DS.Fine': { pair: 'Segno', move: -1 },\n        'DS.Coda': { pair: 'Segno', move: -1 },\n        'DC.Fine': {},\n        'DC.Coda': {},\n        'Fine': {\n            fine: true,\n            validator: function (state) { return Sheet.readyForFineOrCoda(state); }\n        },\n        'ToCoda': {\n            pair: 'Coda', move: 1,\n            validator: function (state) { return Sheet.readyForFineOrCoda(state); }\n        }\n    };\n    return Sheet;\n}());\nexports.Sheet = Sheet;\n/*\nTODO:\n\nmore typings\nspecial sections:\nIN: only play the first time\nCODA: only play last time\n\ntest standards:\n- Alice in Wonderland (dc al 2nd ending)\n- All or Nothing at All (dc al coda)\n- Are you real (intro + coda)\n- Armageddon (intro)\n- The Bat (coda sign inside repeat): ireal plays coda directly first time..\n- Bennys Tune (intro+coda sign inside repeat): ireal plays coda directly first time..\n- Bess You Is My Woman (coda sign inside repeat): ireal plays coda directly first time..\n- Blessed Relief (nested repeats, with odd behaviour)\n- Blue in Green (coda)\n- Miles Ahead (coda)\n*/\n","var NAMES = \"C C# Db D D# Eb E F F# Gb G G# Ab A A# Bb B\".split(\" \");\r\nvar names = function (accTypes) {\r\n    return typeof accTypes !== \"string\"\r\n        ? NAMES.slice()\r\n        : NAMES.filter(function (n) {\r\n            var acc = n[1] || \" \";\r\n            return accTypes.indexOf(acc) !== -1;\r\n        });\r\n};\r\nvar SHARPS = names(\" #\");\r\nvar FLATS = names(\" b\");\r\nvar REGEX = /^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\\d*)\\s*(.*)$/;\r\nfunction tokenize(str) {\r\n    if (typeof str !== \"string\")\r\n        str = \"\";\r\n    var m = REGEX.exec(str);\r\n    return [m[1].toUpperCase(), m[2].replace(/x/g, \"##\"), m[3], m[4]];\r\n}\r\nvar NO_NOTE = Object.freeze({\r\n    pc: null,\r\n    name: null,\r\n    step: null,\r\n    alt: null,\r\n    oct: null,\r\n    octStr: null,\r\n    chroma: null,\r\n    midi: null,\r\n    freq: null\r\n});\r\nvar SEMI = [0, 2, 4, 5, 7, 9, 11];\r\nvar properties = function (str) {\r\n    var tokens = tokenize(str);\r\n    if (tokens[0] === \"\" || tokens[3] !== \"\")\r\n        return NO_NOTE;\r\n    var letter = tokens[0], acc = tokens[1], octStr = tokens[2];\r\n    var p = {\r\n        letter: letter,\r\n        acc: acc,\r\n        octStr: octStr,\r\n        pc: letter + acc,\r\n        name: letter + acc + octStr,\r\n        step: (letter.charCodeAt(0) + 3) % 7,\r\n        alt: acc[0] === \"b\" ? -acc.length : acc.length,\r\n        oct: octStr.length ? +octStr : null,\r\n        chroma: 0,\r\n        midi: null,\r\n        freq: null\r\n    };\r\n    p.chroma = (SEMI[p.step] + p.alt + 120) % 12;\r\n    p.midi = p.oct !== null ? SEMI[p.step] + p.alt + 12 * (p.oct + 1) : null;\r\n    p.freq = midiToFreq(p.midi);\r\n    return Object.freeze(p);\r\n};\r\nvar memo = function (fn, cache) {\r\n    if (cache === void 0) { cache = {}; }\r\n    return function (str) { return cache[str] || (cache[str] = fn(str)); };\r\n};\r\nvar props = memo(properties);\r\nvar name = function (str) { return props(str).name; };\r\nvar pc = function (str) { return props(str).pc; };\r\nvar isMidiRange = function (m) { return m >= 0 && m <= 127; };\r\nvar midi = function (note) {\r\n    if (typeof note !== \"number\" && typeof note !== \"string\") {\r\n        return null;\r\n    }\r\n    var midi = props(note).midi;\r\n    var value = midi || midi === 0 ? midi : +note;\r\n    return isMidiRange(value) ? value : null;\r\n};\r\nvar midiToFreq = function (midi, tuning) {\r\n    if (tuning === void 0) { tuning = 440; }\r\n    return typeof midi === \"number\" ? Math.pow(2, (midi - 69) / 12) * tuning : null;\r\n};\r\nvar freq = function (note) { return props(note).freq || midiToFreq(note); };\r\nvar L2 = Math.log(2);\r\nvar L440 = Math.log(440);\r\nvar freqToMidi = function (freq) {\r\n    var v = (12 * (Math.log(freq) - L440)) / L2 + 69;\r\n    return Math.round(v * 100) / 100;\r\n};\r\nvar chroma = function (str) { return props(str).chroma; };\r\nvar oct = function (str) { return props(str).oct; };\r\nvar LETTERS = \"CDEFGAB\";\r\nvar stepToLetter = function (step) { return LETTERS[step]; };\r\nvar fillStr = function (s, n) { return Array(n + 1).join(s); };\r\nvar numToStr = function (num, op) {\r\n    return typeof num !== \"number\" ? \"\" : op(num);\r\n};\r\nvar altToAcc = function (alt) {\r\n    return numToStr(alt, function (alt) { return (alt < 0 ? fillStr(\"b\", -alt) : fillStr(\"#\", alt)); });\r\n};\r\nvar from = function (fromProps, baseNote) {\r\n    if (fromProps === void 0) { fromProps = {}; }\r\n    if (baseNote === void 0) { baseNote = null; }\r\n    var _a = baseNote\r\n        ? Object.assign({}, props(baseNote), fromProps)\r\n        : fromProps, step = _a.step, alt = _a.alt, oct = _a.oct;\r\n    if (typeof step !== \"number\")\r\n        return null;\r\n    var letter = stepToLetter(step);\r\n    if (!letter)\r\n        return null;\r\n    var pc = letter + altToAcc(alt);\r\n    return oct || oct === 0 ? pc + oct : pc;\r\n};\r\nvar build = from;\r\nfunction fromMidi(num, sharps) {\r\n    if (sharps === void 0) { sharps = false; }\r\n    num = Math.round(num);\r\n    var pcs = sharps === true ? SHARPS : FLATS;\r\n    var pc = pcs[num % 12];\r\n    var o = Math.floor(num / 12) - 1;\r\n    return pc + o;\r\n}\r\nvar simplify = function (note, sameAcc) {\r\n    if (sameAcc === void 0) { sameAcc = true; }\r\n    var _a = props(note), alt = _a.alt, chroma = _a.chroma, midi = _a.midi;\r\n    if (chroma === null)\r\n        return null;\r\n    var alteration = alt;\r\n    var useSharps = sameAcc === false ? alteration < 0 : alteration > 0;\r\n    return midi === null\r\n        ? pc(fromMidi(chroma, useSharps))\r\n        : fromMidi(midi, useSharps);\r\n};\r\nvar enharmonic = function (note) { return simplify(note, false); };\n\nexport { names, tokenize, props, name, pc, midi, midiToFreq, freq, freqToMidi, chroma, oct, stepToLetter, altToAcc, from, build, fromMidi, simplify, enharmonic };\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-array.svg?style=flat-square)](https://www.npmjs.com/package/tonal-array)\n *\n * Tonal array utilities. Create ranges, sort notes, ...\n *\n * @example\n * import * as Array;\n * Array.sort([\"f\", \"a\", \"c\"]) // => [\"C\", \"F\", \"A\"]\n *\n * @example\n * const Array = require(\"tonal-array\")\n * Array.range(1, 4) // => [1, 2, 3, 4]\n *\n * @module Array\n */\nimport { props, name } from \"tonal-note\";\n\n// ascending range\nfunction ascR(b, n) {\n  for (var a = []; n--; a[n] = n + b){ ; }\n  return a;\n}\n// descending range\nfunction descR(b, n) {\n  for (var a = []; n--; a[n] = b - n){ ; }\n  return a;\n}\n\n/**\n * Create a numeric range\n *\n * @param {Number} from\n * @param {Number} to\n * @return {Array}\n *\n * @example\n * Array.range(-2, 2) // => [-2, -1, 0, 1, 2]\n * Array.range(2, -2) // => [2, 1, 0, -1, -2]\n */\nexport function range(a, b) {\n  return a === null || b === null\n    ? []\n    : a < b\n      ? ascR(a, b - a + 1)\n      : descR(a, a - b + 1);\n}\n/**\n *\n * Rotates a list a number of times. It\"s completly agnostic about the\n * contents of the list.\n *\n * @param {Integer} times - the number of rotations\n * @param {Array} array\n * @return {Array} the rotated array\n * @example\n * Array.rotate(1, [1, 2, 3]) // => [2, 3, 1]\n */\nexport function rotate(times, arr) {\n  var len = arr.length;\n  var n = ((times % len) + len) % len;\n  return arr.slice(n, len).concat(arr.slice(0, n));\n}\n\n/**\n * Return a copy of the array with the null values removed\n * @function\n * @param {Array} array\n * @return {Array}\n *\n * @example\n * Array.compact([\"a\", \"b\", null, \"c\"]) // => [\"a\", \"b\", \"c\"]\n */\nexport var compact = function (arr) { return arr.filter(function (n) { return n === 0 || n; }); };\n\n// a function that get note heights (with negative number for pitch classes)\nvar height = function (name) {\n  var m = props(name).midi;\n  return m !== null ? m : props(name + \"-100\").midi;\n};\n\n/**\n * Sort an array of notes in ascending order\n *\n * @param {String|Array} notes\n * @return {Array} sorted array of notes\n */\nexport function sort(src) {\n  return compact(src.map(name)).sort(function (a, b) { return height(a) > height(b); });\n}\n\n/**\n * Get sorted notes with duplicates removed\n *\n * @function\n * @param {Array} notes\n */\nexport function unique(arr) {\n  return sort(arr).filter(function (n, i, a) { return i === 0 || n !== a[i - 1]; });\n}\n\n/**\n * Randomizes the order of the specified array in-place, using the FisherYates shuffle.\n *\n * @private\n * @function\n * @param {Array|String} arr - the array\n * @return {Array} the shuffled array\n *\n * @example\n * Array.shuffle([\"C\", \"D\", \"E\", \"F\"])\n */\nexport var shuffle = function (arr, rnd) {\n  if ( rnd === void 0 ) rnd = Math.random;\n\n  var i, t;\n  var m = arr.length;\n  while (m) {\n    i = (rnd() * m--) | 0;\n    t = arr[m];\n    arr[m] = arr[i];\n    arr[i] = t;\n  }\n  return arr;\n};\n\n/**\n * Get all permutations of an array\n * http://stackoverflow.com/questions/9960908/permutations-in-javascript\n *\n * @param {Array} array - the array\n * @return {Array<Array>} an array with all the permutations\n */\nexport var permutations = function (arr) {\n  if (arr.length === 0) { return [[]]; }\n  return permutations(arr.slice(1)).reduce(function(acc, perm) {\n    return acc.concat(\n      arr.map(function(e, pos) {\n        var newPerm = perm.slice();\n        newPerm.splice(pos, 0, arr[0]);\n        return newPerm;\n      })\n    );\n  }, []);\n};\n","var IVL_TNL = \"([-+]?\\\\d+)(d{1,4}|m|M|P|A{1,4})\";\r\nvar IVL_STR = \"(AA|A|P|M|m|d|dd)([-+]?\\\\d+)\";\r\nvar REGEX = new RegExp(\"^\" + IVL_TNL + \"|\" + IVL_STR + \"$\");\r\nvar SIZES = [0, 2, 4, 5, 7, 9, 11];\r\nvar TYPES = \"PMMPPMM\";\r\nvar CLASSES = [0, 1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1];\r\nvar NAMES = \"1P 2m 2M 3m 3M 4P 5P 6m 6M 7m 7M 8P\".split(\" \");\r\nvar names = function (types) {\r\n    return typeof types !== \"string\"\r\n        ? NAMES.slice()\r\n        : NAMES.filter(function (n) { return types.indexOf(n[1]) !== -1; });\r\n};\r\nvar tokenize = function (str) {\r\n    var m = REGEX.exec(\"\" + str);\r\n    if (m === null)\r\n        return null;\r\n    return (m[1] ? [m[1], m[2]] : [m[4], m[3]]);\r\n};\r\nvar NO_IVL = Object.freeze({\r\n    name: null,\r\n    num: null,\r\n    q: null,\r\n    step: null,\r\n    alt: null,\r\n    dir: null,\r\n    type: null,\r\n    simple: null,\r\n    semitones: null,\r\n    chroma: null,\r\n    oct: null\r\n});\r\nvar fillStr = function (s, n) { return Array(Math.abs(n) + 1).join(s); };\r\nvar qToAlt = function (type, q) {\r\n    if (q === \"M\" && type === \"M\")\r\n        return 0;\r\n    if (q === \"P\" && type === \"P\")\r\n        return 0;\r\n    if (q === \"m\" && type === \"M\")\r\n        return -1;\r\n    if (/^A+$/.test(q))\r\n        return q.length;\r\n    if (/^d+$/.test(q))\r\n        return type === \"P\" ? -q.length : -q.length - 1;\r\n    return null;\r\n};\r\nvar altToQ = function (type, alt) {\r\n    if (alt === 0)\r\n        return type === \"M\" ? \"M\" : \"P\";\r\n    else if (alt === -1 && type === \"M\")\r\n        return \"m\";\r\n    else if (alt > 0)\r\n        return fillStr(\"A\", alt);\r\n    else if (alt < 0)\r\n        return fillStr(\"d\", type === \"P\" ? alt : alt + 1);\r\n    else\r\n        return null;\r\n};\r\nvar numToStep = function (num) { return (Math.abs(num) - 1) % 7; };\r\nvar properties = function (str) {\r\n    var t = tokenize(str);\r\n    if (t === null)\r\n        return NO_IVL;\r\n    var p = {\r\n        num: 0,\r\n        q: \"d\",\r\n        name: \"\",\r\n        type: \"M\",\r\n        step: 0,\r\n        dir: -1,\r\n        simple: 1,\r\n        alt: 0,\r\n        oct: 0,\r\n        semitones: 0,\r\n        chroma: 0,\r\n        ic: 0\r\n    };\r\n    p.num = +t[0];\r\n    p.q = t[1];\r\n    p.step = numToStep(p.num);\r\n    p.type = TYPES[p.step];\r\n    if (p.type === \"M\" && p.q === \"P\")\r\n        return NO_IVL;\r\n    p.name = \"\" + p.num + p.q;\r\n    p.dir = p.num < 0 ? -1 : 1;\r\n    p.simple = (p.num === 8 || p.num === -8\r\n        ? p.num\r\n        : p.dir * (p.step + 1));\r\n    p.alt = qToAlt(p.type, p.q);\r\n    p.oct = Math.floor((Math.abs(p.num) - 1) / 7);\r\n    p.semitones = p.dir * (SIZES[p.step] + p.alt + 12 * p.oct);\r\n    p.chroma = ((((p.dir * (SIZES[p.step] + p.alt)) % 12) + 12) %\r\n        12);\r\n    return Object.freeze(p);\r\n};\r\nvar cache = {};\r\nfunction props(str) {\r\n    if (typeof str !== \"string\")\r\n        return NO_IVL;\r\n    return cache[str] || (cache[str] = properties(str));\r\n}\r\nvar num = function (str) { return props(str).num; };\r\nvar name = function (str) { return props(str).name; };\r\nvar semitones = function (str) { return props(str).semitones; };\r\nvar chroma = function (str) { return props(str).chroma; };\r\nvar ic = function (ivl) {\r\n    if (typeof ivl === \"string\")\r\n        ivl = props(ivl).chroma;\r\n    return typeof ivl === \"number\" ? CLASSES[ivl % 12] : null;\r\n};\r\nvar build = function (_a) {\r\n    var _b = _a === void 0 ? {} : _a, num = _b.num, step = _b.step, alt = _b.alt, _c = _b.oct, oct = _c === void 0 ? 1 : _c, dir = _b.dir;\r\n    if (step !== undefined)\r\n        num = step + 1 + 7 * oct;\r\n    if (num === undefined)\r\n        return null;\r\n    if (typeof alt !== \"number\")\r\n        return null;\r\n    var d = typeof dir !== \"number\" ? \"\" : dir < 0 ? \"-\" : \"\";\r\n    var type = TYPES[numToStep(num)];\r\n    return (d + num + altToQ(type, alt));\r\n};\r\nvar simplify = function (str) {\r\n    var p = props(str);\r\n    if (p === NO_IVL)\r\n        return null;\r\n    var intervalProps = p;\r\n    return intervalProps.simple + intervalProps.q;\r\n};\r\nvar invert = function (str) {\r\n    var p = props(str);\r\n    if (p === NO_IVL)\r\n        return null;\r\n    var intervalProps = p;\r\n    var step = (7 - intervalProps.step) % 7;\r\n    var alt = intervalProps.type === \"P\" ? -intervalProps.alt : -(intervalProps.alt + 1);\r\n    return build({ step: step, alt: alt, oct: intervalProps.oct, dir: intervalProps.dir });\r\n};\r\nvar IN = [1, 2, 2, 3, 3, 4, 5, 5, 6, 6, 7, 7];\r\nvar IQ = \"P m M m M P d P m M m M\".split(\" \");\r\nvar fromSemitones = function (num) {\r\n    var d = num < 0 ? -1 : 1;\r\n    var n = Math.abs(num);\r\n    var c = n % 12;\r\n    var o = Math.floor(n / 12);\r\n    return d * (IN[c] + 7 * o) + IQ[c];\r\n};\n\nexport { names, tokenize, qToAlt, altToQ, props, num, name, semitones, chroma, ic, build, simplify, invert, fromSemitones };\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-distance.svg)](https://www.npmjs.com/package/tonal-distance)\n * [![tonal](https://img.shields.io/badge/tonal-distance-yellow.svg)](https://github.com/danigb/tonal/tree/master/packages/tonal/distance)\n *\n * Transpose notes by intervals and find distances between notes\n *\n * @example\n * // es6\n * import * as Distance from \"tonal-distance\"\n * Distance.interval(\"C3\", \"C4\") // => \"1P\"\n *\n * @example\n * // es6 import selected functions\n * import { interval, semitones, transpose } from \"tonal-distance\"\n *\n * semitones(\"C\" ,\"D\") // => 2\n * interval(\"C4\", \"G4\") // => \"5P\"\n * transpose(\"C4\", \"P5\") // => \"G4\"\n *\n * @example\n * // included in tonal facade\n * const Tonal = require(\"tonal\");\n * Tonal.Distance.transpose(\"C4\", \"P5\")\n * Tonal.Distance.transposeBy(\"P5\", \"C4\")\n *\n * @module Distance\n */\nimport { props as noteProps, build as fromNote } from \"tonal-note\";\nimport { props as iprops, build as ibuild } from \"tonal-interval\";\n\n// Map from letter step to number of fifths starting from \"C\":\n// { C: 0, D: 2, E: 4, F: -1, G: 1, A: 3, B: 5 }\nvar FIFTHS = [0, 2, 4, -1, 1, 3, 5];\n\n// Given a number of fifths, return the octaves they span\nvar fOcts = function (f) { return Math.floor((f * 7) / 12); };\n\n// Get the number of octaves it span each step\nvar FIFTH_OCTS = FIFTHS.map(fOcts);\n\nvar encode = function (ref) {\n  var step = ref.step;\n  var alt = ref.alt;\n  var oct = ref.oct;\n  var dir = ref.dir; if ( dir === void 0 ) dir = 1;\n\n  var f = FIFTHS[step] + 7 * alt;\n  if (oct === null) { return [dir * f]; }\n  var o = oct - FIFTH_OCTS[step] - 4 * alt;\n  return [dir * f, dir * o];\n};\n\n// We need to get the steps from fifths\n// Fifths for CDEFGAB are [ 0, 2, 4, -1, 1, 3, 5 ]\n// We add 1 to fifths to avoid negative numbers, so:\n// for [\"F\", \"C\", \"G\", \"D\", \"A\", \"E\", \"B\"] we have:\nvar STEPS = [3, 0, 4, 1, 5, 2, 6];\n\n// Return the number of fifths as if it were unaltered\nfunction unaltered(f) {\n  var i = (f + 1) % 7;\n  return i < 0 ? 7 + i : i;\n}\n\nvar decode = function (f, o, dir) {\n  var step = STEPS[unaltered(f)];\n  var alt = Math.floor((f + 1) / 7);\n  if (o === undefined) { return { step: step, alt: alt, dir: dir }; }\n  var oct = o + 4 * alt + FIFTH_OCTS[step];\n  return { step: step, alt: alt, oct: oct, dir: dir };\n};\n\nvar memo = function (fn, cache) {\n  if ( cache === void 0 ) cache = {};\n\n  return function (str) { return cache[str] || (cache[str] = fn(str)); };\n};\n\nvar encoder = function (props) { return memo(function (str) {\n    var p = props(str);\n    return p.name === null ? null : encode(p);\n  }); };\n\nvar encodeNote = encoder(noteProps);\nvar encodeIvl = encoder(iprops);\n\n/**\n * Transpose a note by an interval. The note can be a pitch class.\n *\n * This function can be partially applied.\n *\n * @param {String} note\n * @param {String} interval\n * @return {String} the transposed note\n * @example\n * import { tranpose } from \"tonal-distance\"\n * transpose(\"d3\", \"3M\") // => \"F#3\"\n * // it works with pitch classes\n * transpose(\"D\", \"3M\") // => \"F#\"\n * // can be partially applied\n * [\"C\", \"D\", \"E\", \"F\", \"G\"].map(transpose(\"M3)) // => [\"E\", \"F#\", \"G#\", \"A\", \"B\"]\n */\nexport function transpose(note, interval) {\n  if (arguments.length === 1) { return function (i) { return transpose(note, i); }; }\n  var n = encodeNote(note);\n  var i = encodeIvl(interval);\n  if (n === null || i === null) { return null; }\n  var tr = n.length === 1 ? [n[0] + i[0]] : [n[0] + i[0], n[1] + i[1]];\n  return fromNote(decode(tr[0], tr[1]));\n}\n\n/**\n * Transpose a pitch class by a number of perfect fifths.\n *\n * It can be partially applied.\n *\n * @function\n * @param {String} pitchClass - the pitch class\n * @param {Integer} fifhts - the number of fifths\n * @return {String} the transposed pitch class\n *\n * @example\n * import { trFifths } from \"tonal-transpose\"\n * [0, 1, 2, 3, 4].map(trFifths(\"C\")) // => [\"C\", \"G\", \"D\", \"A\", \"E\"]\n * // or using tonal\n * Distance.trFifths(\"G4\", 1) // => \"D\"\n */\n\nexport function trFifths(note, fifths) {\n  if (arguments.length === 1) { return function (f) { return trFifths(note, f); }; }\n  var n = encodeNote(note);\n  if (n === null) { return null; }\n  return fromNote(decode(n[0] + fifths));\n}\n\n/**\n * Get the distance in fifths between pitch classes\n *\n * Can be partially applied.\n *\n * @param {String} to - note or pitch class\n * @param {String} from - note or pitch class\n */\nexport function fifths(from, to) {\n  if (arguments.length === 1) { return function (to) { return fifths(from, to); }; }\n  var f = encodeNote(from);\n  var t = encodeNote(to);\n  if (t === null || f === null) { return null; }\n  return t[0] - f[0];\n}\n\n/**\n * The same as transpose with the arguments inverted.\n *\n * Can be partially applied.\n *\n * @param {String} note\n * @param {String} interval\n * @return {String} the transposed note\n * @example\n * import { tranposeBy } from \"tonal-distance\"\n * transposeBy(\"3m\", \"5P\") // => \"7m\"\n */\nexport function transposeBy(interval, note) {\n  if (arguments.length === 1) { return function (n) { return transpose(n, interval); }; }\n  return transpose(note, interval);\n}\n\nvar isDescending = function (e) { return e[0] * 7 + e[1] * 12 < 0; };\nvar decodeIvl = function (i) { return isDescending(i) ? decode(-i[0], -i[1], -1) : decode(i[0], i[1], 1); };\n\nexport function addIntervals(ivl1, ivl2, dir) {\n  var i1 = encodeIvl(ivl1);\n  var i2 = encodeIvl(ivl2);\n  if (i1 === null || i2 === null) { return null; }\n  var i = [i1[0] + dir * i2[0], i1[1] + dir * i2[1]];\n  return ibuild(decodeIvl(i));\n}\n\n/**\n * Add two intervals\n *\n * Can be partially applied.\n *\n * @param {String} interval1\n * @param {String} interval2\n * @return {String} the resulting interval\n * @example\n * import { add } from \"tonal-distance\"\n * add(\"3m\", \"5P\") // => \"7m\"\n */\nexport function add(ivl1, ivl2) {\n  if (arguments.length === 1) { return function (i2) { return add(ivl1, i2); }; }\n  return addIntervals(ivl1, ivl2, 1);\n}\n\n/**\n * Subtract two intervals\n *\n * Can be partially applied\n *\n * @param {String} minuend\n * @param {String} subtrahend\n * @return {String} interval diference\n */\nexport function subtract(ivl1, ivl2) {\n  if (arguments.length === 1) { return function (i2) { return add(ivl1, i2); }; }\n  return addIntervals(ivl1, ivl2, -1);\n}\n\n/**\n * Find the interval between two pitches. It works with pitch classes\n * (both must be pitch classes and the interval is always ascending)\n *\n * Can be partially applied\n *\n * @param {String} from - distance from\n * @param {String} to - distance to\n * @return {String} the interval distance\n *\n * @example\n * import { interval } from \"tonal-distance\"\n * interval(\"C2\", \"C3\") // => \"P8\"\n * interval(\"G\", \"B\") // => \"M3\"\n *\n * @example\n * import * as Distance from \"tonal-distance\"\n * Distance.interval(\"M2\", \"P5\") // => \"P4\"\n */\nexport function interval(from, to) {\n  if (arguments.length === 1) { return function (t) { return interval(from, t); }; }\n  var f = encodeNote(from);\n  var t = encodeNote(to);\n  if (f === null || t === null || f.length !== t.length) { return null; }\n  var d =\n    f.length === 1\n      ? [t[0] - f[0], -Math.floor(((t[0] - f[0]) * 7) / 12)]\n      : [t[0] - f[0], t[1] - f[1]];\n  return ibuild(decodeIvl(d));\n}\n\n/**\n * Get the distance between two notes in semitones\n *\n * @param {String|Pitch} from - first note\n * @param {String|Pitch} to - last note\n * @return {Integer} the distance in semitones or null if not valid notes\n * @example\n * import { semitones } from \"tonal-distance\"\n * semitones(\"C3\", \"A2\") // => -3\n * // or use tonal\n * Tonal.Distance.semitones(\"C3\", \"G3\") // => 7\n */\nexport function semitones(from, to) {\n  if (arguments.length === 1) { return function (t) { return semitones(from, t); }; }\n  var f = noteProps(from);\n  var t = noteProps(to);\n  return f.midi !== null && t.midi !== null\n    ? t.midi - f.midi\n    : f.chroma !== null && t.chroma !== null\n      ? (t.chroma - f.chroma + 12) % 12\n      : null;\n}\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-pcset.svg?style=flat-square)](https://www.npmjs.com/package/tonal-pcset)\n * [![tonal](https://img.shields.io/badge/tonal-pcset-yellow.svg?style=flat-square)](https://www.npmjs.com/browse/keyword/tonal)\n *\n * `tonal-pcset` is a collection of functions to work with pitch class sets, oriented\n * to make comparations (isEqual, isSubset, isSuperset)\n *\n * This is part of [tonal](https://www.npmjs.com/package/tonal) music theory library.\n *\n * You can install via npm: `npm i --save tonal-pcset`\n *\n * ```js\n * // es6\n * import PcSet from \"tonal-pcset\"\n * var PcSet = require(\"tonal-pcset\")\n *\n * PcSet.isEqual(\"c2 d5 e6\", \"c6 e3 d1\") // => true\n * ```\n *\n * ## API documentation\n *\n * @module PcSet\n */\nimport { chroma as notechr } from \"tonal-note\";\nimport { chroma as ivlchr } from \"tonal-interval\";\nimport { rotate, range, compact } from \"tonal-array\";\n\nvar chr = function (str) { return notechr(str) || ivlchr(str) || 0; };\nvar pcsetNum = function (set) { return parseInt(chroma(set), 2); };\nvar clen = function (chroma) { return chroma.replace(/0/g, \"\").length; };\n\n/**\n * Get chroma of a pitch class set. A chroma identifies each set uniquely.\n * It\"s a 12-digit binary each presenting one semitone of the octave.\n *\n * Note that this function accepts a chroma as parameter and return it\n * without modification.\n *\n * @param {Array|String} set - the pitch class set\n * @return {String} a binary representation of the pitch class set\n * @example\n * PcSet.chroma([\"C\", \"D\", \"E\"]) // => \"1010100000000\"\n */\nexport function chroma(set) {\n  if (isChroma(set)) { return set; }\n  if (!Array.isArray(set)) { return \"\"; }\n  var b = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n  set.map(chr).forEach(function (i) {\n    b[i] = 1;\n  });\n  return b.join(\"\");\n}\n\nvar all = null;\n/**\n * Get a list of all possible chromas (all possible scales)\n * More information: http://allthescales.org/\n * @return {Array} an array of possible chromas from '10000000000' to '11111111111'\n *\n */\nexport function chromas(n) {\n  all = all || range(2048, 4095).map(function (n) { return n.toString(2); });\n  return typeof n === \"number\"\n    ? all.filter(function (chroma) { return clen(chroma) === n; })\n    : all.slice();\n}\n\n/**\n * Given a a list of notes or a pcset chroma, produce the rotations\n * of the chroma discarding the ones that starts with \"0\"\n *\n * This is used, for example, to get all the modes of a scale.\n *\n * @param {Array|String} set - the list of notes or pitchChr of the set\n * @param {Boolean} normalize - (Optional, true by default) remove all\n * the rotations that starts with \"0\"\n * @return {Array<String>} an array with all the modes of the chroma\n *\n * @example\n * PcSet.modes([\"C\", \"D\", \"E\"]).map(PcSet.intervals)\n */\nexport function modes(set, normalize) {\n  normalize = normalize !== false;\n  var binary = chroma(set).split(\"\");\n  return compact(\n    binary.map(function(_, i) {\n      var r = rotate(i, binary);\n      return normalize && r[0] === \"0\" ? null : r.join(\"\");\n    })\n  );\n}\n\nvar REGEX = /^[01]{12}$/;\n/**\n * Test if the given string is a pitch class set chroma.\n * @param {String} chroma - the pitch class set chroma\n * @return {Boolean} true if its a valid pcset chroma\n * @example\n * PcSet.isChroma(\"101010101010\") // => true\n * PcSet.isChroma(\"101001\") // => false\n */\nexport function isChroma(set) {\n  return REGEX.test(set);\n}\n\nvar IVLS = \"1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M\".split(\" \");\n/**\n * Given a pcset (notes or chroma) return it\"s intervals\n * @param {String|Array} pcset - the pitch class set (notes or chroma)\n * @return {Array} intervals or empty array if not valid pcset\n * @example\n * PcSet.intervals(\"1010100000000\") => [\"1P\", \"2M\", \"3M\"]\n */\nexport function intervals(set) {\n  if (!isChroma(set)) { return []; }\n  return compact(\n    set.split(\"\").map(function(d, i) {\n      return d === \"1\" ? IVLS[i] : null;\n    })\n  );\n}\n\n/**\n * Test if two pitch class sets are identical\n *\n * @param {Array|String} set1 - one of the pitch class sets\n * @param {Array|String} set2 - the other pitch class set\n * @return {Boolean} true if they are equal\n * @example\n * PcSet.isEqual([\"c2\", \"d3\"], [\"c5\", \"d2\"]) // => true\n */\nexport function isEqual(s1, s2) {\n  if (arguments.length === 1) { return function (s) { return isEqual(s1, s); }; }\n  return chroma(s1) === chroma(s2);\n}\n\n/**\n * Create a function that test if a collection of notes is a\n * subset of a given set\n *\n * The function can be partially applied\n *\n * @param {Array|String} set - an array of notes or a chroma set string to test against\n * @param {Array|String} notes - an array of notes or a chroma set\n * @return {boolean} true if notes is a subset of set, false otherwise\n * @example\n * const inCMajor = PcSet.isSubsetOf([\"C\", \"E\", \"G\"])\n * inCMajor([\"e6\", \"c4\"]) // => true\n * inCMajor([\"e6\", \"c4\", \"d3\"]) // => false\n */\nexport function isSubsetOf(set, notes) {\n  if (arguments.length > 1) { return isSubsetOf(set)(notes); }\n  set = pcsetNum(set);\n  return function(notes) {\n    notes = pcsetNum(notes);\n    return notes !== set && (notes & set) === notes;\n  };\n}\n\n/**\n * Create a function that test if a collectio of notes is a\n * superset of a given set (it contains all notes and at least one more)\n *\n * @param {Array|String} set - an array of notes or a chroma set string to test against\n * @param {Array|String} notes - an array of notes or a chroma set\n * @return {boolean} true if notes is a superset of set, false otherwise\n * @example\n * const extendsCMajor = PcSet.isSupersetOf([\"C\", \"E\", \"G\"])\n * extendsCMajor([\"e6\", \"a\", \"c4\", \"g2\"]) // => true\n * extendsCMajor([\"c6\", \"e4\", \"g3\"]) // => false\n */\nexport function isSupersetOf(set, notes) {\n  if (arguments.length > 1) { return isSupersetOf(set)(notes); }\n  set = pcsetNum(set);\n  return function(notes) {\n    notes = pcsetNum(notes);\n    return notes !== set && (notes | set) === notes;\n  };\n}\n\n/**\n * Test if a given pitch class set includes a note\n * @param {Array|String} set - the base set to test against\n * @param {String|Pitch} note - the note to test\n * @return {Boolean} true if the note is included in the pcset\n * @example\n * PcSet.includes([\"C\", \"D\", \"E\"], \"C4\") // => true\n * PcSet.includes([\"C\", \"D\", \"E\"], \"C#4\") // => false\n */\nexport function includes(set, note) {\n  if (arguments.length > 1) { return includes(set)(note); }\n  set = chroma(set);\n  return function(note) {\n    return set[chr(note)] === \"1\";\n  };\n}\n\n/**\n * Filter a list with a pitch class set\n *\n * @param {Array|String} set - the pitch class set notes\n * @param {Array|String} notes - the note list to be filtered\n * @return {Array} the filtered notes\n *\n * @example\n * PcSet.filter([\"C\", \"D\", \"E\"], [\"c2\", \"c#2\", \"d2\", \"c3\", \"c#3\", \"d3\"]) // => [ \"c2\", \"d2\", \"c3\", \"d3\" ])\n * PcSet.filter([\"C2\"], [\"c2\", \"c#2\", \"d2\", \"c3\", \"c#3\", \"d3\"]) // => [ \"c2\", \"c3\" ])\n */\nexport function filter(set, notes) {\n  if (arguments.length === 1) { return function (n) { return filter(set, n); }; }\n  return notes.filter(includes(set));\n}\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-dictionary.svg)](https://www.npmjs.com/package/tonal-dictionary)\n *\n * `tonal-dictionary` contains a dictionary of musical scales and chords\n *\n * This is part of [tonal](https://www.npmjs.com/package/tonal) music theory library.\n *\n * @example\n * // es6\n * import * as Dictionary from \"tonal-dictionary\"\n * // es5\n * const Dictionary = require(\"tonal-dictionary\")\n *\n * @example\n * Dictionary.chord(\"Maj7\") // => [\"1P\", \"3M\", \"5P\", \"7M\"]\n *\n * @module Dictionary\n */\nimport sdata from \"./data/scales.json\";\nimport cdata from \"./data/chords.json\";\nimport { chroma } from \"tonal-pcset\";\n\nexport var dictionary = function (raw) {\n  var keys = Object.keys(raw).sort();\n  var data = [];\n  var index = [];\n\n  var add = function (name, ivls, chroma) {\n    data[name] = ivls;\n    index[chroma] = index[chroma] || [];\n    index[chroma].push(name);\n  };\n\n  keys.forEach(function (key) {\n    var ivls = raw[key][0].split(\" \");\n    var alias = raw[key][1];\n    var chr = chroma(ivls);\n\n    add(key, ivls, chr);\n    if (alias) { alias.forEach(function (a) { return add(a, ivls, chr); }); }\n  });\n  var allKeys = Object.keys(data).sort();\n\n  var dict = function (name) { return data[name]; };\n  dict.names = function (p) {\n    if (typeof p === \"string\") { return (index[p] || []).slice(); }\n    else { return (p === true ? allKeys : keys).slice(); }\n  };\n  return dict;\n};\n\nexport var combine = function (a, b) {\n  var dict = function (name) { return a(name) || b(name); };\n  dict.names = function (p) { return a.names(p).concat(b.names(p)); };\n  return dict;\n};\n\n/**\n * A dictionary of scales: a function that given a scale name (without tonic)\n * returns an array of intervals\n *\n * @function\n * @param {String} name\n * @return {Array} intervals\n * @example\n * import { scale } from \"tonal-dictionary\"\n * scale(\"major\") // => [\"1P\", \"2M\", ...]\n * scale.names(); // => [\"major\", ...]\n */\nexport var scale = dictionary(sdata);\n\n/**\n * A dictionary of chords: a function that given a chord type\n * returns an array of intervals\n *\n * @function\n * @param {String} type\n * @return {Array} intervals\n * @example\n * import { chord } from \"tonal-dictionary\"\n * chord(\"Maj7\") // => [\"1P\", \"3M\", ...]\n * chord.names(); // => [\"Maj3\", ...]\n */\nexport var chord = dictionary(cdata);\nexport var pcset = combine(scale, chord);\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-scale.svg?style=flat-square)](https://www.npmjs.com/package/tonal-scale)\n *\n * A scale is a collection of pitches in ascending or descending order.\n *\n * This module provides functions to get and manipulate scales.\n *\n * @example\n * // es6\n * import * as Scale from \"tonal-scale\"\n * // es5\n * const Scale = require(\"tonal-scale\");\n *\n * @example\n * Scale.notes(\"Ab bebop\") // => [ \"Ab\", \"Bb\", \"C\", \"Db\", \"Eb\", \"F\", \"Gb\", \"G\" ]\n * Scale.names() => [\"major\", \"minor\", ...]\n * @module Scale\n */\nimport { name as noteName, pc } from \"tonal-note\";\nimport {\n  modes as pcsetModes,\n  chroma,\n  isSubsetOf,\n  isSupersetOf\n} from \"tonal-pcset\";\nimport { transpose } from \"tonal-distance\";\nimport { scale, chord } from \"tonal-dictionary\";\nimport { compact, unique, rotate } from \"tonal-array\";\n\nvar NO_SCALE = Object.freeze({\n  name: null,\n  intervals: [],\n  names: [],\n  chroma: null,\n  setnum: null\n});\n\nvar properties = function (name) {\n  var intervals = scale(name);\n  if (!intervals) { return NO_SCALE; }\n  var s = { intervals: intervals, name: name };\n  s.chroma = chroma(intervals);\n  s.setnum = parseInt(s.chroma, 2);\n  s.names = scale.names(s.chroma);\n  return Object.freeze(s);\n};\n\nvar memoize = function (fn, cache) { return function (str) { return cache[str] || (cache[str] = fn(str)); }; };\n\n/**\n * Get scale properties. It returns an object with:\n * - name: the scale name\n * - names: a list with all possible names (includes the current)\n * - intervals: an array with the scale intervals\n * - chroma:  scale croma (see pcset)\n * - setnum: scale chroma number\n *\n * @function\n * @param {String} name - the scale name (without tonic)\n * @return {Object}\n */\nexport var props = memoize(properties, {});\n\n/**\n * Return the available scale names\n *\n * @function\n * @param {boolean} aliases - true to include aliases\n * @return {Array} the scale names\n *\n * @example\n * Scale.names() // => [\"maj7\", ...]\n */\nexport var names = scale.names;\n\n/**\n * Given a scale name, return its intervals. The name can be the type and\n * optionally the tonic (which is ignored)\n *\n * It retruns an empty array when no scale found\n *\n * @function\n * @param {String} name - the scale name (tonic and type, tonic is optional)\n * @return {Array<String>} the scale intervals if is a known scale or an empty\n * array if no scale found\n * @example\n * Scale.intervals(\"major\") // => [ \"1P\", \"2M\", \"3M\", \"4P\", \"5P\", \"6M\", \"7M\" ]\n */\nexport var intervals = function (name) {\n  var p = tokenize(name);\n  return props(p[1]).intervals;\n};\n\n/**\n * Get the notes (pitch classes) of a scale.\n *\n * Note that it always returns an array, and the values are only pitch classes.\n *\n * @function\n * @param {String} tonic\n * @param {String} nameOrTonic - the scale name or tonic (if 2nd param)\n * @param {String} [name] - the scale name without tonic\n * @return {Array} a pitch classes array\n *\n * @example\n * Scale.notes(\"C\", \"major\") // => [ \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\" ]\n * Scale.notes(\"C major\") // => [ \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\" ]\n * Scale.notes(\"C4\", \"major\") // => [ \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\" ]\n * Scale.notes(\"A4\", \"no-scale\") // => []\n * Scale.notes(\"blah\", \"major\") // => []\n */\nexport function notes(nameOrTonic, name) {\n  var p = tokenize(nameOrTonic);\n  name = name || p[1];\n  return intervals(name).map(transpose(p[0]));\n}\n\n/**\n * Check if the given name is a known scale from the scales dictionary\n *\n * @function\n * @param {String} name - the scale name\n * @return {Boolean}\n */\nexport function exists(name) {\n  var p = tokenize(name);\n  return scale(p[1]) !== undefined;\n}\n\n/**\n * Given a string with a scale name and (optionally) a tonic, split\n * that components.\n *\n * It retuns an array with the form [ name, tonic ] where tonic can be a\n * note name or null and name can be any arbitrary string\n * (this function doesn\"t check if that scale name exists)\n *\n * @function\n * @param {String} name - the scale name\n * @return {Array} an array [tonic, name]\n * @example\n * Scale.tokenize(\"C mixolydean\") // => [\"C\", \"mixolydean\"]\n * Scale.tokenize(\"anything is valid\") // => [\"\", \"anything is valid\"]\n * Scale.tokenize() // => [\"\", \"\"]\n */\nexport function tokenize(str) {\n  if (typeof str !== \"string\") { return [\"\", \"\"]; }\n  var i = str.indexOf(\" \");\n  var tonic = noteName(str.substring(0, i)) || noteName(str) || \"\";\n  var name = tonic !== \"\" ? str.substring(tonic.length + 1) : str;\n  return [tonic, name.length ? name : \"\"];\n}\n\n/**\n * Find mode names of a scale\n *\n * @function\n * @param {String} name - scale name\n */\nexport var modeNames = function (name) {\n  var ivls = intervals(name);\n  var tonics = notes(name);\n\n  return pcsetModes(ivls)\n    .map(function (chroma, i) {\n      var name = scale.names(chroma)[0];\n      if (name) { return [tonics[i] || ivls[i], name]; }\n    })\n    .filter(function (x) { return x; });\n};\n\n/**\n * Get all chords that fits a given scale\n *\n * @function\n * @param {String} name\n */\nexport var chords = function (name) {\n  var inScale = isSubsetOf(intervals(name));\n  return chord.names().filter(function (name) { return inScale(chord(name)); });\n};\n\n/**\n * Given an array of notes, return the scale: a pitch class set starting from\n * the first note of the array\n *\n * @function\n * @param {Array} notes\n * @return {Array}\n */\nexport var toScale = function (notes) {\n  var pcset = compact(notes.map(pc));\n  if (!pcset.length) { return pcset; }\n  var tonic = pcset[0];\n  var scale = unique(pcset);\n  return rotate(scale.indexOf(tonic), scale);\n};\n\n/**\n * Get all scales names that are a superset of the given one\n * (has the same notes and at least one more)\n *\n * @function\n * @param {String} name\n * @return {Array} a list of scale names\n */\nexport var supersets = function (name) {\n  if (!intervals(name).length) { return []; }\n  var isSuperset = isSupersetOf(intervals(name));\n  return scale.names().filter(function (name) { return isSuperset(scale(name)); });\n};\n\n/**\n * Find all scales names that are a subset of the given one\n * (has less notes but all from the given scale)\n *\n * @function\n * @param {String} name\n * @return {Array} a list of scale names\n */\nexport var subsets = function (name) {\n  var isSubset = isSubsetOf(intervals(name));\n  return scale.names().filter(function (name) { return isSubset(scale(name)); });\n};\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-chord.svg)](https://www.npmjs.com/package/tonal-chord)\n * [![tonal](https://img.shields.io/badge/tonal-chord-yellow.svg)](https://www.npmjs.com/browse/keyword/tonal)\n *\n * `tonal-chord` is a collection of functions to manipulate musical chords\n *\n * This is part of [tonal](https://www.npmjs.com/package/tonal) music theory library.\n *\n * @example\n * // es6\n * import * as Chord from \"tonal-chord\"\n * // es5\n * const Chord = require(\"tonal-chord\")\n *\n * @example\n * Chord.notes(\"CMaj7\") // => [\"C\", \"E\", \"G\", \"B\"]\n *\n * @module Chord\n */\nimport { tokenize as split } from \"tonal-note\";\nimport { transpose } from \"tonal-distance\";\nimport { chord } from \"tonal-dictionary\";\nimport { chroma, isSubsetOf, isSupersetOf } from \"tonal-pcset\";\n\n/**\n * Return the available chord names\n *\n * @function\n * @param {boolean} aliases - true to include aliases\n * @return {Array} the chord names\n *\n * @example\n * Chord.names() // => [\"maj7\", ...]\n */\nexport var names = chord.names;\n\nvar NO_CHORD = Object.freeze({\n  name: null,\n  names: [],\n  intervals: [],\n  chroma: null,\n  setnum: null\n});\n\nvar properties = function (name) {\n  var intervals = chord(name);\n  if (!intervals) { return NO_CHORD; }\n  var s = { intervals: intervals, name: name };\n  s.chroma = chroma(intervals);\n  s.setnum = parseInt(s.chroma, 2);\n  s.names = chord.names(s.chroma);\n  return s;\n};\n\nvar memo = function (fn, cache) {\n  if ( cache === void 0 ) cache = {};\n\n  return function (str) { return cache[str] || (cache[str] = fn(str)); };\n};\n\n/**\n * Get chord properties. It returns an object with:\n *\n * - name: the chord name\n * - names: a list with all possible names (includes the current)\n * - intervals: an array with the chord intervals\n * - chroma:  chord croma (see pcset)\n * - setnum: chord chroma number\n *\n * @function\n * @param {String} name - the chord name (without tonic)\n * @return {Object} an object with the properties or a object with all properties\n * set to null if not valid chord name\n */\nexport var props = memo(properties);\n\n/**\n * Get chord intervals. It always returns an array\n *\n * @function\n * @param {String} name - the chord name (optionally a tonic and type)\n * @return {Array<String>} a list of intervals or null if the type is not known\n */\nexport var intervals = function (name) { return props(tokenize(name)[1]).intervals; };\n\n/**\n * Get the chord notes of a chord. This function accepts either a chord name\n * (for example: \"Cmaj7\") or a list of notes.\n *\n * It always returns an array, even if the chord is not found.\n *\n * @function\n * @param {String} nameOrTonic - name of the chord or the tonic (if the second parameter is present)\n * @param {String} [name] - (Optional) name if the first parameter is the tonic\n * @return {Array} an array of notes or an empty array\n *\n * @example\n * Chord.notes(\"Cmaj7\") // => [\"C\", \"E\", \"G\", \"B\"]\n * Chord.notes(\"C\", \"maj7\") // => [\"C\", \"E\", \"G\", \"B\"]\n */\nexport function notes(nameOrTonic, name) {\n  if (name) { return props(name).intervals.map(transpose(nameOrTonic)); }\n  var ref = tokenize(nameOrTonic);\n  var tonic = ref[0];\n  var type = ref[1];\n  return props(type).intervals.map(transpose(tonic));\n}\n\n/**\n * Check if a given name correspond to a chord in the dictionary\n *\n * @function\n * @param {String} name\n * @return {Boolean}\n * @example\n * Chord.exists(\"CMaj7\") // => true\n * Chord.exists(\"Maj7\") // => true\n * Chord.exists(\"Ablah\") // => false\n */\nexport var exists = function (name) { return chord(tokenize(name)[1]) !== undefined; };\n\n/**\n * Get all chords names that are a superset of the given one\n * (has the same notes and at least one more)\n *\n * @function\n * @param {String} name\n * @return {Array} a list of chord names\n */\nexport var supersets = function (name) {\n  if (!intervals(name).length) { return []; }\n  var isSuperset = isSupersetOf(intervals(name));\n  return chord.names().filter(function (name) { return isSuperset(chord(name)); });\n};\n\n/**\n * Find all chords names that are a subset of the given one\n * (has less notes but all from the given chord)\n *\n * @function\n * @param {String} name\n * @return {Array} a list of chord names\n */\nexport var subsets = function (name) {\n  var isSubset = isSubsetOf(intervals(name));\n  return chord.names().filter(function (name) { return isSubset(chord(name)); });\n};\n\n// 6, 64, 7, 9, 11 and 13 are consider part of the chord\n// (see https://github.com/danigb/tonal/issues/55)\nvar NUM_TYPES = /^(6|64|7|9|11|13)$/;\n/**\n * Tokenize a chord name. It returns an array with the tonic and chord type\n * If not tonic is found, all the name is considered the chord name.\n *\n * This function does NOT check if the chord type exists or not. It only tries\n * to split the tonic and chord type.\n *\n * @function\n * @param {String} name - the chord name\n * @return {Array} an array with [type, tonic]\n * @example\n * Chord.tokenize(\"Cmaj7\") // => [ \"C\", \"maj7\" ]\n * Chord.tokenize(\"C7\") // => [ \"C\", \"7\" ]\n * Chord.tokenize(\"mMaj7\") // => [ \"\", \"mMaj7\" ]\n * Chord.tokenize(\"Cnonsense\") // => [ \"C\", \"nonsense\" ]\n */\nexport function tokenize(name) {\n  var p = split(name);\n  if (p[0] === \"\") { return [\"\", name]; }\n  // aug is augmented (see https://github.com/danigb/tonal/issues/55)\n  if (p[0] === \"A\" && p[3] === \"ug\") { return [\"\", \"aug\"]; }\n\n  if (NUM_TYPES.test(p[2])) {\n    return [p[0] + p[1], p[2] + p[3]];\n  } else {\n    return [p[0] + p[1] + p[2], p[3]];\n  }\n}\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-key.svg?style=flat-square)](https://www.npmjs.com/package/tonal-key)\n *\n * The `Tonal` module is a facade to the rest of the modules. They are namespaced,\n * so for example to use `pc` function from `tonal-note` you have to write:\n * `Tonal.Note.pc`\n *\n * It exports the following modules:\n * - Note\n * - Interval\n * - Distance\n * - Scale\n * - Chord\n * - PcSet\n *\n * Additionally this facade exports some functions without namespace (see \"Methods\" below)\n *\n * @example\n * // es6 modules\n * import * as Tonal from \"tonal\"\n * Tonal.Note.name(\"cx\") // => \"C##\"\n *\n * @example\n * import { Note } from \"tonal\"\n * Note.name(\"bb\") // => \"Bb\"\n *\n * @example\n * // es5 node modules\n * var Tonal = require(\"tonal\");\n * Tonal.Distance.transpose(Tonal.Note.pc(\"C#2\"), \"M3\") // => \"E#\"\n * Tonal.Chord.notes(\"Dmaj7\") // => [\"D\", \"F#\", \"A\", \"C#\"]\n *\n * @module Tonal\n */\nimport * as Array from \"tonal-array\";\nimport * as Note from \"tonal-note\";\nimport * as Interval from \"tonal-interval\";\nimport * as Distance from \"tonal-distance\";\nimport * as Dictionary from \"tonal-dictionary\";\nimport * as Scale from \"tonal-scale\";\nimport * as Chord from \"tonal-chord\";\nimport * as PcSet from \"tonal-pcset\";\n\nexport { Array, Note, Interval, Distance, Scale, Chord, PcSet, Dictionary };\n\n/**\n * Transpose a note by an interval\n * @function\n * @param {String} note\n * @param {String} interval\n * @return {String} the transported note\n * @see Distance.transpose\n */\nexport const transpose = Distance.transpose;\n\n/**\n * Get the interval from two notes\n * @function\n * @param {String} from\n * @param {String} to\n * @return {String} the interval in reverse shorthand notation\n * @see Distance.interval\n */\nexport const interval = Distance.interval;\n\n/**\n * Get note properties\n * @function\n * @param {String} note - the note name\n * @return {Object}\n * @see Note.props\n * @example\n * Tonal.note(\"A4\").chroma // => 9\n */\nexport const note = Note.props;\n\n/**\n * Get midi note number\n * @function\n * @param {String} note\n * @return {Number}\n * @see Note.midi\n * @example\n * Tonal.midi(\"A4\") // => 49\n */\nexport const midi = Note.midi;\n\n/**\n * Get note frequency using equal tempered tuning at 440\n * @function\n * @param {String} note\n * @return {Number}\n * @see Note.freq\n * @example\n * Tonal.freq(\"A4\") // => 440\n */\nexport const freq = Note.freq;\n\n/**\n * Get intervals from a chord type\n * @function\n * @param {String} type - the chord type (no tonic)\n * @return {Array} an array of intervals or undefined if the chord type is not known\n * @see Dictionary.chord\n * @example\n * Tonal.chord(\"m7b5\") // => [\"1P\", \"3m\", \"5d\", \"7m\"]\n */\nexport const chord = Dictionary.chord;\n\n/**\n * Get intervals from scale name\n * @function\n * @param {String} name - the scale name (without tonic)\n * @return {Array} an array of intervals or undefiend if the scale is not kown\n * @example\n * Tonal.scale(\"major\") // => [\"1P\", \"2M\", \"3M\"...]\n */\nexport const scale = Dictionary.scale;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tonal_1 = require(\"tonal\");\nvar tonal_2 = require(\"tonal\");\nvar tonal_3 = require(\"tonal\");\nvar tonal_4 = require(\"tonal\");\nvar Harmony = /** @class */ (function () {\n    function Harmony() {\n    }\n    Harmony.isBlack = function (note) {\n        return tonal_1.Note.props(note).acc !== '';\n    };\n    Harmony.isSameNote = function (noteA, noteB) {\n        return tonal_1.Note.midi(noteA) === tonal_1.Note.midi(noteB);\n    };\n    Harmony.getTonalChord = function (chord) {\n        if (!chord) {\n            return null;\n        }\n        chord = chord\n            .replace(/([A-G][b|#]?)(69)/, '$1M69')\n            .replace('-', 'm')\n            .replace('^', 'M')\n            .replace('h7', 'm7b5')\n            .replace('h', 'dim');\n        /**\n         * Chords that dont work:\n         * slash cords are ignored\n         * 7b9b5 does not work\n         *\n         */\n        var tokens = tonal_2.Chord.tokenize(chord);\n        var s = tokens[1].split('/');\n        return tokens[0] + (s[0] || 'M');\n    };\n    Harmony.getBassNote = function (chord) {\n        if (!chord) {\n            return null;\n        }\n        if (chord.includes('/')) {\n            return chord.split('/')[1];\n        }\n        return chord.match((/[A-G][b|#]?/))[0];\n    };\n    Harmony.getMidi = function (note, offset) {\n        if (offset === void 0) { offset = 0; }\n        return tonal_1.Note.midi(note) - offset;\n    };\n    Harmony.intervalComplement = function (interval) {\n        var fix = {\n            '8P': '1P',\n            '8d': '1A',\n            '8A': '1d',\n            '1A': '8d',\n            '1d': '8A',\n        };\n        var fixIndex = Object.keys(fix).find(function (key) { return interval.match(key); });\n        if (fixIndex) {\n            return fix[fixIndex];\n        }\n        return tonal_3.Interval.invert(interval);\n    };\n    Harmony.invertInterval = function (interval) {\n        if (!interval) {\n            return null;\n        }\n        var positive = interval.replace('-', '');\n        var complement = Harmony.intervalComplement(positive);\n        var isNegative = interval.length > positive.length;\n        return (isNegative ? '' : '-') + complement;\n    };\n    /** Transforms interval into one octave (octave+ get octaved down) */\n    Harmony.fixInterval = function (interval, simplify) {\n        if (interval === void 0) { interval = ''; }\n        if (simplify === void 0) { simplify = false; }\n        var fix = {\n            '0A': '1P',\n            '-0A': '1P',\n        };\n        if (simplify) {\n            fix = __assign({}, fix, { '8P': '1P', '-8P': '1P' });\n            interval = tonal_3.Interval.simplify(interval);\n        }\n        if (Object.keys(fix).includes(interval)) {\n            return fix[interval];\n        }\n        return interval;\n    };\n    /** inverts the interval if it does not go to the desired direction */\n    Harmony.forceDirection = function (interval, direction, noUnison) {\n        if (noUnison === void 0) { noUnison = false; }\n        var semitones = tonal_3.Interval.semitones(interval);\n        if ((direction === 'up' && semitones < 0) ||\n            (direction === 'down' && semitones > 0)) {\n            return Harmony.invertInterval(interval);\n        }\n        if (interval === '1P' && noUnison) {\n            return (direction === 'down' ? '-' : '') + '8P';\n        }\n        return interval;\n    };\n    // use Interval.ic?\n    Harmony.minInterval = function (interval, direction, noUnison) {\n        interval = Harmony.fixInterval(interval, true);\n        if (direction) {\n            return Harmony.forceDirection(interval, direction, noUnison);\n        }\n        var inversion = Harmony.invertInterval(interval);\n        if (Math.abs(tonal_3.Interval.semitones(inversion)) < Math.abs(tonal_3.Interval.semitones(interval))) {\n            interval = inversion;\n        }\n        return interval;\n    };\n    // returns array of intervals that lead the voices of chord A to chordB\n    Harmony.minIntervals = function (chordA, chordB) {\n        return chordA.map(function (n, i) { return Harmony.minInterval(tonal_4.Distance.interval(n, chordB[i])); });\n    };\n    Harmony.mapMinInterval = function (direction) {\n        return function (interval) { return Harmony.minInterval(interval, direction); };\n    };\n    // sort function\n    Harmony.sortMinInterval = function (preferredDirection, accessor) {\n        if (preferredDirection === void 0) { preferredDirection = 'up'; }\n        if (accessor === void 0) { accessor = (function (i) { return i; }); }\n        return function (a, b) {\n            var diff = Math.abs(tonal_3.Interval.semitones(accessor(a))) - Math.abs(tonal_3.Interval.semitones(accessor(b)));\n            if (diff === 0) {\n                return preferredDirection === 'up' ? -1 : 1;\n            }\n            return diff;\n        };\n    };\n    /** Returns the note with the least distance to \"from\" */\n    Harmony.getNearestNote = function (from, to, direction) {\n        var interval = Harmony.minInterval(tonal_4.Distance.interval(tonal_1.Note.pc(from), tonal_1.Note.pc(to)), direction);\n        return tonal_4.Distance.transpose(from, interval);\n    };\n    /** Returns the note with the least distance to \"from\". TODO: add range */\n    Harmony.getNearestTargets = function (from, targets, preferredDirection, flip) {\n        if (preferredDirection === void 0) { preferredDirection = 'down'; }\n        if (flip === void 0) { flip = false; }\n        var intervals = targets\n            .map(function (target) { return tonal_4.Distance.interval(tonal_1.Note.pc(from), target); })\n            .map(Harmony.mapMinInterval(preferredDirection))\n            .sort(Harmony.sortMinInterval(preferredDirection));\n        /* if (flip) {\n            intervals = intervals.reverse();\n        } */\n        return intervals.map(function (i) { return tonal_4.Distance.transpose(from, i); });\n    };\n    Harmony.intervalMatrix = function (from, to) {\n        return to.map(function (note) { return from\n            .map(function (n) {\n            return tonal_4.Distance.interval(n, note);\n        })\n            .map(function (d) { return Harmony.minInterval(d); }); }\n        /* .map(i => i.slice(0, 2) === '--' ? i.slice(1) : i) */\n        );\n    };\n    return Harmony;\n}());\nexports.Harmony = Harmony;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar Instrument = /** @class */ (function () {\n    function Instrument(_a) {\n        var _b = _a === void 0 ? {} : _a, context = _b.context, gain = _b.gain, mix = _b.mix, onTrigger = _b.onTrigger, midiOffset = _b.midiOffset;\n        this.midiOffset = 0;\n        this.gain = 1;\n        this.activeEvents = [];\n        this.onTrigger = onTrigger;\n        this.midiOffset = midiOffset || this.midiOffset;\n        this.gain = gain || this.gain;\n        this.init({ context: context, mix: mix });\n    }\n    Instrument.prototype.init = function (_a) {\n        var context = _a.context, mix = _a.mix;\n        if (!context && (!mix || !mix.context)) {\n            console.warn(\"you should pass a context or a mix (gainNode) to a new Instrument. \\n            You can also Call init with {context,mix} to setup the Instrument later\");\n            return;\n        }\n        this.context = context || mix.context;\n        this.mix = mix || this.context.destination;\n    };\n    Instrument.prototype.playNotes = function (notes, settings) {\n        var _this = this;\n        if (settings === void 0) { settings = {}; }\n        var deadline = (settings.deadline || this.context.currentTime);\n        settings = Object.assign({\n            duration: 2000,\n            gain: 1,\n        }, settings, { deadline: deadline });\n        if (settings.interval) {\n            // call recursively with single notes at interval\n            return notes.map(function (note, index) {\n                _this.playNotes([note], Object.assign({}, settings, {\n                    interval: 0,\n                    deadline: deadline + index * settings.interval\n                }));\n            });\n        }\n        var midi = notes.map(function (note) { return Harmony_1.Harmony.getMidi(note, _this.midiOffset); });\n        var noteOff = settings.deadline + settings.duration / 1000;\n        var notesOn = notes.map(function (note, index) { return ({\n            note: note,\n            midi: midi[index],\n            gain: settings.gain,\n            noteOff: noteOff,\n            deadline: settings.deadline\n        }); });\n        if (settings.pulse && this.onTrigger) {\n            settings.pulse.clock.callbackAtTime(function (deadline) {\n                _this.activeEvents = _this.activeEvents.concat(notesOn);\n                _this.onTrigger({ on: notesOn, off: [], active: _this.activeEvents });\n            }, settings.deadline);\n        }\n        if (settings.duration && settings.pulse) {\n            settings.pulse.clock.callbackAtTime(function (deadline) {\n                // find out which notes need to be deactivated\n                var notesOff = notes\n                    .filter(function (note) { return !_this.activeEvents\n                    .find(function (event) {\n                    var keep = note === event.note && event.noteOff > deadline;\n                    if (keep) {\n                        console.log('keep', note);\n                    }\n                    return keep;\n                }); }).map(function (note) { return _this.activeEvents.find(function (e) { return e.note === note; }); });\n                _this.activeEvents = _this.activeEvents\n                    .filter(function (e) { return !notesOff.includes(e); });\n                if (_this.onTrigger) {\n                    _this.onTrigger({ on: [], off: notesOff, active: _this.activeEvents });\n                }\n            }, noteOff);\n        }\n        return this.playKeys(midi, settings);\n    };\n    Instrument.prototype.playKeys = function (keys, settings) {\n        // TODO: fire callbacks after keys.map((key,i)=>i*settings.interval)?\n    };\n    return Instrument;\n}());\nexports.Instrument = Instrument;\n","\"use strict\";\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Chord = __importStar(require(\"tonal-chord\"));\nvar Scale = __importStar(require(\"tonal-scale\"));\nexports.chords = [\n    {\n        symbol: 'm',\n        long: 'minor',\n        short: '-',\n        groups: ['Basic', 'Triads']\n    },\n    {\n        symbol: 'M',\n        long: 'major',\n        short: '',\n        groups: ['Basic', 'Triads']\n    },\n    {\n        symbol: 'o',\n        groups: ['Basic', 'Symmetric', 'Triads'],\n        long: 'Vermindert'\n        /* short: 'o' */\n    },\n    {\n        symbol: 'M#5',\n        groups: ['Advanced', 'Symmetric', 'Triads'],\n        short: '#5'\n    },\n    {\n        symbol: 'Msus4',\n        groups: ['Advanced', 'Symmetric'],\n        short: 'sus4'\n    },\n    {\n        symbol: 'Msus2',\n        groups: ['Advanced', 'Symmetric'],\n        short: 'sus2'\n    },\n    // 5 4 64 m#5 Mb5  7no5  \n    {\n        symbol: '7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Dominantsept'\n    },\n    {\n        symbol: '7#11',\n        groups: ['Advanced', 'Diatonic', 'Modes'],\n        long: 'Dominant #11'\n    },\n    {\n        symbol: 'M6',\n        groups: ['Advanced'],\n        long: 'major 6',\n        short: '6'\n    },\n    {\n        symbol: 'o7',\n        groups: ['Advanced', 'Symmetric', 'Diatonic'],\n        long: 'Vermindert 7',\n    },\n    {\n        symbol: 'm7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'minor 7',\n        short: '-7'\n    },\n    {\n        symbol: 'oM7',\n        groups: ['Expert'],\n        long: 'diminished major 7',\n        short: 'o7'\n    },\n    {\n        symbol: 'm7b5',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Halbvermindert',\n        short: '-7b5'\n    },\n    {\n        symbol: '7#5',\n        groups: ['Advanced', 'Symmetric'],\n        long: 'Dominantsept #5'\n    },\n    {\n        symbol: 'Maj7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Major 7',\n        short: '7'\n    },\n    {\n        symbol: 'mMaj7',\n        short: '-7',\n        groups: ['Advanced', 'Diatonic']\n    },\n    {\n        symbol: 'M7#5',\n        groups: ['Advanced', 'Diatonic'],\n        short: '7#5'\n    },\n    {\n        symbol: '7sus4',\n        groups: ['Advanced'],\n    },\n    {\n        symbol: '9',\n        groups: ['Advanced'],\n    },\n    {\n        symbol: 'M9',\n        groups: ['Advanced'],\n        short: '9'\n    },\n    {\n        symbol: 'M69',\n        groups: ['Advanced'],\n        short: '69'\n    }\n    /*\n7b13 M7b5 m7#5 9no5  M7b6 7b5 Madd9 mb6b9 mb6M7 madd4 sus24 madd9 Maddb9 +add#9 M7sus4 7#5sus4 M#5add9 M7#5sus4\n11 m9 m6 9#5 7b9 7#9 M69 9b5 m69 mM9 7b6 m9b5 m9#5 7#11 M7b9 9b13 o7M7 M9b5 11b9 M9#5 7add6 M6#11 M7#11 7#5#9 13no5 9sus4 7#5b9 M9sus4 7sus4b9 m7add11 mMaj7b6 M9#5sus4\n13 m11 M13 9#11 13#9 13b5 13b9 m11b5 7b9#9 mM9b6 M9#11 9#5#11 7#9b13 7b9b13 13sus4 m11A 5 7#9#11 7b9#11 M69#11 7#11b13 M7#9#11 M7add13 7#5b9#11 7sus4b9b13\nm13 13#11 M13#11 13b9#11 9#11b13 13#9#11 7b9b13#11 7#9#11b13\n    */\n];\nexports.scales = [\n    {\n        symbol: 'major pentatonic',\n        groups: ['Basic', 'Pentatonic'],\n    },\n    {\n        symbol: 'minor pentatonic',\n        groups: ['Basic', 'Pentatonic'],\n    },\n    {\n        symbol: 'minor blues',\n        groups: ['Basic'],\n    },\n    // gregorian modes\n    {\n        symbol: 'major',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'dorian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'phrygian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'lydian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'mixolydian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'aeolian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'locrian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'whole tone',\n        groups: ['Advanced', 'Symmetric']\n    },\n    {\n        symbol: 'diminished',\n        groups: ['Advanced', 'Symmetric']\n    },\n    //HTGT ?\n    {\n        symbol: 'augmented',\n        groups: ['Advanced', 'Symmetric']\n    },\n    {\n        symbol: 'chromatic',\n        groups: ['Expert', 'Symmetric']\n    },\n    // harmonic minor modes\n    {\n        symbol: 'harmonic minor',\n        groups: ['Advanced', 'Diatonic']\n    },\n    // HM 2 locrian #6 !\n    {\n        symbol: 'ionian augmented',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'dorian #4',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'spanish',\n        groups: ['Advanced', 'Diatonic']\n    },\n    // HM 6 lydian #9\n    // HM 7 ???\n    // melodic minor modes\n    {\n        symbol: 'melodic minor',\n        groups: ['Advanced', 'Diatonic']\n    },\n    {\n        symbol: 'melodic minor second mode',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'lydian augmented',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'lydian dominant',\n        groups: ['Advanced', 'Diatonic'],\n        long: 'mixolydian #11'\n    },\n    {\n        symbol: 'melodic minor fifth mode',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'locrian #2',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'altered',\n        groups: ['Advanced', 'Diatonic']\n    },\n    //non european\n    {\n        symbol: 'kumoijoshi',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'iwato',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'pelog',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    // hyojo?\n    {\n        symbol: 'egyptian',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'in-sen',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'scriabin',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'ritusen',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'hirajoshi',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'malkos raga',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'vietnamese 1',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    /* {\n        symbol: 'vietnamese 2',\n        groups: ['Exotic', 'Pentatonic'] // = minor pentatonic\n    }, */\n    {\n        symbol: 'lydian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'mixolydian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'ionian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'locrian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'flat six pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'minor six pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'minor #7M pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'lydian #5P pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'whole tone pentatonic',\n        groups: ['Pentatonic', 'Symmetric']\n    },\n    {\n        symbol: 'flat three pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'super locrian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'major flat two pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'lydian dominant pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'neopolitan major pentatonic',\n        groups: ['Pentatonic']\n    }\n    /*\n    mystery #1 piongio    prometheus major blues minor hexatonic six tone symmetric prometheus neopolitan\n     persian  spanish  oriental flamenco balinese   todi raga enigmatic lydian #9 neopolitan locrian #2  lydian minor  locrian major  romanian minor harmonic major hungarian major hungarian minor lydian dominant   neopolitan minor neopolitan major lydian diminished leading whole tone augmented heptatonic double harmonic major double harmonic lydian melodic minor fifth mode melodic minor second mode\n    bebop kafi raga  purvi raga ichikosucho bebop minor minor bebop bebop major bebop locrian bebop dominant spanish heptatonic minor six diminished\n    composite blues\n    */\n];\nexports.symbols = { chords: exports.chords, scales: exports.scales };\nexports.levels = ['Basic', 'Advanced', 'Expert'];\nfunction groupFilter(group) {\n    return function (item) {\n        var level = Math.max(item.groups.filter(function (group) { return exports.levels.indexOf(group) !== -1; })\n            .map(function (group) { return exports.levels.indexOf(group) + 1; }));\n        var groups = level > 0 ? Array.from(new Set(exports.levels.slice(level).concat(item.groups))) : item.groups;\n        return groups.indexOf(group) !== -1;\n    };\n}\nexports.groupFilter = groupFilter;\nfunction scaleNames(group) {\n    if (group === void 0) { group = 'Basic'; }\n    if (!group || group === 'All') {\n        return Scale.names();\n    }\n    return exports.scales.filter(groupFilter(group))\n        .map(function (scale) { return scale.symbol; });\n}\nexports.scaleNames = scaleNames;\nfunction chordNames(group) {\n    if (group === void 0) { group = 'Basic'; }\n    if (!group || group === 'All') {\n        return Chord.names();\n    }\n    return exports.chords.filter(groupFilter(group))\n        .map(function (scale) { return scale.symbol; });\n}\nexports.chordNames = chordNames;\nfunction groupNames() {\n    return Array.from(new Set(exports.levels.concat(exports.scales.concat(exports.chords)\n        .map(function (item) { return item.groups; })\n        .reduce(function (groups, current) { return groups.concat(current); })))).concat(['All']);\n}\nexports.groupNames = groupNames;\nfunction symbolName(type, symbol, long) {\n    var pool = exports.symbols[type + 's'];\n    var match = pool.find(function (item) { return item.symbol === symbol; });\n    if (!match) {\n        return symbol;\n    }\n    /* return symbol; */\n    return (long ? match.long : match.short) || symbol;\n}\nexports.symbolName = symbolName;\nfunction scaleName(symbol, long) {\n    if (long === void 0) { long = false; }\n    return symbolName('scale', symbol, long);\n}\nexports.scaleName = scaleName;\nfunction chordName(symbol, long) {\n    if (long === void 0) { long = false; }\n    return symbolName('chord', symbol, long);\n}\nexports.chordName = chordName;\nfunction randomItem(array) {\n    return array[Math.floor(Math.random() * array.length)];\n}\nexports.randomItem = randomItem;\nfunction randomScale(group) {\n    return randomItem(scaleNames(group));\n}\nexports.randomScale = randomScale;\nfunction randomChord(group) {\n    return randomItem(chordNames(group));\n}\nexports.randomChord = randomChord;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tonal_1 = require(\"tonal\");\nvar Synthesizer_1 = require(\"../instruments/Synthesizer\");\nvar symbols_1 = require(\"../symbols\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar steps = {\n    '1P': ['1', '8'],\n    '2m': ['b9', 'b2'],\n    '2M': ['9', '2',],\n    '2A': ['#9', '#2'],\n    '3m': ['b3'],\n    '3M': ['3'],\n    '4P': ['11', '4'],\n    '4A': ['#11', '#4'],\n    '5d': ['b5'],\n    '5P': ['5'],\n    '5A': ['#5'],\n    '6m': ['b13', 'b6'],\n    '6M': ['13', '6'],\n    '7m': ['b7'],\n    '7M': ['7', '^7', 'maj7']\n};\n/*\nLower Interval Limits (just guidelines):\n2m: E3-F3\n2M: Eb3-F3\n3m: C3-Eb3\n3M: Bb2-D3\n4P: Bb2-Eb3\n5D: B2-F3\n5P: Bb1-F2\n6m: F2-Db3\n6M: F2-D3\n7m: F2-Eb3\n7m: F2-E3\n8P: -\n\nmore rough: top note should be D3 or higher.\ntaken from https://www.youtube.com/watch?v=iW6YeDJklhQ\n*/\nfunction randomNumber(n) {\n    return Math.floor(Math.random() * n);\n}\nexports.randomNumber = randomNumber;\nfunction arraySum(array) {\n    return array.reduce(function (s, i) { return s + i; }, 0);\n}\nexports.arraySum = arraySum;\nfunction randomElement(array, weighted) {\n    if (!weighted) {\n        return array[randomNumber(array.length)];\n    }\n    var r = randomNumber(arraySum(weighted)) + 1;\n    var total = weighted\n        .reduce(function (abs, w, i) { return abs.concat(w + (abs.length ? abs[i - 1] : 0)); }, []);\n    return array[total.indexOf(total.find(function (s, i) { return s >= r; }))];\n}\nexports.randomElement = randomElement;\nfunction shuffleArray(a) {\n    var _a;\n    for (var i = a.length - 1; i > 0; i--) {\n        var j = Math.floor(Math.random() * (i + 1));\n        _a = [a[j], a[i]], a[i] = _a[0], a[j] = _a[1];\n    }\n    return a;\n}\nexports.shuffleArray = shuffleArray;\n/** OLD SHEET / RHYTHM STUFF */\n/** Travels path along measures */\nfunction getPath(path, measures, traveled) {\n    if (traveled === void 0) { traveled = []; }\n    if (!Array.isArray(measures[path[0]]) || path.length === 1) {\n        return measures[Math.min(path[0], measures.length - 1)];\n    }\n    return this.getPath(path.slice(1), measures[path[0]], traveled.concat(path[0]));\n}\nexports.getPath = getPath;\nfunction getDuration(divisions, noteLength, measureLength) {\n    if (noteLength === void 0) { noteLength = 1; }\n    if (measureLength === void 0) { measureLength = 1; }\n    return noteLength * divisions.reduce(function (f, d) { return f / d; }, 1000) * measureLength; // fraction of one\n}\nexports.getDuration = getDuration;\nfunction resolveChords(pattern, measures, path, divisions) {\n    var _this = this;\n    if (divisions === void 0) { divisions = []; }\n    if (Array.isArray(pattern)) {\n        // division: array of children lengths down the path (to calculate fraction)\n        divisions = [].concat(divisions, [pattern.length]);\n        return pattern.map(function (p, i) { return _this.resolveChords(p, measures, path.concat([i]), divisions); });\n    }\n    if (pattern === 0) {\n        return 0;\n    }\n    var fraction = getDuration(divisions, pattern);\n    if (fraction === 0) {\n        console.warn('fraction is 0', pattern);\n    }\n    if (fraction === NaN) {\n        console.warn('fraction NaN', divisions, pattern);\n    }\n    return { chord: this.getPath(path, measures), pattern: pattern, path: path, divisions: divisions, fraction: fraction };\n}\nexports.resolveChords = resolveChords;\nfunction hasOff(pattern, division) {\n    if (division === void 0) { division = 3; }\n    return Array.isArray(pattern) && pattern.length === division && pattern[division - 1] !== 0;\n}\nexports.hasOff = hasOff;\n// replaces offs on last beat with next chord + erases next one\nfunction offbeatReducer(settings) {\n    var _this = this;\n    // TODO: find out why some offbeats sound sketchy\n    return function (measures, bar, index) {\n        var last = index > 0 ? measures[index - 1] : null;\n        if (last && _this.hasOff(last[settings.cycle - 1], settings.division)) {\n            last[settings.cycle - 1][settings.division - 1] = bar[0];\n            bar[0] = 0;\n        }\n        return measures.concat([bar]);\n    };\n}\nexports.offbeatReducer = offbeatReducer;\nfunction randomSynth(mix, allowed, settings) {\n    if (allowed === void 0) { allowed = ['sine', 'triangle', 'square', 'sawtooth']; }\n    if (settings === void 0) { settings = {}; }\n    var gains = {\n        sine: 0.9,\n        triangle: 0.8,\n        square: 0.2,\n        sawtooth: 0.3\n    };\n    var wave = randomElement(allowed);\n    return new Synthesizer_1.Synthesizer(Object.assign({ gain: gains[wave], type: wave, mix: mix }, settings));\n}\nexports.randomSynth = randomSynth;\nfunction adsr(_a, time, param) {\n    var attack = _a.attack, decay = _a.decay, sustain = _a.sustain, release = _a.release, gain = _a.gain, duration = _a.duration, endless = _a.endless;\n    // console.log('adsr', attack, decay, sustain, release, gain, duration, time);\n    param.linearRampToValueAtTime(gain, time + attack);\n    param.setTargetAtTime(sustain * gain, time + Math.min(attack + decay, duration), decay);\n    if (!endless) {\n        param.setTargetAtTime(0, time + Math.max(duration - attack - decay, attack + decay, duration), release);\n    }\n}\nexports.adsr = adsr;\nfunction randomDelay(maxMs) {\n    return Math.random() * maxMs * 2 / 1000;\n}\nexports.randomDelay = randomDelay;\nfunction isInRange(note, range) {\n    return tonal_1.Distance.semitones(note, range[0]) <= 0 && tonal_1.Distance.semitones(note, range[1]) >= 0;\n}\nexports.isInRange = isInRange;\nfunction transposeNotes(notes, interval) {\n    return notes.map(function (note) { return tonal_1.Distance.transpose(note, interval); });\n}\nexports.transposeNotes = transposeNotes;\nfunction transposeToRange(notes, range, times) {\n    if (times === void 0) { times = 0; }\n    if (times > 10) {\n        return notes;\n    }\n    if (notes.find(function (note) { return tonal_1.Distance.semitones(note, range[0]) > 0; })) {\n        notes = notes.map(function (note) { return tonal_1.Distance.transpose(note, '8P'); });\n        console.log('tp up');\n        return transposeToRange(notes, range, ++times);\n    }\n    if (notes.find(function (note) { return tonal_1.Distance.semitones(note, range[1]) < 0; })) {\n        console.log('tp down');\n        notes = notes.map(function (note) { return tonal_1.Distance.transpose(note, '-8P'); });\n        return transposeToRange(notes, range, ++times);\n    }\n    return notes;\n}\nexports.transposeToRange = transposeToRange;\nfunction getAverageMidi(notes, offset) {\n    return notes.reduce(function (sum, note) { return sum + Harmony_1.Harmony.getMidi(note, offset); }, 0) / notes.length;\n}\nexports.getAverageMidi = getAverageMidi;\nfunction getDistancesToRangeEnds(notes, range) {\n    if (notes.length > 2) {\n        notes = [notes[0], notes[notes.length - 1]];\n    }\n    var midi = notes.map(function (n) { return Harmony_1.Harmony.getMidi(n); });\n    var rangeMidi = range.map(function (n) { return Harmony_1.Harmony.getMidi(n); });\n    return [midi[0] - rangeMidi[0], rangeMidi[1] - midi[1]];\n}\nexports.getDistancesToRangeEnds = getDistancesToRangeEnds;\nfunction getRangePosition(note, range) {\n    note = Harmony_1.Harmony.getMidi(note);\n    range = range.map(function (n) { return Harmony_1.Harmony.getMidi(n); });\n    var semitones = [note - range[0], range[1] - range[0]];\n    return semitones[0] / semitones[1];\n}\nexports.getRangePosition = getRangePosition;\nfunction getRangeDirection(note, range, defaultDirection, border) {\n    if (defaultDirection === void 0) { defaultDirection = 'down'; }\n    if (border === void 0) { border = 0; }\n    var position = getRangePosition(note, range);\n    if (position <= border) {\n        return { direction: 'up', force: true };\n    }\n    if (position >= (1 - border)) {\n        return { direction: 'down', force: true };\n    }\n    return {\n        direction: defaultDirection, force: false\n    };\n}\nexports.getRangeDirection = getRangeDirection;\n// accepts both strings or numbers where negative means minor, \n// returns unified step string that can be turned into an interval\nfunction getStep(step) {\n    if (typeof step === 'number' && step < 0) {\n        step = 'b' + (step * -1);\n    }\n    return step + ''; // to string\n}\nexports.getStep = getStep;\nfunction getIntervalFromStep(step) {\n    step = getStep(step);\n    var interval = Object.keys(steps)\n        .find(function (i) { return steps[i].includes(step); });\n    if (!interval) {\n        // console.warn(`step ${step} has no defined inteval`);\n    }\n    return interval;\n}\nexports.getIntervalFromStep = getIntervalFromStep;\nfunction getStepsFromDegree(degree) {\n    return;\n}\nexports.getStepsFromDegree = getStepsFromDegree;\nfunction getStepInChord(note, chord, group) {\n    return getStepFromInterval(tonal_1.Distance.interval(tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord))[0], tonal_1.Note.pc(note)));\n}\nexports.getStepInChord = getStepInChord;\nfunction getChordScales(chord, group) {\n    if (group === void 0) { group = 'Diatonic'; }\n    var tokens = tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord));\n    var isSuperset = tonal_1.PcSet.isSupersetOf(tonal_1.Chord.intervals(tokens[1]));\n    return symbols_1.scaleNames(group).filter(function (name) { return isSuperset(tonal_1.Scale.intervals(name)); });\n}\nexports.getChordScales = getChordScales;\nfunction pickChordScale(chord, group) {\n    if (group === void 0) { group = 'Diatonic'; }\n    var scales = getChordScales(chord);\n    if (!scales.length) {\n        console.warn(\"cannot pick chord scale: no scales found for chord \" + chord + \" in group \" + group);\n        return;\n    }\n    return scales[0];\n}\nexports.pickChordScale = pickChordScale;\nfunction findDegree(degreeOrStep, intervalsOrSteps) {\n    var intervals = intervalsOrSteps.map(function (i) { return isInterval(i) ? i : getIntervalFromStep(i); });\n    if (typeof degreeOrStep === 'number') { // is degree\n        var degree_1 = Math.abs(degreeOrStep);\n        return intervals.find(function (i) {\n            i = Harmony_1.Harmony.minInterval(i, 'up');\n            if (!steps[i]) {\n                console.error('interval', i, 'is not valid', intervals);\n            }\n            return !!(steps[i].find(function (step) { return getDegreeFromStep(step) === degree_1; }));\n        });\n    }\n    // is step\n    var step = getStep(degreeOrStep);\n    return intervals.find(function (i) { return i.includes(step) ||\n        i === getIntervalFromStep(step); });\n}\nexports.findDegree = findDegree;\nfunction hasDegree(degree, intervals) {\n    return !!findDegree(degree, intervals);\n}\nexports.hasDegree = hasDegree;\nfunction hasAllDegrees(degrees, intervals) {\n    return degrees.reduce(function (res, d) { return res && hasDegree(d, intervals); }, true);\n}\nexports.hasAllDegrees = hasAllDegrees;\nfunction getScaleDegree(degree, scale) {\n    return findDegree(degree, tonal_1.Scale.intervals(scale));\n}\nexports.getScaleDegree = getScaleDegree;\nfunction getScalePattern(pattern, scale) {\n    return pattern.map(function (degree) { return getScaleDegree(degree, scale); });\n}\nexports.getScalePattern = getScalePattern;\nfunction renderIntervals(intervals, root) {\n    return intervals.map(function (i) { return tonal_1.Distance.transpose(root, i); });\n}\nexports.renderIntervals = renderIntervals;\nfunction renderSteps(steps, root) {\n    return renderIntervals(steps.map(function (step) { return getIntervalFromStep(step); }), root);\n}\nexports.renderSteps = renderSteps;\nfunction permutateIntervals(intervals, pattern) {\n    return pattern.map(function (d) { return findDegree(d, intervals); });\n}\nexports.permutateIntervals = permutateIntervals;\nfunction getStepFromInterval(interval) {\n    return steps[interval] ? steps[interval][0] : 0;\n}\nexports.getStepFromInterval = getStepFromInterval;\nfunction getDegreeFromInterval(interval, simplify) {\n    if (interval === void 0) { interval = '-1'; }\n    if (simplify === void 0) { simplify = false; }\n    var fixed = Harmony_1.Harmony.fixInterval(interval, simplify) || '';\n    var match = fixed.match(/[-]?([1-9])+/);\n    if (!match) {\n        return 0;\n    }\n    return Math.abs(parseInt(match[0], 10));\n}\nexports.getDegreeFromInterval = getDegreeFromInterval;\nfunction getDegreeFromStep(step) {\n    step = getStep(step);\n    return parseInt(step.match(/([1-9])+/)[0], 10);\n}\nexports.getDegreeFromStep = getDegreeFromStep;\nfunction getDegreeInChord(degree, chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var intervals = tonal_1.Chord.intervals(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    return tonal_1.Distance.transpose(tokens[0], findDegree(degree, intervals));\n}\nexports.getDegreeInChord = getDegreeInChord;\nfunction getPatternInChord(pattern, chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var intervals = tonal_1.Chord.intervals(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    var permutation;\n    if (hasAllDegrees(pattern, intervals)) {\n        permutation = permutateIntervals(intervals, pattern);\n    }\n    else {\n        // not all degrees of the pattern are in the chord > get scale\n        var scale = pickChordScale(chord);\n        permutation = permutateIntervals(tonal_1.Scale.intervals(scale), pattern);\n    }\n    if (tokens[0]) {\n        return renderIntervals(permutation, tokens[0]);\n    }\n    return permutation;\n}\nexports.getPatternInChord = getPatternInChord;\n// TODO: other way around: find fixed interval pattern in a scale\n// TODO: motives aka start pattern from same note in different scale\n// TODO: motives aka start pattern from different note in same scale\n// TODO: motives aka start pattern from different note in different scale\nfunction getDigitalPattern(chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var intervals = tonal_1.Chord.intervals(chord);\n    if (intervals.includes('3m')) {\n        return [1, 3, 4, 5];\n    }\n    else if (intervals.includes('3M')) {\n        return [1, 2, 3, 5];\n    }\n    else {\n        return [1, 1, 1, 1];\n    }\n}\nexports.getDigitalPattern = getDigitalPattern;\nfunction renderDigitalPattern(chord) {\n    return getPatternInChord(getDigitalPattern(chord), chord);\n}\nexports.renderDigitalPattern = renderDigitalPattern;\nfunction getGuideTones(chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    return getPatternInChord([3, 7], chord);\n}\nexports.getGuideTones = getGuideTones;\nfunction isFirstInPath(path, index) {\n    return path.slice(index)\n        .reduce(function (sum, value) { return sum + value; }, 0) === 0;\n}\nexports.isFirstInPath = isFirstInPath;\nfunction isBarStart(path) {\n    return isFirstInPath(path, 1);\n}\nexports.isBarStart = isBarStart;\nfunction isFormStart(path) {\n    return isFirstInPath(path, 0);\n}\nexports.isFormStart = isFormStart;\nfunction isOffbeat(path) {\n    return path[2] !== 0;\n}\nexports.isOffbeat = isOffbeat;\nfunction otherDirection(direction, defaultDirection) {\n    if (direction === 'up') {\n        return 'down';\n    }\n    else if (direction === 'down') {\n        return 'up';\n    }\n    return defaultDirection;\n}\nexports.otherDirection = otherDirection;\nfunction totalDiff(diff) {\n    var total = diff.reduce(function (weight, diff) {\n        weight.added += diff.added ? diff.count : 0;\n        weight.removed += diff.added ? diff.count : 0;\n        weight.kept += (!diff.added && !diff.removed) ? diff.count : 0;\n        return weight;\n    }, { added: 0, removed: 0, kept: 0, balance: 0 });\n    total.balance = total.added - total.removed;\n    total.changes = total.added + total.removed;\n    return total;\n}\nexports.totalDiff = totalDiff;\n/** Reorders the given notes to contain the given step as close as possible */\nfunction sortByDegree(notes, degree) {\n    degree = Math.max(degree, (degree + 8) % 8);\n    /* const semitones = Interval.semitones(interval); */\n    var diffDegrees = function (a, b) { return Math.abs(getDegreeFromInterval(tonal_1.Distance.interval(a, b)) - degree); };\n    /* const diffTones = (a, b) => Math.abs(Distance.interval(a, b) - semitones); */\n    notes = notes.slice(1).reduce(function (chain, note) {\n        var closest = notes\n            .filter(function (n) { return !chain.includes(n); })\n            .sort(function (a, b) { return diffDegrees(chain[0], a) < diffDegrees(chain[0], b) ? -1 : 1; });\n        chain.unshift(closest[0]);\n        return chain;\n    }, [notes[0]]).reverse();\n    return notes;\n}\nexports.sortByDegree = sortByDegree;\n/** Returns the given notes with octaves either moving bottom up or top down */\nfunction renderAbsoluteNotes(notes, octave, direction) {\n    if (octave === void 0) { octave = 3; }\n    if (direction === void 0) { direction = 'up'; }\n    return notes.reduce(function (absolute, current, index, notes) {\n        if (index === 0) {\n            return [current + octave];\n        }\n        var interval = tonal_1.Distance.interval(notes[index - 1], current);\n        interval = Harmony_1.Harmony.minInterval(interval, direction);\n        if (interval === '1P') {\n            interval = direction === 'down' ? '-8P' : '8P';\n        }\n        absolute.push(tonal_1.Distance.transpose(absolute[index - 1], interval));\n        return absolute;\n    }, []);\n}\nexports.renderAbsoluteNotes = renderAbsoluteNotes;\nfunction getIntervals(notes) {\n    return notes.reduce(function (intervals, note, index, notes) {\n        if (index === 0) {\n            return [];\n        }\n        intervals.push(tonal_1.Distance.interval(notes[index - 1], note));\n        return intervals;\n    }, []);\n}\nexports.getIntervals = getIntervals;\nfunction isInterval(interval) {\n    return typeof tonal_1.Interval.semitones(interval) === 'number';\n}\nexports.isInterval = isInterval;\nfunction smallestInterval(intervals) {\n    return intervals.reduce(function (min, current) {\n        if (!min || tonal_1.Distance.semitones(current) < tonal_1.Distance.semitones(min)) {\n            return current;\n        }\n        return min;\n    });\n}\nexports.smallestInterval = smallestInterval;\nfunction sortNotes(notes, direction) {\n    if (direction === void 0) { direction = 'up'; }\n    return notes.sort(function (a, b) { return Harmony_1.Harmony.getMidi(a) - Harmony_1.Harmony.getMidi(b); });\n}\nexports.sortNotes = sortNotes;\nfunction analyzeVoicing(notes, root) {\n    if (!notes || notes.length < 2) {\n        throw new Error('Can only analyze Voicing with at least two notes');\n    }\n    notes = sortNotes(notes);\n    root = root || notes[0]; // TODO: get degrees\n    var intervals = getIntervals(notes);\n    var sortedIntervals = intervals.sort(Harmony_1.Harmony.sortMinInterval());\n    return {\n        notes: notes,\n        minInterval: sortedIntervals[0],\n        maxInterval: sortedIntervals[sortedIntervals.length - 1],\n        intervals: intervals,\n        spread: tonal_1.Distance.interval(notes[0], notes[notes.length - 1])\n    };\n}\nexports.analyzeVoicing = analyzeVoicing;\nfunction semitoneDifference(intervals) {\n    return intervals.reduce(function (semitones, interval) {\n        return semitones + Math.abs(tonal_1.Interval.semitones(interval));\n    }, 0);\n}\nexports.semitoneDifference = semitoneDifference;\nfunction semitoneMovement(intervals) {\n    return intervals.reduce(function (semitones, interval) {\n        return semitones + tonal_1.Interval.semitones(interval);\n    }, 0);\n}\nexports.semitoneMovement = semitoneMovement;\nfunction longestChild(array) {\n    return array.reduce(function (max, current) { return (current.length > max.length ? current : max); }, array[0]);\n}\nexports.longestChild = longestChild;\nfunction isPitchClass(note) {\n    return tonal_1.Note.pc(note) === note;\n}\nexports.isPitchClass = isPitchClass;\nfunction mapTree(tree, modifier, simplify, path, siblings, position) {\n    if (simplify === void 0) { simplify = false; }\n    if (path === void 0) { path = []; }\n    if (siblings === void 0) { siblings = []; }\n    if (position === void 0) { position = 0; }\n    // skip current tree if only one child\n    if (simplify && Array.isArray(tree) && tree.length === 1) {\n        return mapTree(tree[0], modifier, simplify, path, siblings, position);\n    }\n    var fraction = siblings.reduce(function (f, d) { return f / d; }, 1);\n    if (!Array.isArray(tree)) {\n        return modifier ? modifier(tree, { path: path, siblings: siblings, fraction: fraction, position: position }) : tree;\n    }\n    if (Array.isArray(tree)) {\n        siblings = siblings.concat([tree.length]);\n        fraction = fraction / tree.length;\n        return tree.map(function (subtree, index) {\n            return mapTree(subtree, modifier, simplify, path.concat([index]), siblings, position + index * fraction);\n        });\n    }\n}\nexports.mapTree = mapTree;\nfunction flattenTree(tree) {\n    var flat = [];\n    mapTree(tree, function (value, props) { return flat.push(Object.assign(props, { value: value })); });\n    return flat;\n}\nexports.flattenTree = flattenTree;\nfunction expandTree(tree) {\n    // TODO\n}\nexports.expandTree = expandTree;\n/* Returns true if the given intervals are all present in the chords interval structure\nIntervals can be appendend with \"?\" to indicate that those degrees could also be omitted\n(but when present they should match)\n*/\nfunction chordHasIntervals(chord, intervals) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var has = tonal_1.Chord.intervals(chord);\n    return intervals.reduce(function (match, current) {\n        var isOptional = current.includes('?');\n        var isForbidden = current.includes('!');\n        if (isOptional) {\n            current = current.replace('?', '');\n            return (!hasDegree(getDegreeFromInterval(current), has) ||\n                has.includes(current)) && match;\n        }\n        if (isForbidden) {\n            current = current.replace('!', '');\n            return !hasDegree(getDegreeFromInterval(current), has);\n        }\n        return has.includes(current) && match;\n    }, true);\n}\nexports.chordHasIntervals = chordHasIntervals;\nfunction isDominantChord(chord) {\n    return chordHasIntervals(chord, ['3M', '7m']) || chordHasIntervals(chord, ['!3', '4P', '7m']);\n}\nexports.isDominantChord = isDominantChord;\nfunction isMajorChord(chord) {\n    return chordHasIntervals(chord, ['3M', '7M?']);\n}\nexports.isMajorChord = isMajorChord;\nfunction isMinorChord(chord) {\n    return chordHasIntervals(chord, ['3m']);\n}\nexports.isMinorChord = isMinorChord;\nfunction isMinorTonic(chord) {\n    return chordHasIntervals(chord, ['3m', '5P', '13M?', '7M?']);\n}\nexports.isMinorTonic = isMinorTonic;\nfunction getChordType(chord) {\n    if (isDominantChord(chord)) {\n        return 'dominant';\n    }\n    if (isMajorChord(chord)) {\n        return 'major';\n    }\n    if (isMinorTonic(chord)) {\n        return 'minor-tonic';\n    }\n    if (isMinorChord(chord)) {\n        return 'minor';\n    }\n}\nexports.getChordType = getChordType;\nfunction getChordNotes(chord, validate) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    var notes = tonal_1.Chord.notes(chord);\n    return notes.filter(function (note) {\n        var interval = tonal_1.Distance.interval(tokens[0], note);\n        return !validate || validate(note, {\n            root: tokens[0],\n            symbol: tokens[1],\n            interval: interval,\n            step: getStepFromInterval(interval),\n            degree: getDegreeFromInterval(interval)\n        });\n    });\n}\nexports.getChordNotes = getChordNotes;\nfunction validateWithoutRoot(note, _a) {\n    var degree = _a.degree;\n    return degree !== 1;\n}\nexports.validateWithoutRoot = validateWithoutRoot;\n// OLD...\nfunction getVoicing(chord, _a) {\n    var _b = _a === void 0 ? {} : _a, voices = _b.voices, previousVoicing = _b.previousVoicing, omitRoot = _b.omitRoot, quartal = _b.quartal;\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    var notes = tonal_1.Chord.notes(chord);\n    if (omitRoot) {\n        notes = notes.filter(function (n) { return n !== tokens[0]; });\n    }\n    if (quartal) {\n    }\n    if (previousVoicing) {\n    }\n    return notes;\n}\nexports.getVoicing = getVoicing;\nfunction semitoneDistance(noteA, noteB) {\n    return tonal_1.Interval.semitones(tonal_1.Distance.interval(noteA, noteB));\n}\nexports.semitoneDistance = semitoneDistance;\nfunction noteArray(range) {\n    var slots = tonal_1.Interval.semitones(tonal_1.Distance.interval(range[0], range[1]));\n    return new Array(slots + 1)\n        .fill('')\n        .map(function (v, i) { return tonal_1.Distance.transpose(range[0], tonal_1.Interval.fromSemitones(i)); })\n        .map(function (n) { return tonal_1.Note.simplify(n); });\n}\nexports.noteArray = noteArray;\nfunction factorial(n) {\n    var value = 1;\n    for (var i = 2; i <= n; ++i) {\n        value *= i;\n    }\n    return value;\n}\nexports.factorial = factorial;\n// finds best combination following the given notes, based on minimal movement\n/* export function bestCombination(notes, combinations = []) {\n    return combinations.reduce((best, current) => {\n        const currentMovement = voicingDifference(notes, current);\n        const bestMovement = voicingDifference(notes, best);\n        if (Math.abs(currentMovement) < Math.abs(bestMovement)) {\n            return current;\n        }\n        return best;\n    });\n} */\n/* export function sortCombinationsByMovement(notes, combinations, direction: intervalDirection = 'up', min = true) {\n    const movements = combinations.map((combination) => ({\n        movement: voicingMovement(notes, combination, min),\n        combination\n    }));\n    let right = movements.filter(move => direction === 'up' ? move >= 0 : move <= 0);\n    if (!right.length) {\n        right = movements;\n    }\n    let sorted = right.sort((a, b) => a.movement - b.movement);\n    if (direction === 'down') {\n        sorted = sorted.reverse();\n    }\n    return sorted.map(movement => movement.combination);\n}\n */ \n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Instrument_1 = require(\"./Instrument\");\nvar tonal_1 = require(\"tonal\");\nvar util_1 = require(\"../util/util\");\nvar Synthesizer = /** @class */ (function (_super) {\n    __extends(Synthesizer, _super);\n    function Synthesizer(props) {\n        var _this = _super.call(this, props) || this;\n        _this.duration = 200;\n        _this.type = 'sine';\n        _this.gain = 0.9;\n        _this.attack = .05;\n        _this.decay = .05;\n        _this.sustain = .4;\n        _this.release = .1;\n        _this.duration = props.duration || _this.duration;\n        _this.type = props.type || _this.type;\n        _this.gain = props.gain || _this.gain;\n        return _this;\n    }\n    Synthesizer.prototype.getVoice = function (type, gain, key) {\n        if (type === void 0) { type = 'sine'; }\n        if (gain === void 0) { gain = 0; }\n        var frequency = tonal_1.Note.freq(key);\n        var oscNode = this.context.createOscillator();\n        oscNode.type = type;\n        var gainNode = this.context.createGain();\n        oscNode.connect(gainNode);\n        gainNode.gain.value = typeof gain === 'number' ? gain : 0.8;\n        gainNode.connect(this.mix);\n        oscNode.frequency.value = frequency;\n        return { oscNode: oscNode, gainNode: gainNode, key: key, frequency: frequency };\n    };\n    Synthesizer.prototype.lowestGain = function (a, b) {\n        return a.gain.gain.value < b.gain.gain.value ? -1 : 0;\n    };\n    Synthesizer.prototype.startKeys = function (keys, settings) {\n        if (settings === void 0) { settings = {}; }\n    };\n    Synthesizer.prototype.playKeys = function (keys, settings) {\n        var _this = this;\n        if (settings === void 0) { settings = {}; }\n        _super.prototype.playKeys.call(this, keys, settings); // fires callback   \n        //const time = this.context.currentTime + settings.deadline / 1000;\n        var time = settings.deadline || this.context.currentTime;\n        var interval = settings.interval || 0;\n        return keys.map(function (key, i) {\n            var delay = i * interval;\n            var _a = [\n                settings.endless,\n                settings.attack || _this.attack,\n                settings.decay || _this.decay,\n                settings.sustain || _this.sustain,\n                settings.release || _this.release,\n                (settings.duration || _this.duration) / 1000,\n                (settings.gain || 1) * _this.gain\n            ], endless = _a[0], attack = _a[1], decay = _a[2], sustain = _a[3], release = _a[4], duration = _a[5], gain = _a[6];\n            var voice = _this.getVoice(_this.type, 0, key);\n            util_1.adsr({ attack: attack, decay: decay, sustain: sustain, release: release, gain: gain, duration: duration, endless: endless }, time + delay, voice.gainNode.gain);\n            voice.oscNode.start(settings.deadline + delay);\n            return voice;\n        });\n    };\n    Synthesizer.prototype.stopVoice = function (voice, settings) {\n        if (settings === void 0) { settings = {}; }\n        if (!voice) {\n            return;\n        }\n        var time = settings.deadline || this.context.currentTime;\n        voice.gainNode.gain.setTargetAtTime(0, time, settings.release || this.release);\n        //voice.oscNode.stop()\n    };\n    Synthesizer.prototype.stopVoices = function (voices, settings) {\n        var _this = this;\n        voices.forEach(function (voice) {\n            _this.stopVoice(voice, settings);\n        });\n    };\n    return Synthesizer;\n}(Instrument_1.Instrument));\nexports.Synthesizer = Synthesizer;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Synthesizer_1 = require(\"./instruments/Synthesizer\");\nvar Metronome = /** @class */ (function () {\n    function Metronome(mix) {\n        this.synth = new Synthesizer_1.Synthesizer({ type: 'sine', gain: 1, mix: mix });\n        this.ready = this.synth.ready;\n    }\n    Metronome.prototype.count = function (pulse, bars) {\n        var _this = this;\n        if (bars === void 0) { bars = 1; }\n        var count = new Array(bars).fill([new Array(pulse.props.cycle).fill(1)]);\n        return pulse.tickArray(count, function (_a) {\n            var path = _a.path, deadline = _a.deadline;\n            _this.synth.playKeys([path[2] === 0 ? 90 : 78], { deadline: deadline, duration: 0.01, attack: .01, release: .01, decay: .01, sustain: 1 });\n        });\n    };\n    return Metronome;\n}());\nexports.Metronome = Metronome;\n","/*!\n\n diff v3.5.0\n\nSoftware License Agreement (BSD License)\n\nCopyright (c) 2009-2015, Kevin Decker <kpdecker@gmail.com>\n\nAll rights reserved.\n\nRedistribution and use of this software in source and binary forms, with or without modification,\nare permitted provided that the following conditions are met:\n\n* Redistributions of source code must retain the above\n  copyright notice, this list of conditions and the\n  following disclaimer.\n\n* Redistributions in binary form must reproduce the above\n  copyright notice, this list of conditions and the\n  following disclaimer in the documentation and/or other\n  materials provided with the distribution.\n\n* Neither the name of Kevin Decker nor the names of its\n  contributors may be used to endorse or promote products\n  derived from this software without specific prior\n  written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\nIMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\nFITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR\nCONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER\nIN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\nOF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n@license\n*/\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"JsDiff\"] = factory();\n\telse\n\t\troot[\"JsDiff\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n\n\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.canonicalize = exports.convertChangesToXML = exports.convertChangesToDMP = exports.merge = exports.parsePatch = exports.applyPatches = exports.applyPatch = exports.createPatch = exports.createTwoFilesPatch = exports.structuredPatch = exports.diffArrays = exports.diffJson = exports.diffCss = exports.diffSentences = exports.diffTrimmedLines = exports.diffLines = exports.diffWordsWithSpace = exports.diffWords = exports.diffChars = exports.Diff = undefined;\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_character = __webpack_require__(2) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_word = __webpack_require__(3) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_line = __webpack_require__(5) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_sentence = __webpack_require__(6) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_css = __webpack_require__(7) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_json = __webpack_require__(8) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_array = __webpack_require__(9) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_apply = __webpack_require__(10) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_parse = __webpack_require__(11) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_merge = __webpack_require__(13) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_create = __webpack_require__(14) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_dmp = __webpack_require__(16) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_xml = __webpack_require__(17) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/* See LICENSE file for terms of use */\n\n\t/*\n\t * Text diff implementation.\n\t *\n\t * This library supports the following APIS:\n\t * JsDiff.diffChars: Character by character diff\n\t * JsDiff.diffWords: Word (as defined by \\b regex) diff which ignores whitespace\n\t * JsDiff.diffLines: Line based diff\n\t *\n\t * JsDiff.diffCss: Diff targeted at CSS content\n\t *\n\t * These methods are based on the implementation proposed in\n\t * \"An O(ND) Difference Algorithm and its Variations\" (Myers, 1986).\n\t * http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.4.6927\n\t */\n\texports. /*istanbul ignore end*/Diff = _base2['default'];\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffChars = _character.diffChars;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffWords = _word.diffWords;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffWordsWithSpace = _word.diffWordsWithSpace;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffLines = _line.diffLines;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffTrimmedLines = _line.diffTrimmedLines;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffSentences = _sentence.diffSentences;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffCss = _css.diffCss;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffJson = _json.diffJson;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffArrays = _array.diffArrays;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/structuredPatch = _create.structuredPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/createTwoFilesPatch = _create.createTwoFilesPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/createPatch = _create.createPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/applyPatch = _apply.applyPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/applyPatches = _apply.applyPatches;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/parsePatch = _parse.parsePatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/merge = _merge.merge;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/convertChangesToDMP = _dmp.convertChangesToDMP;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/convertChangesToXML = _xml.convertChangesToXML;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/canonicalize = _json.canonicalize;\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJEaWZmIiwiZGlmZkNoYXJzIiwiZGlmZldvcmRzIiwiZGlmZldvcmRzV2l0aFNwYWNlIiwiZGlmZkxpbmVzIiwiZGlmZlRyaW1tZWRMaW5lcyIsImRpZmZTZW50ZW5jZXMiLCJkaWZmQ3NzIiwiZGlmZkpzb24iLCJkaWZmQXJyYXlzIiwic3RydWN0dXJlZFBhdGNoIiwiY3JlYXRlVHdvRmlsZXNQYXRjaCIsImNyZWF0ZVBhdGNoIiwiYXBwbHlQYXRjaCIsImFwcGx5UGF0Y2hlcyIsInBhcnNlUGF0Y2giLCJtZXJnZSIsImNvbnZlcnRDaGFuZ2VzVG9ETVAiLCJjb252ZXJ0Q2hhbmdlc1RvWE1MIiwiY2Fub25pY2FsaXplIl0sIm1hcHBpbmdzIjoiOzs7Ozt1QkFnQkE7Ozs7dUJBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBRUE7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7Ozs7QUFqQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7O2dDQWtDRUEsSTt5REFFQUMsUzt5REFDQUMsUzt5REFDQUMsa0I7eURBQ0FDLFM7eURBQ0FDLGdCO3lEQUNBQyxhO3lEQUVBQyxPO3lEQUNBQyxRO3lEQUVBQyxVO3lEQUVBQyxlO3lEQUNBQyxtQjt5REFDQUMsVzt5REFDQUMsVTt5REFDQUMsWTt5REFDQUMsVTt5REFDQUMsSzt5REFDQUMsbUI7eURBQ0FDLG1CO3lEQUNBQyxZIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogU2VlIExJQ0VOU0UgZmlsZSBmb3IgdGVybXMgb2YgdXNlICovXG5cbi8qXG4gKiBUZXh0IGRpZmYgaW1wbGVtZW50YXRpb24uXG4gKlxuICogVGhpcyBsaWJyYXJ5IHN1cHBvcnRzIHRoZSBmb2xsb3dpbmcgQVBJUzpcbiAqIEpzRGlmZi5kaWZmQ2hhcnM6IENoYXJhY3RlciBieSBjaGFyYWN0ZXIgZGlmZlxuICogSnNEaWZmLmRpZmZXb3JkczogV29yZCAoYXMgZGVmaW5lZCBieSBcXGIgcmVnZXgpIGRpZmYgd2hpY2ggaWdub3JlcyB3aGl0ZXNwYWNlXG4gKiBKc0RpZmYuZGlmZkxpbmVzOiBMaW5lIGJhc2VkIGRpZmZcbiAqXG4gKiBKc0RpZmYuZGlmZkNzczogRGlmZiB0YXJnZXRlZCBhdCBDU1MgY29udGVudFxuICpcbiAqIFRoZXNlIG1ldGhvZHMgYXJlIGJhc2VkIG9uIHRoZSBpbXBsZW1lbnRhdGlvbiBwcm9wb3NlZCBpblxuICogXCJBbiBPKE5EKSBEaWZmZXJlbmNlIEFsZ29yaXRobSBhbmQgaXRzIFZhcmlhdGlvbnNcIiAoTXllcnMsIDE5ODYpLlxuICogaHR0cDovL2NpdGVzZWVyeC5pc3QucHN1LmVkdS92aWV3ZG9jL3N1bW1hcnk/ZG9pPTEwLjEuMS40LjY5MjdcbiAqL1xuaW1wb3J0IERpZmYgZnJvbSAnLi9kaWZmL2Jhc2UnO1xuaW1wb3J0IHtkaWZmQ2hhcnN9IGZyb20gJy4vZGlmZi9jaGFyYWN0ZXInO1xuaW1wb3J0IHtkaWZmV29yZHMsIGRpZmZXb3Jkc1dpdGhTcGFjZX0gZnJvbSAnLi9kaWZmL3dvcmQnO1xuaW1wb3J0IHtkaWZmTGluZXMsIGRpZmZUcmltbWVkTGluZXN9IGZyb20gJy4vZGlmZi9saW5lJztcbmltcG9ydCB7ZGlmZlNlbnRlbmNlc30gZnJvbSAnLi9kaWZmL3NlbnRlbmNlJztcblxuaW1wb3J0IHtkaWZmQ3NzfSBmcm9tICcuL2RpZmYvY3NzJztcbmltcG9ydCB7ZGlmZkpzb24sIGNhbm9uaWNhbGl6ZX0gZnJvbSAnLi9kaWZmL2pzb24nO1xuXG5pbXBvcnQge2RpZmZBcnJheXN9IGZyb20gJy4vZGlmZi9hcnJheSc7XG5cbmltcG9ydCB7YXBwbHlQYXRjaCwgYXBwbHlQYXRjaGVzfSBmcm9tICcuL3BhdGNoL2FwcGx5JztcbmltcG9ydCB7cGFyc2VQYXRjaH0gZnJvbSAnLi9wYXRjaC9wYXJzZSc7XG5pbXBvcnQge21lcmdlfSBmcm9tICcuL3BhdGNoL21lcmdlJztcbmltcG9ydCB7c3RydWN0dXJlZFBhdGNoLCBjcmVhdGVUd29GaWxlc1BhdGNoLCBjcmVhdGVQYXRjaH0gZnJvbSAnLi9wYXRjaC9jcmVhdGUnO1xuXG5pbXBvcnQge2NvbnZlcnRDaGFuZ2VzVG9ETVB9IGZyb20gJy4vY29udmVydC9kbXAnO1xuaW1wb3J0IHtjb252ZXJ0Q2hhbmdlc1RvWE1MfSBmcm9tICcuL2NvbnZlcnQveG1sJztcblxuZXhwb3J0IHtcbiAgRGlmZixcblxuICBkaWZmQ2hhcnMsXG4gIGRpZmZXb3JkcyxcbiAgZGlmZldvcmRzV2l0aFNwYWNlLFxuICBkaWZmTGluZXMsXG4gIGRpZmZUcmltbWVkTGluZXMsXG4gIGRpZmZTZW50ZW5jZXMsXG5cbiAgZGlmZkNzcyxcbiAgZGlmZkpzb24sXG5cbiAgZGlmZkFycmF5cyxcblxuICBzdHJ1Y3R1cmVkUGF0Y2gsXG4gIGNyZWF0ZVR3b0ZpbGVzUGF0Y2gsXG4gIGNyZWF0ZVBhdGNoLFxuICBhcHBseVBhdGNoLFxuICBhcHBseVBhdGNoZXMsXG4gIHBhcnNlUGF0Y2gsXG4gIG1lcmdlLFxuICBjb252ZXJ0Q2hhbmdlc1RvRE1QLFxuICBjb252ZXJ0Q2hhbmdlc1RvWE1MLFxuICBjYW5vbmljYWxpemVcbn07XG4iXX0=\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports['default'] = /*istanbul ignore end*/Diff;\n\tfunction Diff() {}\n\n\tDiff.prototype = {\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/diff: function diff(oldString, newString) {\n\t    /*istanbul ignore start*/var /*istanbul ignore end*/options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n\t    var callback = options.callback;\n\t    if (typeof options === 'function') {\n\t      callback = options;\n\t      options = {};\n\t    }\n\t    this.options = options;\n\n\t    var self = this;\n\n\t    function done(value) {\n\t      if (callback) {\n\t        setTimeout(function () {\n\t          callback(undefined, value);\n\t        }, 0);\n\t        return true;\n\t      } else {\n\t        return value;\n\t      }\n\t    }\n\n\t    // Allow subclasses to massage the input prior to running\n\t    oldString = this.castInput(oldString);\n\t    newString = this.castInput(newString);\n\n\t    oldString = this.removeEmpty(this.tokenize(oldString));\n\t    newString = this.removeEmpty(this.tokenize(newString));\n\n\t    var newLen = newString.length,\n\t        oldLen = oldString.length;\n\t    var editLength = 1;\n\t    var maxEditLength = newLen + oldLen;\n\t    var bestPath = [{ newPos: -1, components: [] }];\n\n\t    // Seed editLength = 0, i.e. the content starts with the same values\n\t    var oldPos = this.extractCommon(bestPath[0], newString, oldString, 0);\n\t    if (bestPath[0].newPos + 1 >= newLen && oldPos + 1 >= oldLen) {\n\t      // Identity per the equality and tokenizer\n\t      return done([{ value: this.join(newString), count: newString.length }]);\n\t    }\n\n\t    // Main worker method. checks all permutations of a given edit length for acceptance.\n\t    function execEditLength() {\n\t      for (var diagonalPath = -1 * editLength; diagonalPath <= editLength; diagonalPath += 2) {\n\t        var basePath = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\t        var addPath = bestPath[diagonalPath - 1],\n\t            removePath = bestPath[diagonalPath + 1],\n\t            _oldPos = (removePath ? removePath.newPos : 0) - diagonalPath;\n\t        if (addPath) {\n\t          // No one else is going to attempt to use this value, clear it\n\t          bestPath[diagonalPath - 1] = undefined;\n\t        }\n\n\t        var canAdd = addPath && addPath.newPos + 1 < newLen,\n\t            canRemove = removePath && 0 <= _oldPos && _oldPos < oldLen;\n\t        if (!canAdd && !canRemove) {\n\t          // If this path is a terminal then prune\n\t          bestPath[diagonalPath] = undefined;\n\t          continue;\n\t        }\n\n\t        // Select the diagonal that we want to branch from. We select the prior\n\t        // path whose position in the new string is the farthest from the origin\n\t        // and does not pass the bounds of the diff graph\n\t        if (!canAdd || canRemove && addPath.newPos < removePath.newPos) {\n\t          basePath = clonePath(removePath);\n\t          self.pushComponent(basePath.components, undefined, true);\n\t        } else {\n\t          basePath = addPath; // No need to clone, we've pulled it from the list\n\t          basePath.newPos++;\n\t          self.pushComponent(basePath.components, true, undefined);\n\t        }\n\n\t        _oldPos = self.extractCommon(basePath, newString, oldString, diagonalPath);\n\n\t        // If we have hit the end of both strings, then we are done\n\t        if (basePath.newPos + 1 >= newLen && _oldPos + 1 >= oldLen) {\n\t          return done(buildValues(self, basePath.components, newString, oldString, self.useLongestToken));\n\t        } else {\n\t          // Otherwise track this path as a potential candidate and continue.\n\t          bestPath[diagonalPath] = basePath;\n\t        }\n\t      }\n\n\t      editLength++;\n\t    }\n\n\t    // Performs the length of edit iteration. Is a bit fugly as this has to support the\n\t    // sync and async mode which is never fun. Loops over execEditLength until a value\n\t    // is produced.\n\t    if (callback) {\n\t      (function exec() {\n\t        setTimeout(function () {\n\t          // This should not happen, but we want to be safe.\n\t          /* istanbul ignore next */\n\t          if (editLength > maxEditLength) {\n\t            return callback();\n\t          }\n\n\t          if (!execEditLength()) {\n\t            exec();\n\t          }\n\t        }, 0);\n\t      })();\n\t    } else {\n\t      while (editLength <= maxEditLength) {\n\t        var ret = execEditLength();\n\t        if (ret) {\n\t          return ret;\n\t        }\n\t      }\n\t    }\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/pushComponent: function pushComponent(components, added, removed) {\n\t    var last = components[components.length - 1];\n\t    if (last && last.added === added && last.removed === removed) {\n\t      // We need to clone here as the component clone operation is just\n\t      // as shallow array clone\n\t      components[components.length - 1] = { count: last.count + 1, added: added, removed: removed };\n\t    } else {\n\t      components.push({ count: 1, added: added, removed: removed });\n\t    }\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/extractCommon: function extractCommon(basePath, newString, oldString, diagonalPath) {\n\t    var newLen = newString.length,\n\t        oldLen = oldString.length,\n\t        newPos = basePath.newPos,\n\t        oldPos = newPos - diagonalPath,\n\t        commonCount = 0;\n\t    while (newPos + 1 < newLen && oldPos + 1 < oldLen && this.equals(newString[newPos + 1], oldString[oldPos + 1])) {\n\t      newPos++;\n\t      oldPos++;\n\t      commonCount++;\n\t    }\n\n\t    if (commonCount) {\n\t      basePath.components.push({ count: commonCount });\n\t    }\n\n\t    basePath.newPos = newPos;\n\t    return oldPos;\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/equals: function equals(left, right) {\n\t    if (this.options.comparator) {\n\t      return this.options.comparator(left, right);\n\t    } else {\n\t      return left === right || this.options.ignoreCase && left.toLowerCase() === right.toLowerCase();\n\t    }\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/removeEmpty: function removeEmpty(array) {\n\t    var ret = [];\n\t    for (var i = 0; i < array.length; i++) {\n\t      if (array[i]) {\n\t        ret.push(array[i]);\n\t      }\n\t    }\n\t    return ret;\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/castInput: function castInput(value) {\n\t    return value;\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/tokenize: function tokenize(value) {\n\t    return value.split('');\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/join: function join(chars) {\n\t    return chars.join('');\n\t  }\n\t};\n\n\tfunction buildValues(diff, components, newString, oldString, useLongestToken) {\n\t  var componentPos = 0,\n\t      componentLen = components.length,\n\t      newPos = 0,\n\t      oldPos = 0;\n\n\t  for (; componentPos < componentLen; componentPos++) {\n\t    var component = components[componentPos];\n\t    if (!component.removed) {\n\t      if (!component.added && useLongestToken) {\n\t        var value = newString.slice(newPos, newPos + component.count);\n\t        value = value.map(function (value, i) {\n\t          var oldValue = oldString[oldPos + i];\n\t          return oldValue.length > value.length ? oldValue : value;\n\t        });\n\n\t        component.value = diff.join(value);\n\t      } else {\n\t        component.value = diff.join(newString.slice(newPos, newPos + component.count));\n\t      }\n\t      newPos += component.count;\n\n\t      // Common case\n\t      if (!component.added) {\n\t        oldPos += component.count;\n\t      }\n\t    } else {\n\t      component.value = diff.join(oldString.slice(oldPos, oldPos + component.count));\n\t      oldPos += component.count;\n\n\t      // Reverse add and remove so removes are output first to match common convention\n\t      // The diffing algorithm is tied to add then remove output and this is the simplest\n\t      // route to get the desired output with minimal overhead.\n\t      if (componentPos && components[componentPos - 1].added) {\n\t        var tmp = components[componentPos - 1];\n\t        components[componentPos - 1] = components[componentPos];\n\t        components[componentPos] = tmp;\n\t      }\n\t    }\n\t  }\n\n\t  // Special case handle for when one terminal is ignored (i.e. whitespace).\n\t  // For this case we merge the terminal into the prior string and drop the change.\n\t  // This is only available for string mode.\n\t  var lastComponent = components[componentLen - 1];\n\t  if (componentLen > 1 && typeof lastComponent.value === 'string' && (lastComponent.added || lastComponent.removed) && diff.equals('', lastComponent.value)) {\n\t    components[componentLen - 2].value += lastComponent.value;\n\t    components.pop();\n\t  }\n\n\t  return components;\n\t}\n\n\tfunction clonePath(path) {\n\t  return { newPos: path.newPos, components: path.components.slice(0) };\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2Jhc2UuanMiXSwibmFtZXMiOlsiRGlmZiIsInByb3RvdHlwZSIsImRpZmYiLCJvbGRTdHJpbmciLCJuZXdTdHJpbmciLCJvcHRpb25zIiwiY2FsbGJhY2siLCJzZWxmIiwiZG9uZSIsInZhbHVlIiwic2V0VGltZW91dCIsInVuZGVmaW5lZCIsImNhc3RJbnB1dCIsInJlbW92ZUVtcHR5IiwidG9rZW5pemUiLCJuZXdMZW4iLCJsZW5ndGgiLCJvbGRMZW4iLCJlZGl0TGVuZ3RoIiwibWF4RWRpdExlbmd0aCIsImJlc3RQYXRoIiwibmV3UG9zIiwiY29tcG9uZW50cyIsIm9sZFBvcyIsImV4dHJhY3RDb21tb24iLCJqb2luIiwiY291bnQiLCJleGVjRWRpdExlbmd0aCIsImRpYWdvbmFsUGF0aCIsImJhc2VQYXRoIiwiYWRkUGF0aCIsInJlbW92ZVBhdGgiLCJjYW5BZGQiLCJjYW5SZW1vdmUiLCJjbG9uZVBhdGgiLCJwdXNoQ29tcG9uZW50IiwiYnVpbGRWYWx1ZXMiLCJ1c2VMb25nZXN0VG9rZW4iLCJleGVjIiwicmV0IiwiYWRkZWQiLCJyZW1vdmVkIiwibGFzdCIsInB1c2giLCJjb21tb25Db3VudCIsImVxdWFscyIsImxlZnQiLCJyaWdodCIsImNvbXBhcmF0b3IiLCJpZ25vcmVDYXNlIiwidG9Mb3dlckNhc2UiLCJhcnJheSIsImkiLCJzcGxpdCIsImNoYXJzIiwiY29tcG9uZW50UG9zIiwiY29tcG9uZW50TGVuIiwiY29tcG9uZW50Iiwic2xpY2UiLCJtYXAiLCJvbGRWYWx1ZSIsInRtcCIsImxhc3RDb21wb25lbnQiLCJwb3AiLCJwYXRoIl0sIm1hcHBpbmdzIjoiOzs7NENBQXdCQSxJO0FBQVQsU0FBU0EsSUFBVCxHQUFnQixDQUFFOztBQUVqQ0EsS0FBS0MsU0FBTCxHQUFpQjtBQUFBLG1EQUNmQyxJQURlLGdCQUNWQyxTQURVLEVBQ0NDLFNBREQsRUFDMEI7QUFBQSx3REFBZEMsT0FBYyx1RUFBSixFQUFJOztBQUN2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RUFBd0JBLFNBQVNrQyxVQUFVL0IsS0FBM0MsQ0FBVixDQUFsQjtBQUNBSCxnQkFBVWtDLFVBQVUvQixLQUFwQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxVQUFJNkIsZ0JBQWdCakMsV0FBV2lDLGVBQWUsQ0FBMUIsRUFBNkJmLEtBQWpELEVBQXdEO0FBQ3RELFlBQUlxQixNQUFNdkMsV0FBV2lDLGVBQWUsQ0FBMUIsQ0FBVjtBQUNBakMsbUJBQVdpQyxlQUFlLENBQTFCLElBQStCakMsV0FBV2lDLFlBQVgsQ0FBL0I7QUFDQWpDLG1CQUFXaUMsWUFBWCxJQUEyQk0sR0FBM0I7QUFDRDtBQUNGO0FBQ0Y7O0FBRUQ7QUFDQTtBQUNBO0FBQ0EsTUFBSUMsZ0JBQWdCeEMsV0FBV2tDLGVBQWUsQ0FBMUIsQ0FBcEI7QUFDQSxNQUFJQSxlQUFlLENBQWYsSUFDRyxPQUFPTSxjQUFjckQsS0FBckIsS0FBK0IsUUFEbEMsS0FFSXFELGNBQWN0QixLQUFkLElBQXVCc0IsY0FBY3JCLE9BRnpDLEtBR0d2QyxLQUFLMkMsTUFBTCxDQUFZLEVBQVosRUFBZ0JpQixjQUFjckQsS0FBOUIsQ0FIUCxFQUc2QztBQUMzQ2EsZUFBV2tDLGVBQWUsQ0FBMUIsRUFBNkIvQyxLQUE3QixJQUFzQ3FELGNBQWNyRCxLQUFwRDtBQUNBYSxlQUFXeUMsR0FBWDtBQUNEOztBQUVELFNBQU96QyxVQUFQO0FBQ0Q7O0FBRUQsU0FBU1ksU0FBVCxDQUFtQjhCLElBQW5CLEVBQXlCO0FBQ3ZCLFNBQU8sRUFBRTNDLFFBQVEyQyxLQUFLM0MsTUFBZixFQUF1QkMsWUFBWTBDLEtBQUsxQyxVQUFMLENBQWdCb0MsS0FBaEIsQ0FBc0IsQ0FBdEIsQ0FBbkMsRUFBUDtBQUNEIiwiZmlsZSI6ImJhc2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBEaWZmKCkge31cblxuRGlmZi5wcm90b3R5cGUgPSB7XG4gIGRpZmYob2xkU3RyaW5nLCBuZXdTdHJpbmcsIG9wdGlvbnMgPSB7fSkge1xuICAgIGxldCBjYWxsYmFjayA9IG9wdGlvbnMuY2FsbGJhY2s7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjYWxsYmFjayA9IG9wdGlvbnM7XG4gICAgICBvcHRpb25zID0ge307XG4gICAgfVxuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG5cbiAgICBsZXQgc2VsZiA9IHRoaXM7XG5cbiAgICBmdW5jdGlvbiBkb25lKHZhbHVlKSB7XG4gICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgY2FsbGJhY2sodW5kZWZpbmVkLCB2YWx1ZSk7IH0sIDApO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBbGxvdyBzdWJjbGFzc2VzIHRvIG1hc3NhZ2UgdGhlIGlucHV0IHByaW9yIHRvIHJ1bm5pbmdcbiAgICBvbGRTdHJpbmcgPSB0aGlzLmNhc3RJbnB1dChvbGRTdHJpbmcpO1xuICAgIG5ld1N0cmluZyA9IHRoaXMuY2FzdElucHV0KG5ld1N0cmluZyk7XG5cbiAgICBvbGRTdHJpbmcgPSB0aGlzLnJlbW92ZUVtcHR5KHRoaXMudG9rZW5pemUob2xkU3RyaW5nKSk7XG4gICAgbmV3U3RyaW5nID0gdGhpcy5yZW1vdmVFbXB0eSh0aGlzLnRva2VuaXplKG5ld1N0cmluZykpO1xuXG4gICAgbGV0IG5ld0xlbiA9IG5ld1N0cmluZy5sZW5ndGgsIG9sZExlbiA9IG9sZFN0cmluZy5sZW5ndGg7XG4gICAgbGV0IGVkaXRMZW5ndGggPSAxO1xuICAgIGxldCBtYXhFZGl0TGVuZ3RoID0gbmV3TGVuICsgb2xkTGVuO1xuICAgIGxldCBiZXN0UGF0aCA9IFt7IG5ld1BvczogLTEsIGNvbXBvbmVudHM6IFtdIH1dO1xuXG4gICAgLy8gU2VlZCBlZGl0TGVuZ3RoID0gMCwgaS5lLiB0aGUgY29udGVudCBzdGFydHMgd2l0aCB0aGUgc2FtZSB2YWx1ZXNcbiAgICBsZXQgb2xkUG9zID0gdGhpcy5leHRyYWN0Q29tbW9uKGJlc3RQYXRoWzBdLCBuZXdTdHJpbmcsIG9sZFN0cmluZywgMCk7XG4gICAgaWYgKGJlc3RQYXRoWzBdLm5ld1BvcyArIDEgPj0gbmV3TGVuICYmIG9sZFBvcyArIDEgPj0gb2xkTGVuKSB7XG4gICAgICAvLyBJZGVudGl0eSBwZXIgdGhlIGVxdWFsaXR5IGFuZCB0b2tlbml6ZXJcbiAgICAgIHJldHVybiBkb25lKFt7dmFsdWU6IHRoaXMuam9pbihuZXdTdHJpbmcpLCBjb3VudDogbmV3U3RyaW5nLmxlbmd0aH1dKTtcbiAgICB9XG5cbiAgICAvLyBNYWluIHdvcmtlciBtZXRob2QuIGNoZWNrcyBhbGwgcGVybXV0YXRpb25zIG9mIGEgZ2l2ZW4gZWRpdCBsZW5ndGggZm9yIGFjY2VwdGFuY2UuXG4gICAgZnVuY3Rpb24gZXhlY0VkaXRMZW5ndGgoKSB7XG4gICAgICBmb3IgKGxldCBkaWFnb25hbFBhdGggPSAtMSAqIGVkaXRMZW5ndGg7IGRpYWdvbmFsUGF0aCA8PSBlZGl0TGVuZ3RoOyBkaWFnb25hbFBhdGggKz0gMikge1xuICAgICAgICBsZXQgYmFzZVBhdGg7XG4gICAgICAgIGxldCBhZGRQYXRoID0gYmVzdFBhdGhbZGlhZ29uYWxQYXRoIC0gMV0sXG4gICAgICAgICAgICByZW1vdmVQYXRoID0gYmVzdFBhdGhbZGlhZ29uYWxQYXRoICsgMV0sXG4gICAgICAgICAgICBvbGRQb3MgPSAocmVtb3ZlUGF0aCA/IHJlbW92ZVBhdGgubmV3UG9zIDogMCkgLSBkaWFnb25hbFBhdGg7XG4gICAgICAgIGlmIChhZGRQYXRoKSB7XG4gICAgICAgICAgLy8gTm8gb25lIGVsc2UgaXMgZ29pbmcgdG8gYXR0ZW1wdCB0byB1c2UgdGhpcyB2YWx1ZSwgY2xlYXIgaXRcbiAgICAgICAgICBiZXN0UGF0aFtkaWFnb25hbFBhdGggLSAxXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjYW5BZGQgPSBhZGRQYXRoICYmIGFkZFBhdGgubmV3UG9zICsgMSA8IG5ld0xlbixcbiAgICAgICAgICAgIGNhblJlbW92ZSA9IHJlbW92ZVBhdGggJiYgMCA8PSBvbGRQb3MgJiYgb2xkUG9zIDwgb2xkTGVuO1xuICAgICAgICBpZiAoIWNhbkFkZCAmJiAhY2FuUmVtb3ZlKSB7XG4gICAgICAgICAgLy8gSWYgdGhpcyBwYXRoIGlzIGEgdGVybWluYWwgdGhlbiBwcnVuZVxuICAgICAgICAgIGJlc3RQYXRoW2RpYWdvbmFsUGF0aF0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZWxlY3QgdGhlIGRpYWdvbmFsIHRoYXQgd2Ugd2FudCB0byBicmFuY2ggZnJvbS4gV2Ugc2VsZWN0IHRoZSBwcmlvclxuICAgICAgICAvLyBwYXRoIHdob3NlIHBvc2l0aW9uIGluIHRoZSBuZXcgc3RyaW5nIGlzIHRoZSBmYXJ0aGVzdCBmcm9tIHRoZSBvcmlnaW5cbiAgICAgICAgLy8gYW5kIGRvZXMgbm90IHBhc3MgdGhlIGJvdW5kcyBvZiB0aGUgZGlmZiBncmFwaFxuICAgICAgICBpZiAoIWNhbkFkZCB8fCAoY2FuUmVtb3ZlICYmIGFkZFBhdGgubmV3UG9zIDwgcmVtb3ZlUGF0aC5uZXdQb3MpKSB7XG4gICAgICAgICAgYmFzZVBhdGggPSBjbG9uZVBhdGgocmVtb3ZlUGF0aCk7XG4gICAgICAgICAgc2VsZi5wdXNoQ29tcG9uZW50KGJhc2VQYXRoLmNvbXBvbmVudHMsIHVuZGVmaW5lZCwgdHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYmFzZVBhdGggPSBhZGRQYXRoOyAgIC8vIE5vIG5lZWQgdG8gY2xvbmUsIHdlJ3ZlIHB1bGxlZCBpdCBmcm9tIHRoZSBsaXN0XG4gICAgICAgICAgYmFzZVBhdGgubmV3UG9zKys7XG4gICAgICAgICAgc2VsZi5wdXNoQ29tcG9uZW50KGJhc2VQYXRoLmNvbXBvbmVudHMsIHRydWUsIHVuZGVmaW5lZCk7XG4gICAgICAgIH1cblxuICAgICAgICBvbGRQb3MgPSBzZWxmLmV4dHJhY3RDb21tb24oYmFzZVBhdGgsIG5ld1N0cmluZywgb2xkU3RyaW5nLCBkaWFnb25hbFBhdGgpO1xuXG4gICAgICAgIC8vIElmIHdlIGhhdmUgaGl0IHRoZSBlbmQgb2YgYm90aCBzdHJpbmdzLCB0aGVuIHdlIGFyZSBkb25lXG4gICAgICAgIGlmIChiYXNlUGF0aC5uZXdQb3MgKyAxID49IG5ld0xlbiAmJiBvbGRQb3MgKyAxID49IG9sZExlbikge1xuICAgICAgICAgIHJldHVybiBkb25lKGJ1aWxkVmFsdWVzKHNlbGYsIGJhc2VQYXRoLmNvbXBvbmVudHMsIG5ld1N0cmluZywgb2xkU3RyaW5nLCBzZWxmLnVzZUxvbmdlc3RUb2tlbikpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIE90aGVyd2lzZSB0cmFjayB0aGlzIHBhdGggYXMgYSBwb3RlbnRpYWwgY2FuZGlkYXRlIGFuZCBjb250aW51ZS5cbiAgICAgICAgICBiZXN0UGF0aFtkaWFnb25hbFBhdGhdID0gYmFzZVBhdGg7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZWRpdExlbmd0aCsrO1xuICAgIH1cblxuICAgIC8vIFBlcmZvcm1zIHRoZSBsZW5ndGggb2YgZWRpdCBpdGVyYXRpb24uIElzIGEgYml0IGZ1Z2x5IGFzIHRoaXMgaGFzIHRvIHN1cHBvcnQgdGhlXG4gICAgLy8gc3luYyBhbmQgYXN5bmMgbW9kZSB3aGljaCBpcyBuZXZlciBmdW4uIExvb3BzIG92ZXIgZXhlY0VkaXRMZW5ndGggdW50aWwgYSB2YWx1ZVxuICAgIC8vIGlzIHByb2R1Y2VkLlxuICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgKGZ1bmN0aW9uIGV4ZWMoKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy8gVGhpcyBzaG91bGQgbm90IGhhcHBlbiwgYnV0IHdlIHdhbnQgdG8gYmUgc2FmZS5cbiAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgICAgICAgIGlmIChlZGl0TGVuZ3RoID4gbWF4RWRpdExlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCFleGVjRWRpdExlbmd0aCgpKSB7XG4gICAgICAgICAgICBleGVjKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCAwKTtcbiAgICAgIH0oKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdoaWxlIChlZGl0TGVuZ3RoIDw9IG1heEVkaXRMZW5ndGgpIHtcbiAgICAgICAgbGV0IHJldCA9IGV4ZWNFZGl0TGVuZ3RoKCk7XG4gICAgICAgIGlmIChyZXQpIHtcbiAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIHB1c2hDb21wb25lbnQoY29tcG9uZW50cywgYWRkZWQsIHJlbW92ZWQpIHtcbiAgICBsZXQgbGFzdCA9IGNvbXBvbmVudHNbY29tcG9uZW50cy5sZW5ndGggLSAxXTtcbiAgICBpZiAobGFzdCAmJiBsYXN0LmFkZGVkID09PSBhZGRlZCAmJiBsYXN0LnJlbW92ZWQgPT09IHJlbW92ZWQpIHtcbiAgICAgIC8vIFdlIG5lZWQgdG8gY2xvbmUgaGVyZSBhcyB0aGUgY29tcG9uZW50IGNsb25lIG9wZXJhdGlvbiBpcyBqdXN0XG4gICAgICAvLyBhcyBzaGFsbG93IGFycmF5IGNsb25lXG4gICAgICBjb21wb25lbnRzW2NvbXBvbmVudHMubGVuZ3RoIC0gMV0gPSB7Y291bnQ6IGxhc3QuY291bnQgKyAxLCBhZGRlZDogYWRkZWQsIHJlbW92ZWQ6IHJlbW92ZWQgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29tcG9uZW50cy5wdXNoKHtjb3VudDogMSwgYWRkZWQ6IGFkZGVkLCByZW1vdmVkOiByZW1vdmVkIH0pO1xuICAgIH1cbiAgfSxcbiAgZXh0cmFjdENvbW1vbihiYXNlUGF0aCwgbmV3U3RyaW5nLCBvbGRTdHJpbmcsIGRpYWdvbmFsUGF0aCkge1xuICAgIGxldCBuZXdMZW4gPSBuZXdTdHJpbmcubGVuZ3RoLFxuICAgICAgICBvbGRMZW4gPSBvbGRTdHJpbmcubGVuZ3RoLFxuICAgICAgICBuZXdQb3MgPSBiYXNlUGF0aC5uZXdQb3MsXG4gICAgICAgIG9sZFBvcyA9IG5ld1BvcyAtIGRpYWdvbmFsUGF0aCxcblxuICAgICAgICBjb21tb25Db3VudCA9IDA7XG4gICAgd2hpbGUgKG5ld1BvcyArIDEgPCBuZXdMZW4gJiYgb2xkUG9zICsgMSA8IG9sZExlbiAmJiB0aGlzLmVxdWFscyhuZXdTdHJpbmdbbmV3UG9zICsgMV0sIG9sZFN0cmluZ1tvbGRQb3MgKyAxXSkpIHtcbiAgICAgIG5ld1BvcysrO1xuICAgICAgb2xkUG9zKys7XG4gICAgICBjb21tb25Db3VudCsrO1xuICAgIH1cblxuICAgIGlmIChjb21tb25Db3VudCkge1xuICAgICAgYmFzZVBhdGguY29tcG9uZW50cy5wdXNoKHtjb3VudDogY29tbW9uQ291bnR9KTtcbiAgICB9XG5cbiAgICBiYXNlUGF0aC5uZXdQb3MgPSBuZXdQb3M7XG4gICAgcmV0dXJuIG9sZFBvcztcbiAgfSxcblxuICBlcXVhbHMobGVmdCwgcmlnaHQpIHtcbiAgICBpZiAodGhpcy5vcHRpb25zLmNvbXBhcmF0b3IpIHtcbiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuY29tcGFyYXRvcihsZWZ0LCByaWdodCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBsZWZ0ID09PSByaWdodFxuICAgICAgICB8fCAodGhpcy5vcHRpb25zLmlnbm9yZUNhc2UgJiYgbGVmdC50b0xvd2VyQ2FzZSgpID09PSByaWdodC50b0xvd2VyQ2FzZSgpKTtcbiAgICB9XG4gIH0sXG4gIHJlbW92ZUVtcHR5KGFycmF5KSB7XG4gICAgbGV0IHJldCA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChhcnJheVtpXSkge1xuICAgICAgICByZXQucHVzaChhcnJheVtpXSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG4gIH0sXG4gIGNhc3RJbnB1dCh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfSxcbiAgdG9rZW5pemUodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUuc3BsaXQoJycpO1xuICB9LFxuICBqb2luKGNoYXJzKSB7XG4gICAgcmV0dXJuIGNoYXJzLmpvaW4oJycpO1xuICB9XG59O1xuXG5mdW5jdGlvbiBidWlsZFZhbHVlcyhkaWZmLCBjb21wb25lbnRzLCBuZXdTdHJpbmcsIG9sZFN0cmluZywgdXNlTG9uZ2VzdFRva2VuKSB7XG4gIGxldCBjb21wb25lbnRQb3MgPSAwLFxuICAgICAgY29tcG9uZW50TGVuID0gY29tcG9uZW50cy5sZW5ndGgsXG4gICAgICBuZXdQb3MgPSAwLFxuICAgICAgb2xkUG9zID0gMDtcblxuICBmb3IgKDsgY29tcG9uZW50UG9zIDwgY29tcG9uZW50TGVuOyBjb21wb25lbnRQb3MrKykge1xuICAgIGxldCBjb21wb25lbnQgPSBjb21wb25lbnRzW2NvbXBvbmVudFBvc107XG4gICAgaWYgKCFjb21wb25lbnQucmVtb3ZlZCkge1xuICAgICAgaWYgKCFjb21wb25lbnQuYWRkZWQgJiYgdXNlTG9uZ2VzdFRva2VuKSB7XG4gICAgICAgIGxldCB2YWx1ZSA9IG5ld1N0cmluZy5zbGljZShuZXdQb3MsIG5ld1BvcyArIGNvbXBvbmVudC5jb3VudCk7XG4gICAgICAgIHZhbHVlID0gdmFsdWUubWFwKGZ1bmN0aW9uKHZhbHVlLCBpKSB7XG4gICAgICAgICAgbGV0IG9sZFZhbHVlID0gb2xkU3RyaW5nW29sZFBvcyArIGldO1xuICAgICAgICAgIHJldHVybiBvbGRWYWx1ZS5sZW5ndGggPiB2YWx1ZS5sZW5ndGggPyBvbGRWYWx1ZSA6IHZhbHVlO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb21wb25lbnQudmFsdWUgPSBkaWZmLmpvaW4odmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29tcG9uZW50LnZhbHVlID0gZGlmZi5qb2luKG5ld1N0cmluZy5zbGljZShuZXdQb3MsIG5ld1BvcyArIGNvbXBvbmVudC5jb3VudCkpO1xuICAgICAgfVxuICAgICAgbmV3UG9zICs9IGNvbXBvbmVudC5jb3VudDtcblxuICAgICAgLy8gQ29tbW9uIGNhc2VcbiAgICAgIGlmICghY29tcG9uZW50LmFkZGVkKSB7XG4gICAgICAgIG9sZFBvcyArPSBjb21wb25lbnQuY291bnQ7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbXBvbmVudC52YWx1ZSA9IGRpZmYuam9pbihvbGRTdHJpbmcuc2xpY2Uob2xkUG9zLCBvbGRQb3MgKyBjb21wb25lbnQuY291bnQpKTtcbiAgICAgIG9sZFBvcyArPSBjb21wb25lbnQuY291bnQ7XG5cbiAgICAgIC8vIFJldmVyc2UgYWRkIGFuZCByZW1vdmUgc28gcmVtb3ZlcyBhcmUgb3V0cHV0IGZpcnN0IHRvIG1hdGNoIGNvbW1vbiBjb252ZW50aW9uXG4gICAgICAvLyBUaGUgZGlmZmluZyBhbGdvcml0aG0gaXMgdGllZCB0byBhZGQgdGhlbiByZW1vdmUgb3V0cHV0IGFuZCB0aGlzIGlzIHRoZSBzaW1wbGVzdFxuICAgICAgLy8gcm91dGUgdG8gZ2V0IHRoZSBkZXNpcmVkIG91dHB1dCB3aXRoIG1pbmltYWwgb3ZlcmhlYWQuXG4gICAgICBpZiAoY29tcG9uZW50UG9zICYmIGNvbXBvbmVudHNbY29tcG9uZW50UG9zIC0gMV0uYWRkZWQpIHtcbiAgICAgICAgbGV0IHRtcCA9IGNvbXBvbmVudHNbY29tcG9uZW50UG9zIC0gMV07XG4gICAgICAgIGNvbXBvbmVudHNbY29tcG9uZW50UG9zIC0gMV0gPSBjb21wb25lbnRzW2NvbXBvbmVudFBvc107XG4gICAgICAgIGNvbXBvbmVudHNbY29tcG9uZW50UG9zXSA9IHRtcDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBTcGVjaWFsIGNhc2UgaGFuZGxlIGZvciB3aGVuIG9uZSB0ZXJtaW5hbCBpcyBpZ25vcmVkIChpLmUuIHdoaXRlc3BhY2UpLlxuICAvLyBGb3IgdGhpcyBjYXNlIHdlIG1lcmdlIHRoZSB0ZXJtaW5hbCBpbnRvIHRoZSBwcmlvciBzdHJpbmcgYW5kIGRyb3AgdGhlIGNoYW5nZS5cbiAgLy8gVGhpcyBpcyBvbmx5IGF2YWlsYWJsZSBmb3Igc3RyaW5nIG1vZGUuXG4gIGxldCBsYXN0Q29tcG9uZW50ID0gY29tcG9uZW50c1tjb21wb25lbnRMZW4gLSAxXTtcbiAgaWYgKGNvbXBvbmVudExlbiA+IDFcbiAgICAgICYmIHR5cGVvZiBsYXN0Q29tcG9uZW50LnZhbHVlID09PSAnc3RyaW5nJ1xuICAgICAgJiYgKGxhc3RDb21wb25lbnQuYWRkZWQgfHwgbGFzdENvbXBvbmVudC5yZW1vdmVkKVxuICAgICAgJiYgZGlmZi5lcXVhbHMoJycsIGxhc3RDb21wb25lbnQudmFsdWUpKSB7XG4gICAgY29tcG9uZW50c1tjb21wb25lbnRMZW4gLSAyXS52YWx1ZSArPSBsYXN0Q29tcG9uZW50LnZhbHVlO1xuICAgIGNvbXBvbmVudHMucG9wKCk7XG4gIH1cblxuICByZXR1cm4gY29tcG9uZW50cztcbn1cblxuZnVuY3Rpb24gY2xvbmVQYXRoKHBhdGgpIHtcbiAgcmV0dXJuIHsgbmV3UG9zOiBwYXRoLm5ld1BvcywgY29tcG9uZW50czogcGF0aC5jb21wb25lbnRzLnNsaWNlKDApIH07XG59XG4iXX0=\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.characterDiff = undefined;\n\texports. /*istanbul ignore end*/diffChars = diffChars;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var characterDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/characterDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tfunction diffChars(oldStr, newStr, options) {\n\t  return characterDiff.diff(oldStr, newStr, options);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2NoYXJhY3Rlci5qcyJdLCJuYW1lcyI6WyJkaWZmQ2hhcnMiLCJjaGFyYWN0ZXJEaWZmIiwib2xkU3RyIiwibmV3U3RyIiwib3B0aW9ucyIsImRpZmYiXSwibWFwcGluZ3MiOiI7Ozs7Z0NBR2dCQSxTLEdBQUFBLFM7O0FBSGhCOzs7Ozs7dUJBRU8sSUFBTUMseUZBQWdCLHdFQUF0QjtBQUNBLFNBQVNELFNBQVQsQ0FBbUJFLE1BQW5CLEVBQTJCQyxNQUEzQixFQUFtQ0MsT0FBbkMsRUFBNEM7QUFBRSxTQUFPSCxjQUFjSSxJQUFkLENBQW1CSCxNQUFuQixFQUEyQkMsTUFBM0IsRUFBbUNDLE9BQW5DLENBQVA7QUFBcUQiLCJmaWxlIjoiY2hhcmFjdGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IERpZmYgZnJvbSAnLi9iYXNlJztcblxuZXhwb3J0IGNvbnN0IGNoYXJhY3RlckRpZmYgPSBuZXcgRGlmZigpO1xuZXhwb3J0IGZ1bmN0aW9uIGRpZmZDaGFycyhvbGRTdHIsIG5ld1N0ciwgb3B0aW9ucykgeyByZXR1cm4gY2hhcmFjdGVyRGlmZi5kaWZmKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKTsgfVxuIl19\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.wordDiff = undefined;\n\texports. /*istanbul ignore end*/diffWords = diffWords;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffWordsWithSpace = diffWordsWithSpace;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_params = __webpack_require__(4) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/ // Based on https://en.wikipedia.org/wiki/Latin_script_in_Unicode\n\t//\n\t// Ranges and exceptions:\n\t// Latin-1 Supplement, 008000FF\n\t//  - U+00D7   Multiplication sign\n\t//  - U+00F7   Division sign\n\t// Latin Extended-A, 0100017F\n\t// Latin Extended-B, 0180024F\n\t// IPA Extensions, 025002AF\n\t// Spacing Modifier Letters, 02B002FF\n\t//  - U+02C7   &#711;  Caron\n\t//  - U+02D8   &#728;  Breve\n\t//  - U+02D9   &#729;  Dot Above\n\t//  - U+02DA   &#730;  Ring Above\n\t//  - U+02DB   &#731;  Ogonek\n\t//  - U+02DC   &#732;  Small Tilde\n\t//  - U+02DD   &#733;  Double Acute Accent\n\t// Latin Extended Additional, 1E001EFF\n\tvar extendedWordChars = /^[A-Za-z\\xC0-\\u02C6\\u02C8-\\u02D7\\u02DE-\\u02FF\\u1E00-\\u1EFF]+$/;\n\n\tvar reWhitespace = /\\S/;\n\n\tvar wordDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/wordDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\twordDiff.equals = function (left, right) {\n\t  if (this.options.ignoreCase) {\n\t    left = left.toLowerCase();\n\t    right = right.toLowerCase();\n\t  }\n\t  return left === right || this.options.ignoreWhitespace && !reWhitespace.test(left) && !reWhitespace.test(right);\n\t};\n\twordDiff.tokenize = function (value) {\n\t  var tokens = value.split(/(\\s+|\\b)/);\n\n\t  // Join the boundary splits that we do not consider to be boundaries. This is primarily the extended Latin character set.\n\t  for (var i = 0; i < tokens.length - 1; i++) {\n\t    // If we have an empty string in the next field and we have only word chars before and after, merge\n\t    if (!tokens[i + 1] && tokens[i + 2] && extendedWordChars.test(tokens[i]) && extendedWordChars.test(tokens[i + 2])) {\n\t      tokens[i] += tokens[i + 2];\n\t      tokens.splice(i + 1, 2);\n\t      i--;\n\t    }\n\t  }\n\n\t  return tokens;\n\t};\n\n\tfunction diffWords(oldStr, newStr, options) {\n\t  options = /*istanbul ignore start*/(0, _params.generateOptions) /*istanbul ignore end*/(options, { ignoreWhitespace: true });\n\t  return wordDiff.diff(oldStr, newStr, options);\n\t}\n\n\tfunction diffWordsWithSpace(oldStr, newStr, options) {\n\t  return wordDiff.diff(oldStr, newStr, options);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL3dvcmQuanMiXSwibmFtZXMiOlsiZGlmZldvcmRzIiwiZGlmZldvcmRzV2l0aFNwYWNlIiwiZXh0ZW5kZWRXb3JkQ2hhcnMiLCJyZVdoaXRlc3BhY2UiLCJ3b3JkRGlmZiIsImVxdWFscyIsImxlZnQiLCJyaWdodCIsIm9wdGlvbnMiLCJpZ25vcmVDYXNlIiwidG9Mb3dlckNhc2UiLCJpZ25vcmVXaGl0ZXNwYWNlIiwidGVzdCIsInRva2VuaXplIiwidmFsdWUiLCJ0b2tlbnMiLCJzcGxpdCIsImkiLCJsZW5ndGgiLCJzcGxpY2UiLCJvbGRTdHIiLCJuZXdTdHIiLCJkaWZmIl0sIm1hcHBpbmdzIjoiOzs7O2dDQW1EZ0JBLFMsR0FBQUEsUzt5REFLQUMsa0IsR0FBQUEsa0I7O0FBeERoQjs7Ozt1QkFDQTs7Ozt3QkFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFNQyxvQkFBb0IsK0RBQTFCOztBQUVBLElBQU1DLGVBQWUsSUFBckI7O0FBRU8sSUFBTUMsK0VBQVcsd0VBQWpCO0FBQ1BBLFNBQVNDLE1BQVQsR0FBa0IsVUFBU0MsSUFBVCxFQUFlQyxLQUFmLEVBQXNCO0FBQ3RDLE1BQUksS0FBS0MsT0FBTCxDQUFhQyxVQUFqQixFQUE2QjtBQUMzQkgsV0FBT0EsS0FBS0ksV0FBTCxFQUFQO0FBQ0FILFlBQVFBLE1BQU1HLFdBQU4sRUFBUjtBQUNEO0FBQ0QsU0FBT0osU0FBU0MsS0FBVCxJQUFtQixLQUFLQyxPQUFMLENBQWFHLGdCQUFiLElBQWlDLENBQUNSLGFBQWFTLElBQWIsQ0FBa0JOLElBQWxCLENBQWxDLElBQTZELENBQUNILGFBQWFTLElBQWIsQ0FBa0JMLEtBQWxCLENBQXhGO0FBQ0QsQ0FORDtBQU9BSCxTQUFTUyxRQUFULEdBQW9CLFVBQVNDLEtBQVQsRUFBZ0I7QUFDbEMsTUFBSUMsU0FBU0QsTUFBTUUsS0FBTixDQUFZLFVBQVosQ0FBYjs7QUFFQTtBQUNBLE9BQUssSUFBSUMsSUFBSSxDQUFiLEVBQWdCQSxJQUFJRixPQUFPRyxNQUFQLEdBQWdCLENBQXBDLEVBQXVDRCxHQUF2QyxFQUE0QztBQUMxQztBQUNBLFFBQUksQ0FBQ0YsT0FBT0UsSUFBSSxDQUFYLENBQUQsSUFBa0JGLE9BQU9FLElBQUksQ0FBWCxDQUFsQixJQUNLZixrQkFBa0JVLElBQWxCLENBQXVCRyxPQUFPRSxDQUFQLENBQXZCLENBREwsSUFFS2Ysa0JBQWtCVSxJQUFsQixDQUF1QkcsT0FBT0UsSUFBSSxDQUFYLENBQXZCLENBRlQsRUFFZ0Q7QUFDOUNGLGFBQU9FLENBQVAsS0FBYUYsT0FBT0UsSUFBSSxDQUFYLENBQWI7QUFDQUYsYUFBT0ksTUFBUCxDQUFjRixJQUFJLENBQWxCLEVBQXFCLENBQXJCO0FBQ0FBO0FBQ0Q7QUFDRjs7QUFFRCxTQUFPRixNQUFQO0FBQ0QsQ0FoQkQ7O0FBa0JPLFNBQVNmLFNBQVQsQ0FBbUJvQixNQUFuQixFQUEyQkMsTUFBM0IsRUFBbUNiLE9BQW5DLEVBQTRDO0FBQ2pEQSxZQUFVLDhFQUFnQkEsT0FBaEIsRUFBeUIsRUFBQ0csa0JBQWtCLElBQW5CLEVBQXpCLENBQVY7QUFDQSxTQUFPUCxTQUFTa0IsSUFBVCxDQUFjRixNQUFkLEVBQXNCQyxNQUF0QixFQUE4QmIsT0FBOUIsQ0FBUDtBQUNEOztBQUVNLFNBQVNQLGtCQUFULENBQTRCbUIsTUFBNUIsRUFBb0NDLE1BQXBDLEVBQTRDYixPQUE1QyxFQUFxRDtBQUMxRCxTQUFPSixTQUFTa0IsSUFBVCxDQUFjRixNQUFkLEVBQXNCQyxNQUF0QixFQUE4QmIsT0FBOUIsQ0FBUDtBQUNEIiwiZmlsZSI6IndvcmQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgRGlmZiBmcm9tICcuL2Jhc2UnO1xuaW1wb3J0IHtnZW5lcmF0ZU9wdGlvbnN9IGZyb20gJy4uL3V0aWwvcGFyYW1zJztcblxuLy8gQmFzZWQgb24gaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTGF0aW5fc2NyaXB0X2luX1VuaWNvZGVcbi8vXG4vLyBSYW5nZXMgYW5kIGV4Y2VwdGlvbnM6XG4vLyBMYXRpbi0xIFN1cHBsZW1lbnQsIDAwODDigJMwMEZGXG4vLyAgLSBVKzAwRDcgIMOXIE11bHRpcGxpY2F0aW9uIHNpZ25cbi8vICAtIFUrMDBGNyAgw7cgRGl2aXNpb24gc2lnblxuLy8gTGF0aW4gRXh0ZW5kZWQtQSwgMDEwMOKAkzAxN0Zcbi8vIExhdGluIEV4dGVuZGVkLUIsIDAxODDigJMwMjRGXG4vLyBJUEEgRXh0ZW5zaW9ucywgMDI1MOKAkzAyQUZcbi8vIFNwYWNpbmcgTW9kaWZpZXIgTGV0dGVycywgMDJCMOKAkzAyRkZcbi8vICAtIFUrMDJDNyAgy4cgJiM3MTE7ICBDYXJvblxuLy8gIC0gVSswMkQ4ICDLmCAmIzcyODsgIEJyZXZlXG4vLyAgLSBVKzAyRDkgIMuZICYjNzI5OyAgRG90IEFib3ZlXG4vLyAgLSBVKzAyREEgIMuaICYjNzMwOyAgUmluZyBBYm92ZVxuLy8gIC0gVSswMkRCICDLmyAmIzczMTsgIE9nb25la1xuLy8gIC0gVSswMkRDICDLnCAmIzczMjsgIFNtYWxsIFRpbGRlXG4vLyAgLSBVKzAyREQgIMudICYjNzMzOyAgRG91YmxlIEFjdXRlIEFjY2VudFxuLy8gTGF0aW4gRXh0ZW5kZWQgQWRkaXRpb25hbCwgMUUwMOKAkzFFRkZcbmNvbnN0IGV4dGVuZGVkV29yZENoYXJzID0gL15bYS16QS1aXFx1e0MwfS1cXHV7RkZ9XFx1e0Q4fS1cXHV7RjZ9XFx1e0Y4fS1cXHV7MkM2fVxcdXsyQzh9LVxcdXsyRDd9XFx1ezJERX0tXFx1ezJGRn1cXHV7MUUwMH0tXFx1ezFFRkZ9XSskL3U7XG5cbmNvbnN0IHJlV2hpdGVzcGFjZSA9IC9cXFMvO1xuXG5leHBvcnQgY29uc3Qgd29yZERpZmYgPSBuZXcgRGlmZigpO1xud29yZERpZmYuZXF1YWxzID0gZnVuY3Rpb24obGVmdCwgcmlnaHQpIHtcbiAgaWYgKHRoaXMub3B0aW9ucy5pZ25vcmVDYXNlKSB7XG4gICAgbGVmdCA9IGxlZnQudG9Mb3dlckNhc2UoKTtcbiAgICByaWdodCA9IHJpZ2h0LnRvTG93ZXJDYXNlKCk7XG4gIH1cbiAgcmV0dXJuIGxlZnQgPT09IHJpZ2h0IHx8ICh0aGlzLm9wdGlvbnMuaWdub3JlV2hpdGVzcGFjZSAmJiAhcmVXaGl0ZXNwYWNlLnRlc3QobGVmdCkgJiYgIXJlV2hpdGVzcGFjZS50ZXN0KHJpZ2h0KSk7XG59O1xud29yZERpZmYudG9rZW5pemUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICBsZXQgdG9rZW5zID0gdmFsdWUuc3BsaXQoLyhcXHMrfFxcYikvKTtcblxuICAvLyBKb2luIHRoZSBib3VuZGFyeSBzcGxpdHMgdGhhdCB3ZSBkbyBub3QgY29uc2lkZXIgdG8gYmUgYm91bmRhcmllcy4gVGhpcyBpcyBwcmltYXJpbHkgdGhlIGV4dGVuZGVkIExhdGluIGNoYXJhY3RlciBzZXQuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdG9rZW5zLmxlbmd0aCAtIDE7IGkrKykge1xuICAgIC8vIElmIHdlIGhhdmUgYW4gZW1wdHkgc3RyaW5nIGluIHRoZSBuZXh0IGZpZWxkIGFuZCB3ZSBoYXZlIG9ubHkgd29yZCBjaGFycyBiZWZvcmUgYW5kIGFmdGVyLCBtZXJnZVxuICAgIGlmICghdG9rZW5zW2kgKyAxXSAmJiB0b2tlbnNbaSArIDJdXG4gICAgICAgICAgJiYgZXh0ZW5kZWRXb3JkQ2hhcnMudGVzdCh0b2tlbnNbaV0pXG4gICAgICAgICAgJiYgZXh0ZW5kZWRXb3JkQ2hhcnMudGVzdCh0b2tlbnNbaSArIDJdKSkge1xuICAgICAgdG9rZW5zW2ldICs9IHRva2Vuc1tpICsgMl07XG4gICAgICB0b2tlbnMuc3BsaWNlKGkgKyAxLCAyKTtcbiAgICAgIGktLTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdG9rZW5zO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGRpZmZXb3JkcyhvbGRTdHIsIG5ld1N0ciwgb3B0aW9ucykge1xuICBvcHRpb25zID0gZ2VuZXJhdGVPcHRpb25zKG9wdGlvbnMsIHtpZ25vcmVXaGl0ZXNwYWNlOiB0cnVlfSk7XG4gIHJldHVybiB3b3JkRGlmZi5kaWZmKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRpZmZXb3Jkc1dpdGhTcGFjZShvbGRTdHIsIG5ld1N0ciwgb3B0aW9ucykge1xuICByZXR1cm4gd29yZERpZmYuZGlmZihvbGRTdHIsIG5ld1N0ciwgb3B0aW9ucyk7XG59XG4iXX0=\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/generateOptions = generateOptions;\n\tfunction generateOptions(options, defaults) {\n\t  if (typeof options === 'function') {\n\t    defaults.callback = options;\n\t  } else if (options) {\n\t    for (var name in options) {\n\t      /* istanbul ignore else */\n\t      if (options.hasOwnProperty(name)) {\n\t        defaults[name] = options[name];\n\t      }\n\t    }\n\t  }\n\t  return defaults;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL3BhcmFtcy5qcyJdLCJuYW1lcyI6WyJnZW5lcmF0ZU9wdGlvbnMiLCJvcHRpb25zIiwiZGVmYXVsdHMiLCJjYWxsYmFjayIsIm5hbWUiLCJoYXNPd25Qcm9wZXJ0eSJdLCJtYXBwaW5ncyI6Ijs7O2dDQUFnQkEsZSxHQUFBQSxlO0FBQVQsU0FBU0EsZUFBVCxDQUF5QkMsT0FBekIsRUFBa0NDLFFBQWxDLEVBQTRDO0FBQ2pELE1BQUksT0FBT0QsT0FBUCxLQUFtQixVQUF2QixFQUFtQztBQUNqQ0MsYUFBU0MsUUFBVCxHQUFvQkYsT0FBcEI7QUFDRCxHQUZELE1BRU8sSUFBSUEsT0FBSixFQUFhO0FBQ2xCLFNBQUssSUFBSUcsSUFBVCxJQUFpQkgsT0FBakIsRUFBMEI7QUFDeEI7QUFDQSxVQUFJQSxRQUFRSSxjQUFSLENBQXVCRCxJQUF2QixDQUFKLEVBQWtDO0FBQ2hDRixpQkFBU0UsSUFBVCxJQUFpQkgsUUFBUUcsSUFBUixDQUFqQjtBQUNEO0FBQ0Y7QUFDRjtBQUNELFNBQU9GLFFBQVA7QUFDRCIsImZpbGUiOiJwYXJhbXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVPcHRpb25zKG9wdGlvbnMsIGRlZmF1bHRzKSB7XG4gIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGRlZmF1bHRzLmNhbGxiYWNrID0gb3B0aW9ucztcbiAgfSBlbHNlIGlmIChvcHRpb25zKSB7XG4gICAgZm9yIChsZXQgbmFtZSBpbiBvcHRpb25zKSB7XG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgICAgaWYgKG9wdGlvbnMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgICAgZGVmYXVsdHNbbmFtZV0gPSBvcHRpb25zW25hbWVdO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gZGVmYXVsdHM7XG59XG4iXX0=\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.lineDiff = undefined;\n\texports. /*istanbul ignore end*/diffLines = diffLines;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffTrimmedLines = diffTrimmedLines;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_params = __webpack_require__(4) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var lineDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/lineDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tlineDiff.tokenize = function (value) {\n\t  var retLines = [],\n\t      linesAndNewlines = value.split(/(\\n|\\r\\n)/);\n\n\t  // Ignore the final empty token that occurs if the string ends with a new line\n\t  if (!linesAndNewlines[linesAndNewlines.length - 1]) {\n\t    linesAndNewlines.pop();\n\t  }\n\n\t  // Merge the content and line separators into single tokens\n\t  for (var i = 0; i < linesAndNewlines.length; i++) {\n\t    var line = linesAndNewlines[i];\n\n\t    if (i % 2 && !this.options.newlineIsToken) {\n\t      retLines[retLines.length - 1] += line;\n\t    } else {\n\t      if (this.options.ignoreWhitespace) {\n\t        line = line.trim();\n\t      }\n\t      retLines.push(line);\n\t    }\n\t  }\n\n\t  return retLines;\n\t};\n\n\tfunction diffLines(oldStr, newStr, callback) {\n\t  return lineDiff.diff(oldStr, newStr, callback);\n\t}\n\tfunction diffTrimmedLines(oldStr, newStr, callback) {\n\t  var options = /*istanbul ignore start*/(0, _params.generateOptions) /*istanbul ignore end*/(callback, { ignoreWhitespace: true });\n\t  return lineDiff.diff(oldStr, newStr, options);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2xpbmUuanMiXSwibmFtZXMiOlsiZGlmZkxpbmVzIiwiZGlmZlRyaW1tZWRMaW5lcyIsImxpbmVEaWZmIiwidG9rZW5pemUiLCJ2YWx1ZSIsInJldExpbmVzIiwibGluZXNBbmROZXdsaW5lcyIsInNwbGl0IiwibGVuZ3RoIiwicG9wIiwiaSIsImxpbmUiLCJvcHRpb25zIiwibmV3bGluZUlzVG9rZW4iLCJpZ25vcmVXaGl0ZXNwYWNlIiwidHJpbSIsInB1c2giLCJvbGRTdHIiLCJuZXdTdHIiLCJjYWxsYmFjayIsImRpZmYiXSwibWFwcGluZ3MiOiI7Ozs7Z0NBOEJnQkEsUyxHQUFBQSxTO3lEQUNBQyxnQixHQUFBQSxnQjs7QUEvQmhCOzs7O3VCQUNBOzs7O3VCQUVPLElBQU1DLCtFQUFXLHdFQUFqQjtBQUNQQSxTQUFTQyxRQUFULEdBQW9CLFVBQVNDLEtBQVQsRUFBZ0I7QUFDbEMsTUFBSUMsV0FBVyxFQUFmO0FBQUEsTUFDSUMsbUJBQW1CRixNQUFNRyxLQUFOLENBQVksV0FBWixDQUR2Qjs7QUFHQTtBQUNBLE1BQUksQ0FBQ0QsaUJBQWlCQSxpQkFBaUJFLE1BQWpCLEdBQTBCLENBQTNDLENBQUwsRUFBb0Q7QUFDbERGLHFCQUFpQkcsR0FBakI7QUFDRDs7QUFFRDtBQUNBLE9BQUssSUFBSUMsSUFBSSxDQUFiLEVBQWdCQSxJQUFJSixpQkFBaUJFLE1BQXJDLEVBQTZDRSxHQUE3QyxFQUFrRDtBQUNoRCxRQUFJQyxPQUFPTCxpQkFBaUJJLENBQWpCLENBQVg7O0FBRUEsUUFBSUEsSUFBSSxDQUFKLElBQVMsQ0FBQyxLQUFLRSxPQUFMLENBQWFDLGNBQTNCLEVBQTJDO0FBQ3pDUixlQUFTQSxTQUFTRyxNQUFULEdBQWtCLENBQTNCLEtBQWlDRyxJQUFqQztBQUNELEtBRkQsTUFFTztBQUNMLFVBQUksS0FBS0MsT0FBTCxDQUFhRSxnQkFBakIsRUFBbUM7QUFDakNILGVBQU9BLEtBQUtJLElBQUwsRUFBUDtBQUNEO0FBQ0RWLGVBQVNXLElBQVQsQ0FBY0wsSUFBZDtBQUNEO0FBQ0Y7O0FBRUQsU0FBT04sUUFBUDtBQUNELENBeEJEOztBQTBCTyxTQUFTTCxTQUFULENBQW1CaUIsTUFBbkIsRUFBMkJDLE1BQTNCLEVBQW1DQyxRQUFuQyxFQUE2QztBQUFFLFNBQU9qQixTQUFTa0IsSUFBVCxDQUFjSCxNQUFkLEVBQXNCQyxNQUF0QixFQUE4QkMsUUFBOUIsQ0FBUDtBQUFpRDtBQUNoRyxTQUFTbEIsZ0JBQVQsQ0FBMEJnQixNQUExQixFQUFrQ0MsTUFBbEMsRUFBMENDLFFBQTFDLEVBQW9EO0FBQ3pELE1BQUlQLFVBQVUsOEVBQWdCTyxRQUFoQixFQUEwQixFQUFDTCxrQkFBa0IsSUFBbkIsRUFBMUIsQ0FBZDtBQUNBLFNBQU9aLFNBQVNrQixJQUFULENBQWNILE1BQWQsRUFBc0JDLE1BQXRCLEVBQThCTixPQUE5QixDQUFQO0FBQ0QiLCJmaWxlIjoibGluZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEaWZmIGZyb20gJy4vYmFzZSc7XG5pbXBvcnQge2dlbmVyYXRlT3B0aW9uc30gZnJvbSAnLi4vdXRpbC9wYXJhbXMnO1xuXG5leHBvcnQgY29uc3QgbGluZURpZmYgPSBuZXcgRGlmZigpO1xubGluZURpZmYudG9rZW5pemUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICBsZXQgcmV0TGluZXMgPSBbXSxcbiAgICAgIGxpbmVzQW5kTmV3bGluZXMgPSB2YWx1ZS5zcGxpdCgvKFxcbnxcXHJcXG4pLyk7XG5cbiAgLy8gSWdub3JlIHRoZSBmaW5hbCBlbXB0eSB0b2tlbiB0aGF0IG9jY3VycyBpZiB0aGUgc3RyaW5nIGVuZHMgd2l0aCBhIG5ldyBsaW5lXG4gIGlmICghbGluZXNBbmROZXdsaW5lc1tsaW5lc0FuZE5ld2xpbmVzLmxlbmd0aCAtIDFdKSB7XG4gICAgbGluZXNBbmROZXdsaW5lcy5wb3AoKTtcbiAgfVxuXG4gIC8vIE1lcmdlIHRoZSBjb250ZW50IGFuZCBsaW5lIHNlcGFyYXRvcnMgaW50byBzaW5nbGUgdG9rZW5zXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXNBbmROZXdsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgIGxldCBsaW5lID0gbGluZXNBbmROZXdsaW5lc1tpXTtcblxuICAgIGlmIChpICUgMiAmJiAhdGhpcy5vcHRpb25zLm5ld2xpbmVJc1Rva2VuKSB7XG4gICAgICByZXRMaW5lc1tyZXRMaW5lcy5sZW5ndGggLSAxXSArPSBsaW5lO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy5vcHRpb25zLmlnbm9yZVdoaXRlc3BhY2UpIHtcbiAgICAgICAgbGluZSA9IGxpbmUudHJpbSgpO1xuICAgICAgfVxuICAgICAgcmV0TGluZXMucHVzaChsaW5lKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmV0TGluZXM7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZGlmZkxpbmVzKG9sZFN0ciwgbmV3U3RyLCBjYWxsYmFjaykgeyByZXR1cm4gbGluZURpZmYuZGlmZihvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spOyB9XG5leHBvcnQgZnVuY3Rpb24gZGlmZlRyaW1tZWRMaW5lcyhvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spIHtcbiAgbGV0IG9wdGlvbnMgPSBnZW5lcmF0ZU9wdGlvbnMoY2FsbGJhY2ssIHtpZ25vcmVXaGl0ZXNwYWNlOiB0cnVlfSk7XG4gIHJldHVybiBsaW5lRGlmZi5kaWZmKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKTtcbn1cbiJdfQ==\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.sentenceDiff = undefined;\n\texports. /*istanbul ignore end*/diffSentences = diffSentences;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var sentenceDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/sentenceDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tsentenceDiff.tokenize = function (value) {\n\t  return value.split(/(\\S.+?[.!?])(?=\\s+|$)/);\n\t};\n\n\tfunction diffSentences(oldStr, newStr, callback) {\n\t  return sentenceDiff.diff(oldStr, newStr, callback);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL3NlbnRlbmNlLmpzIl0sIm5hbWVzIjpbImRpZmZTZW50ZW5jZXMiLCJzZW50ZW5jZURpZmYiLCJ0b2tlbml6ZSIsInZhbHVlIiwic3BsaXQiLCJvbGRTdHIiLCJuZXdTdHIiLCJjYWxsYmFjayIsImRpZmYiXSwibWFwcGluZ3MiOiI7Ozs7Z0NBUWdCQSxhLEdBQUFBLGE7O0FBUmhCOzs7Ozs7dUJBR08sSUFBTUMsdUZBQWUsd0VBQXJCO0FBQ1BBLGFBQWFDLFFBQWIsR0FBd0IsVUFBU0MsS0FBVCxFQUFnQjtBQUN0QyxTQUFPQSxNQUFNQyxLQUFOLENBQVksdUJBQVosQ0FBUDtBQUNELENBRkQ7O0FBSU8sU0FBU0osYUFBVCxDQUF1QkssTUFBdkIsRUFBK0JDLE1BQS9CLEVBQXVDQyxRQUF2QyxFQUFpRDtBQUFFLFNBQU9OLGFBQWFPLElBQWIsQ0FBa0JILE1BQWxCLEVBQTBCQyxNQUExQixFQUFrQ0MsUUFBbEMsQ0FBUDtBQUFxRCIsImZpbGUiOiJzZW50ZW5jZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEaWZmIGZyb20gJy4vYmFzZSc7XG5cblxuZXhwb3J0IGNvbnN0IHNlbnRlbmNlRGlmZiA9IG5ldyBEaWZmKCk7XG5zZW50ZW5jZURpZmYudG9rZW5pemUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUuc3BsaXQoLyhcXFMuKz9bLiE/XSkoPz1cXHMrfCQpLyk7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZGlmZlNlbnRlbmNlcyhvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spIHsgcmV0dXJuIHNlbnRlbmNlRGlmZi5kaWZmKG9sZFN0ciwgbmV3U3RyLCBjYWxsYmFjayk7IH1cbiJdfQ==\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.cssDiff = undefined;\n\texports. /*istanbul ignore end*/diffCss = diffCss;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var cssDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/cssDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tcssDiff.tokenize = function (value) {\n\t  return value.split(/([{}:;,]|\\s+)/);\n\t};\n\n\tfunction diffCss(oldStr, newStr, callback) {\n\t  return cssDiff.diff(oldStr, newStr, callback);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2Nzcy5qcyJdLCJuYW1lcyI6WyJkaWZmQ3NzIiwiY3NzRGlmZiIsInRva2VuaXplIiwidmFsdWUiLCJzcGxpdCIsIm9sZFN0ciIsIm5ld1N0ciIsImNhbGxiYWNrIiwiZGlmZiJdLCJtYXBwaW5ncyI6Ijs7OztnQ0FPZ0JBLE8sR0FBQUEsTzs7QUFQaEI7Ozs7Ozt1QkFFTyxJQUFNQyw2RUFBVSx3RUFBaEI7QUFDUEEsUUFBUUMsUUFBUixHQUFtQixVQUFTQyxLQUFULEVBQWdCO0FBQ2pDLFNBQU9BLE1BQU1DLEtBQU4sQ0FBWSxlQUFaLENBQVA7QUFDRCxDQUZEOztBQUlPLFNBQVNKLE9BQVQsQ0FBaUJLLE1BQWpCLEVBQXlCQyxNQUF6QixFQUFpQ0MsUUFBakMsRUFBMkM7QUFBRSxTQUFPTixRQUFRTyxJQUFSLENBQWFILE1BQWIsRUFBcUJDLE1BQXJCLEVBQTZCQyxRQUE3QixDQUFQO0FBQWdEIiwiZmlsZSI6ImNzcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEaWZmIGZyb20gJy4vYmFzZSc7XG5cbmV4cG9ydCBjb25zdCBjc3NEaWZmID0gbmV3IERpZmYoKTtcbmNzc0RpZmYudG9rZW5pemUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUuc3BsaXQoLyhbe306OyxdfFxccyspLyk7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZGlmZkNzcyhvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spIHsgcmV0dXJuIGNzc0RpZmYuZGlmZihvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spOyB9XG4iXX0=\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.jsonDiff = undefined;\n\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n\texports. /*istanbul ignore end*/diffJson = diffJson;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/canonicalize = canonicalize;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_line = __webpack_require__(5) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var objectPrototypeToString = Object.prototype.toString;\n\n\tvar jsonDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/jsonDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\t// Discriminate between two lines of pretty-printed, serialized JSON where one of them has a\n\t// dangling comma and the other doesn't. Turns out including the dangling comma yields the nicest output:\n\tjsonDiff.useLongestToken = true;\n\n\tjsonDiff.tokenize = /*istanbul ignore start*/_line.lineDiff /*istanbul ignore end*/.tokenize;\n\tjsonDiff.castInput = function (value) {\n\t  /*istanbul ignore start*/var _options = /*istanbul ignore end*/this.options,\n\t      undefinedReplacement = _options.undefinedReplacement,\n\t      _options$stringifyRep = _options.stringifyReplacer,\n\t      stringifyReplacer = _options$stringifyRep === undefined ? function (k, v) /*istanbul ignore start*/{\n\t    return (/*istanbul ignore end*/typeof v === 'undefined' ? undefinedReplacement : v\n\t    );\n\t  } : _options$stringifyRep;\n\n\n\t  return typeof value === 'string' ? value : JSON.stringify(canonicalize(value, null, null, stringifyReplacer), stringifyReplacer, '  ');\n\t};\n\tjsonDiff.equals = function (left, right) {\n\t  return (/*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/.prototype.equals.call(jsonDiff, left.replace(/,([\\r\\n])/g, '$1'), right.replace(/,([\\r\\n])/g, '$1'))\n\t  );\n\t};\n\n\tfunction diffJson(oldObj, newObj, options) {\n\t  return jsonDiff.diff(oldObj, newObj, options);\n\t}\n\n\t// This function handles the presence of circular references by bailing out when encountering an\n\t// object that is already on the \"stack\" of items being processed. Accepts an optional replacer\n\tfunction canonicalize(obj, stack, replacementStack, replacer, key) {\n\t  stack = stack || [];\n\t  replacementStack = replacementStack || [];\n\n\t  if (replacer) {\n\t    obj = replacer(key, obj);\n\t  }\n\n\t  var i = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\n\t  for (i = 0; i < stack.length; i += 1) {\n\t    if (stack[i] === obj) {\n\t      return replacementStack[i];\n\t    }\n\t  }\n\n\t  var canonicalizedObj = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\n\t  if ('[object Array]' === objectPrototypeToString.call(obj)) {\n\t    stack.push(obj);\n\t    canonicalizedObj = new Array(obj.length);\n\t    replacementStack.push(canonicalizedObj);\n\t    for (i = 0; i < obj.length; i += 1) {\n\t      canonicalizedObj[i] = canonicalize(obj[i], stack, replacementStack, replacer, key);\n\t    }\n\t    stack.pop();\n\t    replacementStack.pop();\n\t    return canonicalizedObj;\n\t  }\n\n\t  if (obj && obj.toJSON) {\n\t    obj = obj.toJSON();\n\t  }\n\n\t  if ( /*istanbul ignore start*/(typeof /*istanbul ignore end*/obj === 'undefined' ? 'undefined' : _typeof(obj)) === 'object' && obj !== null) {\n\t    stack.push(obj);\n\t    canonicalizedObj = {};\n\t    replacementStack.push(canonicalizedObj);\n\t    var sortedKeys = [],\n\t        _key = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\t    for (_key in obj) {\n\t      /* istanbul ignore else */\n\t      if (obj.hasOwnProperty(_key)) {\n\t        sortedKeys.push(_key);\n\t      }\n\t    }\n\t    sortedKeys.sort();\n\t    for (i = 0; i < sortedKeys.length; i += 1) {\n\t      _key = sortedKeys[i];\n\t      canonicalizedObj[_key] = canonicalize(obj[_key], stack, replacementStack, replacer, _key);\n\t    }\n\t    stack.pop();\n\t    replacementStack.pop();\n\t  } else {\n\t    canonicalizedObj = obj;\n\t  }\n\t  return canonicalizedObj;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2pzb24uanMiXSwibmFtZXMiOlsiZGlmZkpzb24iLCJjYW5vbmljYWxpemUiLCJvYmplY3RQcm90b3R5cGVUb1N0cmluZyIsIk9iamVjdCIsInByb3RvdHlwZSIsInRvU3RyaW5nIiwianNvbkRpZmYiLCJ1c2VMb25nZXN0VG9rZW4iLCJ0b2tlbml6ZSIsImNhc3RJbnB1dCIsInZhbHVlIiwib3B0aW9ucyIsInVuZGVmaW5lZFJlcGxhY2VtZW50Iiwic3RyaW5naWZ5UmVwbGFjZXIiLCJrIiwidiIsIkpTT04iLCJzdHJpbmdpZnkiLCJlcXVhbHMiLCJsZWZ0IiwicmlnaHQiLCJjYWxsIiwicmVwbGFjZSIsIm9sZE9iaiIsIm5ld09iaiIsImRpZmYiLCJvYmoiLCJzdGFjayIsInJlcGxhY2VtZW50U3RhY2siLCJyZXBsYWNlciIsImtleSIsImkiLCJsZW5ndGgiLCJjYW5vbmljYWxpemVkT2JqIiwicHVzaCIsIkFycmF5IiwicG9wIiwidG9KU09OIiwic29ydGVkS2V5cyIsImhhc093blByb3BlcnR5Iiwic29ydCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztnQ0FxQmdCQSxRLEdBQUFBLFE7eURBSUFDLFksR0FBQUEsWTs7QUF6QmhCOzs7O3VCQUNBOzs7O3VCQUVBLElBQU1DLDBCQUEwQkMsT0FBT0MsU0FBUCxDQUFpQkMsUUFBakQ7O0FBR08sSUFBTUMsK0VBQVcsd0VBQWpCO0FBQ1A7QUFDQTtBQUNBQSxTQUFTQyxlQUFULEdBQTJCLElBQTNCOztBQUVBRCxTQUFTRSxRQUFULEdBQW9CLGdFQUFTQSxRQUE3QjtBQUNBRixTQUFTRyxTQUFULEdBQXFCLFVBQVNDLEtBQVQsRUFBZ0I7QUFBQSxpRUFDK0UsS0FBS0MsT0FEcEY7QUFBQSxNQUM1QkMsb0JBRDRCLFlBQzVCQSxvQkFENEI7QUFBQSx1Q0FDTkMsaUJBRE07QUFBQSxNQUNOQSxpQkFETSx5Q0FDYyxVQUFDQyxDQUFELEVBQUlDLENBQUo7QUFBQSxtQ0FBVSxPQUFPQSxDQUFQ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QUFLVCxJQUFJLENBQVQsRUFBWUEsSUFBSU8sV0FBV04sTUFBM0IsRUFBbUNELEtBQUssQ0FBeEMsRUFBMkM7QUFDekNELGFBQU1RLFdBQVdQLENBQVgsQ0FBTjtBQUNBRSx1QkFBaUJILElBQWpCLElBQXdCN0IsYUFBYXlCLElBQUlJLElBQUosQ0FBYixFQUF1QkgsS0FBdkIsRUFBOEJDLGdCQUE5QixFQUFnREMsUUFBaEQsRUFBMERDLElBQTFELENBQXhCO0FBQ0Q7QUFDREgsVUFBTVMsR0FBTjtBQUNBUixxQkFBaUJRLEdBQWpCO0FBQ0QsR0FuQkQsTUFtQk87QUFDTEgsdUJBQW1CUCxHQUFuQjtBQUNEO0FBQ0QsU0FBT08sZ0JBQVA7QUFDRCIsImZpbGUiOiJqc29uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IERpZmYgZnJvbSAnLi9iYXNlJztcbmltcG9ydCB7bGluZURpZmZ9IGZyb20gJy4vbGluZSc7XG5cbmNvbnN0IG9iamVjdFByb3RvdHlwZVRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcblxuXG5leHBvcnQgY29uc3QganNvbkRpZmYgPSBuZXcgRGlmZigpO1xuLy8gRGlzY3JpbWluYXRlIGJldHdlZW4gdHdvIGxpbmVzIG9mIHByZXR0eS1wcmludGVkLCBzZXJpYWxpemVkIEpTT04gd2hlcmUgb25lIG9mIHRoZW0gaGFzIGFcbi8vIGRhbmdsaW5nIGNvbW1hIGFuZCB0aGUgb3RoZXIgZG9lc24ndC4gVHVybnMgb3V0IGluY2x1ZGluZyB0aGUgZGFuZ2xpbmcgY29tbWEgeWllbGRzIHRoZSBuaWNlc3Qgb3V0cHV0OlxuanNvbkRpZmYudXNlTG9uZ2VzdFRva2VuID0gdHJ1ZTtcblxuanNvbkRpZmYudG9rZW5pemUgPSBsaW5lRGlmZi50b2tlbml6ZTtcbmpzb25EaWZmLmNhc3RJbnB1dCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIGNvbnN0IHt1bmRlZmluZWRSZXBsYWNlbWVudCwgc3RyaW5naWZ5UmVwbGFjZXIgPSAoaywgdikgPT4gdHlwZW9mIHYgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkUmVwbGFjZW1lbnQgOiB2fSA9IHRoaXMub3B0aW9ucztcblxuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IHZhbHVlIDogSlNPTi5zdHJpbmdpZnkoY2Fub25pY2FsaXplKHZhbHVlLCBudWxsLCBudWxsLCBzdHJpbmdpZnlSZXBsYWNlciksIHN0cmluZ2lmeVJlcGxhY2VyLCAnICAnKTtcbn07XG5qc29uRGlmZi5lcXVhbHMgPSBmdW5jdGlvbihsZWZ0LCByaWdodCkge1xuICByZXR1cm4gRGlmZi5wcm90b3R5cGUuZXF1YWxzLmNhbGwoanNvbkRpZmYsIGxlZnQucmVwbGFjZSgvLChbXFxyXFxuXSkvZywgJyQxJyksIHJpZ2h0LnJlcGxhY2UoLywoW1xcclxcbl0pL2csICckMScpKTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBkaWZmSnNvbihvbGRPYmosIG5ld09iaiwgb3B0aW9ucykgeyByZXR1cm4ganNvbkRpZmYuZGlmZihvbGRPYmosIG5ld09iaiwgb3B0aW9ucyk7IH1cblxuLy8gVGhpcyBmdW5jdGlvbiBoYW5kbGVzIHRoZSBwcmVzZW5jZSBvZiBjaXJjdWxhciByZWZlcmVuY2VzIGJ5IGJhaWxpbmcgb3V0IHdoZW4gZW5jb3VudGVyaW5nIGFuXG4vLyBvYmplY3QgdGhhdCBpcyBhbHJlYWR5IG9uIHRoZSBcInN0YWNrXCIgb2YgaXRlbXMgYmVpbmcgcHJvY2Vzc2VkLiBBY2NlcHRzIGFuIG9wdGlvbmFsIHJlcGxhY2VyXG5leHBvcnQgZnVuY3Rpb24gY2Fub25pY2FsaXplKG9iaiwgc3RhY2ssIHJlcGxhY2VtZW50U3RhY2ssIHJlcGxhY2VyLCBrZXkpIHtcbiAgc3RhY2sgPSBzdGFjayB8fCBbXTtcbiAgcmVwbGFjZW1lbnRTdGFjayA9IHJlcGxhY2VtZW50U3RhY2sgfHwgW107XG5cbiAgaWYgKHJlcGxhY2VyKSB7XG4gICAgb2JqID0gcmVwbGFjZXIoa2V5LCBvYmopO1xuICB9XG5cbiAgbGV0IGk7XG5cbiAgZm9yIChpID0gMDsgaSA8IHN0YWNrLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgaWYgKHN0YWNrW2ldID09PSBvYmopIHtcbiAgICAgIHJldHVybiByZXBsYWNlbWVudFN0YWNrW2ldO1xuICAgIH1cbiAgfVxuXG4gIGxldCBjYW5vbmljYWxpemVkT2JqO1xuXG4gIGlmICgnW29iamVjdCBBcnJheV0nID09PSBvYmplY3RQcm90b3R5cGVUb1N0cmluZy5jYWxsKG9iaikpIHtcbiAgICBzdGFjay5wdXNoKG9iaik7XG4gICAgY2Fub25pY2FsaXplZE9iaiA9IG5ldyBBcnJheShvYmoubGVuZ3RoKTtcbiAgICByZXBsYWNlbWVudFN0YWNrLnB1c2goY2Fub25pY2FsaXplZE9iaik7XG4gICAgZm9yIChpID0gMDsgaSA8IG9iai5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgY2Fub25pY2FsaXplZE9ialtpXSA9IGNhbm9uaWNhbGl6ZShvYmpbaV0sIHN0YWNrLCByZXBsYWNlbWVudFN0YWNrLCByZXBsYWNlciwga2V5KTtcbiAgICB9XG4gICAgc3RhY2sucG9wKCk7XG4gICAgcmVwbGFjZW1lbnRTdGFjay5wb3AoKTtcbiAgICByZXR1cm4gY2Fub25pY2FsaXplZE9iajtcbiAgfVxuXG4gIGlmIChvYmogJiYgb2JqLnRvSlNPTikge1xuICAgIG9iaiA9IG9iai50b0pTT04oKTtcbiAgfVxuXG4gIGlmICh0eXBlb2Ygb2JqID09PSAnb2JqZWN0JyAmJiBvYmogIT09IG51bGwpIHtcbiAgICBzdGFjay5wdXNoKG9iaik7XG4gICAgY2Fub25pY2FsaXplZE9iaiA9IHt9O1xuICAgIHJlcGxhY2VtZW50U3RhY2sucHVzaChjYW5vbmljYWxpemVkT2JqKTtcbiAgICBsZXQgc29ydGVkS2V5cyA9IFtdLFxuICAgICAgICBrZXk7XG4gICAgZm9yIChrZXkgaW4gb2JqKSB7XG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgIHNvcnRlZEtleXMucHVzaChrZXkpO1xuICAgICAgfVxuICAgIH1cbiAgICBzb3J0ZWRLZXlzLnNvcnQoKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgc29ydGVkS2V5cy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAga2V5ID0gc29ydGVkS2V5c1tpXTtcbiAgICAgIGNhbm9uaWNhbGl6ZWRPYmpba2V5XSA9IGNhbm9uaWNhbGl6ZShvYmpba2V5XSwgc3RhY2ssIHJlcGxhY2VtZW50U3RhY2ssIHJlcGxhY2VyLCBrZXkpO1xuICAgIH1cbiAgICBzdGFjay5wb3AoKTtcbiAgICByZXBsYWNlbWVudFN0YWNrLnBvcCgpO1xuICB9IGVsc2Uge1xuICAgIGNhbm9uaWNhbGl6ZWRPYmogPSBvYmo7XG4gIH1cbiAgcmV0dXJuIGNhbm9uaWNhbGl6ZWRPYmo7XG59XG4iXX0=\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.arrayDiff = undefined;\n\texports. /*istanbul ignore end*/diffArrays = diffArrays;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var arrayDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/arrayDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tarrayDiff.tokenize = function (value) {\n\t  return value.slice();\n\t};\n\tarrayDiff.join = arrayDiff.removeEmpty = function (value) {\n\t  return value;\n\t};\n\n\tfunction diffArrays(oldArr, newArr, callback) {\n\t  return arrayDiff.diff(oldArr, newArr, callback);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2FycmF5LmpzIl0sIm5hbWVzIjpbImRpZmZBcnJheXMiLCJhcnJheURpZmYiLCJ0b2tlbml6ZSIsInZhbHVlIiwic2xpY2UiLCJqb2luIiwicmVtb3ZlRW1wdHkiLCJvbGRBcnIiLCJuZXdBcnIiLCJjYWxsYmFjayIsImRpZmYiXSwibWFwcGluZ3MiOiI7Ozs7Z0NBVWdCQSxVLEdBQUFBLFU7O0FBVmhCOzs7Ozs7dUJBRU8sSUFBTUMsaUZBQVksd0VBQWxCO0FBQ1BBLFVBQVVDLFFBQVYsR0FBcUIsVUFBU0MsS0FBVCxFQUFnQjtBQUNuQyxTQUFPQSxNQUFNQyxLQUFOLEVBQVA7QUFDRCxDQUZEO0FBR0FILFVBQVVJLElBQVYsR0FBaUJKLFVBQVVLLFdBQVYsR0FBd0IsVUFBU0gsS0FBVCxFQUFnQjtBQUN2RCxTQUFPQSxLQUFQO0FBQ0QsQ0FGRDs7QUFJTyxTQUFTSCxVQUFULENBQW9CTyxNQUFwQixFQUE0QkMsTUFBNUIsRUFBb0NDLFFBQXBDLEVBQThDO0FBQUUsU0FBT1IsVUFBVVMsSUFBVixDQUFlSCxNQUFmLEVBQXVCQyxNQUF2QixFQUErQkMsUUFBL0IsQ0FBUDtBQUFrRCIsImZpbGUiOiJhcnJheS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEaWZmIGZyb20gJy4vYmFzZSc7XG5cbmV4cG9ydCBjb25zdCBhcnJheURpZmYgPSBuZXcgRGlmZigpO1xuYXJyYXlEaWZmLnRva2VuaXplID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlLnNsaWNlKCk7XG59O1xuYXJyYXlEaWZmLmpvaW4gPSBhcnJheURpZmYucmVtb3ZlRW1wdHkgPSBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gdmFsdWU7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZGlmZkFycmF5cyhvbGRBcnIsIG5ld0FyciwgY2FsbGJhY2spIHsgcmV0dXJuIGFycmF5RGlmZi5kaWZmKG9sZEFyciwgbmV3QXJyLCBjYWxsYmFjayk7IH1cbiJdfQ==\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/applyPatch = applyPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/applyPatches = applyPatches;\n\n\tvar /*istanbul ignore start*/_parse = __webpack_require__(11) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_distanceIterator = __webpack_require__(12) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _distanceIterator2 = _interopRequireDefault(_distanceIterator);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/function applyPatch(source, uniDiff) {\n\t  /*istanbul ignore start*/var /*istanbul ignore end*/options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n\t  if (typeof uniDiff === 'string') {\n\t    uniDiff = /*istanbul ignore start*/(0, _parse.parsePatch) /*istanbul ignore end*/(uniDiff);\n\t  }\n\n\t  if (Array.isArray(uniDiff)) {\n\t    if (uniDiff.length > 1) {\n\t      throw new Error('applyPatch only works with a single input.');\n\t    }\n\n\t    uniDiff = uniDiff[0];\n\t  }\n\n\t  // Apply the diff to the input\n\t  var lines = source.split(/\\r\\n|[\\n\\v\\f\\r\\x85]/),\n\t      delimiters = source.match(/\\r\\n|[\\n\\v\\f\\r\\x85]/g) || [],\n\t      hunks = uniDiff.hunks,\n\t      compareLine = options.compareLine || function (lineNumber, line, operation, patchContent) /*istanbul ignore start*/{\n\t    return (/*istanbul ignore end*/line === patchContent\n\t    );\n\t  },\n\t      errorCount = 0,\n\t      fuzzFactor = options.fuzzFactor || 0,\n\t      minLine = 0,\n\t      offset = 0,\n\t      removeEOFNL = /*istanbul ignore start*/void 0 /*istanbul ignore end*/,\n\t      addEOFNL = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\n\t  /**\n\t   * Checks if the hunk exactly fits on the provided location\n\t   */\n\t  function hunkFits(hunk, toPos) {\n\t    for (var j = 0; j < hunk.lines.length; j++) {\n\t      var line = hunk.lines[j],\n\t          operation = line.length > 0 ? line[0] : ' ',\n\t          content = line.length > 0 ? line.substr(1) : line;\n\n\t      if (operation === ' ' || operation === '-') {\n\t        // Context sanity check\n\t        if (!compareLine(toPos + 1, lines[toPos], operation, content)) {\n\t          errorCount++;\n\n\t          if (errorCount > fuzzFactor) {\n\t            return false;\n\t          }\n\t        }\n\t        toPos++;\n\t      }\n\t    }\n\n\t    return true;\n\t  }\n\n\t  // Search best fit offsets for each hunk based on the previous ones\n\t  for (var i = 0; i < hunks.length; i++) {\n\t    var hunk = hunks[i],\n\t        maxLine = lines.length - hunk.oldLines,\n\t        localOffset = 0,\n\t        toPos = offset + hunk.oldStart - 1;\n\n\t    var iterator = /*istanbul ignore start*/(0, _distanceIterator2['default']) /*istanbul ignore end*/(toPos, minLine, maxLine);\n\n\t    for (; localOffset !== undefined; localOffset = iterator()) {\n\t      if (hunkFits(hunk, toPos + localOffset)) {\n\t        hunk.offset = offset += localOffset;\n\t        break;\n\t      }\n\t    }\n\n\t    if (localOffset === undefined) {\n\t      return false;\n\t    }\n\n\t    // Set lower text limit to end of the current hunk, so next ones don't try\n\t    // to fit over already patched text\n\t    minLine = hunk.offset + hunk.oldStart + hunk.oldLines;\n\t  }\n\n\t  // Apply patch hunks\n\t  var diffOffset = 0;\n\t  for (var _i = 0; _i < hunks.length; _i++) {\n\t    var _hunk = hunks[_i],\n\t        _toPos = _hunk.oldStart + _hunk.offset + diffOffset - 1;\n\t    diffOffset += _hunk.newLines - _hunk.oldLines;\n\n\t    if (_toPos < 0) {\n\t      // Creating a new file\n\t      _toPos = 0;\n\t    }\n\n\t    for (var j = 0; j < _hunk.lines.length; j++) {\n\t      var line = _hunk.lines[j],\n\t          operation = line.length > 0 ? line[0] : ' ',\n\t          content = line.length > 0 ? line.substr(1) : line,\n\t          delimiter = _hunk.linedelimiters[j];\n\n\t      if (operation === ' ') {\n\t        _toPos++;\n\t      } else if (operation === '-') {\n\t        lines.splice(_toPos, 1);\n\t        delimiters.splice(_toPos, 1);\n\t        /* istanbul ignore else */\n\t      } else if (operation === '+') {\n\t        lines.splice(_toPos, 0, content);\n\t        delimiters.splice(_toPos, 0, delimiter);\n\t        _toPos++;\n\t      } else if (operation === '\\\\') {\n\t        var previousOperation = _hunk.lines[j - 1] ? _hunk.lines[j - 1][0] : null;\n\t        if (previousOperation === '+') {\n\t          removeEOFNL = true;\n\t        } else if (previousOperation === '-') {\n\t          addEOFNL = true;\n\t        }\n\t      }\n\t    }\n\t  }\n\n\t  // Handle EOFNL insertion/removal\n\t  if (removeEOFNL) {\n\t    while (!lines[lines.length - 1]) {\n\t      lines.pop();\n\t      delimiters.pop();\n\t    }\n\t  } else if (addEOFNL) {\n\t    lines.push('');\n\t    delimiters.push('\\n');\n\t  }\n\t  for (var _k = 0; _k < lines.length - 1; _k++) {\n\t    lines[_k] = lines[_k] + delimiters[_k];\n\t  }\n\t  return lines.join('');\n\t}\n\n\t// Wrapper that supports multiple file patches via callbacks.\n\tfunction applyPatches(uniDiff, options) {\n\t  if (typeof uniDiff === 'string') {\n\t    uniDiff = /*istanbul ignore start*/(0, _parse.parsePatch) /*istanbul ignore end*/(uniDiff);\n\t  }\n\n\t  var currentIndex = 0;\n\t  function processIndex() {\n\t    var index = uniDiff[currentIndex++];\n\t    if (!index) {\n\t      return options.complete();\n\t    }\n\n\t    options.loadFile(index, function (err, data) {\n\t      if (err) {\n\t        return options.complete(err);\n\t      }\n\n\t      var updatedContent = applyPatch(data, index, options);\n\t      options.patched(index, updatedContent, function (err) {\n\t        if (err) {\n\t          return options.complete(err);\n\t        }\n\n\t        processIndex();\n\t      });\n\t    });\n\t  }\n\t  processIndex();\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYXRjaC9hcHBseS5qcyJdLCJuYW1lcyI6WyJhcHBseVBhdGNoIiwiYXBwbHlQYXRjaGVzIiwic291cmNlIiwidW5pRGlmZiIsIm9wdGlvbnMiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJFcnJvciIsImxpbmVzIiwic3BsaXQiLCJkZWxpbWl0ZXJzIiwibWF0Y2giLCJodW5rcyIsImNvbXBhcmVMaW5lIiwibGluZU51bWJlciIsImxpbmUiLCJvcGVyYXRpb24iLCJwYXRjaENvbnRlbnQiLCJlcnJvckNvdW50IiwiZnV6ekZhY3RvciIsIm1pbkxpbmUiLCJvZmZzZXQiLCJyZW1vdmVFT0ZOTCIsImFkZEVPRk5MIiwiaHVua0ZpdHMiLCJodW5rIiwidG9Qb3MiLCJqIiwiY29udGVudCIsInN1YnN0ciIsImkiLCJtYXhMaW5lIiwib2xkTGluZXMiLCJsb2NhbE9mZnNldCIsIm9sZFN0YXJ0IiwiaXRlcmF0b3IiLCJ1bmRlZmluZWQiLCJkaWZmT2Zmc2V0IiwibmV3TGluZXMiLCJkZWxpbWl0ZXIiLCJsaW5lZGVsaW1pdGVycyIsInNwbGljZSIsInByZXZpb3VzT3BlcmF0aW9uIiwicG9wIiwicHVzaCIsIl9rIiwiam9pbiIsImN1cnJlbnRJbmRleCIsInByb2Nlc3NJbmRleCIsImluZGV4IiwiY29tcGxldGUiLCJsb2FkRmlsZSIsImVyciIsImRhdGEiLCJ1cGRhdGVkQ29udGVudCIsInBhdGNoZWQiXSwibWFwcGluZ3MiOiI7OztnQ0FHZ0JBLFUsR0FBQUEsVTt5REFvSUFDLFksR0FBQUEsWTs7QUF2SWhCOztBQUNBOzs7Ozs7dUJBRU8sU0FBU0QsVUFBVCxDQUFvQkUsTUFBcEIsRUFBNEJDLE9BQTVCLEVBQW1EO0FBQUEsc0RBQWRDLE9BQWMsdUVBQUosRUFBSTs7QUFDeEQsTUFBSSxPQUFPRCxPQUFQLEtBQW1CLFFBQXZCLEVBQWlDO0FBQy9CQSxjQUFVLHdFQUFXQSxPQUFYLENBQVY7QUFDRDs7QUFFRCxNQUFJRSxNQUFNQyxP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QUFZO0FBQ1YsYUFBTzlDLFFBQVErQyxRQUFSLEVBQVA7QUFDRDs7QUFFRC9DLFlBQVFnRCxRQUFSLENBQWlCRixLQUFqQixFQUF3QixVQUFTRyxHQUFULEVBQWNDLElBQWQsRUFBb0I7QUFDMUMsVUFBSUQsR0FBSixFQUFTO0FBQ1AsZUFBT2pELFFBQVErQyxRQUFSLENBQWlCRSxHQUFqQixDQUFQO0FBQ0Q7O0FBRUQsVUFBSUUsaUJBQWlCdkQsV0FBV3NELElBQVgsRUFBaUJKLEtBQWpCLEVBQXdCOUMsT0FBeEIsQ0FBckI7QUFDQUEsY0FBUW9ELE9BQVIsQ0FBZ0JOLEtBQWhCLEVBQXVCSyxjQUF2QixFQUF1QyxVQUFTRixHQUFULEVBQWM7QUFDbkQsWUFBSUEsR0FBSixFQUFTO0FBQ1AsaUJBQU9qRCxRQUFRK0MsUUFBUixDQUFpQkUsR0FBakIsQ0FBUDtBQUNEOztBQUVESjtBQUNELE9BTkQ7QUFPRCxLQWJEO0FBY0Q7QUFDREE7QUFDRCIsImZpbGUiOiJhcHBseS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7cGFyc2VQYXRjaH0gZnJvbSAnLi9wYXJzZSc7XG5pbXBvcnQgZGlzdGFuY2VJdGVyYXRvciBmcm9tICcuLi91dGlsL2Rpc3RhbmNlLWl0ZXJhdG9yJztcblxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5UGF0Y2goc291cmNlLCB1bmlEaWZmLCBvcHRpb25zID0ge30pIHtcbiAgaWYgKHR5cGVvZiB1bmlEaWZmID09PSAnc3RyaW5nJykge1xuICAgIHVuaURpZmYgPSBwYXJzZVBhdGNoKHVuaURpZmYpO1xuICB9XG5cbiAgaWYgKEFycmF5LmlzQXJyYXkodW5pRGlmZikpIHtcbiAgICBpZiAodW5pRGlmZi5sZW5ndGggPiAxKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2FwcGx5UGF0Y2ggb25seSB3b3JrcyB3aXRoIGEgc2luZ2xlIGlucHV0LicpO1xuICAgIH1cblxuICAgIHVuaURpZmYgPSB1bmlEaWZmWzBdO1xuICB9XG5cbiAgLy8gQXBwbHkgdGhlIGRpZmYgdG8gdGhlIGlucHV0XG4gIGxldCBsaW5lcyA9IHNvdXJjZS5zcGxpdCgvXFxyXFxufFtcXG5cXHZcXGZcXHJcXHg4NV0vKSxcbiAgICAgIGRlbGltaXRlcnMgPSBzb3VyY2UubWF0Y2goL1xcclxcbnxbXFxuXFx2XFxmXFxyXFx4ODVdL2cpIHx8IFtdLFxuICAgICAgaHVua3MgPSB1bmlEaWZmLmh1bmtzLFxuXG4gICAgICBjb21wYXJlTGluZSA9IG9wdGlvbnMuY29tcGFyZUxpbmUgfHwgKChsaW5lTnVtYmVyLCBsaW5lLCBvcGVyYXRpb24sIHBhdGNoQ29udGVudCkgPT4gbGluZSA9PT0gcGF0Y2hDb250ZW50KSxcbiAgICAgIGVycm9yQ291bnQgPSAwLFxuICAgICAgZnV6ekZhY3RvciA9IG9wdGlvbnMuZnV6ekZhY3RvciB8fCAwLFxuICAgICAgbWluTGluZSA9IDAsXG4gICAgICBvZmZzZXQgPSAwLFxuXG4gICAgICByZW1vdmVFT0ZOTCxcbiAgICAgIGFkZEVPRk5MO1xuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgdGhlIGh1bmsgZXhhY3RseSBmaXRzIG9uIHRoZSBwcm92aWRlZCBsb2NhdGlvblxuICAgKi9cbiAgZnVuY3Rpb24gaHVua0ZpdHMoaHVuaywgdG9Qb3MpIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGh1bmsubGluZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgIGxldCBsaW5lID0gaHVuay5saW5lc1tqXSxcbiAgICAgICAgICBvcGVyYXRpb24gPSAobGluZS5sZW5ndGggPiAwID8gbGluZVswXSA6ICcgJyksXG4gICAgICAgICAgY29udGVudCA9IChsaW5lLmxlbmd0aCA+IDAgPyBsaW5lLnN1YnN0cigxKSA6IGxpbmUpO1xuXG4gICAgICBpZiAob3BlcmF0aW9uID09PSAnICcgfHwgb3BlcmF0aW9uID09PSAnLScpIHtcbiAgICAgICAgLy8gQ29udGV4dCBzYW5pdHkgY2hlY2tcbiAgICAgICAgaWYgKCFjb21wYXJlTGluZSh0b1BvcyArIDEsIGxpbmVzW3RvUG9zXSwgb3BlcmF0aW9uLCBjb250ZW50KSkge1xuICAgICAgICAgIGVycm9yQ291bnQrKztcblxuICAgICAgICAgIGlmIChlcnJvckNvdW50ID4gZnV6ekZhY3Rvcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0b1BvcysrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLy8gU2VhcmNoIGJlc3QgZml0IG9mZnNldHMgZm9yIGVhY2ggaHVuayBiYXNlZCBvbiB0aGUgcHJldmlvdXMgb25lc1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGh1bmtzLmxlbmd0aDsgaSsrKSB7XG4gICAgbGV0IGh1bmsgPSBodW5rc1tpXSxcbiAgICAgICAgbWF4TGluZSA9IGxpbmVzLmxlbmd0aCAtIGh1bmsub2xkTGluZXMsXG4gICAgICAgIGxvY2FsT2Zmc2V0ID0gMCxcbiAgICAgICAgdG9Qb3MgPSBvZmZzZXQgKyBodW5rLm9sZFN0YXJ0IC0gMTtcblxuICAgIGxldCBpdGVyYXRvciA9IGRpc3RhbmNlSXRlcmF0b3IodG9Qb3MsIG1pbkxpbmUsIG1heExpbmUpO1xuXG4gICAgZm9yICg7IGxvY2FsT2Zmc2V0ICE9PSB1bmRlZmluZWQ7IGxvY2FsT2Zmc2V0ID0gaXRlcmF0b3IoKSkge1xuICAgICAgaWYgKGh1bmtGaXRzKGh1bmssIHRvUG9zICsgbG9jYWxPZmZzZXQpKSB7XG4gICAgICAgIGh1bmsub2Zmc2V0ID0gb2Zmc2V0ICs9IGxvY2FsT2Zmc2V0O1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobG9jYWxPZmZzZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFNldCBsb3dlciB0ZXh0IGxpbWl0IHRvIGVuZCBvZiB0aGUgY3VycmVudCBodW5rLCBzbyBuZXh0IG9uZXMgZG9uJ3QgdHJ5XG4gICAgLy8gdG8gZml0IG92ZXIgYWxyZWFkeSBwYXRjaGVkIHRleHRcbiAgICBtaW5MaW5lID0gaHVuay5vZmZzZXQgKyBodW5rLm9sZFN0YXJ0ICsgaHVuay5vbGRMaW5lcztcbiAgfVxuXG4gIC8vIEFwcGx5IHBhdGNoIGh1bmtzXG4gIGxldCBkaWZmT2Zmc2V0ID0gMDtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBodW5rcy5sZW5ndGg7IGkrKykge1xuICAgIGxldCBodW5rID0gaHVua3NbaV0sXG4gICAgICAgIHRvUG9zID0gaHVuay5vbGRTdGFydCArIGh1bmsub2Zmc2V0ICsgZGlmZk9mZnNldCAtIDE7XG4gICAgZGlmZk9mZnNldCArPSBodW5rLm5ld0xpbmVzIC0gaHVuay5vbGRMaW5lcztcblxuICAgIGlmICh0b1BvcyA8IDApIHsgLy8gQ3JlYXRpbmcgYSBuZXcgZmlsZVxuICAgICAgdG9Qb3MgPSAwO1xuICAgIH1cblxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgaHVuay5saW5lcy5sZW5ndGg7IGorKykge1xuICAgICAgbGV0IGxpbmUgPSBodW5rLmxpbmVzW2pdLFxuICAgICAgICAgIG9wZXJhdGlvbiA9IChsaW5lLmxlbmd0aCA+IDAgPyBsaW5lWzBdIDogJyAnKSxcbiAgICAgICAgICBjb250ZW50ID0gKGxpbmUubGVuZ3RoID4gMCA/IGxpbmUuc3Vic3RyKDEpIDogbGluZSksXG4gICAgICAgICAgZGVsaW1pdGVyID0gaHVuay5saW5lZGVsaW1pdGVyc1tqXTtcblxuICAgICAgaWYgKG9wZXJhdGlvbiA9PT0gJyAnKSB7XG4gICAgICAgIHRvUG9zKys7XG4gICAgICB9IGVsc2UgaWYgKG9wZXJhdGlvbiA9PT0gJy0nKSB7XG4gICAgICAgIGxpbmVzLnNwbGljZSh0b1BvcywgMSk7XG4gICAgICAgIGRlbGltaXRlcnMuc3BsaWNlKHRvUG9zLCAxKTtcbiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovXG4gICAgICB9IGVsc2UgaWYgKG9wZXJhdGlvbiA9PT0gJysnKSB7XG4gICAgICAgIGxpbmVzLnNwbGljZSh0b1BvcywgMCwgY29udGVudCk7XG4gICAgICAgIGRlbGltaXRlcnMuc3BsaWNlKHRvUG9zLCAwLCBkZWxpbWl0ZXIpO1xuICAgICAgICB0b1BvcysrO1xuICAgICAgfSBlbHNlIGlmIChvcGVyYXRpb24gPT09ICdcXFxcJykge1xuICAgICAgICBsZXQgcHJldmlvdXNPcGVyYXRpb24gPSBodW5rLmxpbmVzW2ogLSAxXSA/IGh1bmsubGluZXNbaiAtIDFdWzBdIDogbnVsbDtcbiAgICAgICAgaWYgKHByZXZpb3VzT3BlcmF0aW9uID09PSAnKycpIHtcbiAgICAgICAgICByZW1vdmVFT0ZOTCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAocHJldmlvdXNPcGVyYXRpb24gPT09ICctJykge1xuICAgICAgICAgIGFkZEVPRk5MID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIEhhbmRsZSBFT0ZOTCBpbnNlcnRpb24vcmVtb3ZhbFxuICBpZiAocmVtb3ZlRU9GTkwpIHtcbiAgICB3aGlsZSAoIWxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdKSB7XG4gICAgICBsaW5lcy5wb3AoKTtcbiAgICAgIGRlbGltaXRlcnMucG9wKCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKGFkZEVPRk5MKSB7XG4gICAgbGluZXMucHVzaCgnJyk7XG4gICAgZGVsaW1pdGVycy5wdXNoKCdcXG4nKTtcbiAgfVxuICBmb3IgKGxldCBfayA9IDA7IF9rIDwgbGluZXMubGVuZ3RoIC0gMTsgX2srKykge1xuICAgIGxpbmVzW19rXSA9IGxpbmVzW19rXSArIGRlbGltaXRlcnNbX2tdO1xuICB9XG4gIHJldHVybiBsaW5lcy5qb2luKCcnKTtcbn1cblxuLy8gV3JhcHBlciB0aGF0IHN1cHBvcnRzIG11bHRpcGxlIGZpbGUgcGF0Y2hlcyB2aWEgY2FsbGJhY2tzLlxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5UGF0Y2hlcyh1bmlEaWZmLCBvcHRpb25zKSB7XG4gIGlmICh0eXBlb2YgdW5pRGlmZiA9PT0gJ3N0cmluZycpIHtcbiAgICB1bmlEaWZmID0gcGFyc2VQYXRjaCh1bmlEaWZmKTtcbiAgfVxuXG4gIGxldCBjdXJyZW50SW5kZXggPSAwO1xuICBmdW5jdGlvbiBwcm9jZXNzSW5kZXgoKSB7XG4gICAgbGV0IGluZGV4ID0gdW5pRGlmZltjdXJyZW50SW5kZXgrK107XG4gICAgaWYgKCFpbmRleCkge1xuICAgICAgcmV0dXJuIG9wdGlvbnMuY29tcGxldGUoKTtcbiAgICB9XG5cbiAgICBvcHRpb25zLmxvYWRGaWxlKGluZGV4LCBmdW5jdGlvbihlcnIsIGRhdGEpIHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuY29tcGxldGUoZXJyKTtcbiAgICAgIH1cblxuICAgICAgbGV0IHVwZGF0ZWRDb250ZW50ID0gYXBwbHlQYXRjaChkYXRhLCBpbmRleCwgb3B0aW9ucyk7XG4gICAgICBvcHRpb25zLnBhdGNoZWQoaW5kZXgsIHVwZGF0ZWRDb250ZW50LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIHJldHVybiBvcHRpb25zLmNvbXBsZXRlKGVycik7XG4gICAgICAgIH1cblxuICAgICAgICBwcm9jZXNzSW5kZXgoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIHByb2Nlc3NJbmRleCgpO1xufVxuIl19\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/parsePatch = parsePatch;\n\tfunction parsePatch(uniDiff) {\n\t  /*istanbul ignore start*/var /*istanbul ignore end*/options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t  var diffstr = uniDiff.split(/\\r\\n|[\\n\\v\\f\\r\\x85]/),\n\t      delimiters = uniDiff.match(/\\r\\n|[\\n\\v\\f\\r\\x85]/g) || [],\n\t      list = [],\n\t      i = 0;\n\n\t  function parseIndex() {\n\t    var index = {};\n\t    list.push(index);\n\n\t    // Parse diff metadata\n\t    while (i < diffstr.length) {\n\t      var line = diffstr[i];\n\n\t      // File header found, end parsing diff metadata\n\t      if (/^(\\-\\-\\-|\\+\\+\\+|@@)\\s/.test(line)) {\n\t        break;\n\t      }\n\n\t      // Diff index\n\t      var header = /^(?:Index:|diff(?: -r \\w+)+)\\s+(.+?)\\s*$/.exec(line);\n\t      if (header) {\n\t        index.index = header[1];\n\t      }\n\n\t      i++;\n\t    }\n\n\t    // Parse file headers if they are defined. Unified diff requires them, but\n\t    // there's no technical issues to have an isolated hunk without file header\n\t    parseFileHeader(index);\n\t    parseFileHeader(index);\n\n\t    // Parse hunks\n\t    index.hunks = [];\n\n\t    while (i < diffstr.length) {\n\t      var _line = diffstr[i];\n\n\t      if (/^(Index:|diff|\\-\\-\\-|\\+\\+\\+)\\s/.test(_line)) {\n\t        break;\n\t      } else if (/^@@/.test(_line)) {\n\t        index.hunks.push(parseHunk());\n\t      } else if (_line && options.strict) {\n\t        // Ignore unexpected content unless in strict mode\n\t        throw new Error('Unknown line ' + (i + 1) + ' ' + JSON.stringify(_line));\n\t      } else {\n\t        i++;\n\t      }\n\t    }\n\t  }\n\n\t  // Parses the --- and +++ headers, if none are found, no lines\n\t  // are consumed.\n\t  function parseFileHeader(index) {\n\t    var fileHeader = /^(---|\\+\\+\\+)\\s+(.*)$/.exec(diffstr[i]);\n\t    if (fileHeader) {\n\t      var keyPrefix = fileHeader[1] === '---' ? 'old' : 'new';\n\t      var data = fileHeader[2].split('\\t', 2);\n\t      var fileName = data[0].replace(/\\\\\\\\/g, '\\\\');\n\t      if (/^\".*\"$/.test(fileName)) {\n\t        fileName = fileName.substr(1, fileName.length - 2);\n\t      }\n\t      index[keyPrefix + 'FileName'] = fileName;\n\t      index[keyPrefix + 'Header'] = (data[1] || '').trim();\n\n\t      i++;\n\t    }\n\t  }\n\n\t  // Parses a hunk\n\t  // This assumes that we are at the start of a hunk.\n\t  function parseHunk() {\n\t    var chunkHeaderIndex = i,\n\t        chunkHeaderLine = diffstr[i++],\n\t        chunkHeader = chunkHeaderLine.split(/@@ -(\\d+)(?:,(\\d+))? \\+(\\d+)(?:,(\\d+))? @@/);\n\n\t    var hunk = {\n\t      oldStart: +chunkHeader[1],\n\t      oldLines: +chunkHeader[2] || 1,\n\t      newStart: +chunkHeader[3],\n\t      newLines: +chunkHeader[4] || 1,\n\t      lines: [],\n\t      linedelimiters: []\n\t    };\n\n\t    var addCount = 0,\n\t        removeCount = 0;\n\t    for (; i < diffstr.length; i++) {\n\t      // Lines starting with '---' could be mistaken for the \"remove line\" operation\n\t      // But they could be the header for the next file. Therefore prune such cases out.\n\t      if (diffstr[i].indexOf('--- ') === 0 && i + 2 < diffstr.length && diffstr[i + 1].indexOf('+++ ') === 0 && diffstr[i + 2].indexOf('@@') === 0) {\n\t        break;\n\t      }\n\t      var operation = diffstr[i].length == 0 && i != diffstr.length - 1 ? ' ' : diffstr[i][0];\n\n\t      if (operation === '+' || operation === '-' || operation === ' ' || operation === '\\\\') {\n\t        hunk.lines.push(diffstr[i]);\n\t        hunk.linedelimiters.push(delimiters[i] || '\\n');\n\n\t        if (operation === '+') {\n\t          addCount++;\n\t        } else if (operation === '-') {\n\t          removeCount++;\n\t        } else if (operation === ' ') {\n\t          addCount++;\n\t          removeCount++;\n\t        }\n\t      } else {\n\t        break;\n\t      }\n\t    }\n\n\t    // Handle the empty block count case\n\t    if (!addCount && hunk.newLines === 1) {\n\t      hunk.newLines = 0;\n\t    }\n\t    if (!removeCount && hunk.oldLines === 1) {\n\t      hunk.oldLines = 0;\n\t    }\n\n\t    // Perform optional sanity checking\n\t    if (options.strict) {\n\t      if (addCount !== hunk.newLines) {\n\t        throw new Error('Added line count did not match for hunk at line ' + (chunkHeaderIndex + 1));\n\t      }\n\t      if (removeCount !== hunk.oldLines) {\n\t        throw new Error('Removed line count did not match for hunk at line ' + (chunkHeaderIndex + 1));\n\t      }\n\t    }\n\n\t    return hunk;\n\t  }\n\n\t  while (i < diffstr.length) {\n\t    parseIndex();\n\t  }\n\n\t  return list;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYXRjaC9wYXJzZS5qcyJdLCJuYW1lcyI6WyJwYXJzZVBhdGNoIiwidW5pRGlmZiIsIm9wdGlvbnMiLCJkaWZmc3RyIiwic3BsaXQiLCJkZWxpbWl0ZXJzIiwibWF0Y2giLCJsaXN0IiwiaSIsInBhcnNlSW5kZXgiLCJpbmRleCIsInB1c2giLCJsZW5ndGgiLCJsaW5lIiwidGVzdCIsImhlYWRlciIsImV4ZWMiLCJwYXJzZUZpbGVIZWFkZXIiLCJodW5rcyIsInBhcnNlSHVuayIsInN0cmljdCIsIkVycm9yIiwiSlNPTiIsInN0cmluZ2lmeSIsImZpbGVIZWFkZXIiLCJrZXlQcmVmaXgiLCJkYXRhIiwiZmlsZU5hbWUiLCJyZXBsYWNlIiwic3Vic3RyIiwidHJpbSIsImNodW5rSGVhZGVySW5kZXgiLCJjaHVua0hlYWRlckxpbmUiLCJjaHVua0hlYWRlciIsImh1bmsiLCJvbGRTdGFydCIsIm9sZExpbmVzIiwibmV3U3RhcnQiLCJuZXdMaW5lcyIsImxpbmVzIiwibGluZWRlbGltaXRlcnMiLCJhZGRDb3VudCIsInJlbW92ZUNvdW50IiwiaW5kZXhPZiIsIm9wZXJhdGlvbiJdLCJtYXBwaW5ncyI6Ijs7O2dDQUFnQkEsVSxHQUFBQSxVO0FBQVQsU0FBU0EsVUFBVCxDQUFvQkMsT0FBcEIsRUFBMkM7QUFBQSxzREFBZEMsT0FBYyx1RUFBSixFQUFJOztBQUNoRCxNQUFJQyxVQUFVRixRQUFRRyxLQUFSLENBQWMscUJBQWQsQ0FBZDtBQUFBLE1BQ0lDLGFBQWFKLFFBQVFLLEtBQVIsQ0FBYyxzQkFBZCxLQUF5QyxFQUQxRDtBQUFBLE1BRUlDLE9BQU8sRUFGWDtBQUFBLE1BR0lDLElBQUksQ0FIUjs7QUFLQSxXQUFTQyxVQUFULEdBQXNCO0FBQ3BCLFFBQUlDLFFBQVEsRUFBWjtBQUNBSCxTQUFLSSxJQUFMLENBQVVELEtBQVY7O0FBRUE7QUFDQSxXQUFPRixJQUFJTCxRQUFRUyxNQUFuQixFQUEyQjtBQUN6QixVQUFJQyxPQUFPVixRQUFR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QW9CO0FBQ2xCLFVBQUlxQixhQUFhUCxLQUFLSSxRQUF0QixFQUFnQztBQUM5QixjQUFNLElBQUlqQixLQUFKLENBQVUsc0RBQXNEVSxtQkFBbUIsQ0FBekUsQ0FBVixDQUFOO0FBQ0Q7QUFDRCxVQUFJVyxnQkFBZ0JSLEtBQUtFLFFBQXpCLEVBQW1DO0FBQ2pDLGNBQU0sSUFBSWYsS0FBSixDQUFVLHdEQUF3RFUsbUJBQW1CLENBQTNFLENBQVYsQ0FBTjtBQUNEO0FBQ0Y7O0FBRUQsV0FBT0csSUFBUDtBQUNEOztBQUVELFNBQU8xQixJQUFJTCxRQUFRUyxNQUFuQixFQUEyQjtBQUN6Qkg7QUFDRDs7QUFFRCxTQUFPRixJQUFQO0FBQ0QiLCJmaWxlIjoicGFyc2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gcGFyc2VQYXRjaCh1bmlEaWZmLCBvcHRpb25zID0ge30pIHtcbiAgbGV0IGRpZmZzdHIgPSB1bmlEaWZmLnNwbGl0KC9cXHJcXG58W1xcblxcdlxcZlxcclxceDg1XS8pLFxuICAgICAgZGVsaW1pdGVycyA9IHVuaURpZmYubWF0Y2goL1xcclxcbnxbXFxuXFx2XFxmXFxyXFx4ODVdL2cpIHx8IFtdLFxuICAgICAgbGlzdCA9IFtdLFxuICAgICAgaSA9IDA7XG5cbiAgZnVuY3Rpb24gcGFyc2VJbmRleCgpIHtcbiAgICBsZXQgaW5kZXggPSB7fTtcbiAgICBsaXN0LnB1c2goaW5kZXgpO1xuXG4gICAgLy8gUGFyc2UgZGlmZiBtZXRhZGF0YVxuICAgIHdoaWxlIChpIDwgZGlmZnN0ci5sZW5ndGgpIHtcbiAgICAgIGxldCBsaW5lID0gZGlmZnN0cltpXTtcblxuICAgICAgLy8gRmlsZSBoZWFkZXIgZm91bmQsIGVuZCBwYXJzaW5nIGRpZmYgbWV0YWRhdGFcbiAgICAgIGlmICgvXihcXC1cXC1cXC18XFwrXFwrXFwrfEBAKVxccy8udGVzdChsaW5lKSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgLy8gRGlmZiBpbmRleFxuICAgICAgbGV0IGhlYWRlciA9ICgvXig/OkluZGV4OnxkaWZmKD86IC1yIFxcdyspKylcXHMrKC4rPylcXHMqJC8pLmV4ZWMobGluZSk7XG4gICAgICBpZiAoaGVhZGVyKSB7XG4gICAgICAgIGluZGV4LmluZGV4ID0gaGVhZGVyWzFdO1xuICAgICAgfVxuXG4gICAgICBpKys7XG4gICAgfVxuXG4gICAgLy8gUGFyc2UgZmlsZSBoZWFkZXJzIGlmIHRoZXkgYXJlIGRlZmluZWQuIFVuaWZpZWQgZGlmZiByZXF1aXJlcyB0aGVtLCBidXRcbiAgICAvLyB0aGVyZSdzIG5vIHRlY2huaWNhbCBpc3N1ZXMgdG8gaGF2ZSBhbiBpc29sYXRlZCBodW5rIHdpdGhvdXQgZmlsZSBoZWFkZXJcbiAgICBwYXJzZUZpbGVIZWFkZXIoaW5kZXgpO1xuICAgIHBhcnNlRmlsZUhlYWRlcihpbmRleCk7XG5cbiAgICAvLyBQYXJzZSBodW5rc1xuICAgIGluZGV4Lmh1bmtzID0gW107XG5cbiAgICB3aGlsZSAoaSA8IGRpZmZzdHIubGVuZ3RoKSB7XG4gICAgICBsZXQgbGluZSA9IGRpZmZzdHJbaV07XG5cbiAgICAgIGlmICgvXihJbmRleDp8ZGlmZnxcXC1cXC1cXC18XFwrXFwrXFwrKVxccy8udGVzdChsaW5lKSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSBpZiAoL15AQC8udGVzdChsaW5lKSkge1xuICAgICAgICBpbmRleC5odW5rcy5wdXNoKHBhcnNlSHVuaygpKTtcbiAgICAgIH0gZWxzZSBpZiAobGluZSAmJiBvcHRpb25zLnN0cmljdCkge1xuICAgICAgICAvLyBJZ25vcmUgdW5leHBlY3RlZCBjb250ZW50IHVubGVzcyBpbiBzdHJpY3QgbW9kZVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gbGluZSAnICsgKGkgKyAxKSArICcgJyArIEpTT04uc3RyaW5naWZ5KGxpbmUpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGkrKztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBQYXJzZXMgdGhlIC0tLSBhbmQgKysrIGhlYWRlcnMsIGlmIG5vbmUgYXJlIGZvdW5kLCBubyBsaW5lc1xuICAvLyBhcmUgY29uc3VtZWQuXG4gIGZ1bmN0aW9uIHBhcnNlRmlsZUhlYWRlcihpbmRleCkge1xuICAgIGNvbnN0IGZpbGVIZWFkZXIgPSAoL14oLS0tfFxcK1xcK1xcKylcXHMrKC4qKSQvKS5leGVjKGRpZmZzdHJbaV0pO1xuICAgIGlmIChmaWxlSGVhZGVyKSB7XG4gICAgICBsZXQga2V5UHJlZml4ID0gZmlsZUhlYWRlclsxXSA9PT0gJy0tLScgPyAnb2xkJyA6ICduZXcnO1xuICAgICAgY29uc3QgZGF0YSA9IGZpbGVIZWFkZXJbMl0uc3BsaXQoJ1xcdCcsIDIpO1xuICAgICAgbGV0IGZpbGVOYW1lID0gZGF0YVswXS5yZXBsYWNlKC9cXFxcXFxcXC9nLCAnXFxcXCcpO1xuICAgICAgaWYgKC9eXCIuKlwiJC8udGVzdChmaWxlTmFtZSkpIHtcbiAgICAgICAgZmlsZU5hbWUgPSBmaWxlTmFtZS5zdWJzdHIoMSwgZmlsZU5hbWUubGVuZ3RoIC0gMik7XG4gICAgICB9XG4gICAgICBpbmRleFtrZXlQcmVmaXggKyAnRmlsZU5hbWUnXSA9IGZpbGVOYW1lO1xuICAgICAgaW5kZXhba2V5UHJlZml4ICsgJ0hlYWRlciddID0gKGRhdGFbMV0gfHwgJycpLnRyaW0oKTtcblxuICAgICAgaSsrO1xuICAgIH1cbiAgfVxuXG4gIC8vIFBhcnNlcyBhIGh1bmtcbiAgLy8gVGhpcyBhc3N1bWVzIHRoYXQgd2UgYXJlIGF0IHRoZSBzdGFydCBvZiBhIGh1bmsuXG4gIGZ1bmN0aW9uIHBhcnNlSHVuaygpIHtcbiAgICBsZXQgY2h1bmtIZWFkZXJJbmRleCA9IGksXG4gICAgICAgIGNodW5rSGVhZGVyTGluZSA9IGRpZmZzdHJbaSsrXSxcbiAgICAgICAgY2h1bmtIZWFkZXIgPSBjaHVua0hlYWRlckxpbmUuc3BsaXQoL0BAIC0oXFxkKykoPzosKFxcZCspKT8gXFwrKFxcZCspKD86LChcXGQrKSk/IEBALyk7XG5cbiAgICBsZXQgaHVuayA9IHtcbiAgICAgIG9sZFN0YXJ0OiArY2h1bmtIZWFkZXJbMV0sXG4gICAgICBvbGRMaW5lczogK2NodW5rSGVhZGVyWzJdIHx8IDEsXG4gICAgICBuZXdTdGFydDogK2NodW5rSGVhZGVyWzNdLFxuICAgICAgbmV3TGluZXM6ICtjaHVua0hlYWRlcls0XSB8fCAxLFxuICAgICAgbGluZXM6IFtdLFxuICAgICAgbGluZWRlbGltaXRlcnM6IFtdXG4gICAgfTtcblxuICAgIGxldCBhZGRDb3VudCA9IDAsXG4gICAgICAgIHJlbW92ZUNvdW50ID0gMDtcbiAgICBmb3IgKDsgaSA8IGRpZmZzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgIC8vIExpbmVzIHN0YXJ0aW5nIHdpdGggJy0tLScgY291bGQgYmUgbWlzdGFrZW4gZm9yIHRoZSBcInJlbW92ZSBsaW5lXCIgb3BlcmF0aW9uXG4gICAgICAvLyBCdXQgdGhleSBjb3VsZCBiZSB0aGUgaGVhZGVyIGZvciB0aGUgbmV4dCBmaWxlLiBUaGVyZWZvcmUgcHJ1bmUgc3VjaCBjYXNlcyBvdXQuXG4gICAgICBpZiAoZGlmZnN0cltpXS5pbmRleE9mKCctLS0gJykgPT09IDBcbiAgICAgICAgICAgICYmIChpICsgMiA8IGRpZmZzdHIubGVuZ3RoKVxuICAgICAgICAgICAgJiYgZGlmZnN0cltpICsgMV0uaW5kZXhPZignKysrICcpID09PSAwXG4gICAgICAgICAgICAmJiBkaWZmc3RyW2kgKyAyXS5pbmRleE9mKCdAQCcpID09PSAwKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBsZXQgb3BlcmF0aW9uID0gKGRpZmZzdHJbaV0ubGVuZ3RoID09IDAgJiYgaSAhPSAoZGlmZnN0ci5sZW5ndGggLSAxKSkgPyAnICcgOiBkaWZmc3RyW2ldWzBdO1xuXG4gICAgICBpZiAob3BlcmF0aW9uID09PSAnKycgfHwgb3BlcmF0aW9uID09PSAnLScgfHwgb3BlcmF0aW9uID09PSAnICcgfHwgb3BlcmF0aW9uID09PSAnXFxcXCcpIHtcbiAgICAgICAgaHVuay5saW5lcy5wdXNoKGRpZmZzdHJbaV0pO1xuICAgICAgICBodW5rLmxpbmVkZWxpbWl0ZXJzLnB1c2goZGVsaW1pdGVyc1tpXSB8fCAnXFxuJyk7XG5cbiAgICAgICAgaWYgKG9wZXJhdGlvbiA9PT0gJysnKSB7XG4gICAgICAgICAgYWRkQ291bnQrKztcbiAgICAgICAgfSBlbHNlIGlmIChvcGVyYXRpb24gPT09ICctJykge1xuICAgICAgICAgIHJlbW92ZUNvdW50Kys7XG4gICAgICAgIH0gZWxzZSBpZiAob3BlcmF0aW9uID09PSAnICcpIHtcbiAgICAgICAgICBhZGRDb3VudCsrO1xuICAgICAgICAgIHJlbW92ZUNvdW50Kys7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhhbmRsZSB0aGUgZW1wdHkgYmxvY2sgY291bnQgY2FzZVxuICAgIGlmICghYWRkQ291bnQgJiYgaHVuay5uZXdMaW5lcyA9PT0gMSkge1xuICAgICAgaHVuay5uZXdMaW5lcyA9IDA7XG4gICAgfVxuICAgIGlmICghcmVtb3ZlQ291bnQgJiYgaHVuay5vbGRMaW5lcyA9PT0gMSkge1xuICAgICAgaHVuay5vbGRMaW5lcyA9IDA7XG4gICAgfVxuXG4gICAgLy8gUGVyZm9ybSBvcHRpb25hbCBzYW5pdHkgY2hlY2tpbmdcbiAgICBpZiAob3B0aW9ucy5zdHJpY3QpIHtcbiAgICAgIGlmIChhZGRDb3VudCAhPT0gaHVuay5uZXdMaW5lcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FkZGVkIGxpbmUgY291bnQgZGlkIG5vdCBtYXRjaCBmb3IgaHVuayBhdCBsaW5lICcgKyAoY2h1bmtIZWFkZXJJbmRleCArIDEpKTtcbiAgICAgIH1cbiAgICAgIGlmIChyZW1vdmVDb3VudCAhPT0gaHVuay5vbGRMaW5lcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlbW92ZWQgbGluZSBjb3VudCBkaWQgbm90IG1hdGNoIGZvciBodW5rIGF0IGxpbmUgJyArIChjaHVua0hlYWRlckluZGV4ICsgMSkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBodW5rO1xuICB9XG5cbiAgd2hpbGUgKGkgPCBkaWZmc3RyLmxlbmd0aCkge1xuICAgIHBhcnNlSW5kZXgoKTtcbiAgfVxuXG4gIHJldHVybiBsaXN0O1xufVxuIl19\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/\"use strict\";\n\n\texports.__esModule = true;\n\n\texports[\"default\"] = /*istanbul ignore end*/function (start, minLine, maxLine) {\n\t  var wantForward = true,\n\t      backwardExhausted = false,\n\t      forwardExhausted = false,\n\t      localOffset = 1;\n\n\t  return function iterator() {\n\t    if (wantForward && !forwardExhausted) {\n\t      if (backwardExhausted) {\n\t        localOffset++;\n\t      } else {\n\t        wantForward = false;\n\t      }\n\n\t      // Check if trying to fit beyond text length, and if not, check it fits\n\t      // after offset location (or desired location on first iteration)\n\t      if (start + localOffset <= maxLine) {\n\t        return localOffset;\n\t      }\n\n\t      forwardExhausted = true;\n\t    }\n\n\t    if (!backwardExhausted) {\n\t      if (!forwardExhausted) {\n\t        wantForward = true;\n\t      }\n\n\t      // Check if trying to fit before text beginning, and if not, check it fits\n\t      // before offset location\n\t      if (minLine <= start - localOffset) {\n\t        return -localOffset++;\n\t      }\n\n\t      backwardExhausted = true;\n\t      return iterator();\n\t    }\n\n\t    // We tried to fit hunk before text beginning and beyond text length, then\n\t    // hunk can't fit on the text. Return undefined\n\t  };\n\t};\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL2Rpc3RhbmNlLWl0ZXJhdG9yLmpzIl0sIm5hbWVzIjpbInN0YXJ0IiwibWluTGluZSIsIm1heExpbmUiLCJ3YW50Rm9yd2FyZCIsImJhY2t3YXJkRXhoYXVzdGVkIiwiZm9yd2FyZEV4aGF1c3RlZCIsImxvY2FsT2Zmc2V0IiwiaXRlcmF0b3IiXSwibWFwcGluZ3MiOiI7Ozs7NENBR2UsVUFBU0EsS0FBVCxFQUFnQkMsT0FBaEIsRUFBeUJDLE9BQXpCLEVBQWtDO0FBQy9DLE1BQUlDLGNBQWMsSUFBbEI7QUFBQSxNQUNJQyxvQkFBb0IsS0FEeEI7QUFBQSxNQUVJQyxtQkFBbUIsS0FGdkI7QUFBQSxNQUdJQyxjQUFjLENBSGxCOztBQUtBLFNBQU8sU0FBU0MsUUFBVCxHQUFvQjtBQUN6QixRQUFJSixlQUFlLENBQUNFLGdCQUFwQixFQUFzQztBQUNwQyxVQUFJRCxpQkFBSixFQUF1QjtBQUNyQkU7QUFDRCxPQUZELE1BRU87QUFDTEgsc0JBQWMsS0FBZDtBQUNEOztBQUVEO0FBQ0E7QUFDQSxVQUFJSCxRQUFRTSxXQUFSLElBQXVCSixPQUEzQixFQUFvQztBQUNsQyxlQUFPSSxXQUFQO0FBQ0Q7O0FBRURELHlCQUFtQixJQUFuQjtBQUNEOztBQUVELFFBQUksQ0FBQ0QsaUJBQUwsRUFBd0I7QUFDdEIsVUFBSSxDQUFDQyxnQkFBTCxFQUF1QjtBQUNyQkYsc0JBQWMsSUFBZDtBQUNEOztBQUVEO0FBQ0E7QUFDQSxVQUFJRixXQUFXRCxRQUFRTSxXQUF2QixFQUFvQztBQUNsQyxlQUFPLENBQUNBLGFBQVI7QUFDRDs7QUFFREYsMEJBQW9CLElBQXBCO0FBQ0EsYUFBT0csVUFBUDtBQUNEOztBQUVEO0FBQ0E7QUFDRCxHQWxDRDtBQW1DRCxDIiwiZmlsZSI6ImRpc3RhbmNlLWl0ZXJhdG9yLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gSXRlcmF0b3IgdGhhdCB0cmF2ZXJzZXMgaW4gdGhlIHJhbmdlIG9mIFttaW4sIG1heF0sIHN0ZXBwaW5nXG4vLyBieSBkaXN0YW5jZSBmcm9tIGEgZ2l2ZW4gc3RhcnQgcG9zaXRpb24uIEkuZS4gZm9yIFswLCA0XSwgd2l0aFxuLy8gc3RhcnQgb2YgMiwgdGhpcyB3aWxsIGl0ZXJhdGUgMiwgMywgMSwgNCwgMC5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHN0YXJ0LCBtaW5MaW5lLCBtYXhMaW5lKSB7XG4gIGxldCB3YW50Rm9yd2FyZCA9IHRydWUsXG4gICAgICBiYWNrd2FyZEV4aGF1c3RlZCA9IGZhbHNlLFxuICAgICAgZm9yd2FyZEV4aGF1c3RlZCA9IGZhbHNlLFxuICAgICAgbG9jYWxPZmZzZXQgPSAxO1xuXG4gIHJldHVybiBmdW5jdGlvbiBpdGVyYXRvcigpIHtcbiAgICBpZiAod2FudEZvcndhcmQgJiYgIWZvcndhcmRFeGhhdXN0ZWQpIHtcbiAgICAgIGlmIChiYWNrd2FyZEV4aGF1c3RlZCkge1xuICAgICAgICBsb2NhbE9mZnNldCsrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgd2FudEZvcndhcmQgPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdHJ5aW5nIHRvIGZpdCBiZXlvbmQgdGV4dCBsZW5ndGgsIGFuZCBpZiBub3QsIGNoZWNrIGl0IGZpdHNcbiAgICAgIC8vIGFmdGVyIG9mZnNldCBsb2NhdGlvbiAob3IgZGVzaXJlZCBsb2NhdGlvbiBvbiBmaXJzdCBpdGVyYXRpb24pXG4gICAgICBpZiAoc3RhcnQgKyBsb2NhbE9mZnNldCA8PSBtYXhMaW5lKSB7XG4gICAgICAgIHJldHVybiBsb2NhbE9mZnNldDtcbiAgICAgIH1cblxuICAgICAgZm9yd2FyZEV4aGF1c3RlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKCFiYWNrd2FyZEV4aGF1c3RlZCkge1xuICAgICAgaWYgKCFmb3J3YXJkRXhoYXVzdGVkKSB7XG4gICAgICAgIHdhbnRGb3J3YXJkID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdHJ5aW5nIHRvIGZpdCBiZWZvcmUgdGV4dCBiZWdpbm5pbmcsIGFuZCBpZiBub3QsIGNoZWNrIGl0IGZpdHNcbiAgICAgIC8vIGJlZm9yZSBvZmZzZXQgbG9jYXRpb25cbiAgICAgIGlmIChtaW5MaW5lIDw9IHN0YXJ0IC0gbG9jYWxPZmZzZXQpIHtcbiAgICAgICAgcmV0dXJuIC1sb2NhbE9mZnNldCsrO1xuICAgICAgfVxuXG4gICAgICBiYWNrd2FyZEV4aGF1c3RlZCA9IHRydWU7XG4gICAgICByZXR1cm4gaXRlcmF0b3IoKTtcbiAgICB9XG5cbiAgICAvLyBXZSB0cmllZCB0byBmaXQgaHVuayBiZWZvcmUgdGV4dCBiZWdpbm5pbmcgYW5kIGJleW9uZCB0ZXh0IGxlbmd0aCwgdGhlblxuICAgIC8vIGh1bmsgY2FuJ3QgZml0IG9uIHRoZSB0ZXh0LiBSZXR1cm4gdW5kZWZpbmVkXG4gIH07XG59XG4iXX0=\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/calcLineCount = calcLineCount;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/merge = merge;\n\n\tvar /*istanbul ignore start*/_create = __webpack_require__(14) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_parse = __webpack_require__(11) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_array = __webpack_require__(15) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n\t/*istanbul ignore end*/function calcLineCount(hunk) {\n\t  /*istanbul ignore start*/var _calcOldNewLineCount = /*istanbul ignore end*/calcOldNewLineCount(hunk.lines),\n\t      oldLines = _calcOldNewLineCount.oldLines,\n\t      newLines = _calcOldNewLineCount.newLines;\n\n\t  if (oldLines !== undefined) {\n\t    hunk.oldLines = oldLines;\n\t  } else {\n\t    delete hunk.oldLines;\n\t  }\n\n\t  if (newLines !== undefined) {\n\t    hunk.newLines = newLines;\n\t  } else {\n\t    delete hunk.newLines;\n\t  }\n\t}\n\n\tfunction merge(mine, theirs, base) {\n\t  mine = loadPatch(mine, base);\n\t  theirs = loadPatch(theirs, base);\n\n\t  var ret = {};\n\n\t  // For index we just let it pass through as it doesn't have any necessary meaning.\n\t  // Leaving sanity checks on this to the API consumer that may know more about the\n\t  // meaning in their own context.\n\t  if (mine.index || theirs.index) {\n\t    ret.index = mine.index || theirs.index;\n\t  }\n\n\t  if (mine.newFileName || theirs.newFileName) {\n\t    if (!fileNameChanged(mine)) {\n\t      // No header or no change in ours, use theirs (and ours if theirs does not exist)\n\t      ret.oldFileName = theirs.oldFileName || mine.oldFileName;\n\t      ret.newFileName = theirs.newFileName || mine.newFileName;\n\t      ret.oldHeader = theirs.oldHeader || mine.oldHeader;\n\t      ret.newHeader = theirs.newHeader || mine.newHeader;\n\t    } else if (!fileNameChanged(theirs)) {\n\t      // No header or no change in theirs, use ours\n\t      ret.oldFileName = mine.oldFileName;\n\t      ret.newFileName = mine.newFileName;\n\t      ret.oldHeader = mine.oldHeader;\n\t      ret.newHeader = mine.newHeader;\n\t    } else {\n\t      // Both changed... figure it out\n\t      ret.oldFileName = selectField(ret, mine.oldFileName, theirs.oldFileName);\n\t      ret.newFileName = selectField(ret, mine.newFileName, theirs.newFileName);\n\t      ret.oldHeader = selectField(ret, mine.oldHeader, theirs.oldHeader);\n\t      ret.newHeader = selectField(ret, mine.newHeader, theirs.newHeader);\n\t    }\n\t  }\n\n\t  ret.hunks = [];\n\n\t  var mineIndex = 0,\n\t      theirsIndex = 0,\n\t      mineOffset = 0,\n\t      theirsOffset = 0;\n\n\t  while (mineIndex < mine.hunks.length || theirsIndex < theirs.hunks.length) {\n\t    var mineCurrent = mine.hunks[mineIndex] || { oldStart: Infinity },\n\t        theirsCurrent = theirs.hunks[theirsIndex] || { oldStart: Infinity };\n\n\t    if (hunkBefore(mineCurrent, theirsCurrent)) {\n\t      // This patch does not overlap with any of the others, yay.\n\t      ret.hunks.push(cloneHunk(mineCurrent, mineOffset));\n\t      mineIndex++;\n\t      theirsOffset += mineCurrent.newLines - mineCurrent.oldLines;\n\t    } else if (hunkBefore(theirsCurrent, mineCurrent)) {\n\t      // This patch does not overlap with any of the others, yay.\n\t      ret.hunks.push(cloneHunk(theirsCurrent, theirsOffset));\n\t      theirsIndex++;\n\t      mineOffset += theirsCurrent.newLines - theirsCurrent.oldLines;\n\t    } else {\n\t      // Overlap, merge as best we can\n\t      var mergedHunk = {\n\t        oldStart: Math.min(mineCurrent.oldStart, theirsCurrent.oldStart),\n\t        oldLines: 0,\n\t        newStart: Math.min(mineCurrent.newStart + mineOffset, theirsCurrent.oldStart + theirsOffset),\n\t        newLines: 0,\n\t        lines: []\n\t      };\n\t      mergeLines(mergedHunk, mineCurrent.oldStart, mineCurrent.lines, theirsCurrent.oldStart, theirsCurrent.lines);\n\t      theirsIndex++;\n\t      mineIndex++;\n\n\t      ret.hunks.push(mergedHunk);\n\t    }\n\t  }\n\n\t  return ret;\n\t}\n\n\tfunction loadPatch(param, base) {\n\t  if (typeof param === 'string') {\n\t    if (/^@@/m.test(param) || /^Index:/m.test(param)) {\n\t      return (/*istanbul ignore start*/(0, _parse.parsePatch) /*istanbul ignore end*/(param)[0]\n\t      );\n\t    }\n\n\t    if (!base) {\n\t      throw new Error('Must provide a base reference or pass in a patch');\n\t    }\n\t    return (/*istanbul ignore start*/(0, _create.structuredPatch) /*istanbul ignore end*/(undefined, undefined, base, param)\n\t    );\n\t  }\n\n\t  return param;\n\t}\n\n\tfunction fileNameChanged(patch) {\n\t  return patch.newFileName && patch.newFileName !== patch.oldFileName;\n\t}\n\n\tfunction selectField(index, mine, theirs) {\n\t  if (mine === theirs) {\n\t    return mine;\n\t  } else {\n\t    index.conflict = true;\n\t    return { mine: mine, theirs: theirs };\n\t  }\n\t}\n\n\tfunction hunkBefore(test, check) {\n\t  return test.oldStart < check.oldStart && test.oldStart + test.oldLines < check.oldStart;\n\t}\n\n\tfunction cloneHunk(hunk, offset) {\n\t  return {\n\t    oldStart: hunk.oldStart, oldLines: hunk.oldLines,\n\t    newStart: hunk.newStart + offset, newLines: hunk.newLines,\n\t    lines: hunk.lines\n\t  };\n\t}\n\n\tfunction mergeLines(hunk, mineOffset, mineLines, theirOffset, theirLines) {\n\t  // This will generally result in a conflicted hunk, but there are cases where the context\n\t  // is the only overlap where we can successfully merge the content here.\n\t  var mine = { offset: mineOffset, lines: mineLines, index: 0 },\n\t      their = { offset: theirOffset, lines: theirLines, index: 0 };\n\n\t  // Handle any leading content\n\t  insertLeading(hunk, mine, their);\n\t  insertLeading(hunk, their, mine);\n\n\t  // Now in the overlap content. Scan through and select the best changes from each.\n\t  while (mine.index < mine.lines.length && their.index < their.lines.length) {\n\t    var mineCurrent = mine.lines[mine.index],\n\t        theirCurrent = their.lines[their.index];\n\n\t    if ((mineCurrent[0] === '-' || mineCurrent[0] === '+') && (theirCurrent[0] === '-' || theirCurrent[0] === '+')) {\n\t      // Both modified ...\n\t      mutualChange(hunk, mine, their);\n\t    } else if (mineCurrent[0] === '+' && theirCurrent[0] === ' ') {\n\t      /*istanbul ignore start*/var _hunk$lines;\n\n\t      /*istanbul ignore end*/ // Mine inserted\n\t      /*istanbul ignore start*/(_hunk$lines = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/collectChange(mine)));\n\t    } else if (theirCurrent[0] === '+' && mineCurrent[0] === ' ') {\n\t      /*istanbul ignore start*/var _hunk$lines2;\n\n\t      /*istanbul ignore end*/ // Theirs inserted\n\t      /*istanbul ignore start*/(_hunk$lines2 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines2 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/collectChange(their)));\n\t    } else if (mineCurrent[0] === '-' && theirCurrent[0] === ' ') {\n\t      // Mine removed or edited\n\t      removal(hunk, mine, their);\n\t    } else if (theirCurrent[0] === '-' && mineCurrent[0] === ' ') {\n\t      // Their removed or edited\n\t      removal(hunk, their, mine, true);\n\t    } else if (mineCurrent === theirCurrent) {\n\t      // Context identity\n\t      hunk.lines.push(mineCurrent);\n\t      mine.index++;\n\t      their.index++;\n\t    } else {\n\t      // Context mismatch\n\t      conflict(hunk, collectChange(mine), collectChange(their));\n\t    }\n\t  }\n\n\t  // Now push anything that may be remaining\n\t  insertTrailing(hunk, mine);\n\t  insertTrailing(hunk, their);\n\n\t  calcLineCount(hunk);\n\t}\n\n\tfunction mutualChange(hunk, mine, their) {\n\t  var myChanges = collectChange(mine),\n\t      theirChanges = collectChange(their);\n\n\t  if (allRemoves(myChanges) && allRemoves(theirChanges)) {\n\t    // Special case for remove changes that are supersets of one another\n\t    if ( /*istanbul ignore start*/(0, _array.arrayStartsWith) /*istanbul ignore end*/(myChanges, theirChanges) && skipRemoveSuperset(their, myChanges, myChanges.length - theirChanges.length)) {\n\t      /*istanbul ignore start*/var _hunk$lines3;\n\n\t      /*istanbul ignore end*/ /*istanbul ignore start*/(_hunk$lines3 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines3 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/myChanges));\n\t      return;\n\t    } else if ( /*istanbul ignore start*/(0, _array.arrayStartsWith) /*istanbul ignore end*/(theirChanges, myChanges) && skipRemoveSuperset(mine, theirChanges, theirChanges.length - myChanges.length)) {\n\t      /*istanbul ignore start*/var _hunk$lines4;\n\n\t      /*istanbul ignore end*/ /*istanbul ignore start*/(_hunk$lines4 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines4 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/theirChanges));\n\t      return;\n\t    }\n\t  } else if ( /*istanbul ignore start*/(0, _array.arrayEqual) /*istanbul ignore end*/(myChanges, theirChanges)) {\n\t    /*istanbul ignore start*/var _hunk$lines5;\n\n\t    /*istanbul ignore end*/ /*istanbul ignore start*/(_hunk$lines5 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines5 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/myChanges));\n\t    return;\n\t  }\n\n\t  conflict(hunk, myChanges, theirChanges);\n\t}\n\n\tfunction removal(hunk, mine, their, swap) {\n\t  var myChanges = collectChange(mine),\n\t      theirChanges = collectContext(their, myChanges);\n\t  if (theirChanges.merged) {\n\t    /*istanbul ignore start*/var _hunk$lines6;\n\n\t    /*istanbul ignore end*/ /*istanbul ignore start*/(_hunk$lines6 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines6 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/theirChanges.merged));\n\t  } else {\n\t    conflict(hunk, swap ? theirChanges : myChanges, swap ? myChanges : theirChanges);\n\t  }\n\t}\n\n\tfunction conflict(hunk, mine, their) {\n\t  hunk.conflict = true;\n\t  hunk.lines.push({\n\t    conflict: true,\n\t    mine: mine,\n\t    theirs: their\n\t  });\n\t}\n\n\tfunction insertLeading(hunk, insert, their) {\n\t  while (insert.offset < their.offset && insert.index < insert.lines.length) {\n\t    var line = insert.lines[insert.index++];\n\t    hunk.lines.push(line);\n\t    insert.offset++;\n\t  }\n\t}\n\tfunction insertTrailing(hunk, insert) {\n\t  while (insert.index < insert.lines.length) {\n\t    var line = insert.lines[insert.index++];\n\t    hunk.lines.push(line);\n\t  }\n\t}\n\n\tfunction collectChange(state) {\n\t  var ret = [],\n\t      operation = state.lines[state.index][0];\n\t  while (state.index < state.lines.length) {\n\t    var line = state.lines[state.index];\n\n\t    // Group additions that are immediately after subtractions and treat them as one \"atomic\" modify change.\n\t    if (operation === '-' && line[0] === '+') {\n\t      operation = '+';\n\t    }\n\n\t    if (operation === line[0]) {\n\t      ret.push(line);\n\t      state.index++;\n\t    } else {\n\t      break;\n\t    }\n\t  }\n\n\t  return ret;\n\t}\n\tfunction collectContext(state, matchChanges) {\n\t  var changes = [],\n\t      merged = [],\n\t      matchIndex = 0,\n\t      contextChanges = false,\n\t      conflicted = false;\n\t  while (matchIndex < matchChanges.length && state.index < state.lines.length) {\n\t    var change = state.lines[state.index],\n\t        match = matchChanges[matchIndex];\n\n\t    // Once we've hit our add, then we are done\n\t    if (match[0] === '+') {\n\t      break;\n\t    }\n\n\t    contextChanges = contextChanges || change[0] !== ' ';\n\n\t    merged.push(match);\n\t    matchIndex++;\n\n\t    // Consume any additions in the other block as a conflict to attempt\n\t    // to pull in the remaining context after this\n\t    if (change[0] === '+') {\n\t      conflicted = true;\n\n\t      while (change[0] === '+') {\n\t        changes.push(change);\n\t        change = state.lines[++state.index];\n\t      }\n\t    }\n\n\t    if (match.substr(1) === change.substr(1)) {\n\t      changes.push(change);\n\t      state.index++;\n\t    } else {\n\t      conflicted = true;\n\t    }\n\t  }\n\n\t  if ((matchChanges[matchIndex] || '')[0] === '+' && contextChanges) {\n\t    conflicted = true;\n\t  }\n\n\t  if (conflicted) {\n\t    return changes;\n\t  }\n\n\t  while (matchIndex < matchChanges.length) {\n\t    merged.push(matchChanges[matchIndex++]);\n\t  }\n\n\t  return {\n\t    merged: merged,\n\t    changes: changes\n\t  };\n\t}\n\n\tfunction allRemoves(changes) {\n\t  return changes.reduce(function (prev, change) {\n\t    return prev && change[0] === '-';\n\t  }, true);\n\t}\n\tfunction skipRemoveSuperset(state, removeChanges, delta) {\n\t  for (var i = 0; i < delta; i++) {\n\t    var changeContent = removeChanges[removeChanges.length - delta + i].substr(1);\n\t    if (state.lines[state.index + i] !== ' ' + changeContent) {\n\t      return false;\n\t    }\n\t  }\n\n\t  state.index += delta;\n\t  return true;\n\t}\n\n\tfunction calcOldNewLineCount(lines) {\n\t  var oldLines = 0;\n\t  var newLines = 0;\n\n\t  lines.forEach(function (line) {\n\t    if (typeof line !== 'string') {\n\t      var myCount = calcOldNewLineCount(line.mine);\n\t      var theirCount = calcOldNewLineCount(line.theirs);\n\n\t      if (oldLines !== undefined) {\n\t        if (myCount.oldLines === theirCount.oldLines) {\n\t          oldLines += myCount.oldLines;\n\t        } else {\n\t          oldLines = undefined;\n\t        }\n\t      }\n\n\t      if (newLines !== undefined) {\n\t        if (myCount.newLines === theirCount.newLines) {\n\t          newLines += myCount.newLines;\n\t        } else {\n\t          newLines = undefined;\n\t        }\n\t      }\n\t    } else {\n\t      if (newLines !== undefined && (line[0] === '+' || line[0] === ' ')) {\n\t        newLines++;\n\t      }\n\t      if (oldLines !== undefined && (line[0] === '-' || line[0] === ' ')) {\n\t        oldLines++;\n\t      }\n\t    }\n\t  });\n\n\t  return { oldLines: oldLines, newLines: newLines };\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYXRjaC9tZXJnZS5qcyJdLCJuYW1lcyI6WyJjYWxjTGluZUNvdW50IiwibWVyZ2UiLCJodW5rIiwiY2FsY09sZE5ld0xpbmVDb3VudCIsImxpbmVzIiwib2xkTGluZXMiLCJuZXdMaW5lcyIsInVuZGVmaW5lZCIsIm1pbmUiLCJ0aGVpcnMiLCJiYXNlIiwibG9hZFBhdGNoIiwicmV0IiwiaW5kZXgiLCJuZXdGaWxlTmFtZSIsImZpbGVOYW1lQ2hhbmdlZCIsIm9sZEZpbGVOYW1lIiwib2xkSGVhZGVyIiwibmV3SGVhZGVyIiwic2VsZWN0RmllbGQiLCJodW5rcyIsIm1pbmVJbmRleCIsInRoZWlyc0luZGV4IiwibWluZU9mZnNldCIsInRoZWlyc09mZnNldCIsImxlbmd0aCIsIm1pbmVDdXJyZW50Iiwib2xkU3RhcnQiLCJJbmZpbml0eSIsInRoZWlyc0N1cnJlbnQiLCJodW5rQmVmb3JlIiwicHVzaCIsImNsb25lSHVuayIsIm1lcmdlZEh1bmsiLCJNYXRoIiwibWluIiwibmV3U3RhcnQiLCJtZXJnZUxpbmVzIiwicGFyYW0iLCJ0ZXN0IiwiRXJyb3IiLCJwYXRjaCIsImNvbmZsaWN0IiwiY2hlY2siLCJvZmZzZXQiLCJtaW5lTGluZXMiLCJ0aGVpck9mZnNldCIsInRoZWlyTGluZXMiLCJ0aGVpciIsImluc2VydExlYWRpbmciLCJ0aGVpckN1cnJlbnQiLCJtdXR1YWxDaGFuZ2UiLCJjb2xsZWN0Q2hhbmdlIiwicmVtb3ZhbCIsImluc2VydFRyYWlsaW5nIiwibXlDaGFuZ2VzIiwidGhlaXJDaGFuZ2VzIiwiYWxsUmVtb3ZlcyIsInNraXBSZW1vdmVTdXBlcnNldCIsInN3YXAiLCJjb2xsZWN0Q29udGV4dCIsIm1lcmdlZCIsImluc2VydCIsImxpbmUiLCJzdGF0ZSIsIm9wZXJhdGlvbiIsIm1hdGNoQ2hhbmdlcyIsImNoYW5nZXMiLCJtYXRjaEluZGV4IiwiY29udGV4dENoYW5nZXMiLCJjb25mbGljdGVkIiwiY2hhbmdlIiwibWF0Y2giLCJzdWJzdHIiLCJyZWR1Y2UiLCJwcmV2IiwicmVtb3ZlQ2hhbmdlcyIsImRlbHRhIiwiaSIsImNoYW5nZUNvbnRlbnQiLCJmb3JFYWNoIiwibXlDb3VudCIsInRoZWlyQ291bnQiXSwibWFwcGluZ3MiOiI7OztnQ0FLZ0JBLGEsR0FBQUEsYTt5REFnQkFDLEssR0FBQUEsSzs7QUFyQmhCOztBQUNBOztBQUVBOzs7O3VCQUVPLFNBQVNELGFBQVQsQ0FBdUJFLElBQXZCLEVBQTZCO0FBQUEsNkVBQ0xDLG9CQUFvQkQsS0FBS0UsS0FBekIsQ0FESztBQUFBLE1BQzNCQyxRQUQyQix3QkFDM0JBLFFBRDJCO0FBQUEsTUFDakJDLFFBRGlCLHdCQUNqQkEsUUFEaUI7O0FBR2xDLE1BQUlELGFBQWFFLFNBQWpCLEVBQTRCO0FBQzFCTCxTQUFLRyxRQUFMLEdBQWdCQSxRQUFoQjtBQUNELEdBRkQsTUFFTztBQUNMLFdBQU9ILEtBQUtHLFFBQVo7QUFDRDs7QUFFRCxNQUFJQyxhQUFhQyxTQUFqQixFQUE0QjtBQUMxQkwsU0FBS0ksUUFBTCxHQUFnQkEsUUFBaEI7QUFDRCxHQUZELE1BRU87QUFDTCxXQUFPSixLQUFLSSxRQUFaO0FBQ0Q7QUFDRjs7QUFFTSxTQUFTTCxLQUFULENBQWVPLElBQWYsRUFBcUJDLE1BQXJCLEVBQTZCQyxJQUE3QixFQUFtQztBQUN4Q0YsU0FBT0csVUFBVUgsSUFBVixFQUFnQkUsSUFBaEIsQ0FBUDtBQUNBRCxXQUFTRSxVQUFVRixNQUFWLEVBQWtCQyxJQUFsQixDQUFUOztBQUVBLE1BQUlFLE1BQU0sRUFBVjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFJSixLQUFLSyxLQUFMLElBQWNKLE9BQU9JLEtBQXpCLEVBQWdDO0FBQzlCRCxRQUFJQyxLQUFKLEdBQVlMLEtBQUtLLEtBQUwsSUFBY0osT0FBT0ksS0FBakM7QUFDRDs7QUFFRCxNQUFJTCxLQUFLTSxXQUFMLElBQW9CTCxPQUFPSyxXQUEvQixFQUE0QztBQUMxQyxRQUFJLENBQUNDLGdCQUFnQlAsSUFBaEIsQ0FBTCxF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Q0Q7QUFDRjs7QUFFRCxVQUFJRCxhQUFhQyxTQUFqQixFQUE0QjtBQUMxQixZQUFJMEUsUUFBUTNFLFFBQVIsS0FBcUI0RSxXQUFXNUUsUUFBcEMsRUFBOEM7QUFDNUNBLHNCQUFZMkUsUUFBUTNFLFFBQXBCO0FBQ0QsU0FGRCxNQUVPO0FBQ0xBLHFCQUFXQyxTQUFYO0FBQ0Q7QUFDRjtBQUNGLEtBbkJELE1BbUJPO0FBQ0wsVUFBSUQsYUFBYUMsU0FBYixLQUEyQndELEtBQUssQ0FBTCxNQUFZLEdBQVosSUFBbUJBLEtBQUssQ0FBTCxNQUFZLEdBQTFELENBQUosRUFBb0U7QUFDbEV6RDtBQUNEO0FBQ0QsVUFBSUQsYUFBYUUsU0FBYixLQUEyQndELEtBQUssQ0FBTCxNQUFZLEdBQVosSUFBbUJBLEtBQUssQ0FBTCxNQUFZLEdBQTFELENBQUosRUFBb0U7QUFDbEUxRDtBQUNEO0FBQ0Y7QUFDRixHQTVCRDs7QUE4QkEsU0FBTyxFQUFDQSxrQkFBRCxFQUFXQyxrQkFBWCxFQUFQO0FBQ0QiLCJmaWxlIjoibWVyZ2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge3N0cnVjdHVyZWRQYXRjaH0gZnJvbSAnLi9jcmVhdGUnO1xuaW1wb3J0IHtwYXJzZVBhdGNofSBmcm9tICcuL3BhcnNlJztcblxuaW1wb3J0IHthcnJheUVxdWFsLCBhcnJheVN0YXJ0c1dpdGh9IGZyb20gJy4uL3V0aWwvYXJyYXknO1xuXG5leHBvcnQgZnVuY3Rpb24gY2FsY0xpbmVDb3VudChodW5rKSB7XG4gIGNvbnN0IHtvbGRMaW5lcywgbmV3TGluZXN9ID0gY2FsY09sZE5ld0xpbmVDb3VudChodW5rLmxpbmVzKTtcblxuICBpZiAob2xkTGluZXMgIT09IHVuZGVmaW5lZCkge1xuICAgIGh1bmsub2xkTGluZXMgPSBvbGRMaW5lcztcbiAgfSBlbHNlIHtcbiAgICBkZWxldGUgaHVuay5vbGRMaW5lcztcbiAgfVxuXG4gIGlmIChuZXdMaW5lcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaHVuay5uZXdMaW5lcyA9IG5ld0xpbmVzO1xuICB9IGVsc2Uge1xuICAgIGRlbGV0ZSBodW5rLm5ld0xpbmVzO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXJnZShtaW5lLCB0aGVpcnMsIGJhc2UpIHtcbiAgbWluZSA9IGxvYWRQYXRjaChtaW5lLCBiYXNlKTtcbiAgdGhlaXJzID0gbG9hZFBhdGNoKHRoZWlycywgYmFzZSk7XG5cbiAgbGV0IHJldCA9IHt9O1xuXG4gIC8vIEZvciBpbmRleCB3ZSBqdXN0IGxldCBpdCBwYXNzIHRocm91Z2ggYXMgaXQgZG9lc24ndCBoYXZlIGFueSBuZWNlc3NhcnkgbWVhbmluZy5cbiAgLy8gTGVhdmluZyBzYW5pdHkgY2hlY2tzIG9uIHRoaXMgdG8gdGhlIEFQSSBjb25zdW1lciB0aGF0IG1heSBrbm93IG1vcmUgYWJvdXQgdGhlXG4gIC8vIG1lYW5pbmcgaW4gdGhlaXIgb3duIGNvbnRleHQuXG4gIGlmIChtaW5lLmluZGV4IHx8IHRoZWlycy5pbmRleCkge1xuICAgIHJldC5pbmRleCA9IG1pbmUuaW5kZXggfHwgdGhlaXJzLmluZGV4O1xuICB9XG5cbiAgaWYgKG1pbmUubmV3RmlsZU5hbWUgfHwgdGhlaXJzLm5ld0ZpbGVOYW1lKSB7XG4gICAgaWYgKCFmaWxlTmFtZUNoYW5nZWQobWluZSkpIHtcbiAgICAgIC8vIE5vIGhlYWRlciBvciBubyBjaGFuZ2UgaW4gb3VycywgdXNlIHRoZWlycyAoYW5kIG91cnMgaWYgdGhlaXJzIGRvZXMgbm90IGV4aXN0KVxuICAgICAgcmV0Lm9sZEZpbGVOYW1lID0gdGhlaXJzLm9sZEZpbGVOYW1lIHx8IG1pbmUub2xkRmlsZU5hbWU7XG4gICAgICByZXQubmV3RmlsZU5hbWUgPSB0aGVpcnMubmV3RmlsZU5hbWUgfHwgbWluZS5uZXdGaWxlTmFtZTtcbiAgICAgIHJldC5vbGRIZWFkZXIgPSB0aGVpcnMub2xkSGVhZGVyIHx8IG1pbmUub2xkSGVhZGVyO1xuICAgICAgcmV0Lm5ld0hlYWRlciA9IHRoZWlycy5uZXdIZWFkZXIgfHwgbWluZS5uZXdIZWFkZXI7XG4gICAgfSBlbHNlIGlmICghZmlsZU5hbWVDaGFuZ2VkKHRoZWlycykpIHtcbiAgICAgIC8vIE5vIGhlYWRlciBvciBubyBjaGFuZ2UgaW4gdGhlaXJzLCB1c2Ugb3Vyc1xuICAgICAgcmV0Lm9sZEZpbGVOYW1lID0gbWluZS5vbGRGaWxlTmFtZTtcbiAgICAgIHJldC5uZXdGaWxlTmFtZSA9IG1pbmUubmV3RmlsZU5hbWU7XG4gICAgICByZXQub2xkSGVhZGVyID0gbWluZS5vbGRIZWFkZXI7XG4gICAgICByZXQubmV3SGVhZGVyID0gbWluZS5uZXdIZWFkZXI7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEJvdGggY2hhbmdlZC4uLiBmaWd1cmUgaXQgb3V0XG4gICAgICByZXQub2xkRmlsZU5hbWUgPSBzZWxlY3RGaWVsZChyZXQsIG1pbmUub2xkRmlsZU5hbWUsIHRoZWlycy5vbGRGaWxlTmFtZSk7XG4gICAgICByZXQubmV3RmlsZU5hbWUgPSBzZWxlY3RGaWVsZChyZXQsIG1pbmUubmV3RmlsZU5hbWUsIHRoZWlycy5uZXdGaWxlTmFtZSk7XG4gICAgICByZXQub2xkSGVhZGVyID0gc2VsZWN0RmllbGQocmV0LCBtaW5lLm9sZEhlYWRlciwgdGhlaXJzLm9sZEhlYWRlcik7XG4gICAgICByZXQubmV3SGVhZGVyID0gc2VsZWN0RmllbGQocmV0LCBtaW5lLm5ld0hlYWRlciwgdGhlaXJzLm5ld0hlYWRlcik7XG4gICAgfVxuICB9XG5cbiAgcmV0Lmh1bmtzID0gW107XG5cbiAgbGV0IG1pbmVJbmRleCA9IDAsXG4gICAgICB0aGVpcnNJbmRleCA9IDAsXG4gICAgICBtaW5lT2Zmc2V0ID0gMCxcbiAgICAgIHRoZWlyc09mZnNldCA9IDA7XG5cbiAgd2hpbGUgKG1pbmVJbmRleCA8IG1pbmUuaHVua3MubGVuZ3RoIHx8IHRoZWlyc0luZGV4IDwgdGhlaXJzLmh1bmtzLmxlbmd0aCkge1xuICAgIGxldCBtaW5lQ3VycmVudCA9IG1pbmUuaHVua3NbbWluZUluZGV4XSB8fCB7b2xkU3RhcnQ6IEluZmluaXR5fSxcbiAgICAgICAgdGhlaXJzQ3VycmVudCA9IHRoZWlycy5odW5rc1t0aGVpcnNJbmRleF0gfHwge29sZFN0YXJ0OiBJbmZpbml0eX07XG5cbiAgICBpZiAoaHVua0JlZm9yZShtaW5lQ3VycmVudCwgdGhlaXJzQ3VycmVudCkpIHtcbiAgICAgIC8vIFRoaXMgcGF0Y2ggZG9lcyBub3Qgb3ZlcmxhcCB3aXRoIGFueSBvZiB0aGUgb3RoZXJzLCB5YXkuXG4gICAgICByZXQuaHVua3MucHVzaChjbG9uZUh1bmsobWluZUN1cnJlbnQsIG1pbmVPZmZzZXQpKTtcbiAgICAgIG1pbmVJbmRleCsrO1xuICAgICAgdGhlaXJzT2Zmc2V0ICs9IG1pbmVDdXJyZW50Lm5ld0xpbmVzIC0gbWluZUN1cnJlbnQub2xkTGluZXM7XG4gICAgfSBlbHNlIGlmIChodW5rQmVmb3JlKHRoZWlyc0N1cnJlbnQsIG1pbmVDdXJyZW50KSkge1xuICAgICAgLy8gVGhpcyBwYXRjaCBkb2VzIG5vdCBvdmVybGFwIHdpdGggYW55IG9mIHRoZSBvdGhlcnMsIHlheS5cbiAgICAgIHJldC5odW5rcy5wdXNoKGNsb25lSHVuayh0aGVpcnNDdXJyZW50LCB0aGVpcnNPZmZzZXQpKTtcbiAgICAgIHRoZWlyc0luZGV4Kys7XG4gICAgICBtaW5lT2Zmc2V0ICs9IHRoZWlyc0N1cnJlbnQubmV3TGluZXMgLSB0aGVpcnNDdXJyZW50Lm9sZExpbmVzO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBPdmVybGFwLCBtZXJnZSBhcyBiZXN0IHdlIGNhblxuICAgICAgbGV0IG1lcmdlZEh1bmsgPSB7XG4gICAgICAgIG9sZFN0YXJ0OiBNYXRoLm1pbihtaW5lQ3VycmVudC5vbGRTdGFydCwgdGhlaXJzQ3VycmVudC5vbGRTdGFydCksXG4gICAgICAgIG9sZExpbmVzOiAwLFxuICAgICAgICBuZXdTdGFydDogTWF0aC5taW4obWluZUN1cnJlbnQubmV3U3RhcnQgKyBtaW5lT2Zmc2V0LCB0aGVpcnNDdXJyZW50Lm9sZFN0YXJ0ICsgdGhlaXJzT2Zmc2V0KSxcbiAgICAgICAgbmV3TGluZXM6IDAsXG4gICAgICAgIGxpbmVzOiBbXVxuICAgICAgfTtcbiAgICAgIG1lcmdlTGluZXMobWVyZ2VkSHVuaywgbWluZUN1cnJlbnQub2xkU3RhcnQsIG1pbmVDdXJyZW50LmxpbmVzLCB0aGVpcnNDdXJyZW50Lm9sZFN0YXJ0LCB0aGVpcnNDdXJyZW50LmxpbmVzKTtcbiAgICAgIHRoZWlyc0luZGV4Kys7XG4gICAgICBtaW5lSW5kZXgrKztcblxuICAgICAgcmV0Lmh1bmtzLnB1c2gobWVyZ2VkSHVuayk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJldDtcbn1cblxuZnVuY3Rpb24gbG9hZFBhdGNoKHBhcmFtLCBiYXNlKSB7XG4gIGlmICh0eXBlb2YgcGFyYW0gPT09ICdzdHJpbmcnKSB7XG4gICAgaWYgKC9eQEAvbS50ZXN0KHBhcmFtKSB8fCAoL15JbmRleDovbS50ZXN0KHBhcmFtKSkpIHtcbiAgICAgIHJldHVybiBwYXJzZVBhdGNoKHBhcmFtKVswXTtcbiAgICB9XG5cbiAgICBpZiAoIWJhc2UpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTXVzdCBwcm92aWRlIGEgYmFzZSByZWZlcmVuY2Ugb3IgcGFzcyBpbiBhIHBhdGNoJyk7XG4gICAgfVxuICAgIHJldHVybiBzdHJ1Y3R1cmVkUGF0Y2godW5kZWZpbmVkLCB1bmRlZmluZWQsIGJhc2UsIHBhcmFtKTtcbiAgfVxuXG4gIHJldHVybiBwYXJhbTtcbn1cblxuZnVuY3Rpb24gZmlsZU5hbWVDaGFuZ2VkKHBhdGNoKSB7XG4gIHJldHVybiBwYXRjaC5uZXdGaWxlTmFtZSAmJiBwYXRjaC5uZXdGaWxlTmFtZSAhPT0gcGF0Y2gub2xkRmlsZU5hbWU7XG59XG5cbmZ1bmN0aW9uIHNlbGVjdEZpZWxkKGluZGV4LCBtaW5lLCB0aGVpcnMpIHtcbiAgaWYgKG1pbmUgPT09IHRoZWlycykge1xuICAgIHJldHVybiBtaW5lO1xuICB9IGVsc2Uge1xuICAgIGluZGV4LmNvbmZsaWN0ID0gdHJ1ZTtcbiAgICByZXR1cm4ge21pbmUsIHRoZWlyc307XG4gIH1cbn1cblxuZnVuY3Rpb24gaHVua0JlZm9yZSh0ZXN0LCBjaGVjaykge1xuICByZXR1cm4gdGVzdC5vbGRTdGFydCA8IGNoZWNrLm9sZFN0YXJ0XG4gICAgJiYgKHRlc3Qub2xkU3RhcnQgKyB0ZXN0Lm9sZExpbmVzKSA8IGNoZWNrLm9sZFN0YXJ0O1xufVxuXG5mdW5jdGlvbiBjbG9uZUh1bmsoaHVuaywgb2Zmc2V0KSB7XG4gIHJldHVybiB7XG4gICAgb2xkU3RhcnQ6IGh1bmsub2xkU3RhcnQsIG9sZExpbmVzOiBodW5rLm9sZExpbmVzLFxuICAgIG5ld1N0YXJ0OiBodW5rLm5ld1N0YXJ0ICsgb2Zmc2V0LCBuZXdMaW5lczogaHVuay5uZXdMaW5lcyxcbiAgICBsaW5lczogaHVuay5saW5lc1xuICB9O1xufVxuXG5mdW5jdGlvbiBtZXJnZUxpbmVzKGh1bmssIG1pbmVPZmZzZXQsIG1pbmVMaW5lcywgdGhlaXJPZmZzZXQsIHRoZWlyTGluZXMpIHtcbiAgLy8gVGhpcyB3aWxsIGdlbmVyYWxseSByZXN1bHQgaW4gYSBjb25mbGljdGVkIGh1bmssIGJ1dCB0aGVyZSBhcmUgY2FzZXMgd2hlcmUgdGhlIGNvbnRleHRcbiAgLy8gaXMgdGhlIG9ubHkgb3ZlcmxhcCB3aGVyZSB3ZSBjYW4gc3VjY2Vzc2Z1bGx5IG1lcmdlIHRoZSBjb250ZW50IGhlcmUuXG4gIGxldCBtaW5lID0ge29mZnNldDogbWluZU9mZnNldCwgbGluZXM6IG1pbmVMaW5lcywgaW5kZXg6IDB9LFxuICAgICAgdGhlaXIgPSB7b2Zmc2V0OiB0aGVpck9mZnNldCwgbGluZXM6IHRoZWlyTGluZXMsIGluZGV4OiAwfTtcblxuICAvLyBIYW5kbGUgYW55IGxlYWRpbmcgY29udGVudFxuICBpbnNlcnRMZWFkaW5nKGh1bmssIG1pbmUsIHRoZWlyKTtcbiAgaW5zZXJ0TGVhZGluZyhodW5rLCB0aGVpciwgbWluZSk7XG5cbiAgLy8gTm93IGluIHRoZSBvdmVybGFwIGNvbnRlbnQuIFNjYW4gdGhyb3VnaCBhbmQgc2VsZWN0IHRoZSBiZXN0IGNoYW5nZXMgZnJvbSBlYWNoLlxuICB3aGlsZSAobWluZS5pbmRleCA8IG1pbmUubGluZXMubGVuZ3RoICYmIHRoZWlyLmluZGV4IDwgdGhlaXIubGluZXMubGVuZ3RoKSB7XG4gICAgbGV0IG1pbmVDdXJyZW50ID0gbWluZS5saW5lc1ttaW5lLmluZGV4XSxcbiAgICAgICAgdGhlaXJDdXJyZW50ID0gdGhlaXIubGluZXNbdGhlaXIuaW5kZXhdO1xuXG4gICAgaWYgKChtaW5lQ3VycmVudFswXSA9PT0gJy0nIHx8IG1pbmVDdXJyZW50WzBdID09PSAnKycpXG4gICAgICAgICYmICh0aGVpckN1cnJlbnRbMF0gPT09ICctJyB8fCB0aGVpckN1cnJlbnRbMF0gPT09ICcrJykpIHtcbiAgICAgIC8vIEJvdGggbW9kaWZpZWQgLi4uXG4gICAgICBtdXR1YWxDaGFuZ2UoaHVuaywgbWluZSwgdGhlaXIpO1xuICAgIH0gZWxzZSBpZiAobWluZUN1cnJlbnRbMF0gPT09ICcrJyAmJiB0aGVpckN1cnJlbnRbMF0gPT09ICcgJykge1xuICAgICAgLy8gTWluZSBpbnNlcnRlZFxuICAgICAgaHVuay5saW5lcy5wdXNoKC4uLiBjb2xsZWN0Q2hhbmdlKG1pbmUpKTtcbiAgICB9IGVsc2UgaWYgKHRoZWlyQ3VycmVudFswXSA9PT0gJysnICYmIG1pbmVDdXJyZW50WzBdID09PSAnICcpIHtcbiAgICAgIC8vIFRoZWlycyBpbnNlcnRlZFxuICAgICAgaHVuay5saW5lcy5wdXNoKC4uLiBjb2xsZWN0Q2hhbmdlKHRoZWlyKSk7XG4gICAgfSBlbHNlIGlmIChtaW5lQ3VycmVudFswXSA9PT0gJy0nICYmIHRoZWlyQ3VycmVudFswXSA9PT0gJyAnKSB7XG4gICAgICAvLyBNaW5lIHJlbW92ZWQgb3IgZWRpdGVkXG4gICAgICByZW1vdmFsKGh1bmssIG1pbmUsIHRoZWlyKTtcbiAgICB9IGVsc2UgaWYgKHRoZWlyQ3VycmVudFswXSA9PT0gJy0nICYmIG1pbmVDdXJyZW50WzBdID09PSAnICcpIHtcbiAgICAgIC8vIFRoZWlyIHJlbW92ZWQgb3IgZWRpdGVkXG4gICAgICByZW1vdmFsKGh1bmssIHRoZWlyLCBtaW5lLCB0cnVlKTtcbiAgICB9IGVsc2UgaWYgKG1pbmVDdXJyZW50ID09PSB0aGVpckN1cnJlbnQpIHtcbiAgICAgIC8vIENvbnRleHQgaWRlbnRpdHlcbiAgICAgIGh1bmsubGluZXMucHVzaChtaW5lQ3VycmVudCk7XG4gICAgICBtaW5lLmluZGV4Kys7XG4gICAgICB0aGVpci5pbmRleCsrO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBDb250ZXh0IG1pc21hdGNoXG4gICAgICBjb25mbGljdChodW5rLCBjb2xsZWN0Q2hhbmdlKG1pbmUpLCBjb2xsZWN0Q2hhbmdlKHRoZWlyKSk7XG4gICAgfVxuICB9XG5cbiAgLy8gTm93IHB1c2ggYW55dGhpbmcgdGhhdCBtYXkgYmUgcmVtYWluaW5nXG4gIGluc2VydFRyYWlsaW5nKGh1bmssIG1pbmUpO1xuICBpbnNlcnRUcmFpbGluZyhodW5rLCB0aGVpcik7XG5cbiAgY2FsY0xpbmVDb3VudChodW5rKTtcbn1cblxuZnVuY3Rpb24gbXV0dWFsQ2hhbmdlKGh1bmssIG1pbmUsIHRoZWlyKSB7XG4gIGxldCBteUNoYW5nZXMgPSBjb2xsZWN0Q2hhbmdlKG1pbmUpLFxuICAgICAgdGhlaXJDaGFuZ2VzID0gY29sbGVjdENoYW5nZSh0aGVpcik7XG5cbiAgaWYgKGFsbFJlbW92ZXMobXlDaGFuZ2VzKSAmJiBhbGxSZW1vdmVzKHRoZWlyQ2hhbmdlcykpIHtcbiAgICAvLyBTcGVjaWFsIGNhc2UgZm9yIHJlbW92ZSBjaGFuZ2VzIHRoYXQgYXJlIHN1cGVyc2V0cyBvZiBvbmUgYW5vdGhlclxuICAgIGlmIChhcnJheVN0YXJ0c1dpdGgobXlDaGFuZ2VzLCB0aGVpckNoYW5nZXMpXG4gICAgICAgICYmIHNraXBSZW1vdmVTdXBlcnNldCh0aGVpciwgbXlDaGFuZ2VzLCBteUNoYW5nZXMubGVuZ3RoIC0gdGhlaXJDaGFuZ2VzLmxlbmd0aCkpIHtcbiAgICAgIGh1bmsubGluZXMucHVzaCguLi4gbXlDaGFuZ2VzKTtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKGFycmF5U3RhcnRzV2l0aCh0aGVpckNoYW5nZXMsIG15Q2hhbmdlcylcbiAgICAgICAgJiYgc2tpcFJlbW92ZVN1cGVyc2V0KG1pbmUsIHRoZWlyQ2hhbmdlcywgdGhlaXJDaGFuZ2VzLmxlbmd0aCAtIG15Q2hhbmdlcy5sZW5ndGgpKSB7XG4gICAgICBodW5rLmxpbmVzLnB1c2goLi4uIHRoZWlyQ2hhbmdlcyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9IGVsc2UgaWYgKGFycmF5RXF1YWwobXlDaGFuZ2VzLCB0aGVpckNoYW5nZXMpKSB7XG4gICAgaHVuay5saW5lcy5wdXNoKC4uLiBteUNoYW5nZXMpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbmZsaWN0KGh1bmssIG15Q2hhbmdlcywgdGhlaXJDaGFuZ2VzKTtcbn1cblxuZnVuY3Rpb24gcmVtb3ZhbChodW5rLCBtaW5lLCB0aGVpciwgc3dhcCkge1xuICBsZXQgbXlDaGFuZ2VzID0gY29sbGVjdENoYW5nZShtaW5lKSxcbiAgICAgIHRoZWlyQ2hhbmdlcyA9IGNvbGxlY3RDb250ZXh0KHRoZWlyLCBteUNoYW5nZXMpO1xuICBpZiAodGhlaXJDaGFuZ2VzLm1lcmdlZCkge1xuICAgIGh1bmsubGluZXMucHVzaCguLi4gdGhlaXJDaGFuZ2VzLm1lcmdlZCk7XG4gIH0gZWxzZSB7XG4gICAgY29uZmxpY3QoaHVuaywgc3dhcCA/IHRoZWlyQ2hhbmdlcyA6IG15Q2hhbmdlcywgc3dhcCA/IG15Q2hhbmdlcyA6IHRoZWlyQ2hhbmdlcyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY29uZmxpY3QoaHVuaywgbWluZSwgdGhlaXIpIHtcbiAgaHVuay5jb25mbGljdCA9IHRydWU7XG4gIGh1bmsubGluZXMucHVzaCh7XG4gICAgY29uZmxpY3Q6IHRydWUsXG4gICAgbWluZTogbWluZSxcbiAgICB0aGVpcnM6IHRoZWlyXG4gIH0pO1xufVxuXG5mdW5jdGlvbiBpbnNlcnRMZWFkaW5nKGh1bmssIGluc2VydCwgdGhlaXIpIHtcbiAgd2hpbGUgKGluc2VydC5vZmZzZXQgPCB0aGVpci5vZmZzZXQgJiYgaW5zZXJ0LmluZGV4IDwgaW5zZXJ0LmxpbmVzLmxlbmd0aCkge1xuICAgIGxldCBsaW5lID0gaW5zZXJ0LmxpbmVzW2luc2VydC5pbmRleCsrXTtcbiAgICBodW5rLmxpbmVzLnB1c2gobGluZSk7XG4gICAgaW5zZXJ0Lm9mZnNldCsrO1xuICB9XG59XG5mdW5jdGlvbiBpbnNlcnRUcmFpbGluZyhodW5rLCBpbnNlcnQpIHtcbiAgd2hpbGUgKGluc2VydC5pbmRleCA8IGluc2VydC5saW5lcy5sZW5ndGgpIHtcbiAgICBsZXQgbGluZSA9IGluc2VydC5saW5lc1tpbnNlcnQuaW5kZXgrK107XG4gICAgaHVuay5saW5lcy5wdXNoKGxpbmUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNvbGxlY3RDaGFuZ2Uoc3RhdGUpIHtcbiAgbGV0IHJldCA9IFtdLFxuICAgICAgb3BlcmF0aW9uID0gc3RhdGUubGluZXNbc3RhdGUuaW5kZXhdWzBdO1xuICB3aGlsZSAoc3RhdGUuaW5kZXggPCBzdGF0ZS5saW5lcy5sZW5ndGgpIHtcbiAgICBsZXQgbGluZSA9IHN0YXRlLmxpbmVzW3N0YXRlLmluZGV4XTtcblxuICAgIC8vIEdyb3VwIGFkZGl0aW9ucyB0aGF0IGFyZSBpbW1lZGlhdGVseSBhZnRlciBzdWJ0cmFjdGlvbnMgYW5kIHRyZWF0IHRoZW0gYXMgb25lIFwiYXRvbWljXCIgbW9kaWZ5IGNoYW5nZS5cbiAgICBpZiAob3BlcmF0aW9uID09PSAnLScgJiYgbGluZVswXSA9PT0gJysnKSB7XG4gICAgICBvcGVyYXRpb24gPSAnKyc7XG4gICAgfVxuXG4gICAgaWYgKG9wZXJhdGlvbiA9PT0gbGluZVswXSkge1xuICAgICAgcmV0LnB1c2gobGluZSk7XG4gICAgICBzdGF0ZS5pbmRleCsrO1xuICAgIH0gZWxzZSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmV0O1xufVxuZnVuY3Rpb24gY29sbGVjdENvbnRleHQoc3RhdGUsIG1hdGNoQ2hhbmdlcykge1xuICBsZXQgY2hhbmdlcyA9IFtdLFxuICAgICAgbWVyZ2VkID0gW10sXG4gICAgICBtYXRjaEluZGV4ID0gMCxcbiAgICAgIGNvbnRleHRDaGFuZ2VzID0gZmFsc2UsXG4gICAgICBjb25mbGljdGVkID0gZmFsc2U7XG4gIHdoaWxlIChtYXRjaEluZGV4IDwgbWF0Y2hDaGFuZ2VzLmxlbmd0aFxuICAgICAgICAmJiBzdGF0ZS5pbmRleCA8IHN0YXRlLmxpbmVzLmxlbmd0aCkge1xuICAgIGxldCBjaGFuZ2UgPSBzdGF0ZS5saW5lc1tzdGF0ZS5pbmRleF0sXG4gICAgICAgIG1hdGNoID0gbWF0Y2hDaGFuZ2VzW21hdGNoSW5kZXhdO1xuXG4gICAgLy8gT25jZSB3ZSd2ZSBoaXQgb3VyIGFkZCwgdGhlbiB3ZSBhcmUgZG9uZVxuICAgIGlmIChtYXRjaFswXSA9PT0gJysnKSB7XG4gICAgICBicmVhaztcbiAgICB9XG5cbiAgICBjb250ZXh0Q2hhbmdlcyA9IGNvbnRleHRDaGFuZ2VzIHx8IGNoYW5nZVswXSAhPT0gJyAnO1xuXG4gICAgbWVyZ2VkLnB1c2gobWF0Y2gpO1xuICAgIG1hdGNoSW5kZXgrKztcblxuICAgIC8vIENvbnN1bWUgYW55IGFkZGl0aW9ucyBpbiB0aGUgb3RoZXIgYmxvY2sgYXMgYSBjb25mbGljdCB0byBhdHRlbXB0XG4gICAgLy8gdG8gcHVsbCBpbiB0aGUgcmVtYWluaW5nIGNvbnRleHQgYWZ0ZXIgdGhpc1xuICAgIGlmIChjaGFuZ2VbMF0gPT09ICcrJykge1xuICAgICAgY29uZmxpY3RlZCA9IHRydWU7XG5cbiAgICAgIHdoaWxlIChjaGFuZ2VbMF0gPT09ICcrJykge1xuICAgICAgICBjaGFuZ2VzLnB1c2goY2hhbmdlKTtcbiAgICAgICAgY2hhbmdlID0gc3RhdGUubGluZXNbKytzdGF0ZS5pbmRleF07XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG1hdGNoLnN1YnN0cigxKSA9PT0gY2hhbmdlLnN1YnN0cigxKSkge1xuICAgICAgY2hhbmdlcy5wdXNoKGNoYW5nZSk7XG4gICAgICBzdGF0ZS5pbmRleCsrO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25mbGljdGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBpZiAoKG1hdGNoQ2hhbmdlc1ttYXRjaEluZGV4XSB8fCAnJylbMF0gPT09ICcrJ1xuICAgICAgJiYgY29udGV4dENoYW5nZXMpIHtcbiAgICBjb25mbGljdGVkID0gdHJ1ZTtcbiAgfVxuXG4gIGlmIChjb25mbGljdGVkKSB7XG4gICAgcmV0dXJuIGNoYW5nZXM7XG4gIH1cblxuICB3aGlsZSAobWF0Y2hJbmRleCA8IG1hdGNoQ2hhbmdlcy5sZW5ndGgpIHtcbiAgICBtZXJnZWQucHVzaChtYXRjaENoYW5nZXNbbWF0Y2hJbmRleCsrXSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIG1lcmdlZCxcbiAgICBjaGFuZ2VzXG4gIH07XG59XG5cbmZ1bmN0aW9uIGFsbFJlbW92ZXMoY2hhbmdlcykge1xuICByZXR1cm4gY2hhbmdlcy5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgY2hhbmdlKSB7XG4gICAgcmV0dXJuIHByZXYgJiYgY2hhbmdlWzBdID09PSAnLSc7XG4gIH0sIHRydWUpO1xufVxuZnVuY3Rpb24gc2tpcFJlbW92ZVN1cGVyc2V0KHN0YXRlLCByZW1vdmVDaGFuZ2VzLCBkZWx0YSkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGRlbHRhOyBpKyspIHtcbiAgICBsZXQgY2hhbmdlQ29udGVudCA9IHJlbW92ZUNoYW5nZXNbcmVtb3ZlQ2hhbmdlcy5sZW5ndGggLSBkZWx0YSArIGldLnN1YnN0cigxKTtcbiAgICBpZiAoc3RhdGUubGluZXNbc3RhdGUuaW5kZXggKyBpXSAhPT0gJyAnICsgY2hhbmdlQ29udGVudCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHN0YXRlLmluZGV4ICs9IGRlbHRhO1xuICByZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gY2FsY09sZE5ld0xpbmVDb3VudChsaW5lcykge1xuICBsZXQgb2xkTGluZXMgPSAwO1xuICBsZXQgbmV3TGluZXMgPSAwO1xuXG4gIGxpbmVzLmZvckVhY2goZnVuY3Rpb24obGluZSkge1xuICAgIGlmICh0eXBlb2YgbGluZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIGxldCBteUNvdW50ID0gY2FsY09sZE5ld0xpbmVDb3VudChsaW5lLm1pbmUpO1xuICAgICAgbGV0IHRoZWlyQ291bnQgPSBjYWxjT2xkTmV3TGluZUNvdW50KGxpbmUudGhlaXJzKTtcblxuICAgICAgaWYgKG9sZExpbmVzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKG15Q291bnQub2xkTGluZXMgPT09IHRoZWlyQ291bnQub2xkTGluZXMpIHtcbiAgICAgICAgICBvbGRMaW5lcyArPSBteUNvdW50Lm9sZExpbmVzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9sZExpbmVzID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChuZXdMaW5lcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmIChteUNvdW50Lm5ld0xpbmVzID09PSB0aGVpckNvdW50Lm5ld0xpbmVzKSB7XG4gICAgICAgICAgbmV3TGluZXMgKz0gbXlDb3VudC5uZXdMaW5lcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdMaW5lcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAobmV3TGluZXMgIT09IHVuZGVmaW5lZCAmJiAobGluZVswXSA9PT0gJysnIHx8IGxpbmVbMF0gPT09ICcgJykpIHtcbiAgICAgICAgbmV3TGluZXMrKztcbiAgICAgIH1cbiAgICAgIGlmIChvbGRMaW5lcyAhPT0gdW5kZWZpbmVkICYmIChsaW5lWzBdID09PSAnLScgfHwgbGluZVswXSA9PT0gJyAnKSkge1xuICAgICAgICBvbGRMaW5lcysrO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHtvbGRMaW5lcywgbmV3TGluZXN9O1xufVxuIl19\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/structuredPatch = structuredPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/createTwoFilesPatch = createTwoFilesPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/createPatch = createPatch;\n\n\tvar /*istanbul ignore start*/_line = __webpack_require__(5) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n\t/*istanbul ignore end*/function structuredPatch(oldFileName, newFileName, oldStr, newStr, oldHeader, newHeader, options) {\n\t  if (!options) {\n\t    options = {};\n\t  }\n\t  if (typeof options.context === 'undefined') {\n\t    options.context = 4;\n\t  }\n\n\t  var diff = /*istanbul ignore start*/(0, _line.diffLines) /*istanbul ignore end*/(oldStr, newStr, options);\n\t  diff.push({ value: '', lines: [] }); // Append an empty value to make cleanup easier\n\n\t  function contextLines(lines) {\n\t    return lines.map(function (entry) {\n\t      return ' ' + entry;\n\t    });\n\t  }\n\n\t  var hunks = [];\n\t  var oldRangeStart = 0,\n\t      newRangeStart = 0,\n\t      curRange = [],\n\t      oldLine = 1,\n\t      newLine = 1;\n\n\t  /*istanbul ignore start*/var _loop = function _loop( /*istanbul ignore end*/i) {\n\t    var current = diff[i],\n\t        lines = current.lines || current.value.replace(/\\n$/, '').split('\\n');\n\t    current.lines = lines;\n\n\t    if (current.added || current.removed) {\n\t      /*istanbul ignore start*/var _curRange;\n\n\t      /*istanbul ignore end*/ // If we have previous context, start with that\n\t      if (!oldRangeStart) {\n\t        var prev = diff[i - 1];\n\t        oldRangeStart = oldLine;\n\t        newRangeStart = newLine;\n\n\t        if (prev) {\n\t          curRange = options.context > 0 ? contextLines(prev.lines.slice(-options.context)) : [];\n\t          oldRangeStart -= curRange.length;\n\t          newRangeStart -= curRange.length;\n\t        }\n\t      }\n\n\t      // Output our changes\n\t      /*istanbul ignore start*/(_curRange = /*istanbul ignore end*/curRange).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_curRange /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/lines.map(function (entry) {\n\t        return (current.added ? '+' : '-') + entry;\n\t      })));\n\n\t      // Track the updated file position\n\t      if (current.added) {\n\t        newLine += lines.length;\n\t      } else {\n\t        oldLine += lines.length;\n\t      }\n\t    } else {\n\t      // Identical context lines. Track line changes\n\t      if (oldRangeStart) {\n\t        // Close out any changes that have been output (or join overlapping)\n\t        if (lines.length <= options.context * 2 && i < diff.length - 2) {\n\t          /*istanbul ignore start*/var _curRange2;\n\n\t          /*istanbul ignore end*/ // Overlapping\n\t          /*istanbul ignore start*/(_curRange2 = /*istanbul ignore end*/curRange).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_curRange2 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/contextLines(lines)));\n\t        } else {\n\t          /*istanbul ignore start*/var _curRange3;\n\n\t          /*istanbul ignore end*/ // end the range and output\n\t          var contextSize = Math.min(lines.length, options.context);\n\t          /*istanbul ignore start*/(_curRange3 = /*istanbul ignore end*/curRange).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_curRange3 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/contextLines(lines.slice(0, contextSize))));\n\n\t          var hunk = {\n\t            oldStart: oldRangeStart,\n\t            oldLines: oldLine - oldRangeStart + contextSize,\n\t            newStart: newRangeStart,\n\t            newLines: newLine - newRangeStart + contextSize,\n\t            lines: curRange\n\t          };\n\t          if (i >= diff.length - 2 && lines.length <= options.context) {\n\t            // EOF is inside this hunk\n\t            var oldEOFNewline = /\\n$/.test(oldStr);\n\t            var newEOFNewline = /\\n$/.test(newStr);\n\t            if (lines.length == 0 && !oldEOFNewline) {\n\t              // special case: old has no eol and no trailing context; no-nl can end up before adds\n\t              curRange.splice(hunk.oldLines, 0, '\\\\ No newline at end of file');\n\t            } else if (!oldEOFNewline || !newEOFNewline) {\n\t              curRange.push('\\\\ No newline at end of file');\n\t            }\n\t          }\n\t          hunks.push(hunk);\n\n\t          oldRangeStart = 0;\n\t          newRangeStart = 0;\n\t          curRange = [];\n\t        }\n\t      }\n\t      oldLine += lines.length;\n\t      newLine += lines.length;\n\t    }\n\t  };\n\n\t  for (var i = 0; i < diff.length; i++) {\n\t    /*istanbul ignore start*/_loop( /*istanbul ignore end*/i);\n\t  }\n\n\t  return {\n\t    oldFileName: oldFileName, newFileName: newFileName,\n\t    oldHeader: oldHeader, newHeader: newHeader,\n\t    hunks: hunks\n\t  };\n\t}\n\n\tfunction createTwoFilesPatch(oldFileName, newFileName, oldStr, newStr, oldHeader, newHeader, options) {\n\t  var diff = structuredPatch(oldFileName, newFileName, oldStr, newStr, oldHeader, newHeader, options);\n\n\t  var ret = [];\n\t  if (oldFileName == newFileName) {\n\t    ret.push('Index: ' + oldFileName);\n\t  }\n\t  ret.push('===================================================================');\n\t  ret.push('--- ' + diff.oldFileName + (typeof diff.oldHeader === 'undefined' ? '' : '\\t' + diff.oldHeader));\n\t  ret.push('+++ ' + diff.newFileName + (typeof diff.newHeader === 'undefined' ? '' : '\\t' + diff.newHeader));\n\n\t  for (var i = 0; i < diff.hunks.length; i++) {\n\t    var hunk = diff.hunks[i];\n\t    ret.push('@@ -' + hunk.oldStart + ',' + hunk.oldLines + ' +' + hunk.newStart + ',' + hunk.newLines + ' @@');\n\t    ret.push.apply(ret, hunk.lines);\n\t  }\n\n\t  return ret.join('\\n') + '\\n';\n\t}\n\n\tfunction createPatch(fileName, oldStr, newStr, oldHeader, newHeader, options) {\n\t  return createTwoFilesPatch(fileName, fileName, oldStr, newStr, oldHeader, newHeader, options);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYXRjaC9jcmVhdGUuanMiXSwibmFtZXMiOlsic3RydWN0dXJlZFBhdGNoIiwiY3JlYXRlVHdvRmlsZXNQYXRjaCIsImNyZWF0ZVBhdGNoIiwib2xkRmlsZU5hbWUiLCJuZXdGaWxlTmFtZSIsIm9sZFN0ciIsIm5ld1N0ciIsIm9sZEhlYWRlciIsIm5ld0hlYWRlciIsIm9wdGlvbnMiLCJjb250ZXh0IiwiZGlmZiIsInB1c2giLCJ2YWx1ZSIsImxpbmVzIiwiY29udGV4dExpbmVzIiwibWFwIiwiZW50cnkiLCJodW5rcyIsIm9sZFJhbmdlU3RhcnQiLCJuZXdSYW5nZVN0YXJ0IiwiY3VyUmFuZ2UiLCJvbGRMaW5lIiwibmV3TGluZSIsImkiLCJjdXJyZW50IiwicmVwbGFjZSIsInNwbGl0IiwiYWRkZWQiLCJyZW1vdmVkIiwicHJldiIsInNsaWNlIiwibGVuZ3RoIiwiY29udGV4dFNpemUiLCJNYXRoIiwibWluIiwiaHVuayIsIm9sZFN0YXJ0Iiwib2xkTGluZXMiLCJuZXdTdGFydCIsIm5ld0xpbmVzIiwib2xkRU9GTmV3bGluZSIsInRlc3QiLCJuZXdFT0ZOZXdsaW5lIiwic3BsaWNlIiwicmV0IiwiYXBwbHkiLCJqb2luIiwiZmlsZU5hbWUiXSwibWFwcGluZ3MiOiI7OztnQ0FFZ0JBLGUsR0FBQUEsZTt5REFpR0FDLG1CLEdBQUFBLG1CO3lEQXdCQUMsVyxHQUFBQSxXOztBQTNIaEI7Ozs7dUJBRU8sU0FBU0YsZUFBVCxDQUF5QkcsV0FBekIsRUFBc0NDLFdBQXRDLEVBQW1EQyxNQUFuRCxFQUEyREMsTUFBM0QsRUFBbUVDLFNBQW5FLEVBQThFQyxTQUE5RSxFQUF5RkMsT0FBekYsRUFBa0c7QUFDdkcsTUFBSSxDQUFDQSxPQUFMLEVBQWM7QUFDWkEsY0FBVSxFQUFWO0FBQ0Q7QUFDRCxNQUFJLE9BQU9BLFFBQVFDLE9BQWYsS0FBMkIsV0FBL0IsRUFBNEM7QUFDMUNELFlBQVFDLE9BQVIsR0FBa0IsQ0FBbEI7QUFDRDs7QUFFRCxN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QUEvQyxFQUEwREMsU0FBMUQsRUFBcUVDLE9BQXJFLEVBQThFO0FBQ25GLFNBQU9SLG9CQUFvQitDLFFBQXBCLEVBQThCQSxRQUE5QixFQUF3QzNDLE1BQXhDLEVBQWdEQyxNQUFoRCxFQUF3REMsU0FBeEQsRUFBbUVDLFNBQW5FLEVBQThFQyxPQUE5RSxDQUFQO0FBQ0QiLCJmaWxlIjoiY3JlYXRlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtkaWZmTGluZXN9IGZyb20gJy4uL2RpZmYvbGluZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBzdHJ1Y3R1cmVkUGF0Y2gob2xkRmlsZU5hbWUsIG5ld0ZpbGVOYW1lLCBvbGRTdHIsIG5ld1N0ciwgb2xkSGVhZGVyLCBuZXdIZWFkZXIsIG9wdGlvbnMpIHtcbiAgaWYgKCFvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IHt9O1xuICB9XG4gIGlmICh0eXBlb2Ygb3B0aW9ucy5jb250ZXh0ID09PSAndW5kZWZpbmVkJykge1xuICAgIG9wdGlvbnMuY29udGV4dCA9IDQ7XG4gIH1cblxuICBjb25zdCBkaWZmID0gZGlmZkxpbmVzKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKTtcbiAgZGlmZi5wdXNoKHt2YWx1ZTogJycsIGxpbmVzOiBbXX0pOyAgIC8vIEFwcGVuZCBhbiBlbXB0eSB2YWx1ZSB0byBtYWtlIGNsZWFudXAgZWFzaWVyXG5cbiAgZnVuY3Rpb24gY29udGV4dExpbmVzKGxpbmVzKSB7XG4gICAgcmV0dXJuIGxpbmVzLm1hcChmdW5jdGlvbihlbnRyeSkgeyByZXR1cm4gJyAnICsgZW50cnk7IH0pO1xuICB9XG5cbiAgbGV0IGh1bmtzID0gW107XG4gIGxldCBvbGRSYW5nZVN0YXJ0ID0gMCwgbmV3UmFuZ2VTdGFydCA9IDAsIGN1clJhbmdlID0gW10sXG4gICAgICBvbGRMaW5lID0gMSwgbmV3TGluZSA9IDE7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgZGlmZi5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGN1cnJlbnQgPSBkaWZmW2ldLFxuICAgICAgICAgIGxpbmVzID0gY3VycmVudC5saW5lcyB8fCBjdXJyZW50LnZhbHVlLnJlcGxhY2UoL1xcbiQvLCAnJykuc3BsaXQoJ1xcbicpO1xuICAgIGN1cnJlbnQubGluZXMgPSBsaW5lcztcblxuICAgIGlmIChjdXJyZW50LmFkZGVkIHx8IGN1cnJlbnQucmVtb3ZlZCkge1xuICAgICAgLy8gSWYgd2UgaGF2ZSBwcmV2aW91cyBjb250ZXh0LCBzdGFydCB3aXRoIHRoYXRcbiAgICAgIGlmICghb2xkUmFuZ2VTdGFydCkge1xuICAgICAgICBjb25zdCBwcmV2ID0gZGlmZltpIC0gMV07XG4gICAgICAgIG9sZFJhbmdlU3RhcnQgPSBvbGRMaW5lO1xuICAgICAgICBuZXdSYW5nZVN0YXJ0ID0gbmV3TGluZTtcblxuICAgICAgICBpZiAocHJldikge1xuICAgICAgICAgIGN1clJhbmdlID0gb3B0aW9ucy5jb250ZXh0ID4gMCA/IGNvbnRleHRMaW5lcyhwcmV2LmxpbmVzLnNsaWNlKC1vcHRpb25zLmNvbnRleHQpKSA6IFtdO1xuICAgICAgICAgIG9sZFJhbmdlU3RhcnQgLT0gY3VyUmFuZ2UubGVuZ3RoO1xuICAgICAgICAgIG5ld1JhbmdlU3RhcnQgLT0gY3VyUmFuZ2UubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIE91dHB1dCBvdXIgY2hhbmdlc1xuICAgICAgY3VyUmFuZ2UucHVzaCguLi4gbGluZXMubWFwKGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgIHJldHVybiAoY3VycmVudC5hZGRlZCA/ICcrJyA6ICctJykgKyBlbnRyeTtcbiAgICAgIH0pKTtcblxuICAgICAgLy8gVHJhY2sgdGhlIHVwZGF0ZWQgZmlsZSBwb3NpdGlvblxuICAgICAgaWYgKGN1cnJlbnQuYWRkZWQpIHtcbiAgICAgICAgbmV3TGluZSArPSBsaW5lcy5sZW5ndGg7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvbGRMaW5lICs9IGxpbmVzLmxlbmd0aDtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSWRlbnRpY2FsIGNvbnRleHQgbGluZXMuIFRyYWNrIGxpbmUgY2hhbmdlc1xuICAgICAgaWYgKG9sZFJhbmdlU3RhcnQpIHtcbiAgICAgICAgLy8gQ2xvc2Ugb3V0IGFueSBjaGFuZ2VzIHRoYXQgaGF2ZSBiZWVuIG91dHB1dCAob3Igam9pbiBvdmVybGFwcGluZylcbiAgICAgICAgaWYgKGxpbmVzLmxlbmd0aCA8PSBvcHRpb25zLmNvbnRleHQgKiAyICYmIGkgPCBkaWZmLmxlbmd0aCAtIDIpIHtcbiAgICAgICAgICAvLyBPdmVybGFwcGluZ1xuICAgICAgICAgIGN1clJhbmdlLnB1c2goLi4uIGNvbnRleHRMaW5lcyhsaW5lcykpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGVuZCB0aGUgcmFuZ2UgYW5kIG91dHB1dFxuICAgICAgICAgIGxldCBjb250ZXh0U2l6ZSA9IE1hdGgubWluKGxpbmVzLmxlbmd0aCwgb3B0aW9ucy5jb250ZXh0KTtcbiAgICAgICAgICBjdXJSYW5nZS5wdXNoKC4uLiBjb250ZXh0TGluZXMobGluZXMuc2xpY2UoMCwgY29udGV4dFNpemUpKSk7XG5cbiAgICAgICAgICBsZXQgaHVuayA9IHtcbiAgICAgICAgICAgIG9sZFN0YXJ0OiBvbGRSYW5nZVN0YXJ0LFxuICAgICAgICAgICAgb2xkTGluZXM6IChvbGRMaW5lIC0gb2xkUmFuZ2VTdGFydCArIGNvbnRleHRTaXplKSxcbiAgICAgICAgICAgIG5ld1N0YXJ0OiBuZXdSYW5nZVN0YXJ0LFxuICAgICAgICAgICAgbmV3TGluZXM6IChuZXdMaW5lIC0gbmV3UmFuZ2VTdGFydCArIGNvbnRleHRTaXplKSxcbiAgICAgICAgICAgIGxpbmVzOiBjdXJSYW5nZVxuICAgICAgICAgIH07XG4gICAgICAgICAgaWYgKGkgPj0gZGlmZi5sZW5ndGggLSAyICYmIGxpbmVzLmxlbmd0aCA8PSBvcHRpb25zLmNvbnRleHQpIHtcbiAgICAgICAgICAgIC8vIEVPRiBpcyBpbnNpZGUgdGhpcyBodW5rXG4gICAgICAgICAgICBsZXQgb2xkRU9GTmV3bGluZSA9ICgvXFxuJC8udGVzdChvbGRTdHIpKTtcbiAgICAgICAgICAgIGxldCBuZXdFT0ZOZXdsaW5lID0gKC9cXG4kLy50ZXN0KG5ld1N0cikpO1xuICAgICAgICAgICAgaWYgKGxpbmVzLmxlbmd0aCA9PSAwICYmICFvbGRFT0ZOZXdsaW5lKSB7XG4gICAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb2xkIGhhcyBubyBlb2wgYW5kIG5vIHRyYWlsaW5nIGNvbnRleHQ7IG5vLW5sIGNhbiBlbmQgdXAgYmVmb3JlIGFkZHNcbiAgICAgICAgICAgICAgY3VyUmFuZ2Uuc3BsaWNlKGh1bmsub2xkTGluZXMsIDAsICdcXFxcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZpbGUnKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIW9sZEVPRk5ld2xpbmUgfHwgIW5ld0VPRk5ld2xpbmUpIHtcbiAgICAgICAgICAgICAgY3VyUmFuZ2UucHVzaCgnXFxcXCBObyBuZXdsaW5lIGF0IGVuZCBvZiBmaWxlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGh1bmtzLnB1c2goaHVuayk7XG5cbiAgICAgICAgICBvbGRSYW5nZVN0YXJ0ID0gMDtcbiAgICAgICAgICBuZXdSYW5nZVN0YXJ0ID0gMDtcbiAgICAgICAgICBjdXJSYW5nZSA9IFtdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBvbGRMaW5lICs9IGxpbmVzLmxlbmd0aDtcbiAgICAgIG5ld0xpbmUgKz0gbGluZXMubGVuZ3RoO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgb2xkRmlsZU5hbWU6IG9sZEZpbGVOYW1lLCBuZXdGaWxlTmFtZTogbmV3RmlsZU5hbWUsXG4gICAgb2xkSGVhZGVyOiBvbGRIZWFkZXIsIG5ld0hlYWRlcjogbmV3SGVhZGVyLFxuICAgIGh1bmtzOiBodW5rc1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVHdvRmlsZXNQYXRjaChvbGRGaWxlTmFtZSwgbmV3RmlsZU5hbWUsIG9sZFN0ciwgbmV3U3RyLCBvbGRIZWFkZXIsIG5ld0hlYWRlciwgb3B0aW9ucykge1xuICBjb25zdCBkaWZmID0gc3RydWN0dXJlZFBhdGNoKG9sZEZpbGVOYW1lLCBuZXdGaWxlTmFtZSwgb2xkU3RyLCBuZXdTdHIsIG9sZEhlYWRlciwgbmV3SGVhZGVyLCBvcHRpb25zKTtcblxuICBjb25zdCByZXQgPSBbXTtcbiAgaWYgKG9sZEZpbGVOYW1lID09IG5ld0ZpbGVOYW1lKSB7XG4gICAgcmV0LnB1c2goJ0luZGV4OiAnICsgb2xkRmlsZU5hbWUpO1xuICB9XG4gIHJldC5wdXNoKCc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Jyk7XG4gIHJldC5wdXNoKCctLS0gJyArIGRpZmYub2xkRmlsZU5hbWUgKyAodHlwZW9mIGRpZmYub2xkSGVhZGVyID09PSAndW5kZWZpbmVkJyA/ICcnIDogJ1xcdCcgKyBkaWZmLm9sZEhlYWRlcikpO1xuICByZXQucHVzaCgnKysrICcgKyBkaWZmLm5ld0ZpbGVOYW1lICsgKHR5cGVvZiBkaWZmLm5ld0hlYWRlciA9PT0gJ3VuZGVmaW5lZCcgPyAnJyA6ICdcXHQnICsgZGlmZi5uZXdIZWFkZXIpKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGRpZmYuaHVua3MubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBodW5rID0gZGlmZi5odW5rc1tpXTtcbiAgICByZXQucHVzaChcbiAgICAgICdAQCAtJyArIGh1bmsub2xkU3RhcnQgKyAnLCcgKyBodW5rLm9sZExpbmVzXG4gICAgICArICcgKycgKyBodW5rLm5ld1N0YXJ0ICsgJywnICsgaHVuay5uZXdMaW5lc1xuICAgICAgKyAnIEBAJ1xuICAgICk7XG4gICAgcmV0LnB1c2guYXBwbHkocmV0LCBodW5rLmxpbmVzKTtcbiAgfVxuXG4gIHJldHVybiByZXQuam9pbignXFxuJykgKyAnXFxuJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhdGNoKGZpbGVOYW1lLCBvbGRTdHIsIG5ld1N0ciwgb2xkSGVhZGVyLCBuZXdIZWFkZXIsIG9wdGlvbnMpIHtcbiAgcmV0dXJuIGNyZWF0ZVR3b0ZpbGVzUGF0Y2goZmlsZU5hbWUsIGZpbGVOYW1lLCBvbGRTdHIsIG5ld1N0ciwgb2xkSGVhZGVyLCBuZXdIZWFkZXIsIG9wdGlvbnMpO1xufVxuIl19\n\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/\"use strict\";\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/arrayEqual = arrayEqual;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/arrayStartsWith = arrayStartsWith;\n\tfunction arrayEqual(a, b) {\n\t  if (a.length !== b.length) {\n\t    return false;\n\t  }\n\n\t  return arrayStartsWith(a, b);\n\t}\n\n\tfunction arrayStartsWith(array, start) {\n\t  if (start.length > array.length) {\n\t    return false;\n\t  }\n\n\t  for (var i = 0; i < start.length; i++) {\n\t    if (start[i] !== array[i]) {\n\t      return false;\n\t    }\n\t  }\n\n\t  return true;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL2FycmF5LmpzIl0sIm5hbWVzIjpbImFycmF5RXF1YWwiLCJhcnJheVN0YXJ0c1dpdGgiLCJhIiwiYiIsImxlbmd0aCIsImFycmF5Iiwic3RhcnQiLCJpIl0sIm1hcHBpbmdzIjoiOzs7Z0NBQWdCQSxVLEdBQUFBLFU7eURBUUFDLGUsR0FBQUEsZTtBQVJULFNBQVNELFVBQVQsQ0FBb0JFLENBQXBCLEVBQXVCQyxDQUF2QixFQUEwQjtBQUMvQixNQUFJRCxFQUFFRSxNQUFGLEtBQWFELEVBQUVDLE1BQW5CLEVBQTJCO0FBQ3pCLFdBQU8sS0FBUDtBQUNEOztBQUVELFNBQU9ILGdCQUFnQkMsQ0FBaEIsRUFBbUJDLENBQW5CLENBQVA7QUFDRDs7QUFFTSxTQUFTRixlQUFULENBQXlCSSxLQUF6QixFQUFnQ0MsS0FBaEMsRUFBdUM7QUFDNUMsTUFBSUEsTUFBTUYsTUFBTixHQUFlQyxNQUFNRCxNQUF6QixFQUFpQztBQUMvQixXQUFPLEtBQVA7QUFDRDs7QUFFRCxPQUFLLElBQUlHLElBQUksQ0FBYixFQUFnQkEsSUFBSUQsTUFBTUYsTUFBMUIsRUFBa0NHLEdBQWxDLEVBQXVDO0FBQ3JDLFFBQUlELE1BQU1DLENBQU4sTUFBYUYsTUFBTUUsQ0FBTixDQUFqQixFQUEyQjtBQUN6QixhQUFPLEtBQVA7QUFDRDtBQUNGOztBQUVELFNBQU8sSUFBUDtBQUNEIiwiZmlsZSI6ImFycmF5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGFycmF5RXF1YWwoYSwgYikge1xuICBpZiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIGFycmF5U3RhcnRzV2l0aChhLCBiKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFycmF5U3RhcnRzV2l0aChhcnJheSwgc3RhcnQpIHtcbiAgaWYgKHN0YXJ0Lmxlbmd0aCA+IGFycmF5Lmxlbmd0aCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3RhcnQubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoc3RhcnRbaV0gIT09IGFycmF5W2ldKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59XG4iXX0=\n\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/\"use strict\";\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/convertChangesToDMP = convertChangesToDMP;\n\t// See: http://code.google.com/p/google-diff-match-patch/wiki/API\n\tfunction convertChangesToDMP(changes) {\n\t  var ret = [],\n\t      change = /*istanbul ignore start*/void 0 /*istanbul ignore end*/,\n\t      operation = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\t  for (var i = 0; i < changes.length; i++) {\n\t    change = changes[i];\n\t    if (change.added) {\n\t      operation = 1;\n\t    } else if (change.removed) {\n\t      operation = -1;\n\t    } else {\n\t      operation = 0;\n\t    }\n\n\t    ret.push([operation, change.value]);\n\t  }\n\t  return ret;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb252ZXJ0L2RtcC5qcyJdLCJuYW1lcyI6WyJjb252ZXJ0Q2hhbmdlc1RvRE1QIiwiY2hhbmdlcyIsInJldCIsImNoYW5nZSIsIm9wZXJhdGlvbiIsImkiLCJsZW5ndGgiLCJhZGRlZCIsInJlbW92ZWQiLCJwdXNoIiwidmFsdWUiXSwibWFwcGluZ3MiOiI7OztnQ0FDZ0JBLG1CLEdBQUFBLG1CO0FBRGhCO0FBQ08sU0FBU0EsbUJBQVQsQ0FBNkJDLE9BQTdCLEVBQXNDO0FBQzNDLE1BQUlDLE1BQU0sRUFBVjtBQUFBLE1BQ0lDLHdDQURKO0FBQUEsTUFFSUMsMkNBRko7QUFHQSxPQUFLLElBQUlDLElBQUksQ0FBYixFQUFnQkEsSUFBSUosUUFBUUssTUFBNUIsRUFBb0NELEdBQXBDLEVBQXlDO0FBQ3ZDRixhQUFTRixRQUFRSSxDQUFSLENBQVQ7QUFDQSxRQUFJRixPQUFPSSxLQUFYLEVBQWtCO0FBQ2hCSCxrQkFBWSxDQUFaO0FBQ0QsS0FGRCxNQUVPLElBQUlELE9BQU9LLE9BQVgsRUFBb0I7QUFDekJKLGtCQUFZLENBQUMsQ0FBYjtBQUNELEtBRk0sTUFFQTtBQUNMQSxrQkFBWSxDQUFaO0FBQ0Q7O0FBRURGLFFBQUlPLElBQUosQ0FBUyxDQUFDTCxTQUFELEVBQVlELE9BQU9PLEtBQW5CLENBQVQ7QUFDRDtBQUNELFNBQU9SLEdBQVA7QUFDRCIsImZpbGUiOiJkbXAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTZWU6IGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9nb29nbGUtZGlmZi1tYXRjaC1wYXRjaC93aWtpL0FQSVxuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRDaGFuZ2VzVG9ETVAoY2hhbmdlcykge1xuICBsZXQgcmV0ID0gW10sXG4gICAgICBjaGFuZ2UsXG4gICAgICBvcGVyYXRpb247XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY2hhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgIGNoYW5nZSA9IGNoYW5nZXNbaV07XG4gICAgaWYgKGNoYW5nZS5hZGRlZCkge1xuICAgICAgb3BlcmF0aW9uID0gMTtcbiAgICB9IGVsc2UgaWYgKGNoYW5nZS5yZW1vdmVkKSB7XG4gICAgICBvcGVyYXRpb24gPSAtMTtcbiAgICB9IGVsc2Uge1xuICAgICAgb3BlcmF0aW9uID0gMDtcbiAgICB9XG5cbiAgICByZXQucHVzaChbb3BlcmF0aW9uLCBjaGFuZ2UudmFsdWVdKTtcbiAgfVxuICByZXR1cm4gcmV0O1xufVxuIl19\n\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/convertChangesToXML = convertChangesToXML;\n\tfunction convertChangesToXML(changes) {\n\t  var ret = [];\n\t  for (var i = 0; i < changes.length; i++) {\n\t    var change = changes[i];\n\t    if (change.added) {\n\t      ret.push('<ins>');\n\t    } else if (change.removed) {\n\t      ret.push('<del>');\n\t    }\n\n\t    ret.push(escapeHTML(change.value));\n\n\t    if (change.added) {\n\t      ret.push('</ins>');\n\t    } else if (change.removed) {\n\t      ret.push('</del>');\n\t    }\n\t  }\n\t  return ret.join('');\n\t}\n\n\tfunction escapeHTML(s) {\n\t  var n = s;\n\t  n = n.replace(/&/g, '&amp;');\n\t  n = n.replace(/</g, '&lt;');\n\t  n = n.replace(/>/g, '&gt;');\n\t  n = n.replace(/\"/g, '&quot;');\n\n\t  return n;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb252ZXJ0L3htbC5qcyJdLCJuYW1lcyI6WyJjb252ZXJ0Q2hhbmdlc1RvWE1MIiwiY2hhbmdlcyIsInJldCIsImkiLCJsZW5ndGgiLCJjaGFuZ2UiLCJhZGRlZCIsInB1c2giLCJyZW1vdmVkIiwiZXNjYXBlSFRNTCIsInZhbHVlIiwiam9pbiIsInMiLCJuIiwicmVwbGFjZSJdLCJtYXBwaW5ncyI6Ijs7O2dDQUFnQkEsbUIsR0FBQUEsbUI7QUFBVCxTQUFTQSxtQkFBVCxDQUE2QkMsT0FBN0IsRUFBc0M7QUFDM0MsTUFBSUMsTUFBTSxFQUFWO0FBQ0EsT0FBSyxJQUFJQyxJQUFJLENBQWIsRUFBZ0JBLElBQUlGLFFBQVFHLE1BQTVCLEVBQW9DRCxHQUFwQyxFQUF5QztBQUN2QyxRQUFJRSxTQUFTSixRQUFRRSxDQUFSLENBQWI7QUFDQSxRQUFJRSxPQUFPQyxLQUFYLEVBQWtCO0FBQ2hCSixVQUFJSyxJQUFKLENBQVMsT0FBVDtBQUNELEtBRkQsTUFFTyxJQUFJRixPQUFPRyxPQUFYLEVBQW9CO0FBQ3pCTixVQUFJSyxJQUFKLENBQVMsT0FBVDtBQUNEOztBQUVETCxRQUFJSyxJQUFKLENBQVNFLFdBQVdKLE9BQU9LLEtBQWxCLENBQVQ7O0FBRUEsUUFBSUwsT0FBT0MsS0FBWCxFQUFrQjtBQUNoQkosVUFBSUssSUFBSixDQUFTLFFBQVQ7QUFDRCxLQUZELE1BRU8sSUFBSUYsT0FBT0csT0FBWCxFQUFvQjtBQUN6Qk4sVUFBSUssSUFBSixDQUFTLFFBQVQ7QUFDRDtBQUNGO0FBQ0QsU0FBT0wsSUFBSVMsSUFBSixDQUFTLEVBQVQsQ0FBUDtBQUNEOztBQUVELFNBQVNGLFVBQVQsQ0FBb0JHLENBQXBCLEVBQXVCO0FBQ3JCLE1BQUlDLElBQUlELENBQVI7QUFDQUMsTUFBSUEsRUFBRUMsT0FBRixDQUFVLElBQVYsRUFBZ0IsT0FBaEIsQ0FBSjtBQUNBRCxNQUFJQSxFQUFFQyxPQUFGLENBQVUsSUFBVixFQUFnQixNQUFoQixDQUFKO0FBQ0FELE1BQUlBLEVBQUVDLE9BQUYsQ0FBVSxJQUFWLEVBQWdCLE1BQWhCLENBQUo7QUFDQUQsTUFBSUEsRUFBRUMsT0FBRixDQUFVLElBQVYsRUFBZ0IsUUFBaEIsQ0FBSjs7QUFFQSxTQUFPRCxDQUFQO0FBQ0QiLCJmaWxlIjoieG1sLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRDaGFuZ2VzVG9YTUwoY2hhbmdlcykge1xuICBsZXQgcmV0ID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY2hhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgIGxldCBjaGFuZ2UgPSBjaGFuZ2VzW2ldO1xuICAgIGlmIChjaGFuZ2UuYWRkZWQpIHtcbiAgICAgIHJldC5wdXNoKCc8aW5zPicpO1xuICAgIH0gZWxzZSBpZiAoY2hhbmdlLnJlbW92ZWQpIHtcbiAgICAgIHJldC5wdXNoKCc8ZGVsPicpO1xuICAgIH1cblxuICAgIHJldC5wdXNoKGVzY2FwZUhUTUwoY2hhbmdlLnZhbHVlKSk7XG5cbiAgICBpZiAoY2hhbmdlLmFkZGVkKSB7XG4gICAgICByZXQucHVzaCgnPC9pbnM+Jyk7XG4gICAgfSBlbHNlIGlmIChjaGFuZ2UucmVtb3ZlZCkge1xuICAgICAgcmV0LnB1c2goJzwvZGVsPicpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmV0LmpvaW4oJycpO1xufVxuXG5mdW5jdGlvbiBlc2NhcGVIVE1MKHMpIHtcbiAgbGV0IG4gPSBzO1xuICBuID0gbi5yZXBsYWNlKC8mL2csICcmYW1wOycpO1xuICBuID0gbi5yZXBsYWNlKC88L2csICcmbHQ7Jyk7XG4gIG4gPSBuLnJlcGxhY2UoLz4vZywgJyZndDsnKTtcbiAgbiA9IG4ucmVwbGFjZSgvXCIvZywgJyZxdW90OycpO1xuXG4gIHJldHVybiBuO1xufVxuIl19\n\n\n/***/ })\n/******/ ])\n});\n;","\"use strict\";\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar JsDiff = __importStar(require(\"diff\"));\nvar Measure_1 = require(\"./Measure\");\nvar Sheet_1 = require(\"./Sheet\");\nvar Snippet = /** @class */ (function () {\n    function Snippet() {\n    }\n    Snippet.render = function (snippet, options) {\n        var parsed = Snippet.parse(snippet);\n        return Sheet_1.Sheet.render(parsed, options);\n    };\n    Snippet.wrapPipes = function (string) {\n        return (\"|\" + string + \"|\").replace(/\\|+/g, '|');\n    };\n    Snippet.formatForDiff = function (snippet) {\n        return Snippet.minify(snippet)\n            .replace(/\\|/g, ' | ').trim();\n    };\n    Snippet.format = function (snippet, linebreaks) {\n        if (linebreaks === void 0) { linebreaks = true; }\n        // replaces url chars back\n        var compact = Snippet.minify(snippet, false);\n        compact = Snippet.wrapPipes(compact);\n        if (linebreaks) {\n            // insert spaces before first chord\n            var bars = compact.split('|').slice(1, -1);\n            bars = bars.map(function (bar, index) {\n                if (!bar[0].match(/[1-9:]/)) {\n                    bar = '  ' + bar;\n                }\n                else if (bar[0] === ':') {\n                    bar = ': ' + bar.slice(1);\n                }\n                return bar;\n            });\n            // find out indices of first houses\n            var houses_1 = bars.reduce(function (offset, bar, index) {\n                if (bar[0] === '1') {\n                    offset.push(index);\n                }\n                return offset;\n            }, []);\n            // insert empty bars before additional houses\n            bars = bars.reduce(function (bars, bar, index) {\n                if (bar[0].match(/[2-9]/)) {\n                    var offset = houses_1.filter(function (h) { return h < index; }).reverse()[0];\n                    bars = bars.concat(new Array(offset % 4).fill(''));\n                }\n                bars.push(bar);\n                return bars;\n            }, []);\n            // find out the maximal number of chars per column\n            var chars_1 = bars.reduce(function (max, bar, index) {\n                max[index % 4] = Math.max(bar.length, max[index % 4] || 0);\n                return max;\n            }, []);\n            // fill up each bar with spaces\n            compact = bars.map(function (bar, index) {\n                var diff = chars_1[index % 4] - bar.length + 2;\n                if (diff > 0) {\n                    bar += new Array(diff).fill(' ').join('');\n                }\n                // move double dots to end of bar\n                bar = bar.replace(/:(\\s+)$/, '$1:');\n                return bar;\n            }).join('|');\n            compact = Snippet.wrapPipes(compact);\n            // break string all 4 bars\n            var pipeIndex_1 = -1;\n            compact = compact.split('').reduce(function (string, char, index) {\n                if (char === '|') {\n                    pipeIndex_1++;\n                }\n                if (char === '|' && pipeIndex_1 % 4 === 0 && index > 0 && index < compact.length - 1) {\n                    char = \"|\\n|\";\n                    pipeIndex_1 = 0;\n                }\n                return string + char;\n            }, '');\n        }\n        else {\n            compact = compact.replace(/\\n/g, '|');\n        }\n        return compact\n            .replace(/\\|+/g, '|')\n            .replace(/\\|( +)\\|( +)/g, ' $1 $2') // remove spacer bar pipes\n            .replace(/\\|( +)\\|([1-9])/g, ' $1|$2')\n            .replace(/^\\s+|\\s+$/g, ''); // remove spaces/line breaks from start/end\n    };\n    Snippet.minify = function (snippet, urlsafe) {\n        if (urlsafe === void 0) { urlsafe = false; }\n        var compact = (\"|\" + snippet + \"|\")\n            .replace(/\\n+/g, '|') // replace line breaks with pipes\n            .replace(/\\s+/g, ' ') // no repeated pipes\n            .replace(/\\s?\\|\\s?/g, '|') // no pipes with spaces\n            .replace(/\\s?\\:\\s?/g, ':') // no repeat with spaces\n            .replace(/\\|+/g, '|'); // no repeated pipes\n        if (urlsafe) {\n            // replaces url unfriendly chars\n            compact = compact\n                .replace(/\\|+/g, 'I')\n                .replace(/\\s+/g, '_')\n                .replace(/:/g, 'R')\n                .replace(/\\^/g, 'M')\n                .replace(/\\#/g, 'S')\n                .replace(/\\%/g, 'X');\n        }\n        else {\n            // replaces url unfriendly chars\n            compact = compact\n                .replace(/\\I+/g, '|')\n                .replace(/\\_+/g, ' ')\n                .replace(/R/g, ':')\n                .replace(/M/g, '^')\n                .replace(/X/g, 'x')\n                .replace(/S/g, '#');\n        }\n        return compact.slice(1, -1);\n    };\n    Snippet.parse = function (snippet, simplify) {\n        if (simplify === void 0) { simplify = true; }\n        var formatted = Snippet.format(snippet, false);\n        return formatted\n            .split('|') // split into measures\n            .map(function (measure) { return measure.split(' '); }) // split measures by spaces\n            .map(function (measure) { return measure.filter(function (chord) { return !!chord; }); }) // kill empty chords\n            .filter(function (measure) { return !measure || measure.length; }) // kill empty measures\n            .map(function (measure) { return ({ symbols: measure, signs: [] }); })\n            // parse symbols to chords and signs\n            .map(function (measure) {\n            // repeat start\n            if (measure.symbols[0][0] === ':') {\n                if (measure.symbols[0].length === 1) {\n                    measure.symbols = measure.symbols.slice(1);\n                }\n                measure.signs.unshift('{');\n            }\n            var last = measure.symbols[measure.symbols.length - 1];\n            // repeat end\n            if (last[last.length - 1] === ':') {\n                if (last.length === 1) {\n                    measure.symbols.pop();\n                }\n                measure.signs.push('}');\n            }\n            measure.symbols = measure.symbols.map(function (s) { return s.replace(/:/g, ''); });\n            var house = measure.symbols.find(function (s) { return s.match(/^[1-9]$/); });\n            if (house) {\n                measure.house = parseInt(house);\n            }\n            measure.symbols = measure.symbols.filter(function (s) { return !s.match(/^[1-9]$/); });\n            // houses\n            measure.chords = [].concat(measure.symbols);\n            delete measure.symbols;\n            return measure;\n        })\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.signs.length === 0) {\n                delete measure.signs;\n            }\n            if (measure.chords.length === 0) {\n                delete measure.chords;\n            }\n            return measure;\n        })\n            // kill empty measures\n            .filter(function (measure) { return Object.keys(measure).length > 0; })\n            // simplify => measures with only chords will be arrays\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.chords && Object.keys(measure).length === 1) {\n                return measure.chords.length === 1 ?\n                    measure.chords[0] : // simplify one chord measures\n                    measure.chords;\n            }\n            return measure;\n        });\n    };\n    Snippet.nest = function (string) {\n        var nested = string.split('.')\n            .map(function (group) { return group.trim(); })\n            .map(function (group) { return group.split(' '); })\n            .map(function (group) { return group.filter(function (chord) { return !!chord; }); }) // kill empty chords\n            .filter(function (group) { return !group || group.length; })\n            .map(function (group) { return group.length === 1 ? group[0] : group; });\n        nested = nested.length === 1 ? nested[0] : nested;\n        return nested;\n    };\n    Snippet.parse2 = function (snippet, simplify) {\n        if (simplify === void 0) { simplify = true; }\n        var formatted = Snippet.format(snippet, false);\n        return formatted\n            .split('|') // split into measures\n            .filter(function (measure) { return measure && measure.length; }) // kill empty measures\n            .map(function (measure) { return ({ symbols: measure.trim(), signs: [] }); })\n            // parse symbols to chords and signs\n            .map(function (measure) {\n            // repeat start\n            if (measure.symbols[0] === ':') {\n                measure.signs.unshift('{');\n            }\n            var last = measure.symbols[measure.symbols.length - 1];\n            // repeat end\n            if (last === ':') {\n                measure.signs.push('}');\n            }\n            measure.symbols = measure.symbols.replace(/:/g, '');\n            /* const house = measure.symbols[0].match(/^[1-9]$/);\n            if (house) {\n                measure.house = parseInt(house);\n                measure.symbols = measure.symbols.slice(1);\n            } */\n            measure.chords = [].concat(Snippet.nest(measure.symbols));\n            delete measure.symbols;\n            return measure;\n        })\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.signs.length === 0) {\n                delete measure.signs;\n            }\n            if (measure.chords.length === 0) {\n                delete measure.chords;\n            }\n            return measure;\n        })\n            // kill empty measures\n            .filter(function (measure) { return Object.keys(measure).length > 0; })\n            // simplify => measures with only chords will be arrays\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.chords && Object.keys(measure).length === 1) {\n                return measure.chords.length === 1 ?\n                    measure.chords[0] : // simplify one chord measures\n                    measure.chords;\n            }\n            return measure;\n        });\n    };\n    Snippet.testFormat = function (sheet) {\n        return sheet.map(function (m) { return Measure_1.Measure.from(m); }).map(function (m) { return m.chords; }).join(' ');\n    };\n    Snippet.from = function (sheet, format) {\n        if (format === void 0) { format = true; }\n        var snippet = sheet\n            .map(function (m) { return Measure_1.Measure.from(m); })\n            .reduce(function (snippet, _a) {\n            var signs = _a.signs, house = _a.house, chords = _a.chords;\n            var repeatStart = signs && signs.includes('{');\n            var repeatEnd = signs && signs.includes('}');\n            return snippet + (\"|\" + (repeatStart ? ':' : '') + (house || '') + \" \" + (chords ? chords.join(' ') : '') + (repeatEnd ? ':' : ''));\n        }, '');\n        if (format) {\n            return Snippet.format(snippet);\n        }\n        return Snippet.minify(snippet);\n    };\n    Snippet.expand = function (snippet, options) {\n        var rendered = Snippet.render(snippet, options);\n        rendered = rendered\n            .map(function (m) { return Measure_1.Measure.from(m); })\n            .map(function (m) {\n            delete m.house;\n            delete m.signs;\n            return m;\n        });\n        var expanded = Snippet.from(rendered);\n        return expanded;\n        /* return from(Sheet.render(render(snippet))); */\n    };\n    Snippet.diff = function (snippetA, snippetB) {\n        var diffFormat = [Snippet.formatForDiff(snippetA), Snippet.formatForDiff(snippetB)];\n        return JsDiff.diffWords(diffFormat[0], diffFormat[1]);\n    };\n    return Snippet;\n}());\nexports.Snippet = Snippet;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Permutation = /** @class */ (function () {\n    function Permutation() {\n    }\n    Permutation.permutateElements = function (array, validate, path) {\n        if (path === void 0) { path = []; }\n        var isValid = function (next) { return !validate || validate(path, next, array); };\n        if (array.length === 1) {\n            return isValid(array[0]) ? array : [];\n        }\n        return array.filter(isValid).reduce(function (combinations, el) { return combinations.concat(Permutation.permutateElements(array.filter(function (e) { return e !== el; }), validate, path.concat([el])).map(function (subcombinations) { return [\n            el\n        ].concat(subcombinations); })); }, []);\n    };\n    Permutation.permutationComplexity = function (array, validate, path) {\n        if (path === void 0) { path = []; }\n        var validations = 0;\n        Permutation.permutateElements(array, function (path, next, array) {\n            ++validations;\n            return !validate || validate(path, next, array);\n        }, path);\n        return validations;\n    };\n    Permutation.permutateArray = function (array) {\n        if (array.length === 1) {\n            return array;\n        }\n        return array.reduce(function (combinations, el) { return combinations.concat(Permutation.permutateArray(array.filter(function (e) { return e !== el; }))\n            .map(function (subcombinations) { return ([el].concat(subcombinations)); })); }, []);\n    };\n    // combine multiple validators\n    Permutation.combineValidators = function () {\n        var validators = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            validators[_i] = arguments[_i];\n        }\n        return function (path, next, array) { return validators\n            .reduce(function (result, validator) { return result && validator(path, next, array); }, true); };\n    };\n    //https://stackoverflow.com/questions/9960908/permutations-in-javascript\n    Permutation.combinations = function (array) {\n        var length = array.length, result = [array.slice()], c = new Array(length).fill(0), i = 1, k, p;\n        while (i < length) {\n            if (c[i] < i) {\n                k = i % 2 && c[i];\n                p = array[i];\n                array[i] = array[k];\n                array[k] = p;\n                ++c[i];\n                i = 1;\n                result.push(array.slice());\n            }\n            else {\n                c[i] = 0;\n                ++i;\n            }\n        }\n        return result;\n    };\n    // https://gist.github.com/axelpale/3118596\n    Permutation.binomial = function (set, k) {\n        var i, j, combs, head, tailcombs;\n        // There is no way to take e.g. sets of 5 elements from\n        // a set of 4.\n        if (k > set.length || k <= 0) {\n            return [];\n        }\n        // K-sized set has only one K-sized subset.\n        if (k == set.length) {\n            return [set];\n        }\n        // There is N 1-sized subsets in a N-sized set.\n        if (k == 1) {\n            combs = [];\n            for (i = 0; i < set.length; i++) {\n                combs.push([set[i]]);\n            }\n            return combs;\n        }\n        // Assert {1 < k < set.length}\n        // Algorithm description:\n        // To get k-combinations of a set, we want to join each element\n        // with all (k-1)-combinations of the other elements. The set of\n        // these k-sized sets would be the desired result. However, as we\n        // represent sets with lists, we need to take duplicates into\n        // account. To avoid producing duplicates and also unnecessary\n        // computing, we use the following approach: each element i\n        // divides the list into three: the preceding elements, the\n        // current element i, and the subsequent elements. For the first\n        // element, the list of preceding elements is empty. For element i,\n        // we compute the (k-1)-computations of the subsequent elements,\n        // join each with the element i, and store the joined to the set of\n        // computed k-combinations. We do not need to take the preceding\n        // elements into account, because they have already been the i:th\n        // element so they are already computed and stored. When the length\n        // of the subsequent list drops below (k-1), we cannot find any\n        // (k-1)-combs, hence the upper limit for the iteration:\n        combs = [];\n        for (i = 0; i < set.length - k + 1; i++) {\n            // head is a list that includes only our current element.\n            head = set.slice(i, i + 1);\n            // We take smaller combinations from the subsequent elements\n            tailcombs = Permutation.binomial(set.slice(i + 1), k - 1);\n            // For each (k-1)-combination we join it with the current\n            // and store it to the set of k-combinations.\n            for (j = 0; j < tailcombs.length; j++) {\n                combs.push(head.concat(tailcombs[j]));\n            }\n        }\n        return combs;\n    };\n    return Permutation;\n}());\nexports.Permutation = Permutation;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Permutation_1 = require(\"../util/Permutation\");\nvar Logger_1 = require(\"../util/Logger\");\nvar tonal_1 = require(\"tonal\");\nvar tonal_2 = require(\"tonal\");\nvar tonal_3 = require(\"tonal\");\nvar tonal_4 = require(\"tonal\");\nvar util_1 = require(\"../util/util\");\nvar Harmony_1 = require(\"./Harmony\");\nvar Voicing = /** @class */ (function () {\n    function Voicing() {\n    }\n    /** Returns the next voicing that should follow the previously played voicing.\n    */\n    Voicing.getNextVoicing = function (chord, previousVoicing, options) {\n        if (options === void 0) { options = {}; }\n        var _a = __assign({ range: ['C3', 'C5'], rangeBorders: [3, 3], maxVoices: 4, forceDirection: null, maxDistance: 7, minBottomDistance: 3, minTopDistance: 2, noTopDrop: true, noTopAdd: true, noBottomDrop: false, noBottomAdd: false, logging: true }, options), maxVoices = _a.maxVoices, range = _a.range, forceDirection = _a.forceDirection, rangeBorders = _a.rangeBorders, sortChoices = _a.sortChoices, filterChoices = _a.filterChoices, noTopDrop = _a.noTopDrop, noTopAdd = _a.noTopAdd, noBottomDrop = _a.noBottomDrop, noBottomAdd = _a.noBottomAdd, logging = _a.logging;\n        // make sure tonal can read the chord\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        if (chord === 'r') {\n            return null;\n        }\n        var combinations = Voicing.getAllVoicePermutations(chord, maxVoices, options);\n        var exit = function () {\n            var pick = [];\n            if (logging) {\n                Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick });\n            }\n            return pick;\n        };\n        if (!combinations.length) {\n            return exit();\n        }\n        if (!previousVoicing || !previousVoicing.length) { // no previous chord\n            // filter out combinations that are out of range\n            combinations = combinations.filter(function (combination) {\n                var firstNote = Harmony_1.Harmony.getNearestNote(range[0], combination[0], 'up');\n                var pick = util_1.renderAbsoluteNotes(combination, tonal_2.Note.oct(firstNote));\n                return util_1.isInRange(pick[0], range) && util_1.isInRange(pick[pick.length - 1], range);\n            });\n            var firstPick = combinations[0];\n            var firstNoteInRange = Harmony_1.Harmony.getNearestNote(range[0], firstPick[0], 'up');\n            var pick_1 = util_1.renderAbsoluteNotes(firstPick, tonal_2.Note.oct(firstNoteInRange));\n            if (logging) {\n                Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick_1 });\n            }\n            return pick_1;\n        }\n        var choices = Voicing.getAllChoices(combinations, previousVoicing, range)\n            .filter(function (choice) {\n            return (!noTopDrop || !choice.dropped.includes(choice.topNotes[0])) &&\n                (!noTopAdd || !choice.added.includes(choice.topNotes[1])) &&\n                (!noBottomDrop || !choice.dropped.includes(choice.topNotes[0])) &&\n                (!noBottomAdd || !choice.added.includes(choice.topNotes[1])) &&\n                (!filterChoices || filterChoices(choice));\n        })\n            .sort(sortChoices ?\n            function (a, b) { return sortChoices(a, b); } :\n            function (a, b) { return a.difference - b.difference; });\n        if (!choices.length) {\n            return exit();\n        }\n        var bestPick = choices[0].targets, choice;\n        var direction = Voicing.getDesiredDirection(previousVoicing, range, rangeBorders) || forceDirection;\n        if (!direction) {\n            var pick_2 = bestPick;\n            choice = choices[0];\n            if (logging) {\n                Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick_2, direction: direction, bestPick: bestPick, choice: choice, choices: choices });\n            }\n            return pick_2;\n        }\n        // sort after movement instead of difference\n        choice = choices.sort(function (a, b) {\n            return Math.abs(a.movement) - Math.abs(b.movement);\n        }).find(function (choice) {\n            if (direction === 'up') {\n                return choice.movement >= 0;\n            }\n            return choice.movement <= 0;\n        });\n        if (!choice) { // keep hanging in the corner of the range..\n            choice = choices[0];\n        }\n        var pick = choice.targets;\n        if (logging) {\n            Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick, direction: direction, bestPick: bestPick, choice: choice, choices: choices });\n        }\n        return pick;\n    };\n    /** Computes all valid voice permutations for a given chord and voice number.\n     * Runs getVoicePermutations for each possible selection of notes.\n     */\n    Voicing.getAllVoicePermutations = function (chord, length, voicingOptions) {\n        return Voicing.getAllNoteSelections(chord, length)\n            .reduce(function (combinations, combination) {\n            return combinations.concat(Voicing.getVoicePermutations(combination, voicingOptions));\n        }, []);\n    };\n    /** Get all permutations of the given notes that would make a good voicing. */\n    Voicing.getVoicePermutations = function (notes, options) {\n        if (options === void 0) { options = {}; }\n        if (notes.length === 1) {\n            return [notes];\n        }\n        var validator = options.validatePermutation || (function (path, next, array) { return true; });\n        return Permutation_1.Permutation.permutateElements(notes, Permutation_1.Permutation.combineValidators(validator, Voicing.voicingValidator(options)));\n    };\n    /** Configurable Validator that sorts out note combinations with untasty intervals.  */\n    Voicing.voicingValidator = function (options) {\n        options = __assign({ maxDistance: 6, minDistance: 1, minBottomDistance: 3, minTopDistance: 2 }, options);\n        return function (path, next, array) {\n            return Permutation_1.Permutation.combineValidators(Voicing.notesAtPositionValidator(options.topNotes, path.length + array.length - 1), Voicing.notesAtPositionValidator(options.bottomNotes, 0), Voicing.validateInterval(function (interval) { return tonal_4.Interval.semitones(interval) <= options.maxDistance; }), Voicing.validateInterval(function (interval) { return tonal_4.Interval.semitones(interval) >= options.minDistance; }), Voicing.validateInterval(function (interval, _a) {\n                var array = _a.array;\n                return array.length !== 1 || tonal_4.Interval.semitones(interval) >= options.minTopDistance;\n            }), Voicing.validateInterval(function (interval, _a) {\n                var path = _a.path;\n                return path.length !== 1 || tonal_4.Interval.semitones(interval) >= options.minBottomDistance;\n            }))(path, next, array);\n        };\n    };\n    /** Validates the interval to the next note. You can write your own logic inside the validate fn. */\n    Voicing.validateInterval = function (validate) {\n        return function (path, next, array) {\n            if (!path.length) {\n                return true;\n            }\n            var interval = tonal_3.Distance.interval(path[path.length - 1], next);\n            return validate(interval, { path: path, next: next, array: array });\n        };\n    };\n    /** Returns all possible combinations of required and optional notes for a given chord and desired length.\n     * If the voices number is higher than the required notes of the chord, the rest number will be permutated from the optional notes */\n    Voicing.getAllNoteSelections = function (chord, voices) {\n        if (voices === void 0) { voices = 2; }\n        var required = Voicing.getRequiredNotes(chord);\n        if (voices === 1) {\n            return required.map(function (note) { return [note]; });\n        }\n        var fill = voices - required.length;\n        if (fill === 0) {\n            return [required];\n        }\n        if (fill < 0) { // required notes are enough\n            return Permutation_1.Permutation.binomial(required, voices);\n        }\n        var optional = Voicing.getOptionalNotes(chord, required);\n        if (fill >= optional.length) {\n            return [required.concat(optional)];\n        }\n        return Permutation_1.Permutation.binomial(optional, fill)\n            .map(function (selection) { return required.concat(selection); });\n    };\n    /** Get available tensions for a given chord. Omits tensions that kill the chord quality */\n    Voicing.getAvailableTensions = function (chord) {\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        var notes = tonal_1.Chord.notes(chord);\n        if (util_1.isDominantChord(chord)) {\n            return Voicing.getAllTensions(notes[0])\n                // filter out tensions that are part of the chord\n                .filter(function (note) { return !notes.find(function (n) { return util_1.semitoneDistance(notes[0], note) === util_1.semitoneDistance(notes[0], n); }); })\n                // filter out tensions that are a semitone above the 3 (if exists)\n                .filter(function (note) { return util_1.chordHasIntervals(chord, ['3!']) || util_1.semitoneDistance(util_1.getDegreeInChord(3, chord), note) > 1; })\n                // filter out tensions that are a semitone above the 4 (if exists => sus)\n                .filter(function (note) { return !util_1.chordHasIntervals(chord, ['4P']) || util_1.semitoneDistance(util_1.getDegreeInChord(4, chord), note) > 1; })\n                // filter out tensions that are a semitone above the 7\n                .filter(function (note) { return util_1.semitoneDistance(util_1.getDegreeInChord(7, chord), note) > 1; });\n        }\n        return notes.slice(0, 4)\n            // notes less than 3 semitones away from root are omitted (tensions 2M above would be in next octave)\n            .filter(function (note) { return note === notes[0] || util_1.semitoneDistance(note, notes[0]) > 2; })\n            // all tensions are a major second above a chord note\n            .map(function (note) { return tonal_3.Distance.transpose(note, '2M'); })\n            // tensions 2 semiontes below root are flat 7 => changes chord quality\n            .filter(function (note) { return util_1.semitoneDistance(note, notes[0]) !== 2; });\n        // omit tensions that end up on a chord note again?\n    };\n    /** Returns all Tensions that could be in any chord */\n    Voicing.getAllTensions = function (root) {\n        return ['b9', '9', '#9', '3', '11', '#11', 'b13', '13', '7']\n            .map(function (step) { return util_1.getIntervalFromStep(step); })\n            .map(function (interval) { return tonal_3.Distance.transpose(root, interval); });\n    };\n    /** Returns all notes that are required to outline a chord */\n    Voicing.getRequiredNotes = function (chord) {\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        var notes = tonal_1.Chord.notes(chord);\n        var intervals = tonal_1.Chord.intervals(chord);\n        var requiredSteps = [3, 7, 'b5', 6]; // order is important\n        if (!util_1.hasDegree(3, intervals)) {\n            requiredSteps.push(4); // fixes m6 chords\n        }\n        var required = requiredSteps.reduce(function (req, degree) {\n            if (util_1.hasDegree(degree, intervals)) {\n                req.push(util_1.getDegreeInChord(degree, chord));\n            }\n            return req;\n        }, []);\n        // WHY 3??\n        if (notes.length > 3 && !required.includes(notes[notes.length - 1])) {\n            required.push(notes[notes.length - 1]); // could check if is 5 than dont push\n        }\n        return required;\n    };\n    /** Returns all notes that are not required */\n    Voicing.getOptionalNotes = function (chord, required) {\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        var notes = tonal_1.Chord.notes(chord);\n        required = required || Voicing.getRequiredNotes(chord);\n        return notes.filter(function (note) { return !required.includes(note); });\n    };\n    /** Returns all possible note choices for the given combinations.\n     * Takes the bottom note of the previous voicing and computes the minimal intervals up and down to the next bottom note.\n     */\n    Voicing.getAllChoices = function (combinations, previousVoicing, range) {\n        var lastPitches = previousVoicing.map(function (note) { return tonal_2.Note.pc(note); });\n        return combinations\n            .map(function (combination) {\n            var bottomInterval = tonal_3.Distance.interval(lastPitches[0], combination[0]);\n            var bottomNotes = [\n                tonal_3.Distance.transpose(previousVoicing[0], Harmony_1.Harmony.minInterval(bottomInterval, 'down')),\n                tonal_3.Distance.transpose(previousVoicing[0], Harmony_1.Harmony.minInterval(bottomInterval, 'up')),\n            ];\n            if (bottomNotes[0] === bottomNotes[1]) {\n                bottomNotes = [bottomNotes[0]];\n            }\n            return { combination: combination, bottomNotes: bottomNotes };\n        })\n            .reduce(function (all, _a) {\n            var combination = _a.combination, bottomNotes = _a.bottomNotes;\n            return all.concat(bottomNotes.map(function (bottomNote) { return util_1.renderAbsoluteNotes(combination, tonal_2.Note.oct(bottomNote)); }));\n        }, [])\n            .filter(function (targets) {\n            return !range ||\n                util_1.isInRange(targets[0], range) &&\n                    util_1.isInRange(targets[targets.length - 1], range);\n        })\n            .reduce(function (all, targets) {\n            var leads = Voicing.voiceLeading(previousVoicing, targets);\n            return all.concat(leads);\n        }, []);\n    };\n    /** Analyzes all possible voice movements for all possible transitions. Handles inequal lengths */\n    Voicing.voiceLeading = function (origin, targets) {\n        // if same length > dont permutate\n        if (origin.length === targets.length) {\n            return Voicing.analyzeVoiceLeading(origin, targets);\n        }\n        var _a = [origin, targets].sort(function (a, b) { return b.length - a.length; }), more = _a[0], less = _a[1];\n        return Permutation_1.Permutation.binomial(more, less.length)\n            .map(function (selection) {\n            var _a, _b;\n            var from, to;\n            if (origin.length < targets.length) {\n                _a = [origin, selection], from = _a[0], to = _a[1];\n            }\n            else {\n                _b = [selection, targets], from = _b[0], to = _b[1];\n            }\n            return Voicing.analyzeVoiceLeading(from, to, origin, targets);\n        });\n    };\n    /** Analyzed the voice leading for the movement from > to.\n     * Origin and targets needs to be passed if the voice transition over unequal lengths\n     */\n    Voicing.analyzeVoiceLeading = function (from, to, origin, targets) {\n        var _a;\n        _a = [origin || from, targets || to], origin = _a[0], targets = _a[1];\n        var intervals = Voicing.voicingIntervals(from, to, false)\n            .map(function (interval) { return Harmony_1.Harmony.fixInterval(interval, false); });\n        /** Interval qualities */\n        var degrees = intervals.map(function (i) { return util_1.getDegreeFromInterval(i); });\n        /** Voices that did not move */\n        var oblique = from.filter(function (n, i) { return to.find(function (note) { return Harmony_1.Harmony.isSameNote(n, note); }); });\n        /** abs sum of semitones movements of voices */\n        var difference = util_1.semitoneDifference(intervals);\n        /** relative sum of semitone movements */\n        var movement = util_1.semitoneMovement(intervals);\n        /** voice differences did not cancel each other out > moved in same direction */\n        var similar = Math.abs(movement) === Math.abs(difference);\n        /** moves parallel if all interval qualities the same and in the same direction */\n        var parallel = difference > 0 && similar && degrees.reduce(function (match, degree, index) {\n            return match && (index === 0 || degrees[index - 1] === degree);\n        }, true);\n        // find out which notes have been dropped / added\n        var dropped = [], added = [];\n        if (origin.length < targets.length) {\n            added = targets.filter(function (n) { return !to.includes(n); });\n        }\n        else {\n            dropped = origin.filter(function (n) { return !from.includes(n); });\n        }\n        return {\n            from: from,\n            to: to,\n            origin: origin,\n            targets: targets,\n            intervals: intervals,\n            difference: difference,\n            movement: movement,\n            bottomInterval: intervals[0],\n            topInterval: intervals[intervals.length - 1],\n            topNotes: [origin[origin.length - 1], targets[targets.length - 1]],\n            bottomNotes: [origin[0], targets[0]],\n            similar: similar,\n            contrary: !similar,\n            parallel: parallel,\n            oblique: oblique,\n            degrees: degrees,\n            added: added,\n            dropped: dropped,\n        };\n    };\n    /** Returns true if the given note is contained in the given voicing. */\n    Voicing.containsNote = function (note, voicing, enharmonic) {\n        if (enharmonic === void 0) { enharmonic = true; }\n        if (!enharmonic) {\n            return voicing.includes(note);\n        }\n        return !!voicing.find(function (n) { return Harmony_1.Harmony.isSameNote(note, n); });\n    };\n    /** Returns the intervals between the given chord voicings.\n     * Can be passed pitch classes or absolute notes.\n     * The two voicings should have the same length. */\n    Voicing.voicingIntervals = function (chordA, chordB, min, direction) {\n        if (min === void 0) { min = true; }\n        if (chordA.length !== chordB.length) {\n            // console.log('voicingIntervals: not the same length..');\n        }\n        var intervals = chordA.map(function (n, i) {\n            var interval = tonal_3.Distance.interval(n, chordB[i]);\n            if (min === false) {\n                return interval;\n            }\n            if (util_1.isPitchClass(n) && util_1.isPitchClass(chordB[i])) {\n                return Harmony_1.Harmony.minInterval(interval, direction);\n            }\n            return interval;\n        });\n        return intervals;\n    };\n    /** Validates the current permutation to have a note at a certain position (array index) */\n    Voicing.notesAtPositionValidator = function (notes, position) {\n        if (notes === void 0) { notes = []; }\n        return function (selected, note, remaining) {\n            return !notes.length || selected.length !== position || notes.includes(note);\n        };\n    };\n    /** Returns true if the given voicing contains its root */\n    Voicing.hasTonic = function (voicing, chord) {\n        var tokens = tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord));\n        return voicing.map(function (n) { return tonal_2.Note.pc(n); }).includes(tokens[0]);\n    };\n    /** Returns the best direction to move for a given voicing in a range.\n     * Outputs a direction as soon as the semitone distance of one of the outer notes is below the given threshold\n     */\n    Voicing.getDesiredDirection = function (voicing, range, thresholds) {\n        if (thresholds === void 0) { thresholds = [3, 3]; }\n        var distances = util_1.getDistancesToRangeEnds([voicing[0], voicing[voicing.length - 1]], range);\n        if (distances[0] < thresholds[0] && distances[1] < thresholds[1]) {\n            console.error('range is too small to fit the comfy zone');\n            return;\n        }\n        if (distances[0] < thresholds[0]) {\n            return 'up';\n        }\n        if (distances[1] < thresholds[1]) {\n            return 'down';\n        }\n    };\n    return Voicing;\n}());\nexports.Voicing = Voicing;\n/**\n *\n\n\n\n    static getPossibleVoicings(chord, voices = 4) {\n        const required = getRequiredNotes(chord);\n        const optional = getOptionalNotes(chord);\n        const tensions = getAvailableTensions(chord);\n        return { required, optional, tensions };\n    }\n    static voicingDifference(chordA, chordB, min = true) {\n        return semitoneDifference(Voicing.voicingIntervals(chordA, chordB, min));\n    }\n\n    static voicingMovement(chordA, chordB, min = true, direction?: intervalDirection) {\n        return semitoneMovement(Voicing.voicingIntervals(chordA, chordB, min, direction));\n    }\n\n    static bestVoiceLeading(chordA, chordB, sortFn?) {\n        sortFn = sortFn || ((a, b) => a.difference - b.difference);\n        const voices = Voicing.voiceLeading(chordA, chordB)\n            .sort((best, current) => {\n                return sortFn(best, current);\n            }, null);\n        return voices[0];\n    }\n\n    static minVoiceMovement(chordA, chordB) {\n        [chordA, chordB] = [chordA, chordB].sort((a, b) => b.length - a.length);\n        const picks = Permutation.binomial(chordA, chordB.length);\n        return picks.reduce((min, current) => {\n            const diff = Voicing.voicingMovement(current, chordB, false);\n            if (Math.abs(diff) < Math.abs(min)) {\n                return diff;\n            }\n            return min;\n        }, 100);\n    }\n\n    static getVoices(chord, voices = 4, rootless = false, tension = 1) {\n        // THE PROBLEM: TENSION MUST BE CHOSEN WHEN SELECTING THE OPTIMAL VOICING!\n        chord = Harmony.getTonalChord(chord);\n        const tokens = Chord.tokenize(chord);\n        const required = Voicing.getRequiredNotes(chord);\n        let optional = Voicing.getOptionalNotes(chord, required);\n        let choices = [].concat(required);\n        const remaining = () => voices - choices.length;\n        if (tension > 0) {\n            choices = choices.concat(Voicing.getAvailableTensions(chord).slice(0, tension));\n        }\n        if (remaining() > 0) {\n            choices = choices.concat(optional);\n        }\n        if (remaining() < 0 && rootless) {\n            choices = choices.filter(n => n !== tokens[0]);\n        }\n        if (remaining() > 0) {\n            // console.warn(`${remaining} notes must be doubled!!!`);\n            choices = choices.concat(required, optional).slice(0, voices);\n        }\n        return choices.slice(0, voices);\n    }\n */ \n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"./util\");\nvar tonal_1 = require(\"tonal\");\nvar tonal_2 = require(\"tonal\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar Snippet_1 = require(\"../sheet/Snippet\");\nvar Voicing_1 = require(\"../harmony/Voicing\");\nvar Logger = /** @class */ (function () {\n    function Logger() {\n    }\n    Logger.logCustom = function (args, logFn) {\n        if (logFn === void 0) { logFn = console.log; }\n        /* console.clear(); */\n        logFn.apply(console, args);\n    };\n    Logger.logLegend = function () {\n        if (console.groupCollapsed) {\n            console.groupCollapsed('Show Emoji Legend');\n            console.table(Logger.emoji);\n            console.groupEnd();\n        }\n        else {\n            console.log('Emoji Legend:', Logger.emoji);\n        }\n    };\n    Logger.logSheet = function (sheet) {\n        sheet = __assign({ title: 'Untitled', composer: 'Unkown', chords: [], forms: 3, tempo: 130, style: 'Swing' }, sheet);\n        var snippet = Snippet_1.Snippet.from(sheet.chords);\n        console.log(sheet.composer + \" - \" + sheet.title);\n        console.log(sheet.tempo + \"bpm, Style: \" + sheet.style);\n        console.log(snippet);\n        if (console.groupCollapsed) {\n            console.log('Sheet', sheet);\n            /* console.log('Groove', sheet.groove); */\n            console.groupCollapsed(\"show \" + sheet.forms + \" rendered forms\");\n            console.log(\"expanded view\\n\\n\" + Snippet_1.Snippet.expand(snippet, { forms: sheet.forms || 1 }));\n            console.groupEnd();\n        }\n    };\n    Logger.logLabel = function (key) {\n        if (!Logger.emoji[key]) {\n            return key;\n        }\n        return Logger.emoji[key].icon + ' ' + key;\n    };\n    Logger.logChoice = function (choice) {\n        var _a;\n        if (!choice) {\n            return;\n        }\n        var difference = choice.difference, origin = choice.origin, targets = choice.targets, from = choice.from, to = choice.to, movement = choice.movement, similar = choice.similar, added = choice.added, dropped = choice.dropped, contrary = choice.contrary, parallel = choice.parallel, topInterval = choice.topInterval, bottomInterval = choice.bottomInterval, topNotes = choice.topNotes, bottomNotes = choice.bottomNotes, intervals = choice.intervals, degrees = choice.degrees;\n        console.table((_a = {\n                difference: difference,\n                movement: movement,\n                origin: origin.join(' '),\n                dropped: dropped.join(' '),\n                added: added.join(' '),\n                targets: targets.join(' '),\n                /* from: from.join(' '),\n                to: to.join(' '), */\n                intervals: intervals.join(' '),\n                degrees: degrees.join(' ')\n            },\n            _a[Logger.logLabel('similar')] = similar,\n            _a[Logger.logLabel('contrary')] = contrary,\n            _a[Logger.logLabel('parallel')] = parallel,\n            _a.topNotes = topNotes.join(' '),\n            _a.topInterval = topInterval,\n            _a.bottomNotes = bottomNotes.join(' '),\n            _a.bottomInterval = bottomInterval,\n            _a));\n    };\n    Logger.logNotes = function (activeNotes, idleNotes, addedNotes, range) {\n        var span = [\n            tonal_1.Distance.transpose(range[0], tonal_2.Interval.fromSemitones(-7)),\n            tonal_1.Distance.transpose(range[1], tonal_2.Interval.fromSemitones(12))\n        ];\n        var allNotes = util_1.noteArray(span);\n        var keyboard = allNotes.map(function (note, index) {\n            var active = !!activeNotes.find(function (n) { return Harmony_1.Harmony.isSameNote(note, n); });\n            var idle = !!idleNotes.find(function (n) { return Harmony_1.Harmony.isSameNote(note, n); });\n            var added = !!addedNotes.find(function (n) { return Harmony_1.Harmony.isSameNote(note, n); });\n            var black = Harmony_1.Harmony.isBlack(note);\n            var css = '', sign = '_';\n            if (added && !black) {\n                css = 'color:green;';\n                sign = '';\n            }\n            else if (added && black) {\n                css = 'color:darkgreen;';\n                sign = '';\n            }\n            else if (active && black) {\n                css = 'color:#a50909;';\n                sign = '';\n            }\n            else if (active && !black) {\n                css = 'color:#eda3a3;';\n                sign = '';\n            }\n            else if (idle && !black) {\n                css = 'color:gray;';\n                sign = '';\n            }\n            else if (idle && black) {\n                css = 'color:black;';\n                sign = '';\n            }\n            else {\n                css = black ? 'color:black;' : 'color:#eee;';\n            }\n            var position = util_1.getRangePosition(note, range);\n            if (position < 0 || position > 1) {\n                if (active || idle || added) {\n                    css += 'color:red;';\n                }\n                else {\n                    sign = ' ';\n                }\n            }\n            return {\n                sign: sign,\n                css: css\n            };\n        });\n        var args = [\n            keyboard.map(function (key) { return \"%c\" + key.sign; }).join('')\n        ].concat((keyboard.map(function (key) { return key.css + \";\"; })));\n        /* Snippet.logCustom(args); */\n        return args;\n    };\n    Logger.logVoicing = function (_a) {\n        var chord = _a.chord, previousVoicing = _a.previousVoicing, combinations = _a.combinations, bestPick = _a.bestPick, pick = _a.pick, range = _a.range, choice = _a.choice, direction = _a.direction, choices = _a.choices;\n        /* pick = pick.map(n => Note.simplify(n)); */\n        pick = pick || [];\n        previousVoicing = previousVoicing || [];\n        var idle = previousVoicing.filter(function (n) { return pick.find(function (p) { return Harmony_1.Harmony.isSameNote(n, p); }); });\n        var active = pick.filter(function (n) { return !previousVoicing.find(function (p) { return Harmony_1.Harmony.isSameNote(n, p); }); });\n        var added = choice ? choice.added : [];\n        var konsole = Logger.logNotes(active, idle, added, range);\n        var movement = choice ? choice.movement : 0;\n        var difference = choice ? choice.difference : 0;\n        choices = choices || [];\n        if (movement > 0) {\n            konsole.push(Logger.emoji.movedUp.icon);\n        }\n        else if (movement < 0) {\n            konsole.push(Logger.emoji.movedDown.icon);\n        }\n        else {\n            konsole.push(Logger.emoji.equilibrium.icon);\n        }\n        if (!pick.length) {\n            konsole.push(Logger.emoji.error.icon);\n        }\n        // TODO replace force with filter of choices after isInRange\n        //      isInRange: checks if top and bottom note are inside the range\n        if (!direction) {\n            konsole.push(Logger.emoji.bestMatch.icon);\n        }\n        else {\n            if (bestPick !== pick) {\n                konsole.push(Logger.emoji.force.icon);\n            }\n            else {\n                konsole.push(Logger.emoji.lucky.icon);\n            }\n            // wrong direction?\n            if ((direction === 'up' && movement < 0) || (direction === 'down' && movement > 0)) {\n                konsole.push(Logger.emoji.wrong.icon);\n            }\n        }\n        if (choice) {\n            if (choice.similar) {\n                konsole.push(Logger.emoji.similar.icon);\n            }\n            if (choice.contrary) {\n                konsole.push(Logger.emoji.contrary.icon);\n            }\n            if (choice.parallel) {\n                konsole.push(Logger.emoji.parallel.icon);\n            }\n            if (choice.added.length && choice.added[choice.added.length - 1] === choice.topNotes[1]) {\n                konsole.push(Logger.emoji.topAdded.icon);\n            }\n            if (choice.dropped.length && choice.dropped[choice.dropped.length - 1] === choice.topNotes[0]) {\n                konsole.push(Logger.emoji.topRemoved.icon);\n            }\n            if (choice.dropped.length && choice.dropped[0] === choice.origin[0]) {\n                konsole.push(Logger.emoji.bottomRemoved.icon);\n            }\n            if (choice.added.length && choice.added[0] === choice.targets[0]) {\n                konsole.push(Logger.emoji.bottomAdded.icon);\n            }\n            if (!Voicing_1.Voicing.hasTonic(pick, chord)) {\n                konsole.push(Logger.emoji.rootless.icon);\n            }\n            if (!choice.parallel && choice.oblique.length === 0) {\n                konsole.push(Logger.emoji.noOblique.icon);\n            }\n            if (choice.oblique.length === choice.targets.length) {\n                konsole.push(Logger.emoji.noChange.icon);\n            }\n        }\n        previousVoicing = previousVoicing || [];\n        konsole.push(difference + \"/\" + movement + \": \" + chord + \" (\" + (choices.indexOf(choice) + 1) + \"/\" + choices.length + \")\");\n        if (combinations) {\n            if (combinations.length < 4) {\n                konsole.push(Logger.emoji.fewCombinations.icon);\n            }\n        }\n        if (console && console.table) {\n            Logger.logCustom(konsole, console.groupCollapsed);\n            console.table({\n                previousVoicing: previousVoicing.join(' '),\n                pick: pick.join(' '),\n            });\n            if (choice) {\n                console.group('Choice:');\n                Logger.logChoice(choice);\n                console.groupEnd();\n                console.groupCollapsed('All Choices:');\n                choices.forEach(function (c) { return Logger.logChoice(c); });\n                console.groupEnd();\n                console.groupCollapsed('Combinations:');\n                console.log(combinations);\n                console.groupEnd();\n            }\n            console.groupEnd();\n        }\n        //console.log(`${ Snippet.voicing(voicing, ['G2', 'C5']) } ${ chord }: ${ voicing.join(' ') } `);\n        //console.log(`#${ event.path[1] + 1 }: ${ chord }: ${ latest } > ${ voicing }.moved ${ moves } (avg | ${ avgDiff } | total ${ totalMoves })`);\n        // console.log(chord, voicing);\n        // G#o7 2 (5.25) (4)[\"G3\", \"D4\", \"F4\", \"Bb4\"] > (4)[\"B2\", \"D3\", \"E#3\", \"G#3\"]\n        /* } */\n        return pick;\n    };\n    Logger.emoji = {\n        bestMatch: {\n            icon: '',\n            description: 'The selected voicing had the best possible voice leading from the previous voicing'\n        },\n        force: {\n            icon: '',\n            description: 'Voicing had to be forced in the desired direction. The best pick would have gone in the wrong direction.'\n        },\n        lucky: {\n            icon: '',\n            description: 'The best pick moved in the direction that would have been forced.'\n        },\n        wrong: {\n            icon: '',\n            description: 'Continued moving in the wrong direction'\n        },\n        similar: {\n            icon: '',\n            description: 'All voices are moving in the same direction'\n        },\n        parallel: {\n            icon: '',\n            description: 'All voices are moving by parallel intervals'\n        },\n        contrary: {\n            icon: '',\n            description: 'Some voices were moving in opposite directions'\n        },\n        noOblique: {\n            icon: '',\n            description: 'All voices changed position. (Not shown when parallel)'\n        },\n        noChange: {\n            icon: '',\n            description: 'All voices remained in position.'\n        },\n        topAdded: {\n            icon: '',\n            description: 'A top voice was added',\n        },\n        topRemoved: {\n            icon: '',\n            description: 'A top voice was dropped'\n        },\n        bottomRemoved: {\n            icon: '',\n            description: 'A bottom voice was dropped'\n        },\n        bottomAdded: {\n            icon: '',\n            description: 'A bottom note was added'\n        },\n        movedUp: {\n            icon: '',\n            description: 'The Voices generally moved up'\n        },\n        movedDown: {\n            icon: '',\n            description: 'The Voices generally moved down'\n        },\n        equilibrium: {\n            icon: '',\n            description: 'The Voices generally did not move anywhere'\n        },\n        fewCombinations: {\n            icon: '',\n            description: 'There were very few valid combinations to choose from'\n        },\n        error: {\n            icon: '',\n            description: 'No notes could be selected. Some error happened.'\n        },\n        rootless: {\n            icon: '',\n            description: 'The voicing does not contain its root note (tonic).'\n        }\n        // \n    };\n    return Logger;\n}());\nexports.Logger = Logger;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Pulse_1 = require(\"./Pulse\");\nvar Sheet_1 = require(\"./sheet/Sheet\");\nvar Metronome_1 = require(\"./Metronome\");\nvar Logger_1 = require(\"./util/Logger\");\n/** Band */\nvar Band = /** @class */ (function () {\n    function Band(_a) {\n        var _b = _a === void 0 ? {} : _a, context = _b.context, musicians = _b.musicians, onMeasure = _b.onMeasure;\n        this.defaults = {\n            cycle: 4,\n            division: 3,\n            transpose: 0,\n            style: 'Medium Swing',\n        };\n        this.context = context || new AudioContext();\n        this.onMeasure = onMeasure;\n        this.musicians = musicians || [];\n        this.mix = this.setupMix(this.context);\n        this.metronome = new Metronome_1.Metronome(this.mix);\n    }\n    Band.prototype.setupMix = function (context) {\n        var mix = context.createGain();\n        mix.gain.value = 0.9;\n        mix.connect(context.destination);\n        return mix;\n    };\n    Band.prototype.addMember = function (musician) {\n        this.musicians = this.musicians.concat(musician);\n    };\n    Band.prototype.ready = function () {\n        return Promise.all([this.resume()].concat(this.musicians.map(function (m) { return m.ready; })));\n    };\n    Band.prototype.resume = function () {\n        var _this = this;\n        return this.context.resume().then(function () { return _this.context; });\n    };\n    Band.prototype.comp = function (sheet, settings) {\n        if (this.pulse) {\n            this.pulse.stop();\n        }\n        Logger_1.Logger.logLegend();\n        Logger_1.Logger.logSheet(sheet);\n        var measures = Sheet_1.Sheet.render(sheet.chords, settings.render);\n        measures = measures.concat(measures);\n        settings = Object.assign(this.defaults, settings, { context: this.context });\n        this.play(measures, settings);\n    };\n    Band.prototype.play = function (measures, settings) {\n        var _this = this;\n        this.ready().then(function () {\n            _this.pulse = settings.pulse || new Pulse_1.Pulse(settings);\n            return _this.count(_this.pulse, settings.metronome ? null : 0);\n        }).then(function (tick) {\n            /* settings.deadline = tick.deadline; */\n            if (_this.onMeasure) {\n                // TODO: add onChord for setting tonics + circle chroma etc\n                _this.pulse.tickArray(measures.map(function (measure) { return ({ measure: measure }); }), function (tick) { return _this.onMeasure(tick.value.measure, tick); });\n            }\n            measures = measures.map(function (m) { return m.chords ? m.chords : m; });\n            console.log('Band#play', settings);\n            var musicians = (settings.musicians || _this.musicians);\n            musicians.forEach(function (musician) { return musician.play({ pulse: _this.pulse, measures: measures, settings: settings }); });\n            _this.pulse.start();\n        });\n    };\n    Band.prototype.count = function (pulse, bars) {\n        if (bars === void 0) { bars = 1; }\n        if (pulse.getMeasureLength() < 1.5) {\n            bars *= 2; //double countin bars when countin would be shorter than 1.5s\n        }\n        return this.metronome.count(pulse, bars);\n    };\n    return Band;\n}());\nexports.default = Band;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Musician = /** @class */ (function () {\n    function Musician(instrument) {\n        this.name = 'Musician';\n        this.gain = 1;\n        if (!instrument) {\n            console.warn('musician has no instrument', this);\n        }\n        this.instrument = instrument;\n        this.ready = this.instrument ? this.instrument.ready : Promise.resolve();\n    }\n    Musician.prototype.play = function (_a) {\n        var pulse = _a.pulse, measures = _a.measures, settings = _a.settings;\n        console.log('play..', pulse, measures, settings);\n    };\n    Musician.prototype.getGain = function (value) {\n        if (value === void 0) { value = 1; }\n        return value * this.gain * this.instrument.gain;\n    };\n    return Musician;\n}());\nexports.Musician = Musician;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nvar off = function () { return util_1.randomElement([0, [0, 0, 2]], [6, 1]); };\nvar eightFour = function () { return util_1.randomElement([[1, 0, 1], 1, [0, 0, 1, 1]], [4, 2, 1]); };\nvar eightOff = function () { return util_1.randomElement([[1, 0, 1], [0, 0, 1]], [4, 1]); };\nvar halfTriplet = function () { return util_1.randomElement([\n    [2, 0],\n    [[2, 0, 2], [0, 2, 0]],\n    [1, 1, 1, 1]\n], [2, 1, 1]); };\nexports.swing = {\n    name: 'Swing',\n    tempo: 130,\n    chords: function (_a) {\n        var measure = _a.measure, settings = _a.settings;\n        var r = Math.random() > 0.5 ? .6 : 0;\n        var t = settings.cycle + \"/\" + measure.length;\n        if (t === '4/1') {\n            return util_1.randomElement([\n                [[1, 0], [0, 0, 7], 0, 0],\n                [1, [0, 0, 2], 0, off()],\n                [[0, 0, 1], 0, 2, 0],\n                [[0, 0, 4], 0, 1, 0],\n                [2, 0, 0, 0],\n                [3, 0, 0, 0],\n                [1, 0, r, off()],\n                [[0, 0, 2], 0, r, 0],\n                [1.5, [0, 0, 2], 0, off()],\n            ]); //, [2, 1, 1]\n        }\n        if (t === '4/2') {\n            return util_1.randomElement([\n                [[1, 0], [0, 0, 7], 0, 0],\n                [1, [0, 0, 3], 0, 0],\n                [1, 0, 2, 0],\n                [2, 0, 1, 0],\n                [1, 0, .7, off()],\n                [[1, 0, 0], 0, .7, off()],\n                [[4, 0, 0], [0, 0, 2.8], 0, off()],\n            ]);\n        }\n        if (t === '4/3') {\n            return [1, [0, 0, 2], [0, 0, 4], 0];\n        }\n        if ('4/4') {\n            return util_1.randomElement([\n                [1, 1, 1, 1],\n                [[1, 0, 2], [0, 0, 2], 0, 1]\n            ]);\n        }\n    },\n    bass: function () { return util_1.randomElement([\n        [1, 1, 1, 1],\n    ]); },\n    crash: function (_a) {\n        var measures = _a.measures, index = _a.index;\n        var fill = index !== 0 && index % measures.length === 0;\n        if (fill) {\n            return [4, 0, 0, 0];\n        }\n        return [0, 0, 0, 0];\n    },\n    ride: function (_a) {\n        var measures = _a.measures, index = _a.index;\n        return util_1.randomElement([\n            [.6, [.9, 0, 1], .6, [.9, 0, 1]],\n            [.6, [.4, 0, 1], .8, [0, 0, 1],],\n            [.6, .9, [.6, 0, 1], 1],\n            [.6, .9, .6, [.9, 0, 1]],\n        ], [3, 2, 1, 2]);\n    },\n    hihat: function () { return [0, .8, 0, 1]; },\n    solo: function () { return util_1.randomElement([\n        [eightFour(), eightFour(), eightFour(), eightFour()],\n        [eightFour(), 2, 0, eightFour()],\n        [0, 0, eightFour(), eightFour()],\n        [[1, 0, 4], 0, eightFour(), eightFour()],\n        [3, 0, 0, eightFour()],\n        halfTriplet().concat(halfTriplet()),\n        [eightOff(), eightOff(), eightOff(), eightOff()],\n    ]); }\n    /* solo: () => [1, 1, 0, 1] */\n};\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nvar Musician_1 = require(\"./Musician\");\nvar swing_1 = require(\"../grooves/swing\");\nvar Voicing_1 = require(\"../harmony/Voicing\");\nvar tonal_1 = require(\"tonal\");\nvar Pianist = /** @class */ (function (_super) {\n    __extends(Pianist, _super);\n    function Pianist(instrument, props) {\n        if (props === void 0) { props = {}; }\n        var _this = _super.call(this, instrument) || this;\n        _this.name = 'Pianist';\n        _this.playedNotes = [];\n        _this.playedChords = [];\n        _this.defaults = { groove: swing_1.swing };\n        _this.min = Math.min;\n        _this.rollFactor = 1; // how much keyroll effect? controls interval between notes\n        _this.voicingOptions = {};\n        _this.props = Object.assign({}, _this.defaults, props || {});\n        return _this;\n    }\n    Pianist.prototype.play = function (_a) {\n        var _this = this;\n        var pulse = _a.pulse, measures = _a.measures, settings = _a.settings;\n        var groove = settings.groove || this.defaults.groove;\n        var grooveKey = 'chords';\n        this.voicingOptions = __assign({}, this.voicingOptions, settings.voicings || {});\n        // if no groove or groove without chords, or exact, play whats there\n        // TODO: exact timing is false with metronome\n        if (settings.exact || !groove || !groove[grooveKey]) {\n            if (!groove[grooveKey]) {\n                console.warn('Groove has no chords, Pianist will play exact.', groove);\n            }\n            measures = measures\n                .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); });\n            return pulse.tickArray(measures, function (_a) {\n                var value = _a.value, deadline = _a.deadline;\n                var fraction = util_1.getDuration(value.divisions, 1);\n                // TODO: find out why value fraction is NaN\n                var duration = fraction * pulse.getMeasureLength();\n                _this.playChord(value.chord || value, { deadline: deadline, duration: duration, pulse: pulse });\n            });\n        }\n        // else, play groovy\n        var pattern = groove[grooveKey];\n        measures = measures\n            // generate random patterns\n            .map(function (measure) { return pattern({ measures: measures, pulse: pulse, measure: measure, settings: settings })\n            .slice(0, Math.floor(settings.cycle)); })\n            // fill in chords\n            .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); })\n            // fix chords at last offbeat\n            .reduce(util_1.offbeatReducer(settings), []);\n        pulse.tickArray(measures, function (_a) {\n            var path = _a.path, value = _a.value, deadline = _a.deadline;\n            var measureLength = pulse.getMeasureLength();\n            var concurrency = settings.bpm / (_this.rollFactor || 1);\n            var interval = settings.arpeggio ? measureLength / settings.cycle : Math.random() / (concurrency * 20);\n            if (path[0] % 2 === 0 && !path[1] && !path[2]) {\n                interval = Math.random() / concurrency;\n            }\n            var duration = settings.arpeggio ? interval : value.fraction * measureLength;\n            var slice = settings.arpeggio ? Math.ceil(value.fraction / 1000 * 4) : null;\n            var gain = _this.getGain(value.gain);\n            _this.playChord(value.chord, { deadline: deadline, gain: gain, duration: duration, interval: interval, slice: slice, pulse: pulse });\n        }, settings.deadline);\n    };\n    Pianist.prototype.getLastVoicing = function () {\n        return this.playedNotes.length ? this.playedNotes[this.playedNotes.length - 1] : null;\n    };\n    // plays the given notes at the given interval\n    Pianist.prototype.playNotes = function (scorenotes, _a) {\n        var deadline = _a.deadline, interval = _a.interval, gain = _a.gain, duration = _a.duration, pulse = _a.pulse;\n        this.playedNotes.push([].concat(scorenotes));\n        this.instrument.playNotes(scorenotes, { deadline: deadline, interval: interval, gain: gain, duration: duration, pulse: pulse });\n    };\n    Pianist.prototype.playChord = function (chord, settings) {\n        if (chord === 'x') { // repeat\n            chord = this.playedChords[this.playedChords.length - 1];\n        }\n        if (!chord || chord === '0') {\n            this.playedChords.push('');\n            return;\n        }\n        this.playedChords.push(chord);\n        var notes = Voicing_1.Voicing.getNextVoicing(chord, this.getLastVoicing(), this.voicingOptions);\n        notes = notes.map(function (note) { return tonal_1.Note.simplify(note); });\n        settings.deadline += 0.02 + util_1.randomDelay(5);\n        this.playNotes(notes, settings);\n    };\n    return Pianist;\n}(Musician_1.Musician));\nexports.default = Pianist;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Musician_1 = require(\"./Musician\");\nvar swing_1 = require(\"../grooves/swing\");\nvar util_1 = require(\"../util/util\");\nvar Drummer = /** @class */ (function (_super) {\n    __extends(Drummer, _super);\n    function Drummer(instrument) {\n        var _this = _super.call(this, instrument) || this;\n        _this.name = 'Drummer';\n        _this.set = {\n            kick: 0,\n            snare: 1,\n            hihat: 2,\n            ride: 3,\n            crash: 4,\n            rimshot: 5\n        };\n        _this.defaults = { groove: swing_1.swing };\n        return _this;\n    }\n    Drummer.prototype.play = function (_a) {\n        var _this = this;\n        var measures = _a.measures, pulse = _a.pulse, settings = _a.settings;\n        var groove = settings.groove || this.defaults.groove;\n        Object.keys(groove)\n            .filter(function (t) { return Object.keys(_this.set).includes(t); }) // only use drum set patterns\n            .forEach(function (key) {\n            var patterns = measures\n                .map(function (measure, index) { return groove[key]({ measures: measures, index: index, measure: measure, settings: settings, pulse: pulse })\n                .slice(0, Math.floor(settings.cycle)); });\n            pulse.tickArray(patterns, function (_a) {\n                var deadline = _a.deadline, value = _a.value;\n                deadline += util_1.randomDelay(5);\n                _this.instrument.playKeys([_this.set[key]], { deadline: deadline, gain: _this.getGain(value) });\n            }, settings.deadline);\n        });\n    };\n    return Drummer;\n}(Musician_1.Musician));\nexports.default = Drummer;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nvar Musician_1 = require(\"./Musician\");\nvar tonal_1 = require(\"tonal\");\nvar swing_1 = require(\"../grooves/swing\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar Bassist = /** @class */ (function (_super) {\n    __extends(Bassist, _super);\n    function Bassist(instrument) {\n        var _this = _super.call(this, instrument) || this;\n        _this.name = 'Bassist';\n        _this.defaults = { groove: swing_1.swing };\n        _this.playedChords = [];\n        return _this;\n    }\n    Bassist.prototype.play = function (_a) {\n        var _this = this;\n        var measures = _a.measures, pulse = _a.pulse, settings = _a.settings;\n        var groove = settings.groove || this.defaults.groove;\n        var pattern = groove['bass'];\n        if (!pattern) {\n            console.warn('no bass pattern found in groove', groove);\n            return;\n        }\n        measures = measures\n            .map(function (measure) { return pattern({ measures: measures, measure: measure, settings: settings, pulse: pulse }).slice(0, Math.floor(settings.cycle)); })\n            .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); });\n        pulse.tickArray(measures, function (tick) {\n            _this.playBass(tick, measures, pulse);\n        }, settings.deadline);\n    };\n    Bassist.prototype.getStep = function (step, chord, octave) {\n        if (octave === void 0) { octave = 2; }\n        var tokens = tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord));\n        var interval = tonal_1.Chord.intervals(tokens[1]).find(function (i) { return parseInt(i[0]) === step; });\n        return tonal_1.Distance.transpose(tokens[0] + octave, interval);\n    };\n    Bassist.prototype.playBass = function (_a, measures, pulse) {\n        var value = _a.value, cycle = _a.cycle, path = _a.path, deadline = _a.deadline, interval = _a.interval;\n        var chord = value.chord;\n        if (chord === 'N.C.') {\n            return;\n        }\n        if (chord === 'x') {\n            chord = this.playedChords[this.playedChords.length - 1];\n        }\n        if (!chord || chord === '0') {\n            this.playedChords.push('');\n            return;\n        }\n        this.playedChords.push(chord);\n        var note;\n        var steps = [1, util_1.randomElement([3, 5]), 1, util_1.randomElement([3, 5])];\n        var octave = 2;\n        if (value.value === 1 && chord.split('/').length > 1) {\n            note = chord.split('/')[1] + octave;\n        }\n        else {\n            note = this.getStep(steps[path[1]], Harmony_1.Harmony.getTonalChord(chord), octave);\n        }\n        var duration = value.fraction * pulse.getMeasureLength();\n        deadline += util_1.randomDelay(10);\n        this.instrument.playNotes([note], { deadline: deadline, interval: interval, gain: this.getGain() * .7, duration: duration, pulse: pulse });\n    };\n    return Bassist;\n}(Musician_1.Musician));\nexports.default = Bassist;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Instrument_1 = require(\"./Instrument\");\nvar util_1 = require(\"../util/util\");\nvar Sampler = /** @class */ (function (_super) {\n    __extends(Sampler, _super);\n    function Sampler(options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, options) || this;\n        _this.buffers = {};\n        _this.duration = 10000;\n        _this.type = 'sine';\n        _this.gain = 1;\n        _this.attack = 0;\n        _this.decay = 0;\n        _this.sustain = 1;\n        _this.release = .2;\n        _this.gain = options.gain || _this.gain;\n        _this.gainNode = _this.context.createGain();\n        _this.gainNode.connect(_this.context.destination);\n        _this.duration = options.duration || _this.duration;\n        // this.overlap = options.overlap;\n        if (options.samples) {\n            _this.sources = options.samples;\n            _this.ready = _this.loadSources(options.samples);\n        }\n        return _this;\n    }\n    // returns buffer from buffer cache or loads buffer data from source\n    Sampler.prototype.getBuffer = function (src, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        if (this.buffers[src] && this.buffers[src].context === context) {\n            // console.log('buffer already present');\n            return Promise.resolve(this.buffers[src].buffer);\n        }\n        return fetch(src)\n            .then(function (res) { return res.arrayBuffer(); })\n            .then(function (buffer) {\n            return new Promise(function (resolve, reject) {\n                context.decodeAudioData(buffer, function (decodedData) {\n                    _this.buffers[src] = { buffer: decodedData, context: context };\n                    resolve(decodedData);\n                });\n            });\n        });\n    };\n    Sampler.prototype.getSource = function (buffer, connect) {\n        var source = this.context.createBufferSource();\n        connect = connect || this.gainNode;\n        source.buffer = buffer;\n        source.connect(connect);\n        return source;\n    };\n    Sampler.prototype.getSources = function (sources, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        if (!this.hasLoaded(sources)) {\n            console.error('not all sources loaded!!!');\n            return [];\n        }\n        return sources.map(function (source) { return _this.getSource(_this.buffers[source].buffer); });\n    };\n    // loads a sound file into the context\n    Sampler.prototype.loadSource = function (src, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        return this.getBuffer(src, context)\n            .then(function (decodedData) { return _this.getSource(decodedData); });\n    };\n    // loads multiple sources into the context\n    Sampler.prototype.loadSources = function (sources, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        sources.forEach(function (source, i) {\n            if (!source) {\n                console.warn(\"note at index \" + i + \" cannot be played!\");\n            }\n        });\n        return Promise.all(sources.filter(function (source) { return !!source; }).map(function (source) { return _this.loadSource(source, context); }));\n    };\n    Sampler.prototype.hasLoaded = function (sources, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        return sources.reduce(function (allLoaded, src) {\n            return allLoaded && _this.buffers[src] && _this.buffers[src].context === context;\n        }, true);\n    };\n    Sampler.prototype.playSounds = function (sounds, deadline, interval) {\n        if (deadline === void 0) { deadline = this.context.currentTime; }\n        if (interval === void 0) { interval = 0; }\n        sounds.forEach(function (sound, i) { return sound.start(deadline + interval * i); });\n    };\n    Sampler.prototype.playSource = function (source, settings) {\n        var gainNode = this.context.createGain();\n        if (!this.buffers[source]) {\n            console.warn('no buffer found for source', source);\n            return;\n        }\n        var sound = this.getSource(this.buffers[source].buffer, gainNode);\n        var _a = [\n            settings.attack || this.attack,\n            settings.decay || this.decay,\n            settings.sustain || this.sustain,\n            settings.release || this.release,\n            (settings.duration || this.duration) / 1000,\n            (settings.gain || 1) * this.gain\n        ], attack = _a[0], decay = _a[1], sustain = _a[2], release = _a[3], duration = _a[4], gain = _a[5];\n        var time = settings.deadline || this.context.currentTime;\n        //gainNode.gain.value = typeof settings.gain === 'number' ? settings.gain : this.gain;\n        gainNode.connect(this.mix);\n        util_1.adsr({ attack: attack, decay: decay, sustain: sustain, release: release, gain: gain, duration: duration }, time, gainNode.gain);\n        this.playSounds([sound], time); //, settings.interval\n    };\n    /* playSources(sources, deadline = 0, interval = 0) {\n        if (this.hasLoaded(sources, this.context)) {\n            this.playSounds(this.getSources(sources, this.context), deadline, interval)\n        } else {\n            console.warn('need to load');\n            this.loadSources(sources, this.context)\n                .then(sounds => this.playSounds(sounds, deadline, interval));\n        }\n    } */\n    Sampler.prototype.playKeys = function (keys, settings) {\n        var _this = this;\n        _super.prototype.playKeys.call(this, keys, settings);\n        keys.forEach(function (key, index) {\n            if (settings.delay) {\n                settings.deadline += settings.delay;\n            }\n            _this.playSource(_this.sources[key], settings);\n        });\n    };\n    return Sampler;\n}(Instrument_1.Instrument));\nexports.Sampler = Sampler;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Kick = /** @class */ (function () {\n    function Kick(context) {\n        this.context = context;\n    }\n    Kick.prototype.setup = function () {\n        this.osc = this.context.createOscillator();\n        this.gain = this.context.createGain();\n        this.osc.connect(this.gain);\n        this.gain.connect(this.context.destination);\n    };\n    Kick.prototype.trigger = function (time) {\n        this.setup();\n        this.osc.frequency.setValueAtTime(150, time);\n        this.gain.gain.setValueAtTime(1, time);\n        this.osc.frequency.exponentialRampToValueAtTime(0.01, time + 0.5);\n        this.gain.gain.exponentialRampToValueAtTime(0.01, time + 0.5);\n        this.osc.start(time);\n        this.osc.stop(time + 0.5);\n    };\n    return Kick;\n}());\nexports.Kick = Kick;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Snare = /** @class */ (function () {\n    function Snare(context) {\n        this.context = context;\n    }\n    Snare.prototype.noiseBuffer = function () {\n        var bufferSize = this.context.sampleRate;\n        var buffer = this.context.createBuffer(1, bufferSize, this.context.sampleRate);\n        var output = buffer.getChannelData(0);\n        for (var i = 0; i < bufferSize; i++) {\n            output[i] = Math.random() * 2 - 1;\n        }\n        return buffer;\n    };\n    Snare.prototype.setup = function () {\n        this.noise = this.context.createBufferSource();\n        this.noise.buffer = this.noiseBuffer();\n        var noiseFilter = this.context.createBiquadFilter();\n        noiseFilter.type = 'highpass';\n        noiseFilter.frequency.value = 1000;\n        this.noise.connect(noiseFilter);\n        this.noiseEnvelope = this.context.createGain();\n        noiseFilter.connect(this.noiseEnvelope);\n        this.noiseEnvelope.connect(this.context.destination);\n        this.osc = this.context.createOscillator();\n        this.osc.type = 'triangle';\n        this.oscEnvelope = this.context.createGain();\n        this.osc.connect(this.oscEnvelope);\n        this.oscEnvelope.connect(this.context.destination);\n    };\n    ;\n    Snare.prototype.trigger = function (time) {\n        this.setup();\n        this.noiseEnvelope.gain.setValueAtTime(1, time);\n        this.noiseEnvelope.gain.exponentialRampToValueAtTime(0.01, time + 0.2);\n        this.noise.start(time);\n        this.osc.frequency.setValueAtTime(100, time);\n        this.oscEnvelope.gain.setValueAtTime(0.7, time);\n        this.oscEnvelope.gain.exponentialRampToValueAtTime(0.01, time + 0.1);\n        this.osc.start(time);\n        this.osc.stop(time + 0.2);\n        this.noise.stop(time + 0.2);\n    };\n    ;\n    return Snare;\n}());\nexports.Snare = Snare;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Instrument_1 = require(\"./Instrument\");\nvar Kick_1 = require(\"./Kick\");\nvar Snare_1 = require(\"./Snare\");\nvar PlasticDrums = /** @class */ (function (_super) {\n    __extends(PlasticDrums, _super);\n    function PlasticDrums(options) {\n        var _this = _super.call(this, options) || this;\n        _this.keys = [\n            new Kick_1.Kick(_this.context),\n            new Snare_1.Snare(_this.context)\n        ];\n        return _this;\n    }\n    PlasticDrums.prototype.playKeys = function (keys, _a) {\n        var _this = this;\n        var deadline = _a.deadline, gain = _a.gain, value = _a.value;\n        var sounds = keys.filter(function (key) { return !!_this.keys[key]; }).map(function (key) { return _this.keys[key]; });\n        if (sounds.length < keys.length) {\n            var missing = keys.filter(function (key) { return !_this.keys[key]; });\n            console.warn('PlasticDrums missing keys:', missing);\n        }\n        sounds.forEach(function (sound) { return sound.trigger(deadline); });\n    };\n    return PlasticDrums;\n}(Instrument_1.Instrument));\nexports.PlasticDrums = PlasticDrums;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Improvisation = /** @class */ (function () {\n    function Improvisation(rules) {\n        this.rules = rules;\n        this.cache = {};\n    }\n    Improvisation.prototype.get = function (key, fromCache) {\n        if (fromCache === void 0) { fromCache = false; }\n        if (fromCache) {\n            return this.cache[key];\n        }\n        var rule = this.rules[key];\n        if (rule === undefined) {\n            console.error('could not resolve key', key, '!');\n        }\n        if (typeof rule === 'function') {\n            rule = rule(this.getRuleFactories(key));\n        }\n        this.cache[key] = rule;\n        return rule;\n    };\n    Improvisation.prototype.enhance = function (rules) {\n        return new Improvisation(Object.assign({}, this.rules, rules));\n    };\n    Improvisation.prototype.mutate = function (reducer) {\n        this.rules = Object.assign({}, this.rules, reducer(this.getRuleFactories()));\n        return this;\n    };\n    Improvisation.prototype.getRuleFactories = function (originKey) {\n        var _this = this;\n        return Object.keys(this.rules)\n            .map(function (key) { return ({ key: key, factory: function () { return _this.get(key); } }); })\n            .reduce(function (factories, _a) {\n            var key = _a.key, factory = _a.factory;\n            var _b, _c;\n            return (Object.assign({}, factories, (_b = {}, _b[key] = factory, _b), (originKey ? (_c = {}, _c[originKey] = function () { return _this.cache[originKey]; }, _c) : {})));\n        }, {});\n    };\n    return Improvisation;\n}());\nexports.Improvisation = Improvisation;\n/**\n *\n * methods: { [method: string]: ImprovisationRules } = {\n        guideTones: {\n            pattern: [3, 7]\n        },\n        flippedGuideTones: {\n            pattern: [3, 7],\n            flip: true,\n        },\n        chordTones: {\n            pattern: [1, 3, 7],\n            variance: .5,\n            variety: .5,\n            drill: .5,\n            flip: ({ drill }) => Math.random() * Math.abs(drill()) > .5,\n        }\n    }\n */ \n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar swing_1 = require(\"../grooves/swing\");\nvar tonal_1 = require(\"tonal\");\nvar util_1 = require(\"../util/util\");\nvar Improvisation_1 = require(\"./Improvisation\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nexports.permutator = new Improvisation_1.Improvisation({\n    groove: swing_1.swing,\n    groovePattern: function (_a) {\n        var groove = _a.groove;\n        return groove()['solo'] || (function (m) {\n            return m.measure.map(function () { return [1]; });\n        });\n    },\n    octave: 4,\n    reach: 1,\n    lineBreaks: false,\n    direction: null,\n    force: false,\n    flip: false,\n    playedNotes: [],\n    fixRange: true,\n    startRandom: false,\n    range: ['Bb3', 'Bb5'],\n    /* chanceCurve: () => (distance, length) => (length - distance) * 10, */\n    firstNoteInPattern: function (_a) {\n        var pattern = _a.pattern, chord = _a.chord;\n        return util_1.getPatternInChord([pattern()[0]], chord());\n    },\n    firstNote: function (_a) {\n        var randomNote = _a.randomNote, firstNoteInPattern = _a.firstNoteInPattern, startRandom = _a.startRandom, octave = _a.octave;\n        return startRandom() ? randomNote() : firstNoteInPattern() + octave();\n    },\n    lastNote: function (_a) {\n        var playedNotes = _a.playedNotes;\n        return playedNotes().length ? playedNotes()[0] : null;\n    },\n    material: function (_a) {\n        var pattern = _a.pattern, chord = _a.chord;\n        return util_1.getPatternInChord(pattern(), chord());\n    },\n    randomNote: function (_a) {\n        var material = _a.material, octave = _a.octave;\n        return util_1.randomElement(material()) + octave();\n    },\n    nextNotes: function (_a) {\n        var fixRange = _a.fixRange, firstNote = _a.firstNote, chord = _a.chord, reach = _a.reach, lineBreaks = _a.lineBreaks, lastNote = _a.lastNote, range = _a.range, material = _a.material, direction = _a.direction, force = _a.force, flip = _a.flip;\n        var note;\n        if (!lastNote() || lineBreaks()) {\n            note = firstNote();\n        }\n        else {\n            var choices = material();\n            if (!choices.length) {\n                console.warn('no choice..');\n                return;\n            }\n            var targets = Harmony_1.Harmony.getNearestTargets(lastNote(), material(), direction(), flip());\n            targets = targets.slice(0, reach());\n            note = util_1.randomElement(targets);\n            note = tonal_1.Note.simplify(note, true);\n        }\n        if (fixRange()) {\n            note = util_1.transposeToRange([note], range())[0];\n        }\n        var step = util_1.getStepInChord(note, chord());\n        /* console.log(`${step} in ${chord()} = ${note}`); */\n        return [note];\n    }\n});\n/** MODIFIERS */\nvar getStraightBar = function (notes, cycle) {\n    if (cycle === void 0) { cycle = 4; }\n    return new Array(cycle).fill(new Array(Math.ceil(notes / cycle)).fill(1));\n};\nvar straightNotes = function (n, cycle) {\n    if (cycle === void 0) { cycle = 4; }\n    return ({\n        groove: null,\n        groovePattern: function () { return (function (m) {\n            return getStraightBar(n, cycle);\n        }); },\n    });\n};\nvar fixedNotesPerChord = function (n, cycle) {\n    if (cycle === void 0) { cycle = 4; }\n    return ({\n        groove: null,\n        groovePattern: function () { return (function (m) { return m.measure.map(function () {\n            return getStraightBar(n, cycle);\n        }); }); },\n    });\n};\nvar pendulum = function (defaultDirection, softForce, comfort) {\n    if (defaultDirection === void 0) { defaultDirection = 'up'; }\n    if (softForce === void 0) { softForce = false; }\n    if (comfort === void 0) { comfort = .4; }\n    return ({\n        exclude: 1,\n        force: !softForce ? true : function (_a) {\n            var lastNote = _a.lastNote, range = _a.range;\n            var position = util_1.getRangePosition(lastNote(), range());\n            return position < 0 || position > 1; // only force if out of range..    \n        },\n        fixRange: false,\n        direction: function (_a) {\n            var lastNote = _a.lastNote, range = _a.range, direction = _a.direction, barNumber = _a.barNumber, isBarStart = _a.isBarStart;\n            var position = util_1.getRangePosition(lastNote(), range());\n            var comfortSwitchBars = 1; // switch direction each x bars when in comfort zone\n            var isComfortZone = (position > comfort && position < 1 - comfort);\n            if ((position <= 0 && direction() === 'down') ||\n                (position >= 1 && direction() === 'up') ||\n                (isComfortZone && isBarStart() && barNumber() % comfortSwitchBars === 0)) {\n                /* console.log('change direction', otherDirection(direction(), defaultDirection)); */\n                return util_1.otherDirection(direction(), defaultDirection);\n            }\n            return direction() || defaultDirection;\n        }\n    });\n};\nvar beatPattern = function (_a) {\n    var pattern = _a.pattern, on = _a.on, off = _a.off, barStart = _a.barStart;\n    return ({\n        beatPattern: function (_a) {\n            var isBarStart = _a.isBarStart, isOffbeat = _a.isOffbeat;\n            if (isBarStart()) {\n                return barStart || on || pattern;\n            }\n            else if (!isOffbeat()) {\n                return on || pattern;\n            }\n            return off || pattern;\n        },\n        pattern: function (_a) {\n            var beatPattern = _a.beatPattern;\n            return beatPattern();\n        },\n    });\n};\nvar notesPerChord = function (n) { return (__assign({}, fixedNotesPerChord(1, n))); };\nvar patternPractise = function (direction, notes, lineBreaks) {\n    if (direction === void 0) { direction = 'up'; }\n    if (notes === void 0) { notes = 4; }\n    if (lineBreaks === void 0) { lineBreaks = false; }\n    return (__assign({}, straightNotes(notes), { firstNoteInPattern: function (_a) {\n            var pattern = _a.pattern, chord = _a.chord;\n            return util_1.getPatternInChord(direction === 'up' ? [pattern()[0]] : pattern().slice(-1), chord());\n        }, direction: direction, force: true, fixRange: false, lineBreaks: function (_a) {\n            var isBarStart = _a.isBarStart;\n            return lineBreaks ? isBarStart() : false;\n        }, exclude: 1, reach: 1 }));\n};\n/** FORMULAS */\nexports.advancedPermutator = exports.permutator.enhance({\n    drill: .5,\n    direction: function (_a) {\n        var drill = _a.drill;\n        return drill() > 0 ? 'up' : 'down';\n    },\n    force: function (_a) {\n        var drill = _a.drill;\n        return Math.random() * Math.abs(drill()) > .5;\n    },\n    exclude: 1,\n    reach: 1,\n    material: function (_a) {\n        var pattern = _a.pattern, chord = _a.chord, playedNotes = _a.playedNotes, exclude = _a.exclude;\n        var all = util_1.getPatternInChord(pattern(), chord());\n        if (!playedNotes().length) {\n            return all;\n        }\n        var excludeNotes = playedNotes()\n            .slice(0, exclude())\n            .map(function (n) { return tonal_1.Note.pc(n); });\n        return all.filter(function (n) { return !excludeNotes.includes(n); });\n    }\n});\nexports.guideTones = exports.advancedPermutator.enhance(__assign({ name: 'Guide Lines' }, notesPerChord(1), pendulum('down', true), { pattern: [3, 7], exclude: 0 }));\nexports.guideTonesFlipped = exports.guideTones.enhance({\n    name: 'Distant Guide Tones',\n    flip: true\n});\nexports.chordTones = exports.advancedPermutator.enhance({\n    name: 'Only Chord Tones',\n    pattern: [1, 3, 5, 7],\n    drill: .75,\n    direction: function (_a) {\n        var drill = _a.drill;\n        return drill() > 0 ? 'up' : 'down';\n    },\n});\n/* export const digitalPattern = advancedPermutator.enhance({\n    pattern: ({ chord }) => getDigitalPattern(chord()),\n    ...pendulum(),\n    ...straightNotes(4)\n}); */\nexports.fullScale = exports.advancedPermutator.enhance(__assign({ name: 'Heptatonic' }, beatPattern({ on: [1, 3, 5, 7], off: [1, 2, 3, 4, 5, 6, 7] }), pendulum()));\nexports.scalePendulum = exports.advancedPermutator.enhance(__assign({ name: 'Heptatonic Pendulum' }, beatPattern({ pattern: [1, 2, 3, 4, 5, 6, 7] }), pendulum(), straightNotes(8)));\nexports.digitalPattern = exports.advancedPermutator.enhance(__assign({ name: 'Digital Patterns', pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }, pendulum('up', true, .2), { exclude: 2, reach: 3 }));\nexports.digitalPendulum = exports.advancedPermutator.enhance(__assign({ name: 'Digital Pendulum', pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }, pendulum('up', false, 1), straightNotes(8), { \n    /* lineBreaks: ({ isBarStart }) => isBarStart(), */\n    exclude: 1, reach: 1 }));\nexports.digitalWalker = exports.advancedPermutator.enhance(__assign({ name: 'Digital Fourths', pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }, pendulum('up', true, .4), straightNotes(4), { lineBreaks: false, \n    /* lineBreaks: ({ isBarStart }) => isBarStart(), */\n    exclude: 2, reach: 2 }));\nexports.digitalPractiseUp = exports.advancedPermutator.enhance(__assign({ name: 'Digital Practise Up' }, patternPractise('up', 4, true), { pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }));\nexports.digitalPractiseDown = exports.advancedPermutator.enhance(__assign({ name: 'Digital Practise Down' }, patternPractise('down', 4, true), { pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }));\nexports.heptatonicPractise = exports.advancedPermutator.enhance(__assign({ name: 'Heptatonic Practise' }, patternPractise('up', 8, false), beatPattern({ barStart: [1], on: [3, 5, 7], off: [1, 2, 3, 4, 5, 6, 7] })));\nexports.defaultMethod = exports.guideTones;\nexports.improvisationMethods = {\n    guideTones: exports.guideTones,\n    guideTonesFlipped: exports.guideTonesFlipped,\n    chordTones: exports.chordTones,\n    digitalPattern: exports.digitalPattern,\n    digitalPendulum: exports.digitalPendulum,\n    digitalWalker: exports.digitalWalker,\n    fullScale: exports.fullScale,\n    scalePendulum: exports.scalePendulum,\n    digitalPractiseUp: exports.digitalPractiseUp,\n    digitalPractiseDown: exports.digitalPractiseDown,\n};\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar swing_1 = require(\"../grooves/swing\");\nvar methods_1 = require(\"../improvisation/methods\");\nvar util_1 = require(\"../util/util\");\nvar Musician_1 = require(\"./Musician\");\nvar Improvisor = /** @class */ (function (_super) {\n    __extends(Improvisor, _super);\n    function Improvisor(instrument, method) {\n        var _this = _super.call(this, instrument) || this;\n        _this.name = 'Improvisor';\n        _this.defaultMethod = methods_1.defaultMethod;\n        method = method || _this.defaultMethod;\n        _this.method = method /* .enhance({\n            range: ['F3', 'F5']\n        }) */;\n        return _this;\n    }\n    Improvisor.prototype.useMethod = function (method) {\n        this.method = method;\n    };\n    Improvisor.prototype.play = function (_a) {\n        var _this = this;\n        var measures = _a.measures, pulse = _a.pulse, settings = _a.settings;\n        if (settings.method) {\n            this.useMethod(settings.method);\n        }\n        var groove = settings.groove || swing_1.swing;\n        this.method.mutate(function () { return ({ groove: groove, playedNotes: [] }); });\n        var pattern = this.method.get('groovePattern');\n        measures = measures\n            .map(function (measure) { return pattern({ measures: measures, measure: measure, settings: settings, pulse: pulse }); }\n        /*     .slice(0, Math.floor(settings.cycle)) */\n        )\n            .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); });\n        pulse.tickArray(measures, function (tick) {\n            _this.improvise(tick, measures, pulse);\n        }, settings.deadline);\n    };\n    Improvisor.prototype.improvise = function (_a, measures, pulse) {\n        var _this = this;\n        var value = _a.value, deadline = _a.deadline, interval = _a.interval;\n        var chord = value.chord;\n        if (chord === 'N.C.') {\n            return;\n        }\n        this.method.mutate(function () { return ({\n            chord: chord,\n            isFormStart: util_1.isFormStart(value.path),\n            isBarStart: util_1.isBarStart(value.path),\n            isOffbeat: util_1.isOffbeat(value.path),\n            // TODO: is ChordStart\n            barNumber: value.path[0]\n        }); })\n            .mutate(function (_a) {\n            var nextNotes = _a.nextNotes, playedNotes = _a.playedNotes;\n            var pick = nextNotes();\n            var duration = value.fraction * pulse.getMeasureLength();\n            _this.instrument.playNotes(pick, { deadline: deadline, interval: interval, gain: _this.getGain(), duration: duration, pulse: pulse });\n            return {\n                playedNotes: [].concat(pick, playedNotes())\n            };\n        });\n    };\n    return Improvisor;\n}(Musician_1.Musician));\nexports.default = Improvisor;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"./util/util\");\nvar Band_1 = __importDefault(require(\"./Band\"));\nvar Pianist_1 = __importDefault(require(\"./musicians/Pianist\"));\nvar Bassist_1 = __importDefault(require(\"./musicians/Bassist\"));\nvar Drummer_1 = __importDefault(require(\"./musicians/Drummer\"));\nvar PlasticDrums_1 = require(\"./instruments/PlasticDrums\");\nvar Improvisor_1 = __importDefault(require(\"./musicians/Improvisor\"));\nvar Trio = /** @class */ (function (_super) {\n    __extends(Trio, _super);\n    function Trio(_a) {\n        var context = _a.context, piano = _a.piano, bass = _a.bass, drums = _a.drums, onMeasure = _a.onMeasure, solo = _a.solo;\n        var _this = _super.call(this, { context: context, onMeasure: onMeasure }) || this;\n        var instruments = _this.setupInstruments({ piano: piano, bass: bass, drums: drums });\n        _this.pianist = new Pianist_1.default(instruments.piano);\n        _this.bassist = new Bassist_1.default(instruments.bass);\n        _this.drummer = new Drummer_1.default(instruments.drums);\n        _this.musicians = [_this.pianist, _this.bassist, _this.drummer];\n        if (solo) {\n            // this.soloist = new Permutator(instruments.piano);\n            _this.soloist = new Improvisor_1.default(instruments.piano);\n            _this.musicians.push(_this.soloist);\n        }\n        return _this;\n    }\n    Trio.prototype.setupInstruments = function (_a) {\n        var piano = _a.piano, bass = _a.bass, drums = _a.drums;\n        bass = bass || util_1.randomSynth(this.mix);\n        piano = piano || util_1.randomSynth(this.mix);\n        drums = drums || new PlasticDrums_1.PlasticDrums({ mix: this.mix });\n        return { piano: piano, bass: bass, drums: drums };\n    };\n    return Trio;\n}(Band_1.default));\nexports.Trio = Trio;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Measure_1 = require(\"./Measure\");\n// extension of https://github.com/daumling/ireal-renderer/blob/master/src/ireal-renderer.js\nvar RealParser = /** @class */ (function () {\n    function RealParser() {\n    }\n    RealParser.getChord = function (iRealChord) {\n        return iRealChord.note + iRealChord.modifiers + (iRealChord.over ? '/' + this.getChord(iRealChord.over) : '');\n    };\n    RealParser.parseSheet = function (raw) {\n        return RealParser.getSheet(RealParser.parse(raw));\n    };\n    RealParser.getSheet = function (tokens) {\n        var _this = this;\n        var parsed = tokens\n            .reduce(function (current, token, index, array) {\n            var lastBarEnded = ['{', '|', '[', '||' /* 'Z',  */ /* , ']' */]\n                .includes(token.bars || token.token);\n            var signs = token.annots || [];\n            var repeatStart = (token.bars || token.token) === '{';\n            var repeatEnd = (token.bars || token.token) === '}';\n            if (repeatStart) {\n                signs.push('{');\n            }\n            if (repeatEnd) {\n                signs.push('}');\n            }\n            // current.measure ends\n            if (lastBarEnded) {\n                if (current.measure) {\n                    // simplify measure if no signs\n                    /* if (Object.keys(current.measure).find(k=>k)) {\n                        current.measure = current.measure.chords;\n                    } */\n                    current.measures.push(current.measure);\n                }\n                current.measure = { chords: [] };\n            }\n            var sectionStart = signs.find(function (a) { return a.match(/^\\*[a-zA-Z]/); });\n            if (sectionStart) {\n                signs = signs.filter(function (s) { return s !== sectionStart; });\n                current.measure.section = sectionStart.replace('*', '');\n            }\n            var hasCodaSign = signs.includes('Q');\n            if (hasCodaSign) {\n                signs = signs.filter(function (s) { return s !== 'Q'; });\n                var codaSign = 'ToCoda';\n                if (!!current.measures.find(function (m) { return Measure_1.Measure.hasSign('ToCoda', m); })) {\n                    codaSign = 'Coda';\n                }\n                current.measure.signs = (current.measure.signs || []).concat([codaSign]);\n            }\n            var houseStart = signs.find(function (s) { return !!s.match(/^N./); });\n            if (houseStart) {\n                signs = signs.filter(function (s) { return s !== houseStart; });\n                current.measure.house = parseInt(houseStart.replace('N', ''));\n            }\n            var time = signs.find(function (a) { return a.match(/^T\\d\\d/); });\n            if (time) {\n                signs = signs.filter(function (s) { return s !== time; });\n                current.measure.time = time.replace('T', '');\n            }\n            if (token.chord) {\n                current.measure.chords.push(_this.getChord(token.chord));\n            }\n            else if (token.token === 'n') {\n                current.measure.chords.push(0);\n            }\n            var last = current.measures[current.measures.length - 1];\n            if (last && last.chords[0] === 'r') {\n                last.chords = current.measures[current.measures.length - 3].chords;\n                current.measure.chords = current.measures[current.measures.length - 2].chords;\n            }\n            if (last && current.measure.chords[0] === 'x') {\n                current.measure.chords = [].concat(last.chords);\n                current.measure.idle = true;\n            }\n            if (signs.length) {\n                current.measure.signs = (current.measure.signs || [])\n                    .concat(signs);\n            }\n            if (token.comments.length) {\n                current.measure.comments = (current.measure.comments || [])\n                    .concat(token.comments.map(function (c) { return c.trim(); }));\n            }\n            return current;\n        }, { measure: null, signs: null, measures: [] });\n        if (parsed.measure.chords.length) {\n            parsed.measures.push(parsed.measure);\n        }\n        return parsed.measures;\n    };\n    RealParser.parse = function (raw) {\n        var text = raw;\n        var arr = [], headers = [], comments = [];\n        var i;\n        text = text.trim();\n        // text = text.trimRight();\n        while (text) {\n            var found = false;\n            for (i = 0; i < RealParser.regExps.length; i++) {\n                var match = RealParser.regExps[i].exec(text);\n                if (match) {\n                    found = true;\n                    if (match.length <= 2) {\n                        var replacement = match[0];\n                        var repl = RealParser.replacements[replacement];\n                        arr = arr.concat(repl ? repl : [replacement]);\n                        text = text.substr(replacement.length);\n                    }\n                    else { // a chord\n                        arr.push(match);\n                        text = text.substr(match[0].length);\n                    }\n                    break;\n                }\n            }\n            if (!found) {\n                // ignore the comma separator\n                if (text[0] !== ',')\n                    arr.push(text[0]);\n                text = text.substr(1);\n            }\n        }\n        //\t\tconsole.log(arr);\n        // pass 2: extract prefixes, suffixes, annotations and comments\n        var out = [];\n        var obj = RealParser.newToken(out);\n        for (i = 0; i < arr.length; i++) {\n            var token = arr[i];\n            if (token instanceof Array) {\n                obj.chord = RealParser.parseChord(token);\n                token = \" \";\n            }\n            switch (token[0]) {\n                case ',':\n                    token = null;\n                    break; // separator\n                case 'S': // segno\n                case 'T': // time measurement\n                case 'Q': // coda\n                case 'N': // repeat\n                case 'U': // END\n                case 's': // small\n                case 'l': // normal\n                case 'f': // fermata\n                case '*':\n                    obj.annots.push(token);\n                    token = null;\n                    break;\n                case 'Y':\n                    obj.spacer++;\n                    token = null;\n                    break;\n                case 'r':\n                case 'x':\n                case 'W':\n                    obj.chord = new iRealChord(token, \"\", null, null);\n                    break;\n                case '<':\n                    token = token.substr(1, token.length - 2);\n                    token = token.replace(/XyQ/g, \"   \"); // weird; needs to be done\n                    obj.comments.push(token);\n                    token = null;\n                    break;\n                default:\n            }\n            if (token) {\n                if (\"]}Z\".indexOf(arr[i + 1]) >= 0)\n                    obj.bars += arr[++i];\n                if (\"{[|\".indexOf(token) >= 0) {\n                    obj.bars += token;\n                    token = null;\n                }\n            }\n            if (token && i < arr.length - 1) {\n                obj.token = token;\n                obj = RealParser.newToken(out);\n            }\n        }\n        return out;\n    };\n    RealParser.parseChord = function (match) {\n        var note = match[1] || \" \";\n        var modifiers = match[2] || \"\";\n        var comment = match[3] || \"\";\n        if (comment)\n            modifiers += comment.substr(1, comment.length - 2).replace(\"XyQ\", \"   \");\n        var over = match[4] || \"\";\n        if (over[0] === '/')\n            over = over.substr(1);\n        var alternate = match[5] || null;\n        if (alternate) {\n            match = RealParser.chordRegex.exec(alternate.substr(1, alternate.length - 2));\n            if (!match)\n                alternate = null;\n            else\n                alternate = this.parseChord(match);\n        }\n        // empty cell?\n        if (note === \" \" && !alternate && !over)\n            return null;\n        if (over) {\n            var offset = (over[1] === '#' || over[1] === 'b') ? 2 : 1;\n            over = new iRealChord(over.substr(0, offset), over.substr(offset), null, null);\n        }\n        else\n            over = null;\n        return new iRealChord(note, modifiers, over, alternate);\n    };\n    RealParser.newToken = function (arr) {\n        var obj = new iRealToken;\n        arr.push(obj);\n        return obj;\n    };\n    /**\n     * The RegExp for a complete chord. The match array contains:\n     * 1 - the base note\n     * 2 - the modifiers (+-ohd0123456789 and su for sus)\n     * 3 - any comments (may be e.g. add, sub, or private stuff)\n     * 4 - the \"over\" part starting with a slash\n     * 5 - the top chord as (chord)\n     * @type RegExp\n     */\n    RealParser.chordRegex = /^([ A-GW][b#]?)((?:sus|[\\+\\-\\^\\dhob#])*)(\\*.+?\\*)*(\\/[A-G][#b]?)?(\\(.*?\\))?/;\n    RealParser.regExps = [\n        /^\\*[a-zA-Z]/,\n        /^T\\d\\d/,\n        /^N./,\n        /^<.*?>/,\n        /^ \\(.*?\\)/,\n        RealParser.chordRegex,\n        /^LZ/,\n        /^XyQ/,\n        /^Kcl/ // repeat last bar\n    ];\n    RealParser.replacements = {\n        \"LZ\": [\" \", \"|\"],\n        \"XyQ\": [\" \", \" \", \" \"],\n        \"Kcl\": [\"|\", \"x\", \" \"]\n    };\n    return RealParser;\n}());\nexports.RealParser = RealParser;\nvar iRealChord = /** @class */ (function () {\n    function iRealChord(note, modifiers, over, alternate) {\n        this.note = note;\n        this.modifiers = modifiers;\n        this.over = over;\n        this.alternate = alternate;\n    }\n    return iRealChord;\n}());\nvar iRealToken = /** @class */ (function () {\n    function iRealToken() {\n        this.annots = [];\n        this.comments = [];\n        this.bars = \"\";\n        this.spacer = 0;\n        this.chord = null;\n    }\n    return iRealToken;\n}());\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Instrument_1 = require(\"./Instrument\");\nvar MidiOut = /** @class */ (function (_super) {\n    __extends(MidiOut, _super);\n    function MidiOut(props) {\n        var _this = _super.call(this, props) || this;\n        _this.gain = 0.9;\n        _this.output = 'Scarlett 6i6 USB';\n        _this.gain = props.gain || _this.gain;\n        if (!navigator['requestMIDIAccess']) {\n            console.warn('This browser does not support WebMIDI!');\n            return _this;\n        }\n        navigator['requestMIDIAccess']().then(function (midi) { return _this.midiInit(midi); }, _this.midiFail);\n        return _this;\n    }\n    MidiOut.prototype.midiInit = function (midi) {\n        var _this = this;\n        console.log('midi init', midi);\n        console.log(midi.outputs.size, 'outputs');\n        console.log(midi.inputs.size, 'inputs');\n        this.midi = midi;\n        midi.outputs.forEach(function (output) {\n            console.log('ouput', output);\n        });\n        midi.inputs.forEach(function (input) {\n            console.log('input', input);\n            input.onmidimessage = _this.getMidiMessage;\n        });\n        this.onTrigger = function (_a) {\n            var on = _a.on, off = _a.off;\n            on.forEach(function (_a) {\n                var midi = _a.midi, gain = _a.gain, deadline = _a.deadline;\n                _this.noteOn(midi, Math.round(gain * 127), deadline);\n            });\n            off.forEach(function (event) {\n                _this.noteOff(event.midi, Math.round(event.gain * 127));\n            });\n        };\n    };\n    MidiOut.prototype.midiFail = function () {\n        console.warn('could not get midi access!');\n    };\n    MidiOut.prototype.getMidiMessage = function (message) {\n        console.log('midi data', message.data, 'message', message);\n    };\n    MidiOut.prototype.send = function (message, deadline) {\n        var _this = this;\n        if (!this.midi) {\n            console.warn('tried to play keys but midi was not ready');\n            return;\n        }\n        console.log('send', message, deadline);\n        this.midi.outputs.forEach(function (output) {\n            if (true || output.name === _this.output) {\n                output.send(message);\n            }\n        });\n    };\n    MidiOut.prototype.noteOn = function (key, velocity, deadline) {\n        if (velocity === void 0) { velocity = 127; }\n        if (deadline === void 0) { deadline = 0; }\n        this.send([144, key, 0x7f], deadline); //velocity\n    };\n    MidiOut.prototype.noteOff = function (key, velocity, deadline) {\n        if (velocity === void 0) { velocity = 127; }\n        if (deadline === void 0) { deadline = 0; }\n        this.send([144, key, 0], deadline); //velocity\n    };\n    MidiOut.prototype.playKeys = function (keys, settings) {\n        if (settings === void 0) { settings = {}; }\n        /* if (!this.midi) {\n            console.warn('tried to play keys but midi was not ready');\n            return;\n        }\n        this.midi.outputs.forEach(output => {\n            console.log(keys, 'send to', output);\n            keys.forEach(key => {\n                output.send([144, key, 9]);\n            })\n        });\n    } */\n    };\n    return MidiOut;\n}(Instrument_1.Instrument));\nexports.MidiOut = MidiOut;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nvar Musician_1 = require(\"./Musician\");\nvar swing_1 = require(\"../grooves/swing\");\nvar Permutator = /** @class */ (function (_super) {\n    __extends(Permutator, _super);\n    function Permutator(instrument) {\n        var _this = _super.call(this, instrument) || this;\n        _this.defaults = { groove: swing_1.swing };\n        _this.playedChords = [];\n        return _this;\n    }\n    Permutator.prototype.play = function (_a) {\n        var _this = this;\n        var measures = _a.measures, pulse = _a.pulse, settings = _a.settings;\n        var groove = settings.groove || this.defaults.groove;\n        var pattern = groove['solo'] || (function (m) {\n            return m.measure.map(function (c) { return [1, 1, 1, 1]; });\n        }); // dont changes anything\n        measures = measures\n            .map(function (measure) { return pattern({ measures: measures, measure: measure, settings: settings, pulse: pulse }).slice(0, Math.floor(settings.cycle)); })\n            .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); });\n        pulse.tickArray(measures, function (tick) {\n            _this.playPermutations(tick, measures, pulse);\n        }, settings.deadline);\n    };\n    Permutator.prototype.playPermutations = function (_a, measures, pulse) {\n        var value = _a.value, cycle = _a.cycle, path = _a.path, deadline = _a.deadline, interval = _a.interval;\n        var chord = value.chord;\n        if (chord === 'N.C.') {\n            return;\n        }\n        if (chord === 'x') {\n            chord = this.playedChords[this.playedChords.length - 1];\n        }\n        if (!chord || chord === '0') {\n            this.playedChords.push('');\n            return;\n        }\n        this.playedChords.push(chord);\n        // digital patterns\n        var notes = util_1.renderDigitalPattern(chord);\n        var note = util_1.randomElement(notes) + '5';\n        // all scale notes with different chances\n        /* const notes = getPatternInChord([1, 2, 3, 4, 5, 6, 7], chord);\n        const note = randomElement(notes, [4, 3, 6, 1, 3, 4, 6]) + '5'; */\n        /* console.log('beat (starting from zero)', path[1]); */\n        var duration = value.fraction * pulse.getMeasureLength();\n        /* deadline += randomDelay(10); */\n        this.instrument.playNotes([note], { deadline: deadline, interval: interval, gain: 1, duration: duration, pulse: pulse });\n    };\n    return Permutator;\n}(Musician_1.Musician));\nexports.default = Permutator;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Band_1 = __importDefault(require(\"./Band\"));\nexports.Band = Band_1.default;\nvar Pianist_1 = __importDefault(require(\"./musicians/Pianist\"));\nexports.Pianist = Pianist_1.default;\nvar Drummer_1 = __importDefault(require(\"./musicians/Drummer\"));\nexports.Drummer = Drummer_1.default;\nvar Bassist_1 = __importDefault(require(\"./musicians/Bassist\"));\nexports.Bassist = Bassist_1.default;\nvar Instrument_1 = require(\"./instruments/Instrument\");\nexports.Instrument = Instrument_1.Instrument;\nvar Musician_1 = require(\"./musicians/Musician\");\nexports.Musician = Musician_1.Musician;\nvar Synthesizer_1 = require(\"./instruments/Synthesizer\");\nexports.Synthesizer = Synthesizer_1.Synthesizer;\nvar Sampler_1 = require(\"./instruments/Sampler\");\nexports.Sampler = Sampler_1.Sampler;\nvar PlasticDrums_1 = require(\"./instruments/PlasticDrums\");\nexports.PlasticDrums = PlasticDrums_1.PlasticDrums;\nvar Trio_1 = require(\"./Trio\");\nexports.Trio = Trio_1.Trio;\nvar util = __importStar(require(\"./util/util\"));\nexports.util = util;\nvar Pulse_1 = require(\"./Pulse\");\nexports.Pulse = Pulse_1.Pulse;\nvar RealParser_1 = require(\"./sheet/RealParser\");\nexports.RealParser = RealParser_1.RealParser;\nvar MidiOut_1 = require(\"./instruments/MidiOut\");\nexports.MidiOut = MidiOut_1.MidiOut;\nvar Permutator_1 = __importDefault(require(\"./musicians/Permutator\"));\nexports.Permutator = Permutator_1.default;\nvar Voicing_1 = require(\"./harmony/Voicing\");\nexports.Voicing = Voicing_1.Voicing;\nvar Permutation_1 = require(\"./util/Permutation\");\nexports.Permutation = Permutation_1.Permutation;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tonal_1 = require(\"tonal\");\nvar tonal_2 = require(\"tonal\");\nvar tonal_3 = require(\"tonal\");\nvar tonal_4 = require(\"tonal\");\nvar Harmony = /** @class */ (function () {\n    function Harmony() {\n    }\n    Harmony.isBlack = function (note) {\n        return tonal_1.Note.props(note).acc !== '';\n    };\n    Harmony.isSameNote = function (noteA, noteB) {\n        return tonal_1.Note.midi(noteA) === tonal_1.Note.midi(noteB);\n    };\n    Harmony.getTonalChord = function (chord) {\n        if (!chord) {\n            return null;\n        }\n        chord = chord\n            .replace(/([A-G][b|#]?)(69)/, '$1M69')\n            .replace('-', 'm')\n            .replace('^', 'M')\n            .replace('h7', 'm7b5')\n            .replace('h', 'dim');\n        /**\n         * Chords that dont work:\n         * slash cords are ignored\n         * 7b9b5 does not work\n         *\n         */\n        var tokens = tonal_2.Chord.tokenize(chord);\n        var s = tokens[1].split('/');\n        return tokens[0] + (s[0] || 'M');\n    };\n    Harmony.getBassNote = function (chord) {\n        if (!chord) {\n            return null;\n        }\n        if (chord.includes('/')) {\n            return chord.split('/')[1];\n        }\n        return chord.match((/[A-G][b|#]?/))[0];\n    };\n    Harmony.getMidi = function (note, offset) {\n        if (offset === void 0) { offset = 0; }\n        return tonal_1.Note.midi(note) - offset;\n    };\n    Harmony.intervalComplement = function (interval) {\n        var fix = {\n            '8P': '1P',\n            '8d': '1A',\n            '8A': '1d',\n            '1A': '8d',\n            '1d': '8A',\n        };\n        var fixIndex = Object.keys(fix).find(function (key) { return interval.match(key); });\n        if (fixIndex) {\n            return fix[fixIndex];\n        }\n        return tonal_3.Interval.invert(interval);\n    };\n    Harmony.invertInterval = function (interval) {\n        if (!interval) {\n            return null;\n        }\n        var positive = interval.replace('-', '');\n        var complement = Harmony.intervalComplement(positive);\n        var isNegative = interval.length > positive.length;\n        return (isNegative ? '' : '-') + complement;\n    };\n    /** Transforms interval into one octave (octave+ get octaved down) */\n    Harmony.fixInterval = function (interval, simplify) {\n        if (interval === void 0) { interval = ''; }\n        if (simplify === void 0) { simplify = false; }\n        var fix = {\n            '0A': '1P',\n            '-0A': '1P',\n        };\n        if (simplify) {\n            fix = __assign({}, fix, { '8P': '1P', '-8P': '1P' });\n            interval = tonal_3.Interval.simplify(interval);\n        }\n        if (Object.keys(fix).includes(interval)) {\n            return fix[interval];\n        }\n        return interval;\n    };\n    /** inverts the interval if it does not go to the desired direction */\n    Harmony.forceDirection = function (interval, direction, noUnison) {\n        if (noUnison === void 0) { noUnison = false; }\n        var semitones = tonal_3.Interval.semitones(interval);\n        if ((direction === 'up' && semitones < 0) ||\n            (direction === 'down' && semitones > 0)) {\n            return Harmony.invertInterval(interval);\n        }\n        if (interval === '1P' && noUnison) {\n            return (direction === 'down' ? '-' : '') + '8P';\n        }\n        return interval;\n    };\n    // use Interval.ic?\n    Harmony.minInterval = function (interval, direction, noUnison) {\n        interval = Harmony.fixInterval(interval, true);\n        if (direction) {\n            return Harmony.forceDirection(interval, direction, noUnison);\n        }\n        var inversion = Harmony.invertInterval(interval);\n        if (Math.abs(tonal_3.Interval.semitones(inversion)) < Math.abs(tonal_3.Interval.semitones(interval))) {\n            interval = inversion;\n        }\n        return interval;\n    };\n    // returns array of intervals that lead the voices of chord A to chordB\n    Harmony.minIntervals = function (chordA, chordB) {\n        return chordA.map(function (n, i) { return Harmony.minInterval(tonal_4.Distance.interval(n, chordB[i])); });\n    };\n    Harmony.mapMinInterval = function (direction) {\n        return function (interval) { return Harmony.minInterval(interval, direction); };\n    };\n    // sort function\n    Harmony.sortMinInterval = function (preferredDirection, accessor) {\n        if (preferredDirection === void 0) { preferredDirection = 'up'; }\n        if (accessor === void 0) { accessor = (function (i) { return i; }); }\n        return function (a, b) {\n            var diff = Math.abs(tonal_3.Interval.semitones(accessor(a))) - Math.abs(tonal_3.Interval.semitones(accessor(b)));\n            if (diff === 0) {\n                return preferredDirection === 'up' ? -1 : 1;\n            }\n            return diff;\n        };\n    };\n    /** Returns the note with the least distance to \"from\" */\n    Harmony.getNearestNote = function (from, to, direction) {\n        var interval = Harmony.minInterval(tonal_4.Distance.interval(tonal_1.Note.pc(from), tonal_1.Note.pc(to)), direction);\n        return tonal_4.Distance.transpose(from, interval);\n    };\n    /** Returns the note with the least distance to \"from\". TODO: add range */\n    Harmony.getNearestTargets = function (from, targets, preferredDirection, flip) {\n        if (preferredDirection === void 0) { preferredDirection = 'down'; }\n        if (flip === void 0) { flip = false; }\n        var intervals = targets\n            .map(function (target) { return tonal_4.Distance.interval(tonal_1.Note.pc(from), target); })\n            .map(Harmony.mapMinInterval(preferredDirection))\n            .sort(Harmony.sortMinInterval(preferredDirection));\n        /* if (flip) {\n            intervals = intervals.reverse();\n        } */\n        return intervals.map(function (i) { return tonal_4.Distance.transpose(from, i); });\n    };\n    Harmony.intervalMatrix = function (from, to) {\n        return to.map(function (note) { return from\n            .map(function (n) {\n            return tonal_4.Distance.interval(n, note);\n        })\n            .map(function (d) { return Harmony.minInterval(d); }); }\n        /* .map(i => i.slice(0, 2) === '--' ? i.slice(1) : i) */\n        );\n    };\n    return Harmony;\n}());\nexports.Harmony = Harmony;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar Instrument = /** @class */ (function () {\n    function Instrument(_a) {\n        var _b = _a === void 0 ? {} : _a, context = _b.context, gain = _b.gain, mix = _b.mix, onTrigger = _b.onTrigger, midiOffset = _b.midiOffset;\n        this.midiOffset = 0;\n        this.gain = 1;\n        this.activeEvents = [];\n        this.onTrigger = onTrigger;\n        this.midiOffset = midiOffset || this.midiOffset;\n        this.gain = gain || this.gain;\n        this.init({ context: context, mix: mix });\n    }\n    Instrument.prototype.init = function (_a) {\n        var context = _a.context, mix = _a.mix;\n        if (!context && (!mix || !mix.context)) {\n            console.warn(\"you should pass a context or a mix (gainNode) to a new Instrument. \\n            You can also Call init with {context,mix} to setup the Instrument later\");\n            return;\n        }\n        this.context = context || mix.context;\n        this.mix = mix || this.context.destination;\n    };\n    Instrument.prototype.playNotes = function (notes, settings) {\n        var _this = this;\n        if (settings === void 0) { settings = {}; }\n        var deadline = (settings.deadline || this.context.currentTime);\n        settings = Object.assign({\n            duration: 2000,\n            gain: 1,\n        }, settings, { deadline: deadline });\n        if (settings.interval) {\n            // call recursively with single notes at interval\n            return notes.map(function (note, index) {\n                _this.playNotes([note], Object.assign({}, settings, {\n                    interval: 0,\n                    deadline: deadline + index * settings.interval\n                }));\n            });\n        }\n        var midi = notes.map(function (note) { return Harmony_1.Harmony.getMidi(note, _this.midiOffset); });\n        var noteOff = settings.deadline + settings.duration / 1000;\n        var notesOn = notes.map(function (note, index) { return ({\n            note: note,\n            midi: midi[index],\n            gain: settings.gain,\n            noteOff: noteOff,\n            deadline: settings.deadline\n        }); });\n        if (settings.pulse && this.onTrigger) {\n            settings.pulse.clock.callbackAtTime(function (deadline) {\n                _this.activeEvents = _this.activeEvents.concat(notesOn);\n                _this.onTrigger({ on: notesOn, off: [], active: _this.activeEvents });\n            }, settings.deadline);\n        }\n        if (settings.duration && settings.pulse) {\n            settings.pulse.clock.callbackAtTime(function (deadline) {\n                // find out which notes need to be deactivated\n                var notesOff = notes\n                    .filter(function (note) { return !_this.activeEvents\n                    .find(function (event) {\n                    var keep = note === event.note && event.noteOff > deadline;\n                    if (keep) {\n                        console.log('keep', note);\n                    }\n                    return keep;\n                }); }).map(function (note) { return _this.activeEvents.find(function (e) { return e.note === note; }); });\n                _this.activeEvents = _this.activeEvents\n                    .filter(function (e) { return !notesOff.includes(e); });\n                if (_this.onTrigger) {\n                    _this.onTrigger({ on: [], off: notesOff, active: _this.activeEvents });\n                }\n            }, noteOff);\n        }\n        return this.playKeys(midi, settings);\n    };\n    Instrument.prototype.playKeys = function (keys, settings) {\n        // TODO: fire callbacks after keys.map((key,i)=>i*settings.interval)?\n    };\n    return Instrument;\n}());\nexports.Instrument = Instrument;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Instrument_1 = require(\"./Instrument\");\nvar tonal_1 = require(\"tonal\");\nvar util_1 = require(\"../util/util\");\nvar Synthesizer = /** @class */ (function (_super) {\n    __extends(Synthesizer, _super);\n    function Synthesizer(props) {\n        var _this = _super.call(this, props) || this;\n        _this.duration = 200;\n        _this.type = 'sine';\n        _this.gain = 0.9;\n        _this.attack = .05;\n        _this.decay = .05;\n        _this.sustain = .4;\n        _this.release = .1;\n        _this.duration = props.duration || _this.duration;\n        _this.type = props.type || _this.type;\n        _this.gain = props.gain || _this.gain;\n        return _this;\n    }\n    Synthesizer.prototype.getVoice = function (type, gain, key) {\n        if (type === void 0) { type = 'sine'; }\n        if (gain === void 0) { gain = 0; }\n        var frequency = tonal_1.Note.freq(key);\n        var oscNode = this.context.createOscillator();\n        oscNode.type = type;\n        var gainNode = this.context.createGain();\n        oscNode.connect(gainNode);\n        gainNode.gain.value = typeof gain === 'number' ? gain : 0.8;\n        gainNode.connect(this.mix);\n        oscNode.frequency.value = frequency;\n        return { oscNode: oscNode, gainNode: gainNode, key: key, frequency: frequency };\n    };\n    Synthesizer.prototype.lowestGain = function (a, b) {\n        return a.gain.gain.value < b.gain.gain.value ? -1 : 0;\n    };\n    Synthesizer.prototype.startKeys = function (keys, settings) {\n        if (settings === void 0) { settings = {}; }\n    };\n    Synthesizer.prototype.playKeys = function (keys, settings) {\n        var _this = this;\n        if (settings === void 0) { settings = {}; }\n        _super.prototype.playKeys.call(this, keys, settings); // fires callback   \n        //const time = this.context.currentTime + settings.deadline / 1000;\n        var time = settings.deadline || this.context.currentTime;\n        var interval = settings.interval || 0;\n        return keys.map(function (key, i) {\n            var delay = i * interval;\n            var _a = [\n                settings.endless,\n                settings.attack || _this.attack,\n                settings.decay || _this.decay,\n                settings.sustain || _this.sustain,\n                settings.release || _this.release,\n                (settings.duration || _this.duration) / 1000,\n                (settings.gain || 1) * _this.gain\n            ], endless = _a[0], attack = _a[1], decay = _a[2], sustain = _a[3], release = _a[4], duration = _a[5], gain = _a[6];\n            var voice = _this.getVoice(_this.type, 0, key);\n            util_1.adsr({ attack: attack, decay: decay, sustain: sustain, release: release, gain: gain, duration: duration, endless: endless }, time + delay, voice.gainNode.gain);\n            voice.oscNode.start(settings.deadline + delay);\n            return voice;\n        });\n    };\n    Synthesizer.prototype.stopVoice = function (voice, settings) {\n        if (settings === void 0) { settings = {}; }\n        if (!voice) {\n            return;\n        }\n        var time = settings.deadline || this.context.currentTime;\n        voice.gainNode.gain.setTargetAtTime(0, time, settings.release || this.release);\n        //voice.oscNode.stop()\n    };\n    Synthesizer.prototype.stopVoices = function (voices, settings) {\n        var _this = this;\n        voices.forEach(function (voice) {\n            _this.stopVoice(voice, settings);\n        });\n    };\n    return Synthesizer;\n}(Instrument_1.Instrument));\nexports.Synthesizer = Synthesizer;\n","\"use strict\";\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Chord = __importStar(require(\"tonal-chord\"));\nvar Scale = __importStar(require(\"tonal-scale\"));\nexports.chords = [\n    {\n        symbol: 'm',\n        long: 'minor',\n        short: '-',\n        groups: ['Basic', 'Triads']\n    },\n    {\n        symbol: 'M',\n        long: 'major',\n        short: '',\n        groups: ['Basic', 'Triads']\n    },\n    {\n        symbol: 'o',\n        groups: ['Basic', 'Symmetric', 'Triads'],\n        long: 'Vermindert'\n        /* short: 'o' */\n    },\n    {\n        symbol: 'M#5',\n        groups: ['Advanced', 'Symmetric', 'Triads'],\n        short: '#5'\n    },\n    {\n        symbol: 'Msus4',\n        groups: ['Advanced', 'Symmetric'],\n        short: 'sus4'\n    },\n    {\n        symbol: 'Msus2',\n        groups: ['Advanced', 'Symmetric'],\n        short: 'sus2'\n    },\n    // 5 4 64 m#5 Mb5  7no5  \n    {\n        symbol: '7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Dominantsept'\n    },\n    {\n        symbol: '7#11',\n        groups: ['Advanced', 'Diatonic', 'Modes'],\n        long: 'Dominant #11'\n    },\n    {\n        symbol: 'M6',\n        groups: ['Advanced'],\n        long: 'major 6',\n        short: '6'\n    },\n    {\n        symbol: 'o7',\n        groups: ['Advanced', 'Symmetric', 'Diatonic'],\n        long: 'Vermindert 7',\n    },\n    {\n        symbol: 'm7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'minor 7',\n        short: '-7'\n    },\n    {\n        symbol: 'oM7',\n        groups: ['Expert'],\n        long: 'diminished major 7',\n        short: 'o7'\n    },\n    {\n        symbol: 'm7b5',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Halbvermindert',\n        short: '-7b5'\n    },\n    {\n        symbol: '7#5',\n        groups: ['Advanced', 'Symmetric'],\n        long: 'Dominantsept #5'\n    },\n    {\n        symbol: 'Maj7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Major 7',\n        short: '7'\n    },\n    {\n        symbol: 'mMaj7',\n        short: '-7',\n        groups: ['Advanced', 'Diatonic']\n    },\n    {\n        symbol: 'M7#5',\n        groups: ['Advanced', 'Diatonic'],\n        short: '7#5'\n    },\n    {\n        symbol: '7sus4',\n        groups: ['Advanced'],\n    },\n    {\n        symbol: '9',\n        groups: ['Advanced'],\n    },\n    {\n        symbol: 'M9',\n        groups: ['Advanced'],\n        short: '9'\n    },\n    {\n        symbol: 'M69',\n        groups: ['Advanced'],\n        short: '69'\n    }\n    /*\n7b13 M7b5 m7#5 9no5  M7b6 7b5 Madd9 mb6b9 mb6M7 madd4 sus24 madd9 Maddb9 +add#9 M7sus4 7#5sus4 M#5add9 M7#5sus4\n11 m9 m6 9#5 7b9 7#9 M69 9b5 m69 mM9 7b6 m9b5 m9#5 7#11 M7b9 9b13 o7M7 M9b5 11b9 M9#5 7add6 M6#11 M7#11 7#5#9 13no5 9sus4 7#5b9 M9sus4 7sus4b9 m7add11 mMaj7b6 M9#5sus4\n13 m11 M13 9#11 13#9 13b5 13b9 m11b5 7b9#9 mM9b6 M9#11 9#5#11 7#9b13 7b9b13 13sus4 m11A 5 7#9#11 7b9#11 M69#11 7#11b13 M7#9#11 M7add13 7#5b9#11 7sus4b9b13\nm13 13#11 M13#11 13b9#11 9#11b13 13#9#11 7b9b13#11 7#9#11b13\n    */\n];\nexports.scales = [\n    {\n        symbol: 'major pentatonic',\n        groups: ['Basic', 'Pentatonic'],\n    },\n    {\n        symbol: 'minor pentatonic',\n        groups: ['Basic', 'Pentatonic'],\n    },\n    {\n        symbol: 'minor blues',\n        groups: ['Basic'],\n    },\n    // gregorian modes\n    {\n        symbol: 'major',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'dorian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'phrygian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'lydian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'mixolydian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'aeolian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'locrian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'whole tone',\n        groups: ['Advanced', 'Symmetric']\n    },\n    {\n        symbol: 'diminished',\n        groups: ['Advanced', 'Symmetric']\n    },\n    //HTGT ?\n    {\n        symbol: 'augmented',\n        groups: ['Advanced', 'Symmetric']\n    },\n    {\n        symbol: 'chromatic',\n        groups: ['Expert', 'Symmetric']\n    },\n    // harmonic minor modes\n    {\n        symbol: 'harmonic minor',\n        groups: ['Advanced', 'Diatonic']\n    },\n    // HM 2 locrian #6 !\n    {\n        symbol: 'ionian augmented',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'dorian #4',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'spanish',\n        groups: ['Advanced', 'Diatonic']\n    },\n    // HM 6 lydian #9\n    // HM 7 ???\n    // melodic minor modes\n    {\n        symbol: 'melodic minor',\n        groups: ['Advanced', 'Diatonic']\n    },\n    {\n        symbol: 'melodic minor second mode',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'lydian augmented',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'lydian dominant',\n        groups: ['Advanced', 'Diatonic'],\n        long: 'mixolydian #11'\n    },\n    {\n        symbol: 'melodic minor fifth mode',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'locrian #2',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'altered',\n        groups: ['Advanced', 'Diatonic']\n    },\n    //non european\n    {\n        symbol: 'kumoijoshi',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'iwato',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'pelog',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    // hyojo?\n    {\n        symbol: 'egyptian',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'in-sen',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'scriabin',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'ritusen',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'hirajoshi',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'malkos raga',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'vietnamese 1',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    /* {\n        symbol: 'vietnamese 2',\n        groups: ['Exotic', 'Pentatonic'] // = minor pentatonic\n    }, */\n    {\n        symbol: 'lydian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'mixolydian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'ionian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'locrian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'flat six pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'minor six pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'minor #7M pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'lydian #5P pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'whole tone pentatonic',\n        groups: ['Pentatonic', 'Symmetric']\n    },\n    {\n        symbol: 'flat three pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'super locrian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'major flat two pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'lydian dominant pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'neopolitan major pentatonic',\n        groups: ['Pentatonic']\n    }\n    /*\n    mystery #1 piongio    prometheus major blues minor hexatonic six tone symmetric prometheus neopolitan\n     persian  spanish  oriental flamenco balinese   todi raga enigmatic lydian #9 neopolitan locrian #2  lydian minor  locrian major  romanian minor harmonic major hungarian major hungarian minor lydian dominant   neopolitan minor neopolitan major lydian diminished leading whole tone augmented heptatonic double harmonic major double harmonic lydian melodic minor fifth mode melodic minor second mode\n    bebop kafi raga  purvi raga ichikosucho bebop minor minor bebop bebop major bebop locrian bebop dominant spanish heptatonic minor six diminished\n    composite blues\n    */\n];\nexports.symbols = { chords: exports.chords, scales: exports.scales };\nexports.levels = ['Basic', 'Advanced', 'Expert'];\nfunction groupFilter(group) {\n    return function (item) {\n        var level = Math.max(item.groups.filter(function (group) { return exports.levels.indexOf(group) !== -1; })\n            .map(function (group) { return exports.levels.indexOf(group) + 1; }));\n        var groups = level > 0 ? Array.from(new Set(exports.levels.slice(level).concat(item.groups))) : item.groups;\n        return groups.indexOf(group) !== -1;\n    };\n}\nexports.groupFilter = groupFilter;\nfunction scaleNames(group) {\n    if (group === void 0) { group = 'Basic'; }\n    if (!group || group === 'All') {\n        return Scale.names();\n    }\n    return exports.scales.filter(groupFilter(group))\n        .map(function (scale) { return scale.symbol; });\n}\nexports.scaleNames = scaleNames;\nfunction chordNames(group) {\n    if (group === void 0) { group = 'Basic'; }\n    if (!group || group === 'All') {\n        return Chord.names();\n    }\n    return exports.chords.filter(groupFilter(group))\n        .map(function (scale) { return scale.symbol; });\n}\nexports.chordNames = chordNames;\nfunction groupNames() {\n    return Array.from(new Set(exports.levels.concat(exports.scales.concat(exports.chords)\n        .map(function (item) { return item.groups; })\n        .reduce(function (groups, current) { return groups.concat(current); })))).concat(['All']);\n}\nexports.groupNames = groupNames;\nfunction symbolName(type, symbol, long) {\n    var pool = exports.symbols[type + 's'];\n    var match = pool.find(function (item) { return item.symbol === symbol; });\n    if (!match) {\n        return symbol;\n    }\n    /* return symbol; */\n    return (long ? match.long : match.short) || symbol;\n}\nexports.symbolName = symbolName;\nfunction scaleName(symbol, long) {\n    if (long === void 0) { long = false; }\n    return symbolName('scale', symbol, long);\n}\nexports.scaleName = scaleName;\nfunction chordName(symbol, long) {\n    if (long === void 0) { long = false; }\n    return symbolName('chord', symbol, long);\n}\nexports.chordName = chordName;\nfunction randomItem(array) {\n    return array[Math.floor(Math.random() * array.length)];\n}\nexports.randomItem = randomItem;\nfunction randomScale(group) {\n    return randomItem(scaleNames(group));\n}\nexports.randomScale = randomScale;\nfunction randomChord(group) {\n    return randomItem(chordNames(group));\n}\nexports.randomChord = randomChord;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tonal_1 = require(\"tonal\");\nvar Synthesizer_1 = require(\"../instruments/Synthesizer\");\nvar symbols_1 = require(\"../symbols\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar steps = {\n    '1P': ['1', '8'],\n    '2m': ['b9', 'b2'],\n    '2M': ['9', '2',],\n    '2A': ['#9', '#2'],\n    '3m': ['b3'],\n    '3M': ['3'],\n    '4P': ['11', '4'],\n    '4A': ['#11', '#4'],\n    '5d': ['b5'],\n    '5P': ['5'],\n    '5A': ['#5'],\n    '6m': ['b13', 'b6'],\n    '6M': ['13', '6'],\n    '7m': ['b7'],\n    '7M': ['7', '^7', 'maj7']\n};\n/*\nLower Interval Limits (just guidelines):\n2m: E3-F3\n2M: Eb3-F3\n3m: C3-Eb3\n3M: Bb2-D3\n4P: Bb2-Eb3\n5D: B2-F3\n5P: Bb1-F2\n6m: F2-Db3\n6M: F2-D3\n7m: F2-Eb3\n7m: F2-E3\n8P: -\n\nmore rough: top note should be D3 or higher.\ntaken from https://www.youtube.com/watch?v=iW6YeDJklhQ\n*/\nfunction randomNumber(n) {\n    return Math.floor(Math.random() * n);\n}\nexports.randomNumber = randomNumber;\nfunction arraySum(array) {\n    return array.reduce(function (s, i) { return s + i; }, 0);\n}\nexports.arraySum = arraySum;\nfunction randomElement(array, weighted) {\n    if (!weighted) {\n        return array[randomNumber(array.length)];\n    }\n    var r = randomNumber(arraySum(weighted)) + 1;\n    var total = weighted\n        .reduce(function (abs, w, i) { return abs.concat(w + (abs.length ? abs[i - 1] : 0)); }, []);\n    return array[total.indexOf(total.find(function (s, i) { return s >= r; }))];\n}\nexports.randomElement = randomElement;\nfunction shuffleArray(a) {\n    var _a;\n    for (var i = a.length - 1; i > 0; i--) {\n        var j = Math.floor(Math.random() * (i + 1));\n        _a = [a[j], a[i]], a[i] = _a[0], a[j] = _a[1];\n    }\n    return a;\n}\nexports.shuffleArray = shuffleArray;\n/** OLD SHEET / RHYTHM STUFF */\n/** Travels path along measures */\nfunction getPath(path, measures, traveled) {\n    if (traveled === void 0) { traveled = []; }\n    if (!Array.isArray(measures[path[0]]) || path.length === 1) {\n        return measures[Math.min(path[0], measures.length - 1)];\n    }\n    return this.getPath(path.slice(1), measures[path[0]], traveled.concat(path[0]));\n}\nexports.getPath = getPath;\nfunction getDuration(divisions, noteLength, measureLength) {\n    if (noteLength === void 0) { noteLength = 1; }\n    if (measureLength === void 0) { measureLength = 1; }\n    return noteLength * divisions.reduce(function (f, d) { return f / d; }, 1000) * measureLength; // fraction of one\n}\nexports.getDuration = getDuration;\nfunction resolveChords(pattern, measures, path, divisions) {\n    var _this = this;\n    if (divisions === void 0) { divisions = []; }\n    if (Array.isArray(pattern)) {\n        // division: array of children lengths down the path (to calculate fraction)\n        divisions = [].concat(divisions, [pattern.length]);\n        return pattern.map(function (p, i) { return _this.resolveChords(p, measures, path.concat([i]), divisions); });\n    }\n    if (pattern === 0) {\n        return 0;\n    }\n    var fraction = getDuration(divisions, pattern);\n    if (fraction === 0) {\n        console.warn('fraction is 0', pattern);\n    }\n    if (fraction === NaN) {\n        console.warn('fraction NaN', divisions, pattern);\n    }\n    return { chord: this.getPath(path, measures), pattern: pattern, path: path, divisions: divisions, fraction: fraction };\n}\nexports.resolveChords = resolveChords;\nfunction hasOff(pattern, division) {\n    if (division === void 0) { division = 3; }\n    return Array.isArray(pattern) && pattern.length === division && pattern[division - 1] !== 0;\n}\nexports.hasOff = hasOff;\n// replaces offs on last beat with next chord + erases next one\nfunction offbeatReducer(settings) {\n    var _this = this;\n    // TODO: find out why some offbeats sound sketchy\n    return function (measures, bar, index) {\n        var last = index > 0 ? measures[index - 1] : null;\n        if (last && _this.hasOff(last[settings.cycle - 1], settings.division)) {\n            last[settings.cycle - 1][settings.division - 1] = bar[0];\n            bar[0] = 0;\n        }\n        return measures.concat([bar]);\n    };\n}\nexports.offbeatReducer = offbeatReducer;\nfunction randomSynth(mix, allowed, settings) {\n    if (allowed === void 0) { allowed = ['sine', 'triangle', 'square', 'sawtooth']; }\n    if (settings === void 0) { settings = {}; }\n    var gains = {\n        sine: 0.9,\n        triangle: 0.8,\n        square: 0.2,\n        sawtooth: 0.3\n    };\n    var wave = randomElement(allowed);\n    return new Synthesizer_1.Synthesizer(Object.assign({ gain: gains[wave], type: wave, mix: mix }, settings));\n}\nexports.randomSynth = randomSynth;\nfunction adsr(_a, time, param) {\n    var attack = _a.attack, decay = _a.decay, sustain = _a.sustain, release = _a.release, gain = _a.gain, duration = _a.duration, endless = _a.endless;\n    // console.log('adsr', attack, decay, sustain, release, gain, duration, time);\n    param.linearRampToValueAtTime(gain, time + attack);\n    param.setTargetAtTime(sustain * gain, time + Math.min(attack + decay, duration), decay);\n    if (!endless) {\n        param.setTargetAtTime(0, time + Math.max(duration - attack - decay, attack + decay, duration), release);\n    }\n}\nexports.adsr = adsr;\nfunction randomDelay(maxMs) {\n    return Math.random() * maxMs * 2 / 1000;\n}\nexports.randomDelay = randomDelay;\nfunction isInRange(note, range) {\n    return tonal_1.Distance.semitones(note, range[0]) <= 0 && tonal_1.Distance.semitones(note, range[1]) >= 0;\n}\nexports.isInRange = isInRange;\nfunction transposeNotes(notes, interval) {\n    return notes.map(function (note) { return tonal_1.Distance.transpose(note, interval); });\n}\nexports.transposeNotes = transposeNotes;\nfunction transposeToRange(notes, range, times) {\n    if (times === void 0) { times = 0; }\n    if (times > 10) {\n        return notes;\n    }\n    if (notes.find(function (note) { return tonal_1.Distance.semitones(note, range[0]) > 0; })) {\n        notes = notes.map(function (note) { return tonal_1.Distance.transpose(note, '8P'); });\n        console.log('tp up');\n        return transposeToRange(notes, range, ++times);\n    }\n    if (notes.find(function (note) { return tonal_1.Distance.semitones(note, range[1]) < 0; })) {\n        console.log('tp down');\n        notes = notes.map(function (note) { return tonal_1.Distance.transpose(note, '-8P'); });\n        return transposeToRange(notes, range, ++times);\n    }\n    return notes;\n}\nexports.transposeToRange = transposeToRange;\nfunction getAverageMidi(notes, offset) {\n    return notes.reduce(function (sum, note) { return sum + Harmony_1.Harmony.getMidi(note, offset); }, 0) / notes.length;\n}\nexports.getAverageMidi = getAverageMidi;\nfunction getDistancesToRangeEnds(notes, range) {\n    if (notes.length > 2) {\n        notes = [notes[0], notes[notes.length - 1]];\n    }\n    var midi = notes.map(function (n) { return Harmony_1.Harmony.getMidi(n); });\n    var rangeMidi = range.map(function (n) { return Harmony_1.Harmony.getMidi(n); });\n    return [midi[0] - rangeMidi[0], rangeMidi[1] - midi[1]];\n}\nexports.getDistancesToRangeEnds = getDistancesToRangeEnds;\nfunction getRangePosition(note, range) {\n    note = Harmony_1.Harmony.getMidi(note);\n    range = range.map(function (n) { return Harmony_1.Harmony.getMidi(n); });\n    var semitones = [note - range[0], range[1] - range[0]];\n    return semitones[0] / semitones[1];\n}\nexports.getRangePosition = getRangePosition;\nfunction getRangeDirection(note, range, defaultDirection, border) {\n    if (defaultDirection === void 0) { defaultDirection = 'down'; }\n    if (border === void 0) { border = 0; }\n    var position = getRangePosition(note, range);\n    if (position <= border) {\n        return { direction: 'up', force: true };\n    }\n    if (position >= (1 - border)) {\n        return { direction: 'down', force: true };\n    }\n    return {\n        direction: defaultDirection, force: false\n    };\n}\nexports.getRangeDirection = getRangeDirection;\n// accepts both strings or numbers where negative means minor, \n// returns unified step string that can be turned into an interval\nfunction getStep(step) {\n    if (typeof step === 'number' && step < 0) {\n        step = 'b' + (step * -1);\n    }\n    return step + ''; // to string\n}\nexports.getStep = getStep;\nfunction getIntervalFromStep(step) {\n    step = getStep(step);\n    var interval = Object.keys(steps)\n        .find(function (i) { return steps[i].includes(step); });\n    if (!interval) {\n        // console.warn(`step ${step} has no defined inteval`);\n    }\n    return interval;\n}\nexports.getIntervalFromStep = getIntervalFromStep;\nfunction getStepsFromDegree(degree) {\n    return;\n}\nexports.getStepsFromDegree = getStepsFromDegree;\nfunction getStepInChord(note, chord, group) {\n    return getStepFromInterval(tonal_1.Distance.interval(tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord))[0], tonal_1.Note.pc(note)));\n}\nexports.getStepInChord = getStepInChord;\nfunction getChordScales(chord, group) {\n    if (group === void 0) { group = 'Diatonic'; }\n    var tokens = tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord));\n    var isSuperset = tonal_1.PcSet.isSupersetOf(tonal_1.Chord.intervals(tokens[1]));\n    return symbols_1.scaleNames(group).filter(function (name) { return isSuperset(tonal_1.Scale.intervals(name)); });\n}\nexports.getChordScales = getChordScales;\nfunction pickChordScale(chord, group) {\n    if (group === void 0) { group = 'Diatonic'; }\n    var scales = getChordScales(chord);\n    if (!scales.length) {\n        console.warn(\"cannot pick chord scale: no scales found for chord \" + chord + \" in group \" + group);\n        return;\n    }\n    return scales[0];\n}\nexports.pickChordScale = pickChordScale;\nfunction findDegree(degreeOrStep, intervalsOrSteps) {\n    var intervals = intervalsOrSteps.map(function (i) { return isInterval(i) ? i : getIntervalFromStep(i); });\n    if (typeof degreeOrStep === 'number') { // is degree\n        var degree_1 = Math.abs(degreeOrStep);\n        return intervals.find(function (i) {\n            i = Harmony_1.Harmony.minInterval(i, 'up');\n            if (!steps[i]) {\n                console.error('interval', i, 'is not valid', intervals);\n            }\n            return !!(steps[i].find(function (step) { return getDegreeFromStep(step) === degree_1; }));\n        });\n    }\n    // is step\n    var step = getStep(degreeOrStep);\n    return intervals.find(function (i) { return i.includes(step) ||\n        i === getIntervalFromStep(step); });\n}\nexports.findDegree = findDegree;\nfunction hasDegree(degree, intervals) {\n    return !!findDegree(degree, intervals);\n}\nexports.hasDegree = hasDegree;\nfunction hasAllDegrees(degrees, intervals) {\n    return degrees.reduce(function (res, d) { return res && hasDegree(d, intervals); }, true);\n}\nexports.hasAllDegrees = hasAllDegrees;\nfunction getScaleDegree(degree, scale) {\n    return findDegree(degree, tonal_1.Scale.intervals(scale));\n}\nexports.getScaleDegree = getScaleDegree;\nfunction getScalePattern(pattern, scale) {\n    return pattern.map(function (degree) { return getScaleDegree(degree, scale); });\n}\nexports.getScalePattern = getScalePattern;\nfunction renderIntervals(intervals, root) {\n    return intervals.map(function (i) { return tonal_1.Distance.transpose(root, i); });\n}\nexports.renderIntervals = renderIntervals;\nfunction renderSteps(steps, root) {\n    return renderIntervals(steps.map(function (step) { return getIntervalFromStep(step); }), root);\n}\nexports.renderSteps = renderSteps;\nfunction permutateIntervals(intervals, pattern) {\n    return pattern.map(function (d) { return findDegree(d, intervals); });\n}\nexports.permutateIntervals = permutateIntervals;\nfunction getStepFromInterval(interval) {\n    return steps[interval] ? steps[interval][0] : 0;\n}\nexports.getStepFromInterval = getStepFromInterval;\nfunction getDegreeFromInterval(interval, simplify) {\n    if (interval === void 0) { interval = '-1'; }\n    if (simplify === void 0) { simplify = false; }\n    var fixed = Harmony_1.Harmony.fixInterval(interval, simplify) || '';\n    var match = fixed.match(/[-]?([1-9])+/);\n    if (!match) {\n        return 0;\n    }\n    return Math.abs(parseInt(match[0], 10));\n}\nexports.getDegreeFromInterval = getDegreeFromInterval;\nfunction getDegreeFromStep(step) {\n    step = getStep(step);\n    return parseInt(step.match(/([1-9])+/)[0], 10);\n}\nexports.getDegreeFromStep = getDegreeFromStep;\nfunction getDegreeInChord(degree, chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var intervals = tonal_1.Chord.intervals(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    return tonal_1.Distance.transpose(tokens[0], findDegree(degree, intervals));\n}\nexports.getDegreeInChord = getDegreeInChord;\nfunction getPatternInChord(pattern, chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var intervals = tonal_1.Chord.intervals(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    var permutation;\n    if (hasAllDegrees(pattern, intervals)) {\n        permutation = permutateIntervals(intervals, pattern);\n    }\n    else {\n        // not all degrees of the pattern are in the chord > get scale\n        var scale = pickChordScale(chord);\n        permutation = permutateIntervals(tonal_1.Scale.intervals(scale), pattern);\n    }\n    if (tokens[0]) {\n        return renderIntervals(permutation, tokens[0]);\n    }\n    return permutation;\n}\nexports.getPatternInChord = getPatternInChord;\n// TODO: other way around: find fixed interval pattern in a scale\n// TODO: motives aka start pattern from same note in different scale\n// TODO: motives aka start pattern from different note in same scale\n// TODO: motives aka start pattern from different note in different scale\nfunction getDigitalPattern(chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var intervals = tonal_1.Chord.intervals(chord);\n    if (intervals.includes('3m')) {\n        return [1, 3, 4, 5];\n    }\n    else if (intervals.includes('3M')) {\n        return [1, 2, 3, 5];\n    }\n    else {\n        return [1, 1, 1, 1];\n    }\n}\nexports.getDigitalPattern = getDigitalPattern;\nfunction renderDigitalPattern(chord) {\n    return getPatternInChord(getDigitalPattern(chord), chord);\n}\nexports.renderDigitalPattern = renderDigitalPattern;\nfunction getGuideTones(chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    return getPatternInChord([3, 7], chord);\n}\nexports.getGuideTones = getGuideTones;\nfunction isFirstInPath(path, index) {\n    return path.slice(index)\n        .reduce(function (sum, value) { return sum + value; }, 0) === 0;\n}\nexports.isFirstInPath = isFirstInPath;\nfunction isBarStart(path) {\n    return isFirstInPath(path, 1);\n}\nexports.isBarStart = isBarStart;\nfunction isFormStart(path) {\n    return isFirstInPath(path, 0);\n}\nexports.isFormStart = isFormStart;\nfunction isOffbeat(path) {\n    return path[2] !== 0;\n}\nexports.isOffbeat = isOffbeat;\nfunction otherDirection(direction, defaultDirection) {\n    if (direction === 'up') {\n        return 'down';\n    }\n    else if (direction === 'down') {\n        return 'up';\n    }\n    return defaultDirection;\n}\nexports.otherDirection = otherDirection;\nfunction totalDiff(diff) {\n    var total = diff.reduce(function (weight, diff) {\n        weight.added += diff.added ? diff.count : 0;\n        weight.removed += diff.added ? diff.count : 0;\n        weight.kept += (!diff.added && !diff.removed) ? diff.count : 0;\n        return weight;\n    }, { added: 0, removed: 0, kept: 0, balance: 0 });\n    total.balance = total.added - total.removed;\n    total.changes = total.added + total.removed;\n    return total;\n}\nexports.totalDiff = totalDiff;\n/** Reorders the given notes to contain the given step as close as possible */\nfunction sortByDegree(notes, degree) {\n    degree = Math.max(degree, (degree + 8) % 8);\n    /* const semitones = Interval.semitones(interval); */\n    var diffDegrees = function (a, b) { return Math.abs(getDegreeFromInterval(tonal_1.Distance.interval(a, b)) - degree); };\n    /* const diffTones = (a, b) => Math.abs(Distance.interval(a, b) - semitones); */\n    notes = notes.slice(1).reduce(function (chain, note) {\n        var closest = notes\n            .filter(function (n) { return !chain.includes(n); })\n            .sort(function (a, b) { return diffDegrees(chain[0], a) < diffDegrees(chain[0], b) ? -1 : 1; });\n        chain.unshift(closest[0]);\n        return chain;\n    }, [notes[0]]).reverse();\n    return notes;\n}\nexports.sortByDegree = sortByDegree;\n/** Returns the given notes with octaves either moving bottom up or top down */\nfunction renderAbsoluteNotes(notes, octave, direction) {\n    if (octave === void 0) { octave = 3; }\n    if (direction === void 0) { direction = 'up'; }\n    return notes.reduce(function (absolute, current, index, notes) {\n        if (index === 0) {\n            return [current + octave];\n        }\n        var interval = tonal_1.Distance.interval(notes[index - 1], current);\n        interval = Harmony_1.Harmony.minInterval(interval, direction);\n        if (interval === '1P') {\n            interval = direction === 'down' ? '-8P' : '8P';\n        }\n        absolute.push(tonal_1.Distance.transpose(absolute[index - 1], interval));\n        return absolute;\n    }, []);\n}\nexports.renderAbsoluteNotes = renderAbsoluteNotes;\nfunction getIntervals(notes) {\n    return notes.reduce(function (intervals, note, index, notes) {\n        if (index === 0) {\n            return [];\n        }\n        intervals.push(tonal_1.Distance.interval(notes[index - 1], note));\n        return intervals;\n    }, []);\n}\nexports.getIntervals = getIntervals;\nfunction isInterval(interval) {\n    return typeof tonal_1.Interval.semitones(interval) === 'number';\n}\nexports.isInterval = isInterval;\nfunction smallestInterval(intervals) {\n    return intervals.reduce(function (min, current) {\n        if (!min || tonal_1.Distance.semitones(current) < tonal_1.Distance.semitones(min)) {\n            return current;\n        }\n        return min;\n    });\n}\nexports.smallestInterval = smallestInterval;\nfunction sortNotes(notes, direction) {\n    if (direction === void 0) { direction = 'up'; }\n    return notes.sort(function (a, b) { return Harmony_1.Harmony.getMidi(a) - Harmony_1.Harmony.getMidi(b); });\n}\nexports.sortNotes = sortNotes;\nfunction analyzeVoicing(notes, root) {\n    if (!notes || notes.length < 2) {\n        throw new Error('Can only analyze Voicing with at least two notes');\n    }\n    notes = sortNotes(notes);\n    root = root || notes[0]; // TODO: get degrees\n    var intervals = getIntervals(notes);\n    var sortedIntervals = intervals.sort(Harmony_1.Harmony.sortMinInterval());\n    return {\n        notes: notes,\n        minInterval: sortedIntervals[0],\n        maxInterval: sortedIntervals[sortedIntervals.length - 1],\n        intervals: intervals,\n        spread: tonal_1.Distance.interval(notes[0], notes[notes.length - 1])\n    };\n}\nexports.analyzeVoicing = analyzeVoicing;\nfunction semitoneDifference(intervals) {\n    return intervals.reduce(function (semitones, interval) {\n        return semitones + Math.abs(tonal_1.Interval.semitones(interval));\n    }, 0);\n}\nexports.semitoneDifference = semitoneDifference;\nfunction semitoneMovement(intervals) {\n    return intervals.reduce(function (semitones, interval) {\n        return semitones + tonal_1.Interval.semitones(interval);\n    }, 0);\n}\nexports.semitoneMovement = semitoneMovement;\nfunction longestChild(array) {\n    return array.reduce(function (max, current) { return (current.length > max.length ? current : max); }, array[0]);\n}\nexports.longestChild = longestChild;\nfunction isPitchClass(note) {\n    return tonal_1.Note.pc(note) === note;\n}\nexports.isPitchClass = isPitchClass;\nfunction mapTree(tree, modifier, simplify, path, siblings, position) {\n    if (simplify === void 0) { simplify = false; }\n    if (path === void 0) { path = []; }\n    if (siblings === void 0) { siblings = []; }\n    if (position === void 0) { position = 0; }\n    // skip current tree if only one child\n    if (simplify && Array.isArray(tree) && tree.length === 1) {\n        return mapTree(tree[0], modifier, simplify, path, siblings, position);\n    }\n    var fraction = siblings.reduce(function (f, d) { return f / d; }, 1);\n    if (!Array.isArray(tree)) {\n        return modifier ? modifier(tree, { path: path, siblings: siblings, fraction: fraction, position: position }) : tree;\n    }\n    if (Array.isArray(tree)) {\n        siblings = siblings.concat([tree.length]);\n        fraction = fraction / tree.length;\n        return tree.map(function (subtree, index) {\n            return mapTree(subtree, modifier, simplify, path.concat([index]), siblings, position + index * fraction);\n        });\n    }\n}\nexports.mapTree = mapTree;\nfunction flattenTree(tree) {\n    var flat = [];\n    mapTree(tree, function (value, props) { return flat.push(Object.assign(props, { value: value })); });\n    return flat;\n}\nexports.flattenTree = flattenTree;\nfunction expandTree(tree) {\n    // TODO\n}\nexports.expandTree = expandTree;\n/* Returns true if the given intervals are all present in the chords interval structure\nIntervals can be appendend with \"?\" to indicate that those degrees could also be omitted\n(but when present they should match)\n*/\nfunction chordHasIntervals(chord, intervals) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var has = tonal_1.Chord.intervals(chord);\n    return intervals.reduce(function (match, current) {\n        var isOptional = current.includes('?');\n        var isForbidden = current.includes('!');\n        if (isOptional) {\n            current = current.replace('?', '');\n            return (!hasDegree(getDegreeFromInterval(current), has) ||\n                has.includes(current)) && match;\n        }\n        if (isForbidden) {\n            current = current.replace('!', '');\n            return !hasDegree(getDegreeFromInterval(current), has);\n        }\n        return has.includes(current) && match;\n    }, true);\n}\nexports.chordHasIntervals = chordHasIntervals;\nfunction isDominantChord(chord) {\n    return chordHasIntervals(chord, ['3M', '7m']) || chordHasIntervals(chord, ['!3', '4P', '7m']);\n}\nexports.isDominantChord = isDominantChord;\nfunction isMajorChord(chord) {\n    return chordHasIntervals(chord, ['3M', '7M?']);\n}\nexports.isMajorChord = isMajorChord;\nfunction isMinorChord(chord) {\n    return chordHasIntervals(chord, ['3m']);\n}\nexports.isMinorChord = isMinorChord;\nfunction isMinorTonic(chord) {\n    return chordHasIntervals(chord, ['3m', '5P', '13M?', '7M?']);\n}\nexports.isMinorTonic = isMinorTonic;\nfunction getChordType(chord) {\n    if (isDominantChord(chord)) {\n        return 'dominant';\n    }\n    if (isMajorChord(chord)) {\n        return 'major';\n    }\n    if (isMinorTonic(chord)) {\n        return 'minor-tonic';\n    }\n    if (isMinorChord(chord)) {\n        return 'minor';\n    }\n}\nexports.getChordType = getChordType;\nfunction getChordNotes(chord, validate) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    var notes = tonal_1.Chord.notes(chord);\n    return notes.filter(function (note) {\n        var interval = tonal_1.Distance.interval(tokens[0], note);\n        return !validate || validate(note, {\n            root: tokens[0],\n            symbol: tokens[1],\n            interval: interval,\n            step: getStepFromInterval(interval),\n            degree: getDegreeFromInterval(interval)\n        });\n    });\n}\nexports.getChordNotes = getChordNotes;\nfunction validateWithoutRoot(note, _a) {\n    var degree = _a.degree;\n    return degree !== 1;\n}\nexports.validateWithoutRoot = validateWithoutRoot;\n// OLD...\nfunction getVoicing(chord, _a) {\n    var _b = _a === void 0 ? {} : _a, voices = _b.voices, previousVoicing = _b.previousVoicing, omitRoot = _b.omitRoot, quartal = _b.quartal;\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    var notes = tonal_1.Chord.notes(chord);\n    if (omitRoot) {\n        notes = notes.filter(function (n) { return n !== tokens[0]; });\n    }\n    if (quartal) {\n    }\n    if (previousVoicing) {\n    }\n    return notes;\n}\nexports.getVoicing = getVoicing;\nfunction semitoneDistance(noteA, noteB) {\n    return tonal_1.Interval.semitones(tonal_1.Distance.interval(noteA, noteB));\n}\nexports.semitoneDistance = semitoneDistance;\nfunction noteArray(range) {\n    var slots = tonal_1.Interval.semitones(tonal_1.Distance.interval(range[0], range[1]));\n    return new Array(slots + 1)\n        .fill('')\n        .map(function (v, i) { return tonal_1.Distance.transpose(range[0], tonal_1.Interval.fromSemitones(i)); })\n        .map(function (n) { return tonal_1.Note.simplify(n); });\n}\nexports.noteArray = noteArray;\nfunction factorial(n) {\n    var value = 1;\n    for (var i = 2; i <= n; ++i) {\n        value *= i;\n    }\n    return value;\n}\nexports.factorial = factorial;\n// finds best combination following the given notes, based on minimal movement\n/* export function bestCombination(notes, combinations = []) {\n    return combinations.reduce((best, current) => {\n        const currentMovement = voicingDifference(notes, current);\n        const bestMovement = voicingDifference(notes, best);\n        if (Math.abs(currentMovement) < Math.abs(bestMovement)) {\n            return current;\n        }\n        return best;\n    });\n} */\n/* export function sortCombinationsByMovement(notes, combinations, direction: intervalDirection = 'up', min = true) {\n    const movements = combinations.map((combination) => ({\n        movement: voicingMovement(notes, combination, min),\n        combination\n    }));\n    let right = movements.filter(move => direction === 'up' ? move >= 0 : move <= 0);\n    if (!right.length) {\n        right = movements;\n    }\n    let sorted = right.sort((a, b) => a.movement - b.movement);\n    if (direction === 'down') {\n        sorted = sorted.reverse();\n    }\n    return sorted.map(movement => movement.combination);\n}\n */ \n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nvar off = function () { return util_1.randomElement([0, [0, 1]], [6, 1]); };\nvar eightFour = function () { return util_1.randomElement([[1, 1], 1], [2, 1]); };\nvar eightOff = function () { return util_1.randomElement([[1, 1], [0, 1]], [2, 1]); };\nvar halfTriplet = function () { return util_1.randomElement([[2, 0], [[2, 0, 2], [0, 2, 0]]], [2, 1]); };\nvar one = function (v) {\n    if (v === void 0) { v = 1; }\n    return util_1.randomElement([0, v]);\n};\nexports.bossa = {\n    name: 'Bossa',\n    tempo: 160,\n    chords: function (_a) {\n        var measure = _a.measure, settings = _a.settings;\n        return util_1.randomElement([\n            [1, [0, 1], 0, [0, 3]],\n            [one(), [0, 3], 0, [0, 1]],\n            [one(), [0, 1], [0, 3], 0],\n            [one(), [0, 3], [0, 1], 0]\n        ]);\n    },\n    bass: function () {\n        return [1, [0, 3], 0, util_1.randomElement([0, 1])];\n    },\n    rimshot: function (_a) {\n        var measure = _a.measure, settings = _a.settings;\n        return [0, .8, 0, 0];\n    },\n    ride: function (_a) {\n        var measures = _a.measures, index = _a.index;\n        return util_1.randomElement([\n            [[one(.6), .9, [.4, .5], [0, .8]]],\n            [[0, .9, [.4, .5], [one(.6), .8]]],\n        ]);\n    },\n    hihat: function () { return [0, .8, 0, 1]; },\n    solo: function () { return util_1.randomElement([\n        [eightFour(), eightFour(), eightFour(), eightFour()],\n        [eightFour(), 2, 0, eightFour()],\n        [0, 0, eightFour(), eightOff()],\n        [[1, 4], 0, eightFour(), eightFour()],\n        [4, 0, 0, 0],\n        halfTriplet().concat(halfTriplet()),\n        [eightOff(), eightOff(), eightOff(), eightOff()],\n    ]); }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nexports.funk = {\n    name: 'Funk',\n    tempo: 90,\n    chords: function () { return util_1.randomElement([\n        [[2, 0, 0, 1], 0, [0, .6], [0, 3.5, 0, 0]],\n        [[1, 0, 0, 5], 0, [0, .6], [1, .5, 0, 0]],\n        [[1, 0, 0, 5], 0, [0, .6], [.5, 0, 2, 0]],\n        [[1, 0, 0, 5], 0, [0, .6], [0, 2, 0, 1]],\n        [[3, 0, 0, 0], 0, 2, 0]\n    ]); },\n    bass: function () { return util_1.randomElement([\n        [[2, 0, 0, 1], [0, 1], 1, [0, 1]],\n        [[2, 0, 0, 0], [0, 1, 0, 1], [0, 0, 1, 0], [0, 0, 0, 1]],\n    ]); },\n    kick: function (t) { return [[[1, .7], 0, [0, 1], 0]]; },\n    snare: function (t) { return [0, 1, [0, .2, 0, 0], [1, 0, 0, .6]]; },\n    hihat: function (t) { return [[.5, .6], [.4, .7], [.3, .6], [.5, .7]]; }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nvar off = function () { return util_1.randomElement([0, [0, 0, 2]], [6, 1]); };\nvar eightFour = function () { return util_1.randomElement([[1, 0, 1], 1, [0, 0, 1, 1]], [4, 2, 1]); };\nvar eightOff = function () { return util_1.randomElement([[1, 0, 1], [0, 0, 1]], [4, 1]); };\nvar halfTriplet = function () { return util_1.randomElement([\n    [2, 0],\n    [[2, 0, 2], [0, 2, 0]],\n    [1, 1, 1, 1]\n], [2, 1, 1]); };\nexports.swing = {\n    name: 'Swing',\n    tempo: 130,\n    chords: function (_a) {\n        var measure = _a.measure, settings = _a.settings;\n        var r = Math.random() > 0.5 ? .6 : 0;\n        var t = settings.cycle + \"/\" + measure.length;\n        if (t === '4/1') {\n            return util_1.randomElement([\n                [[1, 0], [0, 0, 7], 0, 0],\n                [1, [0, 0, 2], 0, off()],\n                [[0, 0, 1], 0, 2, 0],\n                [[0, 0, 4], 0, 1, 0],\n                [2, 0, 0, 0],\n                [3, 0, 0, 0],\n                [1, 0, r, off()],\n                [[0, 0, 2], 0, r, 0],\n                [1.5, [0, 0, 2], 0, off()],\n            ]); //, [2, 1, 1]\n        }\n        if (t === '4/2') {\n            return util_1.randomElement([\n                [[1, 0], [0, 0, 7], 0, 0],\n                [1, [0, 0, 3], 0, 0],\n                [1, 0, 2, 0],\n                [2, 0, 1, 0],\n                [1, 0, .7, off()],\n                [[1, 0, 0], 0, .7, off()],\n                [[4, 0, 0], [0, 0, 2.8], 0, off()],\n            ]);\n        }\n        if (t === '4/3') {\n            return [1, [0, 0, 2], [0, 0, 4], 0];\n        }\n        if ('4/4') {\n            return util_1.randomElement([\n                [1, 1, 1, 1],\n                [[1, 0, 2], [0, 0, 2], 0, 1]\n            ]);\n        }\n    },\n    bass: function () { return util_1.randomElement([\n        [1, 1, 1, 1],\n    ]); },\n    crash: function (_a) {\n        var measures = _a.measures, index = _a.index;\n        var fill = index !== 0 && index % measures.length === 0;\n        if (fill) {\n            return [4, 0, 0, 0];\n        }\n        return [0, 0, 0, 0];\n    },\n    ride: function (_a) {\n        var measures = _a.measures, index = _a.index;\n        return util_1.randomElement([\n            [.6, [.9, 0, 1], .6, [.9, 0, 1]],\n            [.6, [.4, 0, 1], .8, [0, 0, 1],],\n            [.6, .9, [.6, 0, 1], 1],\n            [.6, .9, .6, [.9, 0, 1]],\n        ], [3, 2, 1, 2]);\n    },\n    hihat: function () { return [0, .8, 0, 1]; },\n    solo: function () { return util_1.randomElement([\n        [eightFour(), eightFour(), eightFour(), eightFour()],\n        [eightFour(), 2, 0, eightFour()],\n        [0, 0, eightFour(), eightFour()],\n        [[1, 0, 4], 0, eightFour(), eightFour()],\n        [3, 0, 0, eightFour()],\n        halfTriplet().concat(halfTriplet()),\n        [eightOff(), eightOff(), eightOff(), eightOff()],\n    ]); }\n    /* solo: () => [1, 1, 0, 1] */\n};\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Measure_1 = require(\"./Measure\");\nvar Sheet = /** @class */ (function () {\n    function Sheet() {\n    }\n    Sheet.render = function (sheet, options) {\n        if (options === void 0) { options = {}; }\n        var state = __assign({ sheet: sheet, measures: [], forms: 1, nested: true, fallbackToZero: true, firstTime: true }, options);\n        state = __assign({}, state, Sheet.newForm(state));\n        var runs = 0;\n        while (runs < 100 && state.index < sheet.length) {\n            runs++;\n            state = Sheet.nextMeasure(state);\n        }\n        return state.measures /* .map(m => Measure.from(m)) */;\n    };\n    Sheet.nextMeasure = function (state) {\n        state = __assign({}, state, Sheet.nextSection(state)); // moves to the right house (if any)\n        var sheet = state.sheet, index = state.index, measures = state.measures;\n        state = __assign({}, state, { measures: measures.concat([__assign({}, Measure_1.Measure.from(sheet[index]), { index: index // add index for mapping\n                 })]) }, Sheet.nextIndex(state));\n        return Sheet.nextForm(state);\n    };\n    Sheet.nextIndex = function (state) {\n        var _a;\n        var sheet = state.sheet, index = state.index, jumps = state.jumps, nested = state.nested, fallbackToZero = state.fallbackToZero;\n        if (!Sheet.shouldJump({ sheet: sheet, index: index, jumps: jumps })) {\n            return {\n                index: index + 1\n            };\n        }\n        var braces = [Sheet.getJumpDestination({ sheet: sheet, index: index, fallbackToZero: fallbackToZero, nested: nested }), index];\n        jumps = Sheet.wipeKeys(jumps, [braces[0], braces[1] - 1]); // wipes indices inside braces\n        return {\n            index: braces[0],\n            jumps: __assign({}, jumps, (_a = {}, _a[braces[1]] = (jumps[braces[1]] || 0) + 1, _a))\n        };\n    };\n    Sheet.newForm = function (state) {\n        return __assign({}, state, { index: 0, jumps: {}, visits: {}, lastTime: state.forms === 1 });\n    };\n    Sheet.nextForm = function (state, force) {\n        if (force === void 0) { force = false; }\n        var sheet = state.sheet, index = state.index, forms = state.forms;\n        if (force || (index >= sheet.length && forms > 1)) {\n            return Sheet.newForm(__assign({}, state, { firstTime: false, forms: forms - 1 }));\n        }\n        return state;\n    };\n    // moves the index to the current house (if any)\n    Sheet.nextSection = function (state) {\n        var _a;\n        var sheet = state.sheet, index = state.index, visits = state.visits, firstTime = state.firstTime, lastTime = state.lastTime;\n        // skip intro when not firstTime\n        if (!firstTime && Measure_1.Measure.from(sheet[index]).section === 'IN') {\n            return {\n                index: Sheet.getNextSectionIndex({ sheet: sheet, index: index }),\n            };\n        }\n        // skip coda when not last time\n        if (Measure_1.Measure.hasSign('Coda', sheet[index]) && !Sheet.readyForFineOrCoda(state)) {\n            return Sheet.nextForm(state, true);\n        }\n        if (!Measure_1.Measure.hasHouse(sheet[index], 1)) {\n            return {};\n        }\n        var next = Sheet.getNextHouseIndex({ sheet: sheet, index: index, visits: visits });\n        if (next === -1) {\n            next = index;\n            visits = {}; // reset visits\n        }\n        return {\n            visits: __assign({}, visits, (_a = {}, _a[next] = (visits[next] || 0) + 1, _a)),\n            index: next\n        };\n    };\n    /** Starts at a given index, stops when the pair functions returned equally often */\n    Sheet.findPair = function (sheet, index, pairs, move, stack) {\n        if (move === void 0) { move = 1; }\n        if (stack === void 0) { stack = 0; }\n        var match = -1; // start with no match\n        while (match === -1 && index >= 0 && index < sheet.length) {\n            if (pairs[0](sheet[index], { sheet: sheet, index: index })) { // same sign\n                stack++;\n            }\n            if (pairs[1](sheet[index], { sheet: sheet, index: index })) { // pair sign\n                stack--;\n            }\n            if (stack === 0) { // all pairs resolved > match!\n                match = index;\n            }\n            else {\n                index += move;\n            }\n        }\n        return match;\n    };\n    Sheet.findMatch = function (sheet, index, find, move) {\n        if (move === void 0) { move = 1; }\n        var match = -1; // start with no match\n        while (match === -1 && index >= 0 && index < sheet.length) {\n            if (find(sheet[index], { sheet: sheet, index: index })) {\n                match = index;\n            }\n            else {\n                index += move;\n            }\n        }\n        return match;\n    };\n    // simple matching for brace start, ignores nested repeats\n    Sheet.getJumpDestination = function (state) {\n        var sheet = state.sheet, index = state.index, fallbackToZero = state.fallbackToZero, nested = state.nested;\n        var sign = Measure_1.Measure.getJumpSign(sheet[index]);\n        // if fine > jump till end\n        if (sign.fine) {\n            return sheet.length;\n        }\n        // if no pair given => da capo\n        if (!sign.pair) {\n            return 0;\n        }\n        // if nested mode on and opening brace is searched, use getBracePair..\n        if (nested !== false && sign.pair === '{') {\n            return Sheet.getBracePair({ sheet: sheet, index: index, fallbackToZero: fallbackToZero });\n        }\n        var destination = Sheet.findMatch(sheet, index, function (m) { return Measure_1.Measure.hasSign(sign.pair, m); }, sign.move || -1); // default move back\n        if (fallbackToZero) {\n            // default to zero when searching repeat start (could be forgotten)\n            return destination === -1 ? 0 : destination;\n        }\n        return destination;\n    };\n    // returns the index of the repeat sign that pairs with the given index\n    Sheet.getBracePair = function (_a) {\n        var sheet = _a.sheet, index = _a.index, fallbackToZero = _a.fallbackToZero;\n        if (fallbackToZero === undefined) {\n            fallbackToZero = true;\n        }\n        if (Measure_1.Measure.hasSign('{', sheet[index])) {\n            return Sheet.findPair(sheet, index, [\n                function (m) { return Measure_1.Measure.hasSign('{', m); },\n                function (m) { return Measure_1.Measure.hasSign('}', m); },\n            ], 1);\n        }\n        else if (Measure_1.Measure.hasSign('}', sheet[index])) {\n            var pair = Sheet.findPair(sheet, index, [\n                function (m, state) {\n                    // this logic could be infinitely complex, having many side effects and interpretations\n                    // the current behaviour is similar to musescore or ireal handling braces\n                    if (!Measure_1.Measure.hasSign('}', m)) {\n                        return false;\n                    }\n                    if (index === state.index) {\n                        return true;\n                    }\n                    var relatedHouse = Sheet.getRelatedHouse({ sheet: sheet, index: state.index });\n                    return relatedHouse === -1;\n                },\n                function (m) { return Measure_1.Measure.hasSign('{', m); }\n            ], -1);\n            if (fallbackToZero) {\n                return pair === -1 ? 0 : pair; // default to zero when searching repeat start (could be forgotten)\n            }\n            return pair;\n        }\n        return -1;\n    };\n    // returns true if the house at the given index has not been visited enough times\n    Sheet.canVisitHouse = function (_a) {\n        var sheet = _a.sheet, index = _a.index, visits = _a.visits;\n        var houses = sheet[index].house;\n        if (houses === undefined) {\n            return false;\n        }\n        if (!Array.isArray(houses)) {\n            houses = [houses];\n        }\n        var visited = visits[index] || 0;\n        return visited < houses.length;\n    };\n    // returns the next house that can be visited (from the given index)\n    Sheet.getNextHouseIndex = function (_a, move) {\n        var sheet = _a.sheet, index = _a.index, visits = _a.visits;\n        if (move === void 0) { move = 1; }\n        return Sheet.findMatch(sheet, index, function (m, step) { return Measure_1.Measure.hasHouse(m) && Sheet.canVisitHouse({ sheet: sheet, index: step.index, visits: visits }); }, move);\n    };\n    Sheet.getNextSectionIndex = function (_a, move) {\n        var sheet = _a.sheet, index = _a.index;\n        if (move === void 0) { move = 1; }\n        return Sheet.findMatch(sheet, index + 1, function (m) { return Measure_1.Measure.from(m).section !== undefined; }, 1);\n    };\n    // wipes all keys in the given range\n    Sheet.wipeKeys = function (numberMap, range) {\n        var wiped = {};\n        Object.keys(numberMap)\n            .map(function (i) { return parseInt(i); })\n            .filter(function (i) { return i < range[0] || i > range[1]; })\n            .forEach(function (i) { return wiped[i] = numberMap[i]; });\n        return wiped;\n    };\n    Sheet.getRelatedHouse = function (_a) {\n        var sheet = _a.sheet, index = _a.index;\n        var latestHouse = Sheet.findPair(sheet, index, [\n            function (m, state) { return index === state.index || Measure_1.Measure.hasSign('}', m); },\n            function (m) { return Measure_1.Measure.hasHouse(m); }\n        ], -1);\n        return latestHouse;\n    };\n    Sheet.isFirstHouse = function (_a) {\n        var sheet = _a.sheet, index = _a.index;\n        return Measure_1.Measure.hasHouse(sheet[index], 1);\n    };\n    Sheet.getAllowedJumps = function (_a) {\n        var sheet = _a.sheet, index = _a.index;\n        if (!Measure_1.Measure.hasJumpSign(sheet[index])) {\n            return 0;\n        }\n        var measure = Measure_1.Measure.from(sheet[index]);\n        if (measure.times !== undefined) {\n            return measure.times;\n        }\n        return 1;\n    };\n    Sheet.readyForFineOrCoda = function (_a) {\n        var sheet = _a.sheet, index = _a.index, jumps = _a.jumps, lastTime = _a.lastTime;\n        var signs = Object.keys(Sheet.jumpSigns)\n            .filter(function (s) { return s.includes('DC') || s.includes('DS'); });\n        var backJump = Sheet.findMatch(sheet, index, function (m) { return signs.reduce(function (match, sign) { return match || Measure_1.Measure.hasSign(sign, m); }, false); });\n        if (backJump === -1) {\n            return lastTime; // last time\n        }\n        return jumps[backJump] > 0;\n    };\n    Sheet.shouldJump = function (_a) {\n        var sheet = _a.sheet, index = _a.index, jumps = _a.jumps;\n        if (!Measure_1.Measure.hasJumpSign(sheet[index])) {\n            return false;\n        }\n        var sign = Measure_1.Measure.getJumpSign(sheet[index]);\n        if (sign.validator && !sign.validator({ sheet: sheet, index: index, jumps: jumps })) {\n            return false;\n        }\n        var allowedJumps = Sheet.getAllowedJumps({ sheet: sheet, index: index });\n        var timesJumped = jumps[index] || 0;\n        return timesJumped < allowedJumps;\n    };\n    Sheet.jumpSigns = {\n        '}': { pair: '{', move: -1 },\n        'DC': {},\n        'DS': { pair: 'Segno', move: -1 },\n        'DS.Fine': { pair: 'Segno', move: -1 },\n        'DS.Coda': { pair: 'Segno', move: -1 },\n        'DC.Fine': {},\n        'DC.Coda': {},\n        'Fine': {\n            fine: true,\n            validator: function (state) { return Sheet.readyForFineOrCoda(state); }\n        },\n        'ToCoda': {\n            pair: 'Coda', move: 1,\n            validator: function (state) { return Sheet.readyForFineOrCoda(state); }\n        }\n    };\n    return Sheet;\n}());\nexports.Sheet = Sheet;\n/*\nTODO:\n\nmore typings\nspecial sections:\nIN: only play the first time\nCODA: only play last time\n\ntest standards:\n- Alice in Wonderland (dc al 2nd ending)\n- All or Nothing at All (dc al coda)\n- Are you real (intro + coda)\n- Armageddon (intro)\n- The Bat (coda sign inside repeat): ireal plays coda directly first time..\n- Bennys Tune (intro+coda sign inside repeat): ireal plays coda directly first time..\n- Bess You Is My Woman (coda sign inside repeat): ireal plays coda directly first time..\n- Blessed Relief (nested repeats, with odd behaviour)\n- Blue in Green (coda)\n- Miles Ahead (coda)\n*/\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Sheet_1 = require(\"./Sheet\");\n;\nvar Measure = /** @class */ (function () {\n    function Measure() {\n    }\n    Measure.from = function (measure) {\n        if (typeof measure === 'string') {\n            return {\n                chords: [measure]\n            };\n        }\n        if (Array.isArray(measure)) {\n            return {\n                chords: [].concat(measure)\n            };\n        }\n        return Object.assign({}, measure);\n        // return measure;\n    };\n    Measure.hasSign = function (sign, measure) {\n        measure = Measure.from(measure);\n        return !!measure.signs && measure.signs.includes(sign);\n    };\n    Measure.hasHouse = function (measure, number) {\n        measure = Measure.from(measure);\n        var house = measure.house;\n        if (!house) {\n            return false;\n        }\n        else if (number === undefined) {\n            return true;\n        }\n        if (!Array.isArray(house)) {\n            house = [house];\n        }\n        return house.includes(number);\n    };\n    Measure.getJumpSign = function (measure) {\n        var signs = (Measure.from(measure).signs || [])\n            .filter(function (s) { return Object.keys(Sheet_1.Sheet.jumpSigns).includes(s); });\n        if (signs.length > 1) {\n            console.warn('measure cannot contain more than one repeat sign', measure);\n        }\n        return Sheet_1.Sheet.jumpSigns[signs[0]];\n    };\n    Measure.hasJumpSign = function (measure) {\n        return Object.keys(Sheet_1.Sheet.jumpSigns)\n            .reduce(function (match, current) { return match || Measure.hasSign(current, measure); }, false);\n    };\n    return Measure;\n}());\nexports.Measure = Measure;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Measure_1 = require(\"./Measure\");\n// extension of https://github.com/daumling/ireal-renderer/blob/master/src/ireal-renderer.js\nvar RealParser = /** @class */ (function () {\n    function RealParser() {\n    }\n    RealParser.getChord = function (iRealChord) {\n        return iRealChord.note + iRealChord.modifiers + (iRealChord.over ? '/' + this.getChord(iRealChord.over) : '');\n    };\n    RealParser.parseSheet = function (raw) {\n        return RealParser.getSheet(RealParser.parse(raw));\n    };\n    RealParser.getSheet = function (tokens) {\n        var _this = this;\n        var parsed = tokens\n            .reduce(function (current, token, index, array) {\n            var lastBarEnded = ['{', '|', '[', '||' /* 'Z',  */ /* , ']' */]\n                .includes(token.bars || token.token);\n            var signs = token.annots || [];\n            var repeatStart = (token.bars || token.token) === '{';\n            var repeatEnd = (token.bars || token.token) === '}';\n            if (repeatStart) {\n                signs.push('{');\n            }\n            if (repeatEnd) {\n                signs.push('}');\n            }\n            // current.measure ends\n            if (lastBarEnded) {\n                if (current.measure) {\n                    // simplify measure if no signs\n                    /* if (Object.keys(current.measure).find(k=>k)) {\n                        current.measure = current.measure.chords;\n                    } */\n                    current.measures.push(current.measure);\n                }\n                current.measure = { chords: [] };\n            }\n            var sectionStart = signs.find(function (a) { return a.match(/^\\*[a-zA-Z]/); });\n            if (sectionStart) {\n                signs = signs.filter(function (s) { return s !== sectionStart; });\n                current.measure.section = sectionStart.replace('*', '');\n            }\n            var hasCodaSign = signs.includes('Q');\n            if (hasCodaSign) {\n                signs = signs.filter(function (s) { return s !== 'Q'; });\n                var codaSign = 'ToCoda';\n                if (!!current.measures.find(function (m) { return Measure_1.Measure.hasSign('ToCoda', m); })) {\n                    codaSign = 'Coda';\n                }\n                current.measure.signs = (current.measure.signs || []).concat([codaSign]);\n            }\n            var houseStart = signs.find(function (s) { return !!s.match(/^N./); });\n            if (houseStart) {\n                signs = signs.filter(function (s) { return s !== houseStart; });\n                current.measure.house = parseInt(houseStart.replace('N', ''));\n            }\n            var time = signs.find(function (a) { return a.match(/^T\\d\\d/); });\n            if (time) {\n                signs = signs.filter(function (s) { return s !== time; });\n                current.measure.time = time.replace('T', '');\n            }\n            if (token.chord) {\n                current.measure.chords.push(_this.getChord(token.chord));\n            }\n            else if (token.token === 'n') {\n                current.measure.chords.push(0);\n            }\n            var last = current.measures[current.measures.length - 1];\n            if (last && last.chords[0] === 'r') {\n                last.chords = current.measures[current.measures.length - 3].chords;\n                current.measure.chords = current.measures[current.measures.length - 2].chords;\n            }\n            if (last && current.measure.chords[0] === 'x') {\n                current.measure.chords = [].concat(last.chords);\n                current.measure.idle = true;\n            }\n            if (signs.length) {\n                current.measure.signs = (current.measure.signs || [])\n                    .concat(signs);\n            }\n            if (token.comments.length) {\n                current.measure.comments = (current.measure.comments || [])\n                    .concat(token.comments.map(function (c) { return c.trim(); }));\n            }\n            return current;\n        }, { measure: null, signs: null, measures: [] });\n        if (parsed.measure.chords.length) {\n            parsed.measures.push(parsed.measure);\n        }\n        return parsed.measures;\n    };\n    RealParser.parse = function (raw) {\n        var text = raw;\n        var arr = [], headers = [], comments = [];\n        var i;\n        text = text.trim();\n        // text = text.trimRight();\n        while (text) {\n            var found = false;\n            for (i = 0; i < RealParser.regExps.length; i++) {\n                var match = RealParser.regExps[i].exec(text);\n                if (match) {\n                    found = true;\n                    if (match.length <= 2) {\n                        var replacement = match[0];\n                        var repl = RealParser.replacements[replacement];\n                        arr = arr.concat(repl ? repl : [replacement]);\n                        text = text.substr(replacement.length);\n                    }\n                    else { // a chord\n                        arr.push(match);\n                        text = text.substr(match[0].length);\n                    }\n                    break;\n                }\n            }\n            if (!found) {\n                // ignore the comma separator\n                if (text[0] !== ',')\n                    arr.push(text[0]);\n                text = text.substr(1);\n            }\n        }\n        //\t\tconsole.log(arr);\n        // pass 2: extract prefixes, suffixes, annotations and comments\n        var out = [];\n        var obj = RealParser.newToken(out);\n        for (i = 0; i < arr.length; i++) {\n            var token = arr[i];\n            if (token instanceof Array) {\n                obj.chord = RealParser.parseChord(token);\n                token = \" \";\n            }\n            switch (token[0]) {\n                case ',':\n                    token = null;\n                    break; // separator\n                case 'S': // segno\n                case 'T': // time measurement\n                case 'Q': // coda\n                case 'N': // repeat\n                case 'U': // END\n                case 's': // small\n                case 'l': // normal\n                case 'f': // fermata\n                case '*':\n                    obj.annots.push(token);\n                    token = null;\n                    break;\n                case 'Y':\n                    obj.spacer++;\n                    token = null;\n                    break;\n                case 'r':\n                case 'x':\n                case 'W':\n                    obj.chord = new iRealChord(token, \"\", null, null);\n                    break;\n                case '<':\n                    token = token.substr(1, token.length - 2);\n                    token = token.replace(/XyQ/g, \"   \"); // weird; needs to be done\n                    obj.comments.push(token);\n                    token = null;\n                    break;\n                default:\n            }\n            if (token) {\n                if (\"]}Z\".indexOf(arr[i + 1]) >= 0)\n                    obj.bars += arr[++i];\n                if (\"{[|\".indexOf(token) >= 0) {\n                    obj.bars += token;\n                    token = null;\n                }\n            }\n            if (token && i < arr.length - 1) {\n                obj.token = token;\n                obj = RealParser.newToken(out);\n            }\n        }\n        return out;\n    };\n    RealParser.parseChord = function (match) {\n        var note = match[1] || \" \";\n        var modifiers = match[2] || \"\";\n        var comment = match[3] || \"\";\n        if (comment)\n            modifiers += comment.substr(1, comment.length - 2).replace(\"XyQ\", \"   \");\n        var over = match[4] || \"\";\n        if (over[0] === '/')\n            over = over.substr(1);\n        var alternate = match[5] || null;\n        if (alternate) {\n            match = RealParser.chordRegex.exec(alternate.substr(1, alternate.length - 2));\n            if (!match)\n                alternate = null;\n            else\n                alternate = this.parseChord(match);\n        }\n        // empty cell?\n        if (note === \" \" && !alternate && !over)\n            return null;\n        if (over) {\n            var offset = (over[1] === '#' || over[1] === 'b') ? 2 : 1;\n            over = new iRealChord(over.substr(0, offset), over.substr(offset), null, null);\n        }\n        else\n            over = null;\n        return new iRealChord(note, modifiers, over, alternate);\n    };\n    RealParser.newToken = function (arr) {\n        var obj = new iRealToken;\n        arr.push(obj);\n        return obj;\n    };\n    /**\n     * The RegExp for a complete chord. The match array contains:\n     * 1 - the base note\n     * 2 - the modifiers (+-ohd0123456789 and su for sus)\n     * 3 - any comments (may be e.g. add, sub, or private stuff)\n     * 4 - the \"over\" part starting with a slash\n     * 5 - the top chord as (chord)\n     * @type RegExp\n     */\n    RealParser.chordRegex = /^([ A-GW][b#]?)((?:sus|[\\+\\-\\^\\dhob#])*)(\\*.+?\\*)*(\\/[A-G][#b]?)?(\\(.*?\\))?/;\n    RealParser.regExps = [\n        /^\\*[a-zA-Z]/,\n        /^T\\d\\d/,\n        /^N./,\n        /^<.*?>/,\n        /^ \\(.*?\\)/,\n        RealParser.chordRegex,\n        /^LZ/,\n        /^XyQ/,\n        /^Kcl/ // repeat last bar\n    ];\n    RealParser.replacements = {\n        \"LZ\": [\" \", \"|\"],\n        \"XyQ\": [\" \", \" \", \" \"],\n        \"Kcl\": [\"|\", \"x\", \" \"]\n    };\n    return RealParser;\n}());\nexports.RealParser = RealParser;\nvar iRealChord = /** @class */ (function () {\n    function iRealChord(note, modifiers, over, alternate) {\n        this.note = note;\n        this.modifiers = modifiers;\n        this.over = over;\n        this.alternate = alternate;\n    }\n    return iRealChord;\n}());\nvar iRealToken = /** @class */ (function () {\n    function iRealToken() {\n        this.annots = [];\n        this.comments = [];\n        this.bars = \"\";\n        this.spacer = 0;\n        this.chord = null;\n    }\n    return iRealToken;\n}());\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Permutation = /** @class */ (function () {\n    function Permutation() {\n    }\n    Permutation.permutateElements = function (array, validate, path) {\n        if (path === void 0) { path = []; }\n        var isValid = function (next) { return !validate || validate(path, next, array); };\n        if (array.length === 1) {\n            return isValid(array[0]) ? array : [];\n        }\n        return array.filter(isValid).reduce(function (combinations, el) { return combinations.concat(Permutation.permutateElements(array.filter(function (e) { return e !== el; }), validate, path.concat([el])).map(function (subcombinations) { return [\n            el\n        ].concat(subcombinations); })); }, []);\n    };\n    Permutation.permutationComplexity = function (array, validate, path) {\n        if (path === void 0) { path = []; }\n        var validations = 0;\n        Permutation.permutateElements(array, function (path, next, array) {\n            ++validations;\n            return !validate || validate(path, next, array);\n        }, path);\n        return validations;\n    };\n    Permutation.permutateArray = function (array) {\n        if (array.length === 1) {\n            return array;\n        }\n        return array.reduce(function (combinations, el) { return combinations.concat(Permutation.permutateArray(array.filter(function (e) { return e !== el; }))\n            .map(function (subcombinations) { return ([el].concat(subcombinations)); })); }, []);\n    };\n    // combine multiple validators\n    Permutation.combineValidators = function () {\n        var validators = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            validators[_i] = arguments[_i];\n        }\n        return function (path, next, array) { return validators\n            .reduce(function (result, validator) { return result && validator(path, next, array); }, true); };\n    };\n    //https://stackoverflow.com/questions/9960908/permutations-in-javascript\n    Permutation.combinations = function (array) {\n        var length = array.length, result = [array.slice()], c = new Array(length).fill(0), i = 1, k, p;\n        while (i < length) {\n            if (c[i] < i) {\n                k = i % 2 && c[i];\n                p = array[i];\n                array[i] = array[k];\n                array[k] = p;\n                ++c[i];\n                i = 1;\n                result.push(array.slice());\n            }\n            else {\n                c[i] = 0;\n                ++i;\n            }\n        }\n        return result;\n    };\n    // https://gist.github.com/axelpale/3118596\n    Permutation.binomial = function (set, k) {\n        var i, j, combs, head, tailcombs;\n        // There is no way to take e.g. sets of 5 elements from\n        // a set of 4.\n        if (k > set.length || k <= 0) {\n            return [];\n        }\n        // K-sized set has only one K-sized subset.\n        if (k == set.length) {\n            return [set];\n        }\n        // There is N 1-sized subsets in a N-sized set.\n        if (k == 1) {\n            combs = [];\n            for (i = 0; i < set.length; i++) {\n                combs.push([set[i]]);\n            }\n            return combs;\n        }\n        // Assert {1 < k < set.length}\n        // Algorithm description:\n        // To get k-combinations of a set, we want to join each element\n        // with all (k-1)-combinations of the other elements. The set of\n        // these k-sized sets would be the desired result. However, as we\n        // represent sets with lists, we need to take duplicates into\n        // account. To avoid producing duplicates and also unnecessary\n        // computing, we use the following approach: each element i\n        // divides the list into three: the preceding elements, the\n        // current element i, and the subsequent elements. For the first\n        // element, the list of preceding elements is empty. For element i,\n        // we compute the (k-1)-computations of the subsequent elements,\n        // join each with the element i, and store the joined to the set of\n        // computed k-combinations. We do not need to take the preceding\n        // elements into account, because they have already been the i:th\n        // element so they are already computed and stored. When the length\n        // of the subsequent list drops below (k-1), we cannot find any\n        // (k-1)-combs, hence the upper limit for the iteration:\n        combs = [];\n        for (i = 0; i < set.length - k + 1; i++) {\n            // head is a list that includes only our current element.\n            head = set.slice(i, i + 1);\n            // We take smaller combinations from the subsequent elements\n            tailcombs = Permutation.binomial(set.slice(i + 1), k - 1);\n            // For each (k-1)-combination we join it with the current\n            // and store it to the set of k-combinations.\n            for (j = 0; j < tailcombs.length; j++) {\n                combs.push(head.concat(tailcombs[j]));\n            }\n        }\n        return combs;\n    };\n    return Permutation;\n}());\nexports.Permutation = Permutation;\n","\"use strict\";\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar JsDiff = __importStar(require(\"diff\"));\nvar Measure_1 = require(\"./Measure\");\nvar Sheet_1 = require(\"./Sheet\");\nvar Snippet = /** @class */ (function () {\n    function Snippet() {\n    }\n    Snippet.render = function (snippet, options) {\n        var parsed = Snippet.parse(snippet);\n        return Sheet_1.Sheet.render(parsed, options);\n    };\n    Snippet.wrapPipes = function (string) {\n        return (\"|\" + string + \"|\").replace(/\\|+/g, '|');\n    };\n    Snippet.formatForDiff = function (snippet) {\n        return Snippet.minify(snippet)\n            .replace(/\\|/g, ' | ').trim();\n    };\n    Snippet.format = function (snippet, linebreaks) {\n        if (linebreaks === void 0) { linebreaks = true; }\n        // replaces url chars back\n        var compact = Snippet.minify(snippet, false);\n        compact = Snippet.wrapPipes(compact);\n        if (linebreaks) {\n            // insert spaces before first chord\n            var bars = compact.split('|').slice(1, -1);\n            bars = bars.map(function (bar, index) {\n                if (!bar[0].match(/[1-9:]/)) {\n                    bar = '  ' + bar;\n                }\n                else if (bar[0] === ':') {\n                    bar = ': ' + bar.slice(1);\n                }\n                return bar;\n            });\n            // find out indices of first houses\n            var houses_1 = bars.reduce(function (offset, bar, index) {\n                if (bar[0] === '1') {\n                    offset.push(index);\n                }\n                return offset;\n            }, []);\n            // insert empty bars before additional houses\n            bars = bars.reduce(function (bars, bar, index) {\n                if (bar[0].match(/[2-9]/)) {\n                    var offset = houses_1.filter(function (h) { return h < index; }).reverse()[0];\n                    bars = bars.concat(new Array(offset % 4).fill(''));\n                }\n                bars.push(bar);\n                return bars;\n            }, []);\n            // find out the maximal number of chars per column\n            var chars_1 = bars.reduce(function (max, bar, index) {\n                max[index % 4] = Math.max(bar.length, max[index % 4] || 0);\n                return max;\n            }, []);\n            // fill up each bar with spaces\n            compact = bars.map(function (bar, index) {\n                var diff = chars_1[index % 4] - bar.length + 2;\n                if (diff > 0) {\n                    bar += new Array(diff).fill(' ').join('');\n                }\n                // move double dots to end of bar\n                bar = bar.replace(/:(\\s+)$/, '$1:');\n                return bar;\n            }).join('|');\n            compact = Snippet.wrapPipes(compact);\n            // break string all 4 bars\n            var pipeIndex_1 = -1;\n            compact = compact.split('').reduce(function (string, char, index) {\n                if (char === '|') {\n                    pipeIndex_1++;\n                }\n                if (char === '|' && pipeIndex_1 % 4 === 0 && index > 0 && index < compact.length - 1) {\n                    char = \"|\\n|\";\n                    pipeIndex_1 = 0;\n                }\n                return string + char;\n            }, '');\n        }\n        else {\n            compact = compact.replace(/\\n/g, '|');\n        }\n        return compact\n            .replace(/\\|+/g, '|')\n            .replace(/\\|( +)\\|( +)/g, ' $1 $2') // remove spacer bar pipes\n            .replace(/\\|( +)\\|([1-9])/g, ' $1|$2')\n            .replace(/^\\s+|\\s+$/g, ''); // remove spaces/line breaks from start/end\n    };\n    Snippet.minify = function (snippet, urlsafe) {\n        if (urlsafe === void 0) { urlsafe = false; }\n        var compact = (\"|\" + snippet + \"|\")\n            .replace(/\\n+/g, '|') // replace line breaks with pipes\n            .replace(/\\s+/g, ' ') // no repeated pipes\n            .replace(/\\s?\\|\\s?/g, '|') // no pipes with spaces\n            .replace(/\\s?\\:\\s?/g, ':') // no repeat with spaces\n            .replace(/\\|+/g, '|'); // no repeated pipes\n        if (urlsafe) {\n            // replaces url unfriendly chars\n            compact = compact\n                .replace(/\\|+/g, 'I')\n                .replace(/\\s+/g, '_')\n                .replace(/:/g, 'R')\n                .replace(/\\^/g, 'M')\n                .replace(/\\#/g, 'S')\n                .replace(/\\%/g, 'X');\n        }\n        else {\n            // replaces url unfriendly chars\n            compact = compact\n                .replace(/\\I+/g, '|')\n                .replace(/\\_+/g, ' ')\n                .replace(/R/g, ':')\n                .replace(/M/g, '^')\n                .replace(/X/g, 'x')\n                .replace(/S/g, '#');\n        }\n        return compact.slice(1, -1);\n    };\n    Snippet.parse = function (snippet, simplify) {\n        if (simplify === void 0) { simplify = true; }\n        var formatted = Snippet.format(snippet, false);\n        return formatted\n            .split('|') // split into measures\n            .map(function (measure) { return measure.split(' '); }) // split measures by spaces\n            .map(function (measure) { return measure.filter(function (chord) { return !!chord; }); }) // kill empty chords\n            .filter(function (measure) { return !measure || measure.length; }) // kill empty measures\n            .map(function (measure) { return ({ symbols: measure, signs: [] }); })\n            // parse symbols to chords and signs\n            .map(function (measure) {\n            // repeat start\n            if (measure.symbols[0][0] === ':') {\n                if (measure.symbols[0].length === 1) {\n                    measure.symbols = measure.symbols.slice(1);\n                }\n                measure.signs.unshift('{');\n            }\n            var last = measure.symbols[measure.symbols.length - 1];\n            // repeat end\n            if (last[last.length - 1] === ':') {\n                if (last.length === 1) {\n                    measure.symbols.pop();\n                }\n                measure.signs.push('}');\n            }\n            measure.symbols = measure.symbols.map(function (s) { return s.replace(/:/g, ''); });\n            var house = measure.symbols.find(function (s) { return s.match(/^[1-9]$/); });\n            if (house) {\n                measure.house = parseInt(house);\n            }\n            measure.symbols = measure.symbols.filter(function (s) { return !s.match(/^[1-9]$/); });\n            // houses\n            measure.chords = [].concat(measure.symbols);\n            delete measure.symbols;\n            return measure;\n        })\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.signs.length === 0) {\n                delete measure.signs;\n            }\n            if (measure.chords.length === 0) {\n                delete measure.chords;\n            }\n            return measure;\n        })\n            // kill empty measures\n            .filter(function (measure) { return Object.keys(measure).length > 0; })\n            // simplify => measures with only chords will be arrays\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.chords && Object.keys(measure).length === 1) {\n                return measure.chords.length === 1 ?\n                    measure.chords[0] : // simplify one chord measures\n                    measure.chords;\n            }\n            return measure;\n        });\n    };\n    Snippet.nest = function (string) {\n        var nested = string.split('.')\n            .map(function (group) { return group.trim(); })\n            .map(function (group) { return group.split(' '); })\n            .map(function (group) { return group.filter(function (chord) { return !!chord; }); }) // kill empty chords\n            .filter(function (group) { return !group || group.length; })\n            .map(function (group) { return group.length === 1 ? group[0] : group; });\n        nested = nested.length === 1 ? nested[0] : nested;\n        return nested;\n    };\n    Snippet.parse2 = function (snippet, simplify) {\n        if (simplify === void 0) { simplify = true; }\n        var formatted = Snippet.format(snippet, false);\n        return formatted\n            .split('|') // split into measures\n            .filter(function (measure) { return measure && measure.length; }) // kill empty measures\n            .map(function (measure) { return ({ symbols: measure.trim(), signs: [] }); })\n            // parse symbols to chords and signs\n            .map(function (measure) {\n            // repeat start\n            if (measure.symbols[0] === ':') {\n                measure.signs.unshift('{');\n            }\n            var last = measure.symbols[measure.symbols.length - 1];\n            // repeat end\n            if (last === ':') {\n                measure.signs.push('}');\n            }\n            measure.symbols = measure.symbols.replace(/:/g, '');\n            /* const house = measure.symbols[0].match(/^[1-9]$/);\n            if (house) {\n                measure.house = parseInt(house);\n                measure.symbols = measure.symbols.slice(1);\n            } */\n            measure.chords = [].concat(Snippet.nest(measure.symbols));\n            delete measure.symbols;\n            return measure;\n        })\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.signs.length === 0) {\n                delete measure.signs;\n            }\n            if (measure.chords.length === 0) {\n                delete measure.chords;\n            }\n            return measure;\n        })\n            // kill empty measures\n            .filter(function (measure) { return Object.keys(measure).length > 0; })\n            // simplify => measures with only chords will be arrays\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.chords && Object.keys(measure).length === 1) {\n                return measure.chords.length === 1 ?\n                    measure.chords[0] : // simplify one chord measures\n                    measure.chords;\n            }\n            return measure;\n        });\n    };\n    Snippet.testFormat = function (sheet) {\n        return sheet.map(function (m) { return Measure_1.Measure.from(m); }).map(function (m) { return m.chords; }).join(' ');\n    };\n    Snippet.from = function (sheet, format) {\n        if (format === void 0) { format = true; }\n        var snippet = sheet\n            .map(function (m) { return Measure_1.Measure.from(m); })\n            .reduce(function (snippet, _a) {\n            var signs = _a.signs, house = _a.house, chords = _a.chords;\n            var repeatStart = signs && signs.includes('{');\n            var repeatEnd = signs && signs.includes('}');\n            return snippet + (\"|\" + (repeatStart ? ':' : '') + (house || '') + \" \" + (chords ? chords.join(' ') : '') + (repeatEnd ? ':' : ''));\n        }, '');\n        if (format) {\n            return Snippet.format(snippet);\n        }\n        return Snippet.minify(snippet);\n    };\n    Snippet.expand = function (snippet, options) {\n        var rendered = Snippet.render(snippet, options);\n        rendered = rendered\n            .map(function (m) { return Measure_1.Measure.from(m); })\n            .map(function (m) {\n            delete m.house;\n            delete m.signs;\n            return m;\n        });\n        var expanded = Snippet.from(rendered);\n        return expanded;\n        /* return from(Sheet.render(render(snippet))); */\n    };\n    Snippet.diff = function (snippetA, snippetB) {\n        var diffFormat = [Snippet.formatForDiff(snippetA), Snippet.formatForDiff(snippetB)];\n        return JsDiff.diffWords(diffFormat[0], diffFormat[1]);\n    };\n    return Snippet;\n}());\nexports.Snippet = Snippet;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"./util\");\nvar tonal_1 = require(\"tonal\");\nvar tonal_2 = require(\"tonal\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar Snippet_1 = require(\"../sheet/Snippet\");\nvar Voicing_1 = require(\"../harmony/Voicing\");\nvar Logger = /** @class */ (function () {\n    function Logger() {\n    }\n    Logger.logCustom = function (args, logFn) {\n        if (logFn === void 0) { logFn = console.log; }\n        /* console.clear(); */\n        logFn.apply(console, args);\n    };\n    Logger.logLegend = function () {\n        if (console.groupCollapsed) {\n            console.groupCollapsed('Show Emoji Legend');\n            console.table(Logger.emoji);\n            console.groupEnd();\n        }\n        else {\n            console.log('Emoji Legend:', Logger.emoji);\n        }\n    };\n    Logger.logSheet = function (sheet) {\n        sheet = __assign({ title: 'Untitled', composer: 'Unkown', chords: [], forms: 3, tempo: 130, style: 'Swing' }, sheet);\n        var snippet = Snippet_1.Snippet.from(sheet.chords);\n        console.log(sheet.composer + \" - \" + sheet.title);\n        console.log(sheet.tempo + \"bpm, Style: \" + sheet.style);\n        console.log(snippet);\n        if (console.groupCollapsed) {\n            console.log('Sheet', sheet);\n            /* console.log('Groove', sheet.groove); */\n            console.groupCollapsed(\"show \" + sheet.forms + \" rendered forms\");\n            console.log(\"expanded view\\n\\n\" + Snippet_1.Snippet.expand(snippet, { forms: sheet.forms || 1 }));\n            console.groupEnd();\n        }\n    };\n    Logger.logLabel = function (key) {\n        if (!Logger.emoji[key]) {\n            return key;\n        }\n        return Logger.emoji[key].icon + ' ' + key;\n    };\n    Logger.logChoice = function (choice) {\n        var _a;\n        if (!choice) {\n            return;\n        }\n        var difference = choice.difference, origin = choice.origin, targets = choice.targets, from = choice.from, to = choice.to, movement = choice.movement, similar = choice.similar, added = choice.added, dropped = choice.dropped, contrary = choice.contrary, parallel = choice.parallel, topInterval = choice.topInterval, bottomInterval = choice.bottomInterval, topNotes = choice.topNotes, bottomNotes = choice.bottomNotes, intervals = choice.intervals, degrees = choice.degrees;\n        console.table((_a = {\n                difference: difference,\n                movement: movement,\n                origin: origin.join(' '),\n                dropped: dropped.join(' '),\n                added: added.join(' '),\n                targets: targets.join(' '),\n                /* from: from.join(' '),\n                to: to.join(' '), */\n                intervals: intervals.join(' '),\n                degrees: degrees.join(' ')\n            },\n            _a[Logger.logLabel('similar')] = similar,\n            _a[Logger.logLabel('contrary')] = contrary,\n            _a[Logger.logLabel('parallel')] = parallel,\n            _a.topNotes = topNotes.join(' '),\n            _a.topInterval = topInterval,\n            _a.bottomNotes = bottomNotes.join(' '),\n            _a.bottomInterval = bottomInterval,\n            _a));\n    };\n    Logger.logNotes = function (activeNotes, idleNotes, addedNotes, range) {\n        var span = [\n            tonal_1.Distance.transpose(range[0], tonal_2.Interval.fromSemitones(-7)),\n            tonal_1.Distance.transpose(range[1], tonal_2.Interval.fromSemitones(12))\n        ];\n        var allNotes = util_1.noteArray(span);\n        var keyboard = allNotes.map(function (note, index) {\n            var active = !!activeNotes.find(function (n) { return Harmony_1.Harmony.isSameNote(note, n); });\n            var idle = !!idleNotes.find(function (n) { return Harmony_1.Harmony.isSameNote(note, n); });\n            var added = !!addedNotes.find(function (n) { return Harmony_1.Harmony.isSameNote(note, n); });\n            var black = Harmony_1.Harmony.isBlack(note);\n            var css = '', sign = '_';\n            if (added && !black) {\n                css = 'color:green;';\n                sign = '';\n            }\n            else if (added && black) {\n                css = 'color:darkgreen;';\n                sign = '';\n            }\n            else if (active && black) {\n                css = 'color:#a50909;';\n                sign = '';\n            }\n            else if (active && !black) {\n                css = 'color:#eda3a3;';\n                sign = '';\n            }\n            else if (idle && !black) {\n                css = 'color:gray;';\n                sign = '';\n            }\n            else if (idle && black) {\n                css = 'color:black;';\n                sign = '';\n            }\n            else {\n                css = black ? 'color:black;' : 'color:#eee;';\n            }\n            var position = util_1.getRangePosition(note, range);\n            if (position < 0 || position > 1) {\n                if (active || idle || added) {\n                    css += 'color:red;';\n                }\n                else {\n                    sign = ' ';\n                }\n            }\n            return {\n                sign: sign,\n                css: css\n            };\n        });\n        var args = [\n            keyboard.map(function (key) { return \"%c\" + key.sign; }).join('')\n        ].concat((keyboard.map(function (key) { return key.css + \";\"; })));\n        /* Snippet.logCustom(args); */\n        return args;\n    };\n    Logger.logVoicing = function (_a) {\n        var chord = _a.chord, previousVoicing = _a.previousVoicing, combinations = _a.combinations, bestPick = _a.bestPick, pick = _a.pick, range = _a.range, choice = _a.choice, direction = _a.direction, choices = _a.choices;\n        /* pick = pick.map(n => Note.simplify(n)); */\n        pick = pick || [];\n        previousVoicing = previousVoicing || [];\n        var idle = previousVoicing.filter(function (n) { return pick.find(function (p) { return Harmony_1.Harmony.isSameNote(n, p); }); });\n        var active = pick.filter(function (n) { return !previousVoicing.find(function (p) { return Harmony_1.Harmony.isSameNote(n, p); }); });\n        var added = choice ? choice.added : [];\n        var konsole = Logger.logNotes(active, idle, added, range);\n        var movement = choice ? choice.movement : 0;\n        var difference = choice ? choice.difference : 0;\n        choices = choices || [];\n        if (movement > 0) {\n            konsole.push(Logger.emoji.movedUp.icon);\n        }\n        else if (movement < 0) {\n            konsole.push(Logger.emoji.movedDown.icon);\n        }\n        else {\n            konsole.push(Logger.emoji.equilibrium.icon);\n        }\n        if (!pick.length) {\n            konsole.push(Logger.emoji.error.icon);\n        }\n        // TODO replace force with filter of choices after isInRange\n        //      isInRange: checks if top and bottom note are inside the range\n        if (!direction) {\n            konsole.push(Logger.emoji.bestMatch.icon);\n        }\n        else {\n            if (bestPick !== pick) {\n                konsole.push(Logger.emoji.force.icon);\n            }\n            else {\n                konsole.push(Logger.emoji.lucky.icon);\n            }\n            // wrong direction?\n            if ((direction === 'up' && movement < 0) || (direction === 'down' && movement > 0)) {\n                konsole.push(Logger.emoji.wrong.icon);\n            }\n        }\n        if (choice) {\n            if (choice.similar) {\n                konsole.push(Logger.emoji.similar.icon);\n            }\n            if (choice.contrary) {\n                konsole.push(Logger.emoji.contrary.icon);\n            }\n            if (choice.parallel) {\n                konsole.push(Logger.emoji.parallel.icon);\n            }\n            if (choice.added.length && choice.added[choice.added.length - 1] === choice.topNotes[1]) {\n                konsole.push(Logger.emoji.topAdded.icon);\n            }\n            if (choice.dropped.length && choice.dropped[choice.dropped.length - 1] === choice.topNotes[0]) {\n                konsole.push(Logger.emoji.topRemoved.icon);\n            }\n            if (choice.dropped.length && choice.dropped[0] === choice.origin[0]) {\n                konsole.push(Logger.emoji.bottomRemoved.icon);\n            }\n            if (choice.added.length && choice.added[0] === choice.targets[0]) {\n                konsole.push(Logger.emoji.bottomAdded.icon);\n            }\n            if (!Voicing_1.Voicing.hasTonic(pick, chord)) {\n                konsole.push(Logger.emoji.rootless.icon);\n            }\n            if (!choice.parallel && choice.oblique.length === 0) {\n                konsole.push(Logger.emoji.noOblique.icon);\n            }\n            if (choice.oblique.length === choice.targets.length) {\n                konsole.push(Logger.emoji.noChange.icon);\n            }\n        }\n        previousVoicing = previousVoicing || [];\n        konsole.push(difference + \"/\" + movement + \": \" + chord + \" (\" + (choices.indexOf(choice) + 1) + \"/\" + choices.length + \")\");\n        if (combinations) {\n            if (combinations.length < 4) {\n                konsole.push(Logger.emoji.fewCombinations.icon);\n            }\n        }\n        if (console && console.table) {\n            Logger.logCustom(konsole, console.groupCollapsed);\n            console.table({\n                previousVoicing: previousVoicing.join(' '),\n                pick: pick.join(' '),\n            });\n            if (choice) {\n                console.group('Choice:');\n                Logger.logChoice(choice);\n                console.groupEnd();\n                console.groupCollapsed('All Choices:');\n                choices.forEach(function (c) { return Logger.logChoice(c); });\n                console.groupEnd();\n                console.groupCollapsed('Combinations:');\n                console.log(combinations);\n                console.groupEnd();\n            }\n            console.groupEnd();\n        }\n        //console.log(`${ Snippet.voicing(voicing, ['G2', 'C5']) } ${ chord }: ${ voicing.join(' ') } `);\n        //console.log(`#${ event.path[1] + 1 }: ${ chord }: ${ latest } > ${ voicing }.moved ${ moves } (avg | ${ avgDiff } | total ${ totalMoves })`);\n        // console.log(chord, voicing);\n        // G#o7 2 (5.25) (4)[\"G3\", \"D4\", \"F4\", \"Bb4\"] > (4)[\"B2\", \"D3\", \"E#3\", \"G#3\"]\n        /* } */\n        return pick;\n    };\n    Logger.emoji = {\n        bestMatch: {\n            icon: '',\n            description: 'The selected voicing had the best possible voice leading from the previous voicing'\n        },\n        force: {\n            icon: '',\n            description: 'Voicing had to be forced in the desired direction. The best pick would have gone in the wrong direction.'\n        },\n        lucky: {\n            icon: '',\n            description: 'The best pick moved in the direction that would have been forced.'\n        },\n        wrong: {\n            icon: '',\n            description: 'Continued moving in the wrong direction'\n        },\n        similar: {\n            icon: '',\n            description: 'All voices are moving in the same direction'\n        },\n        parallel: {\n            icon: '',\n            description: 'All voices are moving by parallel intervals'\n        },\n        contrary: {\n            icon: '',\n            description: 'Some voices were moving in opposite directions'\n        },\n        noOblique: {\n            icon: '',\n            description: 'All voices changed position. (Not shown when parallel)'\n        },\n        noChange: {\n            icon: '',\n            description: 'All voices remained in position.'\n        },\n        topAdded: {\n            icon: '',\n            description: 'A top voice was added',\n        },\n        topRemoved: {\n            icon: '',\n            description: 'A top voice was dropped'\n        },\n        bottomRemoved: {\n            icon: '',\n            description: 'A bottom voice was dropped'\n        },\n        bottomAdded: {\n            icon: '',\n            description: 'A bottom note was added'\n        },\n        movedUp: {\n            icon: '',\n            description: 'The Voices generally moved up'\n        },\n        movedDown: {\n            icon: '',\n            description: 'The Voices generally moved down'\n        },\n        equilibrium: {\n            icon: '',\n            description: 'The Voices generally did not move anywhere'\n        },\n        fewCombinations: {\n            icon: '',\n            description: 'There were very few valid combinations to choose from'\n        },\n        error: {\n            icon: '',\n            description: 'No notes could be selected. Some error happened.'\n        },\n        rootless: {\n            icon: '',\n            description: 'The voicing does not contain its root note (tonic).'\n        }\n        // \n    };\n    return Logger;\n}());\nexports.Logger = Logger;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Permutation_1 = require(\"../util/Permutation\");\nvar Logger_1 = require(\"../util/Logger\");\nvar tonal_1 = require(\"tonal\");\nvar tonal_2 = require(\"tonal\");\nvar tonal_3 = require(\"tonal\");\nvar tonal_4 = require(\"tonal\");\nvar util_1 = require(\"../util/util\");\nvar Harmony_1 = require(\"./Harmony\");\nvar Voicing = /** @class */ (function () {\n    function Voicing() {\n    }\n    /** Returns the next voicing that should follow the previously played voicing.\n    */\n    Voicing.getNextVoicing = function (chord, previousVoicing, options) {\n        if (options === void 0) { options = {}; }\n        var _a = __assign({ range: ['C3', 'C5'], rangeBorders: [3, 3], maxVoices: 4, forceDirection: null, maxDistance: 7, minBottomDistance: 3, minTopDistance: 2, noTopDrop: true, noTopAdd: true, noBottomDrop: false, noBottomAdd: false, logging: true }, options), maxVoices = _a.maxVoices, range = _a.range, forceDirection = _a.forceDirection, rangeBorders = _a.rangeBorders, sortChoices = _a.sortChoices, filterChoices = _a.filterChoices, noTopDrop = _a.noTopDrop, noTopAdd = _a.noTopAdd, noBottomDrop = _a.noBottomDrop, noBottomAdd = _a.noBottomAdd, logging = _a.logging;\n        // make sure tonal can read the chord\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        if (chord === 'r') {\n            return null;\n        }\n        var combinations = Voicing.getAllVoicePermutations(chord, maxVoices, options);\n        var exit = function () {\n            var pick = [];\n            if (logging) {\n                Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick });\n            }\n            return pick;\n        };\n        if (!combinations.length) {\n            return exit();\n        }\n        if (!previousVoicing || !previousVoicing.length) { // no previous chord\n            // filter out combinations that are out of range\n            combinations = combinations.filter(function (combination) {\n                var firstNote = Harmony_1.Harmony.getNearestNote(range[0], combination[0], 'up');\n                var pick = util_1.renderAbsoluteNotes(combination, tonal_2.Note.oct(firstNote));\n                return util_1.isInRange(pick[0], range) && util_1.isInRange(pick[pick.length - 1], range);\n            });\n            var firstPick = combinations[0];\n            var firstNoteInRange = Harmony_1.Harmony.getNearestNote(range[0], firstPick[0], 'up');\n            var pick_1 = util_1.renderAbsoluteNotes(firstPick, tonal_2.Note.oct(firstNoteInRange));\n            if (logging) {\n                Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick_1 });\n            }\n            return pick_1;\n        }\n        var choices = Voicing.getAllChoices(combinations, previousVoicing, range)\n            .filter(function (choice) {\n            return (!noTopDrop || !choice.dropped.includes(choice.topNotes[0])) &&\n                (!noTopAdd || !choice.added.includes(choice.topNotes[1])) &&\n                (!noBottomDrop || !choice.dropped.includes(choice.topNotes[0])) &&\n                (!noBottomAdd || !choice.added.includes(choice.topNotes[1])) &&\n                (!filterChoices || filterChoices(choice));\n        })\n            .sort(sortChoices ?\n            function (a, b) { return sortChoices(a, b); } :\n            function (a, b) { return a.difference - b.difference; });\n        if (!choices.length) {\n            return exit();\n        }\n        var bestPick = choices[0].targets, choice;\n        var direction = Voicing.getDesiredDirection(previousVoicing, range, rangeBorders) || forceDirection;\n        if (!direction) {\n            var pick_2 = bestPick;\n            choice = choices[0];\n            if (logging) {\n                Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick_2, direction: direction, bestPick: bestPick, choice: choice, choices: choices });\n            }\n            return pick_2;\n        }\n        // sort after movement instead of difference\n        choice = choices.sort(function (a, b) {\n            return Math.abs(a.movement) - Math.abs(b.movement);\n        }).find(function (choice) {\n            if (direction === 'up') {\n                return choice.movement >= 0;\n            }\n            return choice.movement <= 0;\n        });\n        if (!choice) { // keep hanging in the corner of the range..\n            choice = choices[0];\n        }\n        var pick = choice.targets;\n        if (logging) {\n            Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick, direction: direction, bestPick: bestPick, choice: choice, choices: choices });\n        }\n        return pick;\n    };\n    /** Computes all valid voice permutations for a given chord and voice number.\n     * Runs getVoicePermutations for each possible selection of notes.\n     */\n    Voicing.getAllVoicePermutations = function (chord, length, voicingOptions) {\n        return Voicing.getAllNoteSelections(chord, length)\n            .reduce(function (combinations, combination) {\n            return combinations.concat(Voicing.getVoicePermutations(combination, voicingOptions));\n        }, []);\n    };\n    /** Get all permutations of the given notes that would make a good voicing. */\n    Voicing.getVoicePermutations = function (notes, options) {\n        if (options === void 0) { options = {}; }\n        if (notes.length === 1) {\n            return [notes];\n        }\n        var validator = options.validatePermutation || (function (path, next, array) { return true; });\n        return Permutation_1.Permutation.permutateElements(notes, Permutation_1.Permutation.combineValidators(validator, Voicing.voicingValidator(options)));\n    };\n    /** Configurable Validator that sorts out note combinations with untasty intervals.  */\n    Voicing.voicingValidator = function (options) {\n        options = __assign({ maxDistance: 6, minDistance: 1, minBottomDistance: 3, minTopDistance: 2 }, options);\n        return function (path, next, array) {\n            return Permutation_1.Permutation.combineValidators(Voicing.notesAtPositionValidator(options.topNotes, path.length + array.length - 1), Voicing.notesAtPositionValidator(options.bottomNotes, 0), Voicing.validateInterval(function (interval) { return tonal_4.Interval.semitones(interval) <= options.maxDistance; }), Voicing.validateInterval(function (interval) { return tonal_4.Interval.semitones(interval) >= options.minDistance; }), Voicing.validateInterval(function (interval, _a) {\n                var array = _a.array;\n                return array.length !== 1 || tonal_4.Interval.semitones(interval) >= options.minTopDistance;\n            }), Voicing.validateInterval(function (interval, _a) {\n                var path = _a.path;\n                return path.length !== 1 || tonal_4.Interval.semitones(interval) >= options.minBottomDistance;\n            }))(path, next, array);\n        };\n    };\n    /** Validates the interval to the next note. You can write your own logic inside the validate fn. */\n    Voicing.validateInterval = function (validate) {\n        return function (path, next, array) {\n            if (!path.length) {\n                return true;\n            }\n            var interval = tonal_3.Distance.interval(path[path.length - 1], next);\n            return validate(interval, { path: path, next: next, array: array });\n        };\n    };\n    /** Returns all possible combinations of required and optional notes for a given chord and desired length.\n     * If the voices number is higher than the required notes of the chord, the rest number will be permutated from the optional notes */\n    Voicing.getAllNoteSelections = function (chord, voices) {\n        if (voices === void 0) { voices = 2; }\n        var required = Voicing.getRequiredNotes(chord);\n        if (voices === 1) {\n            return required.map(function (note) { return [note]; });\n        }\n        var fill = voices - required.length;\n        if (fill === 0) {\n            return [required];\n        }\n        if (fill < 0) { // required notes are enough\n            return Permutation_1.Permutation.binomial(required, voices);\n        }\n        var optional = Voicing.getOptionalNotes(chord, required);\n        if (fill >= optional.length) {\n            return [required.concat(optional)];\n        }\n        return Permutation_1.Permutation.binomial(optional, fill)\n            .map(function (selection) { return required.concat(selection); });\n    };\n    /** Get available tensions for a given chord. Omits tensions that kill the chord quality */\n    Voicing.getAvailableTensions = function (chord) {\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        var notes = tonal_1.Chord.notes(chord);\n        if (util_1.isDominantChord(chord)) {\n            return Voicing.getAllTensions(notes[0])\n                // filter out tensions that are part of the chord\n                .filter(function (note) { return !notes.find(function (n) { return util_1.semitoneDistance(notes[0], note) === util_1.semitoneDistance(notes[0], n); }); })\n                // filter out tensions that are a semitone above the 3 (if exists)\n                .filter(function (note) { return util_1.chordHasIntervals(chord, ['3!']) || util_1.semitoneDistance(util_1.getDegreeInChord(3, chord), note) > 1; })\n                // filter out tensions that are a semitone above the 4 (if exists => sus)\n                .filter(function (note) { return !util_1.chordHasIntervals(chord, ['4P']) || util_1.semitoneDistance(util_1.getDegreeInChord(4, chord), note) > 1; })\n                // filter out tensions that are a semitone above the 7\n                .filter(function (note) { return util_1.semitoneDistance(util_1.getDegreeInChord(7, chord), note) > 1; });\n        }\n        return notes.slice(0, 4)\n            // notes less than 3 semitones away from root are omitted (tensions 2M above would be in next octave)\n            .filter(function (note) { return note === notes[0] || util_1.semitoneDistance(note, notes[0]) > 2; })\n            // all tensions are a major second above a chord note\n            .map(function (note) { return tonal_3.Distance.transpose(note, '2M'); })\n            // tensions 2 semiontes below root are flat 7 => changes chord quality\n            .filter(function (note) { return util_1.semitoneDistance(note, notes[0]) !== 2; });\n        // omit tensions that end up on a chord note again?\n    };\n    /** Returns all Tensions that could be in any chord */\n    Voicing.getAllTensions = function (root) {\n        return ['b9', '9', '#9', '3', '11', '#11', 'b13', '13', '7']\n            .map(function (step) { return util_1.getIntervalFromStep(step); })\n            .map(function (interval) { return tonal_3.Distance.transpose(root, interval); });\n    };\n    /** Returns all notes that are required to outline a chord */\n    Voicing.getRequiredNotes = function (chord) {\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        var notes = tonal_1.Chord.notes(chord);\n        var intervals = tonal_1.Chord.intervals(chord);\n        var requiredSteps = [3, 7, 'b5', 6]; // order is important\n        if (!util_1.hasDegree(3, intervals)) {\n            requiredSteps.push(4); // fixes m6 chords\n        }\n        var required = requiredSteps.reduce(function (req, degree) {\n            if (util_1.hasDegree(degree, intervals)) {\n                req.push(util_1.getDegreeInChord(degree, chord));\n            }\n            return req;\n        }, []);\n        // WHY 3??\n        if (notes.length > 3 && !required.includes(notes[notes.length - 1])) {\n            required.push(notes[notes.length - 1]); // could check if is 5 than dont push\n        }\n        return required;\n    };\n    /** Returns all notes that are not required */\n    Voicing.getOptionalNotes = function (chord, required) {\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        var notes = tonal_1.Chord.notes(chord);\n        required = required || Voicing.getRequiredNotes(chord);\n        return notes.filter(function (note) { return !required.includes(note); });\n    };\n    /** Returns all possible note choices for the given combinations.\n     * Takes the bottom note of the previous voicing and computes the minimal intervals up and down to the next bottom note.\n     */\n    Voicing.getAllChoices = function (combinations, previousVoicing, range) {\n        var lastPitches = previousVoicing.map(function (note) { return tonal_2.Note.pc(note); });\n        return combinations\n            .map(function (combination) {\n            var bottomInterval = tonal_3.Distance.interval(lastPitches[0], combination[0]);\n            var bottomNotes = [\n                tonal_3.Distance.transpose(previousVoicing[0], Harmony_1.Harmony.minInterval(bottomInterval, 'down')),\n                tonal_3.Distance.transpose(previousVoicing[0], Harmony_1.Harmony.minInterval(bottomInterval, 'up')),\n            ];\n            if (bottomNotes[0] === bottomNotes[1]) {\n                bottomNotes = [bottomNotes[0]];\n            }\n            return { combination: combination, bottomNotes: bottomNotes };\n        })\n            .reduce(function (all, _a) {\n            var combination = _a.combination, bottomNotes = _a.bottomNotes;\n            return all.concat(bottomNotes.map(function (bottomNote) { return util_1.renderAbsoluteNotes(combination, tonal_2.Note.oct(bottomNote)); }));\n        }, [])\n            .filter(function (targets) {\n            return !range ||\n                util_1.isInRange(targets[0], range) &&\n                    util_1.isInRange(targets[targets.length - 1], range);\n        })\n            .reduce(function (all, targets) {\n            var leads = Voicing.voiceLeading(previousVoicing, targets);\n            return all.concat(leads);\n        }, []);\n    };\n    /** Analyzes all possible voice movements for all possible transitions. Handles inequal lengths */\n    Voicing.voiceLeading = function (origin, targets) {\n        // if same length > dont permutate\n        if (origin.length === targets.length) {\n            return Voicing.analyzeVoiceLeading(origin, targets);\n        }\n        var _a = [origin, targets].sort(function (a, b) { return b.length - a.length; }), more = _a[0], less = _a[1];\n        return Permutation_1.Permutation.binomial(more, less.length)\n            .map(function (selection) {\n            var _a, _b;\n            var from, to;\n            if (origin.length < targets.length) {\n                _a = [origin, selection], from = _a[0], to = _a[1];\n            }\n            else {\n                _b = [selection, targets], from = _b[0], to = _b[1];\n            }\n            return Voicing.analyzeVoiceLeading(from, to, origin, targets);\n        });\n    };\n    /** Analyzed the voice leading for the movement from > to.\n     * Origin and targets needs to be passed if the voice transition over unequal lengths\n     */\n    Voicing.analyzeVoiceLeading = function (from, to, origin, targets) {\n        var _a;\n        _a = [origin || from, targets || to], origin = _a[0], targets = _a[1];\n        var intervals = Voicing.voicingIntervals(from, to, false)\n            .map(function (interval) { return Harmony_1.Harmony.fixInterval(interval, false); });\n        /** Interval qualities */\n        var degrees = intervals.map(function (i) { return util_1.getDegreeFromInterval(i); });\n        /** Voices that did not move */\n        var oblique = from.filter(function (n, i) { return to.find(function (note) { return Harmony_1.Harmony.isSameNote(n, note); }); });\n        /** abs sum of semitones movements of voices */\n        var difference = util_1.semitoneDifference(intervals);\n        /** relative sum of semitone movements */\n        var movement = util_1.semitoneMovement(intervals);\n        /** voice differences did not cancel each other out > moved in same direction */\n        var similar = Math.abs(movement) === Math.abs(difference);\n        /** moves parallel if all interval qualities the same and in the same direction */\n        var parallel = difference > 0 && similar && degrees.reduce(function (match, degree, index) {\n            return match && (index === 0 || degrees[index - 1] === degree);\n        }, true);\n        // find out which notes have been dropped / added\n        var dropped = [], added = [];\n        if (origin.length < targets.length) {\n            added = targets.filter(function (n) { return !to.includes(n); });\n        }\n        else {\n            dropped = origin.filter(function (n) { return !from.includes(n); });\n        }\n        return {\n            from: from,\n            to: to,\n            origin: origin,\n            targets: targets,\n            intervals: intervals,\n            difference: difference,\n            movement: movement,\n            bottomInterval: intervals[0],\n            topInterval: intervals[intervals.length - 1],\n            topNotes: [origin[origin.length - 1], targets[targets.length - 1]],\n            bottomNotes: [origin[0], targets[0]],\n            similar: similar,\n            contrary: !similar,\n            parallel: parallel,\n            oblique: oblique,\n            degrees: degrees,\n            added: added,\n            dropped: dropped,\n        };\n    };\n    /** Returns true if the given note is contained in the given voicing. */\n    Voicing.containsNote = function (note, voicing, enharmonic) {\n        if (enharmonic === void 0) { enharmonic = true; }\n        if (!enharmonic) {\n            return voicing.includes(note);\n        }\n        return !!voicing.find(function (n) { return Harmony_1.Harmony.isSameNote(note, n); });\n    };\n    /** Returns the intervals between the given chord voicings.\n     * Can be passed pitch classes or absolute notes.\n     * The two voicings should have the same length. */\n    Voicing.voicingIntervals = function (chordA, chordB, min, direction) {\n        if (min === void 0) { min = true; }\n        if (chordA.length !== chordB.length) {\n            // console.log('voicingIntervals: not the same length..');\n        }\n        var intervals = chordA.map(function (n, i) {\n            var interval = tonal_3.Distance.interval(n, chordB[i]);\n            if (min === false) {\n                return interval;\n            }\n            if (util_1.isPitchClass(n) && util_1.isPitchClass(chordB[i])) {\n                return Harmony_1.Harmony.minInterval(interval, direction);\n            }\n            return interval;\n        });\n        return intervals;\n    };\n    /** Validates the current permutation to have a note at a certain position (array index) */\n    Voicing.notesAtPositionValidator = function (notes, position) {\n        if (notes === void 0) { notes = []; }\n        return function (selected, note, remaining) {\n            return !notes.length || selected.length !== position || notes.includes(note);\n        };\n    };\n    /** Returns true if the given voicing contains its root */\n    Voicing.hasTonic = function (voicing, chord) {\n        var tokens = tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord));\n        return voicing.map(function (n) { return tonal_2.Note.pc(n); }).includes(tokens[0]);\n    };\n    /** Returns the best direction to move for a given voicing in a range.\n     * Outputs a direction as soon as the semitone distance of one of the outer notes is below the given threshold\n     */\n    Voicing.getDesiredDirection = function (voicing, range, thresholds) {\n        if (thresholds === void 0) { thresholds = [3, 3]; }\n        var distances = util_1.getDistancesToRangeEnds([voicing[0], voicing[voicing.length - 1]], range);\n        if (distances[0] < thresholds[0] && distances[1] < thresholds[1]) {\n            console.error('range is too small to fit the comfy zone');\n            return;\n        }\n        if (distances[0] < thresholds[0]) {\n            return 'up';\n        }\n        if (distances[1] < thresholds[1]) {\n            return 'down';\n        }\n    };\n    return Voicing;\n}());\nexports.Voicing = Voicing;\n/**\n *\n\n\n\n    static getPossibleVoicings(chord, voices = 4) {\n        const required = getRequiredNotes(chord);\n        const optional = getOptionalNotes(chord);\n        const tensions = getAvailableTensions(chord);\n        return { required, optional, tensions };\n    }\n    static voicingDifference(chordA, chordB, min = true) {\n        return semitoneDifference(Voicing.voicingIntervals(chordA, chordB, min));\n    }\n\n    static voicingMovement(chordA, chordB, min = true, direction?: intervalDirection) {\n        return semitoneMovement(Voicing.voicingIntervals(chordA, chordB, min, direction));\n    }\n\n    static bestVoiceLeading(chordA, chordB, sortFn?) {\n        sortFn = sortFn || ((a, b) => a.difference - b.difference);\n        const voices = Voicing.voiceLeading(chordA, chordB)\n            .sort((best, current) => {\n                return sortFn(best, current);\n            }, null);\n        return voices[0];\n    }\n\n    static minVoiceMovement(chordA, chordB) {\n        [chordA, chordB] = [chordA, chordB].sort((a, b) => b.length - a.length);\n        const picks = Permutation.binomial(chordA, chordB.length);\n        return picks.reduce((min, current) => {\n            const diff = Voicing.voicingMovement(current, chordB, false);\n            if (Math.abs(diff) < Math.abs(min)) {\n                return diff;\n            }\n            return min;\n        }, 100);\n    }\n\n    static getVoices(chord, voices = 4, rootless = false, tension = 1) {\n        // THE PROBLEM: TENSION MUST BE CHOSEN WHEN SELECTING THE OPTIMAL VOICING!\n        chord = Harmony.getTonalChord(chord);\n        const tokens = Chord.tokenize(chord);\n        const required = Voicing.getRequiredNotes(chord);\n        let optional = Voicing.getOptionalNotes(chord, required);\n        let choices = [].concat(required);\n        const remaining = () => voices - choices.length;\n        if (tension > 0) {\n            choices = choices.concat(Voicing.getAvailableTensions(chord).slice(0, tension));\n        }\n        if (remaining() > 0) {\n            choices = choices.concat(optional);\n        }\n        if (remaining() < 0 && rootless) {\n            choices = choices.filter(n => n !== tokens[0]);\n        }\n        if (remaining() > 0) {\n            // console.warn(`${remaining} notes must be doubled!!!`);\n            choices = choices.concat(required, optional).slice(0, voices);\n        }\n        return choices.slice(0, voices);\n    }\n */ \n","\nimport k from './drummer/kick.wav';\nimport s from './drummer/snare.wav';\nimport h from './drummer/hihat.wav';\nimport r from './drummer/ride.wav';\nimport c from './drummer/crash.wav';\nimport rs from './drummer/rimshot.wav';\n\nexport const kick = k;\nexport const snare = s;\nexport const hihat = h;\nexport const ride = r;\nexport const crash = c;\nexport const rimshot = rs;\nexport const drumset = [kick, snare, hihat, ride, crash, rimshot];\nexport const drumSamples = { 'C1': kick, 'C2': snare, 'C3': hihat, 'C4': ride, 'C5': crash, 'C6': rimshot };","import C1 from \"./piano/C1.mp3\";\nimport Db1 from \"./piano/Db1.mp3\";\nimport D1 from \"./piano/D1.mp3\";\nimport Eb1 from \"./piano/Eb1.mp3\";\nimport E1 from \"./piano/E1.mp3\";\nimport F1 from \"./piano/F1.mp3\";\nimport Gb1 from \"./piano/Gb1.mp3\";\nimport G1 from \"./piano/G1.mp3\";\nimport Ab1 from \"./piano/Ab1.mp3\";\nimport A1 from \"./piano/A1.mp3\";\nimport Bb1 from \"./piano/Bb1.mp3\";\nimport B1 from \"./piano/B1.mp3\";\nimport C2 from \"./piano/C2.mp3\";\nimport Db2 from \"./piano/Db2.mp3\";\nimport D2 from \"./piano/D2.mp3\";\nimport Eb2 from \"./piano/Eb2.mp3\";\nimport E2 from \"./piano/E2.mp3\";\nimport F2 from \"./piano/F2.mp3\";\nimport Gb2 from \"./piano/Gb2.mp3\";\nimport G2 from \"./piano/G2.mp3\";\nimport Ab2 from \"./piano/Ab2.mp3\";\nimport A2 from \"./piano/A2.mp3\";\nimport Bb2 from \"./piano/Bb2.mp3\";\nimport B2 from \"./piano/B2.mp3\";\nimport C3 from \"./piano/C3.mp3\";\nimport Db3 from \"./piano/Db3.mp3\";\nimport D3 from \"./piano/D3.mp3\";\nimport Eb3 from \"./piano/Eb3.mp3\";\nimport E3 from \"./piano/E3.mp3\";\nimport F3 from \"./piano/F3.mp3\";\nimport Gb3 from \"./piano/Gb3.mp3\";\nimport G3 from \"./piano/G3.mp3\";\nimport Ab3 from \"./piano/Ab3.mp3\";\nimport A3 from \"./piano/A3.mp3\";\nimport Bb3 from \"./piano/Bb3.mp3\";\nimport B3 from \"./piano/B3.mp3\";\nimport C4 from \"./piano/C4.mp3\";\nimport Db4 from \"./piano/Db4.mp3\";\nimport D4 from \"./piano/D4.mp3\";\nimport Eb4 from \"./piano/Eb4.mp3\";\nimport E4 from \"./piano/E4.mp3\";\nimport F4 from \"./piano/F4.mp3\";\nimport Gb4 from \"./piano/Gb4.mp3\";\nimport G4 from \"./piano/G4.mp3\";\nimport Ab4 from \"./piano/Ab4.mp3\";\nimport A4 from \"./piano/A4.mp3\";\nimport Bb4 from \"./piano/Bb4.mp3\";\nimport B4 from \"./piano/B4.mp3\";\nimport C5 from \"./piano/C5.mp3\";\nimport Db5 from \"./piano/Db5.mp3\";\nimport D5 from \"./piano/D5.mp3\";\nimport Eb5 from \"./piano/Eb5.mp3\";\nimport E5 from \"./piano/E5.mp3\";\nimport F5 from \"./piano/F5.mp3\";\nimport Gb5 from \"./piano/Gb5.mp3\";\nimport G5 from \"./piano/G5.mp3\";\nimport Ab5 from \"./piano/Ab5.mp3\";\nimport A5 from \"./piano/A5.mp3\";\nimport Bb5 from \"./piano/Bb5.mp3\";\nimport B5 from \"./piano/B5.mp3\";\nimport C6 from \"./piano/C6.mp3\";\nimport Db6 from \"./piano/Db6.mp3\";\nimport D6 from \"./piano/D6.mp3\";\nimport Eb6 from \"./piano/Eb6.mp3\";\nimport E6 from \"./piano/E6.mp3\";\nimport F6 from \"./piano/F6.mp3\";\nimport Gb6 from \"./piano/Gb6.mp3\";\nimport G6 from \"./piano/G6.mp3\";\nimport Ab6 from \"./piano/Ab6.mp3\";\nimport A6 from \"./piano/A6.mp3\";\nimport Bb6 from \"./piano/Bb6.mp3\";\nimport B6 from \"./piano/B6.mp3\";\nimport C7 from \"./piano/C7.mp3\";\nimport Db7 from \"./piano/Db7.mp3\";\nimport D7 from \"./piano/D7.mp3\";\nimport Eb7 from \"./piano/Eb7.mp3\";\nimport E7 from \"./piano/E7.mp3\";\nimport F7 from \"./piano/F7.mp3\";\nimport Gb7 from \"./piano/Gb7.mp3\";\nimport G7 from \"./piano/G7.mp3\";\nimport Ab7 from \"./piano/Ab7.mp3\";\nimport A7 from \"./piano/A7.mp3\";\nimport Bb7 from \"./piano/Bb7.mp3\";\nimport B7 from \"./piano/B7.mp3\";\n\nexport const piano = [\n    C1,\n    Db1,\n    D1,\n    Eb1,\n    E1,\n    F1,\n    Gb1,\n    G1,\n    Ab1,\n    A1,\n    Bb1,\n    B1,\n    C2,\n    Db2,\n    D2,\n    Eb2,\n    E2,\n    F2,\n    Gb2,\n    G2,\n    Ab2,\n    A2,\n    Bb2,\n    B2,\n    C3,\n    Db3,\n    D3,\n    Eb3,\n    E3,\n    F3,\n    Gb3,\n    G3,\n    Ab3,\n    A3,\n    Bb3,\n    B3,\n    C4,\n    Db4,\n    D4,\n    Eb4,\n    E4,\n    F4,\n    Gb4,\n    G4,\n    Ab4,\n    A4,\n    Bb4,\n    B4,\n    C5,\n    Db5,\n    D5,\n    Eb5,\n    E5,\n    F5,\n    Gb5,\n    G5,\n    Ab5,\n    A5,\n    Bb5,\n    B5,\n    C6,\n    Db6,\n    D6,\n    Eb6,\n    E6,\n    F6,\n    Gb6,\n    G6,\n    Ab6,\n    A6,\n    Bb6,\n    B6,\n    C7,\n    Db7,\n    D7,\n    Eb7,\n    E7,\n    F7,\n    Gb7,\n    G7,\n    Ab7,\n    A7,\n    Bb7,\n    B7,\n];","import iRealReader from 'ireal-reader';\nimport { Trio, Sampler, util } from '../lib';\nimport { bossa } from '../src/grooves/bossa';\n// import { disco } from '../src/grooves/disco';\nimport { funk } from '../src/grooves/funk';\nimport { swing } from '../src/grooves/swing';\nimport { RealParser } from '../src/sheet/RealParser';\nimport { Voicing } from '../src/harmony/Voicing';\nimport link from '../songs/1350.json';\n/* import { harp } from './samples/harp'; */\nimport { drumset } from '../samples/drumset';\nimport { piano } from '../samples/piano';\n\nconst context = new AudioContext();\nconst playlist = new iRealReader(decodeURI(link));\n// bass = new Synthesizer({ duration: 400, gain: gains[w1], type: w1, mix });\nconst keyboard = new Sampler({ samples: piano, midiOffset: 24, gain: 1, context });\n// const keyboard = new WebAudioFont({ context, preset: 50, gain: .8 });\n// const bass = new WebAudioFont({ context, preset: 366 });\nconst bass = keyboard;\n// const harpInstrument = new Sampler({ samples: harp, midiOffset: 24, gain: 1, context });\nconst drums = new Sampler({ samples: drumset, context, gain: 0.5, duration: 6000 });\nconst band = new Trio({ context, piano: keyboard, bass, drums, solo: false });\n\nfunction getStandard(playlist) {\n    /* const standard = util.randomElement(playlist.songs.filter(s => s.title.includes('Black Narcissus'))); */\n    const standard = util.randomElement(playlist.songs);\n    standard.music.measures = RealParser.parseSheet(standard.music.raw); // TODO: add Song that can be passed to comp\n    console.log('standard', standard);\n    return standard;\n}\n\nwindow.onload = function () {\n    // buttons\n    const playJazz = document.getElementById('jazz');\n    const playFunk = document.getElementById('funk');\n    const playBossa = document.getElementById('bossa');\n    const stop = document.getElementById('stop');\n    const slower = document.getElementById('slower');\n    const faster = document.getElementById('faster');\n    const next = document.getElementById('next');\n    const randomInstruments = document.getElementById('instruments');\n    let standard;\n\n    next.addEventListener('click', () => {\n        if (band.pulse) {\n            band.pulse.stop();\n        }\n        standard = getStandard(playlist);\n        setTimeout(() => play(), 500);\n    });\n\n    function play(groove = swing) {\n        const forms = 2;\n        const time = 4;\n        const bpm = 130;\n        band.comp({\n            composer: standard.composer,\n            title: standard.title,\n            chords: standard.music.measures\n        }, {\n                render: { forms },\n                metronome: false,\n                exact: false,\n                cycle: time,\n                bpm,\n                groove,\n                voicings: {\n                    // forceDirection: 'down',\n                    range: ['C3', 'C5'], // allowed voice range\n                    maxVoices: 3, // maximum number of voices per chord\n                    maxDistance: 7,  // general max distance between single voices\n                    minDistance: 1,  // general max distance between single voices\n                    minBottomDistance: 3, // min semitones between the two bottom notes\n                    minTopDistance: 2, // min semitones between the two top notes\n                    noTopDrop: true,\n                    noTopAdd: true,\n                    noBottomDrop: false,\n                    noBottomAdd: false,\n                    logging: true\n                    /* filterChoices: (choice) => {\n                        return true;\n                    },\n                    sortChoices: (a, b) => {\n                        return a.difference - b.difference;\n                    } */\n                }\n            });\n    }\n\n    randomInstruments.addEventListener('click', () => {\n        const allowed = ['sine', 'triangle', 'square', 'sawtooth'];\n        band.pianist.instrument = jazz.util.randomSynth(band.mix, allowed);\n        band.bassist.instrument = jazz.util.randomSynth(band.mix, ['sine']);\n        /* band.soloist.instrument = jazz.util.randomSynth(band.mix, allowed); */\n        console.log('pianist:', band.pianist.instrument.type);\n        console.log('bassist:', band.bassist.instrument.type);\n    });\n\n    playJazz.addEventListener('click', () => play(swing));\n    playFunk.addEventListener('click', () => play(funk));\n    playBossa.addEventListener('click', () => play(bossa));\n\n\n    let lastVoicing;\n    function voiceChord(chord) {\n        const notes = Voicing.getNextVoicing(chord, lastVoicing);\n        lastVoicing = notes;\n        keyboard.playNotes(notes, { duration: 500 });\n    }\n\n    a.addEventListener('click', (e) => voiceChord(e.target.innerHTML));\n    b.addEventListener('click', (e) => voiceChord(e.target.innerHTML));\n    c.addEventListener('click', (e) => voiceChord(e.target.innerHTML));\n    d.addEventListener('click', (e) => voiceChord(e.target.innerHTML));\n    e.addEventListener('click', (e) => voiceChord(e.target.innerHTML));\n    f.addEventListener('click', (e) => voiceChord(e.target.innerHTML));\n    g.addEventListener('click', (e) => voiceChord(e.target.innerHTML));\n\n    playChord.addEventListener('click', () => {\n        voiceChord(chordInput.value);\n    });\n\n    stop.addEventListener('click', () => {\n        band.pulse.stop();\n    });\n    slower.addEventListener('click', () => {\n        band.pulse.changeTempo(band.pulse.props.bpm - 10);\n        console.log('tempo', band.pulse.props.bpm);\n    });\n    faster.addEventListener('click', () => {\n        band.pulse.changeTempo(band.pulse.props.bpm + 10);\n        console.log('tempo', band.pulse.props.bpm);\n    });\n}\n"]}