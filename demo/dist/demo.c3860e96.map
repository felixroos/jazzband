{"version":3,"sources":["../node_modules/ireal-reader/unscramble.js","../node_modules/ireal-reader/Music.js","../node_modules/ireal-reader/Song.js","../node_modules/ireal-reader/Playlist.js","../node_modules/ireal-reader/index.js","../../../.nvm/versions/node/v8.11.1/lib/node_modules/parcel/node_modules/process/browser.js","../node_modules/waaclock/lib/WAAClock.js","../node_modules/waaclock/index.js","../lib/Pulse.js","../lib/sheet/Measure.js","../lib/sheet/Sheet.js","../node_modules/tonal-note/build/es6.js","../node_modules/tonal-array/build/es6.js","../node_modules/tonal-interval/build/es6.js","../node_modules/tonal-distance/build/es6.js","../node_modules/tonal-pcset/build/es6.js","../node_modules/tonal-dictionary/build/es6.js","../node_modules/tonal-scale/build/es6.js","../node_modules/tonal-chord/build/es6.js","../node_modules/tonal/index.js","../lib/harmony/Harmony.js","../lib/instruments/Instrument.js","../lib/symbols.js","../lib/util/util.js","../lib/instruments/Synthesizer.js","../lib/Metronome.js","../lib/util/Permutation.js","../lib/harmony/Voicing.js","../node_modules/diff/dist/diff.js","../lib/sheet/Snippet.js","../lib/util/Logger.js","../lib/Band.js","../lib/musicians/Musician.js","../lib/grooves/swing.js","../lib/musicians/Pianist.js","../lib/musicians/Drummer.js","../lib/musicians/Bassist.js","../lib/instruments/Sampler.js","../lib/instruments/Kick.js","../lib/instruments/Snare.js","../lib/instruments/PlasticDrums.js","../lib/improvisation/Improvisation.js","../lib/improvisation/methods.js","../lib/musicians/Improvisor.js","../lib/Trio.js","../lib/sheet/RealParser.js","../lib/instruments/MidiOut.js","../lib/musicians/Permutator.js","../lib/index.js","../src/harmony/Harmony.ts","../src/instruments/Instrument.ts","../src/instruments/Synthesizer.ts","../src/symbols.ts","../src/util/util.ts","../src/grooves/bossa.ts","../src/grooves/funk.ts","../src/grooves/swing.ts","../src/sheet/Sheet.ts","../src/sheet/Measure.ts","../src/sheet/RealParser.ts","../src/sheet/Snippet.ts","../src/samples/drumset.js","../src/samples/piano.js","demo.js"],"names":["process","module","exports","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","setTimeout","e","clearTimeout","runTimeout","fun","call","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","nextTick","args","Array","arguments","i","push","Item","array","prototype","apply","title","browser","env","argv","version","versions","noop","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","__importDefault","mod","__esModule","Object","defineProperty","value","waaclock_1","require","Pulse","props","defaults","bpm","cycle","delay","events","callbackAtTime","assign","context","AudioContext","clock","default","toleranceEarly","toleranceLate","getMeasureLength","beatsPerMeasure","arrayPulse","children","path","start","callback","deadline","_this","isArray","item_1","pulse","currentTime","event","childLength","map","el","tickArray","l","Promise","resolve","reject","tick","criticalEvents","console","warn","stop","changeTempo","newTempo","factor","filter","timeStretch","Sheet_1","Measure","from","measure","chords","hasSign","sign","signs","includes","hasHouse","number","house","undefined","getJumpSign","s","keys","Sheet","jumpSigns","hasJumpSign","reduce","match","current","__assign","t","n","p","hasOwnProperty","Measure_1","render","sheet","options","state","measures","forms","nested","fallbackToZero","firstTime","newForm","runs","index","nextMeasure","nextSection","nextIndex","nextForm","_a","jumps","shouldJump","braces","getJumpDestination","wipeKeys","visits","lastTime","force","section","getNextSectionIndex","readyForFineOrCoda","next","getNextHouseIndex","findPair","pairs","move","stack","findMatch","find","fine","pair","getBracePair","destination","m","relatedHouse","getRelatedHouse","canVisitHouse","houses","visited","step","numberMap","range","wiped","parseInt","forEach","latestHouse","isFirstHouse","getAllowedJumps","times","backJump","validator","allowedJumps","timesJumped","NAMES","split","names","accTypes","slice","acc","indexOf","SHARPS","FLATS","REGEX","tokenize","str","exec","toUpperCase","replace","NO_NOTE","freeze","pc","alt","oct","octStr","chroma","midi","freq","SEMI","properties","tokens","letter","charCodeAt","midiToFreq","memo","fn","cache","isMidiRange","note","tuning","Math","pow","L2","log","L440","freqToMidi","v","round","LETTERS","stepToLetter","fillStr","join","numToStr","num","op","altToAcc","fromProps","baseNote","build","fromMidi","sharps","pcs","o","floor","simplify","sameAcc","alteration","useSharps","enharmonic","rotate","sort","unique","ascR","b","a","descR","arr","compact","height","src","shuffle","rnd","random","permutations","perm","pos","newPerm","splice","IVL_TNL","IVL_STR","RegExp","SIZES","TYPES","CLASSES","types","NO_IVL","q","type","simple","semitones","abs","qToAlt","test","altToQ","numToStep","ic","ivl","_b","_c","d","intervalProps","invert","IN","IQ","fromSemitones","c","transpose","trFifths","fifths","transposeBy","addIntervals","add","subtract","interval","FIFTHS","fOcts","f","FIFTH_OCTS","encode","ref","STEPS","unaltered","decode","encoder","encodeNote","noteProps","encodeIvl","iprops","tr","to","isDescending","decodeIvl","ivl1","ivl2","i1","i2","chromas","modes","isChroma","intervals","isEqual","isSubsetOf","isSupersetOf","chr","pcsetNum","set","clen","all","toString","normalize","binary","_","r","IVLS","s1","s2","notes","dictionary","raw","data","ivls","key","alias","allKeys","dict","combine","scale","sdata","chord","cdata","pcset","exists","NO_SCALE","setnum","memoize","nameOrTonic","tonic","substring","modeNames","tonics","x","inScale","toScale","supersets","isSuperset","subsets","isSubset","NO_CHORD","NUM_TYPES","Note","Interval","Distance","Dictionary","Scale","Chord","PcSet","tonal_1","tonal_2","tonal_3","tonal_4","Harmony","isBlack","isSameNote","noteA","noteB","getTonalChord","getBassNote","getMidi","offset","intervalComplement","fix","fixIndex","invertInterval","positive","complement","isNegative","fixInterval","forceDirection","direction","noUnison","minInterval","inversion","minIntervals","chordA","chordB","mapMinInterval","sortMinInterval","preferredDirection","accessor","diff","getNearestNote","getNearestTargets","targets","flip","target","intervalMatrix","Harmony_1","Instrument","gain","mix","onTrigger","midiOffset","activeEvents","init","playNotes","settings","duration","noteOff","notesOn","active","notesOff","keep","playKeys","__importStar","result","k","symbol","long","short","groups","scales","symbols","levels","groupFilter","group","item","level","max","Set","scaleNames","chordNames","groupNames","symbolName","pool","scaleName","chordName","randomItem","randomScale","randomChord","Synthesizer_1","symbols_1","steps","randomNumber","arraySum","randomElement","weighted","total","w","shuffleArray","j","getPath","traveled","min","getDuration","divisions","noteLength","measureLength","resolveChords","pattern","fraction","NaN","hasOff","division","offbeatReducer","bar","last","randomSynth","allowed","gains","sine","triangle","square","sawtooth","wave","Synthesizer","adsr","time","param","attack","decay","sustain","release","endless","linearRampToValueAtTime","setTargetAtTime","randomDelay","maxMs","isInRange","transposeNotes","transposeToRange","getAverageMidi","sum","getDistancesToRangeEnds","rangeMidi","getRangePosition","getRangeDirection","defaultDirection","border","position","getStep","getIntervalFromStep","getStepsFromDegree","degree","getStepsInChord","root","getStepFromInterval","getStepInChord","getChordScales","pickChordScale","findDegree","degreeOrStep","intervalsOrSteps","isInterval","degree_1","error","getDegreeFromStep","hasDegree","hasAllDegrees","degrees","res","getScaleDegree","getScalePattern","renderIntervals","renderSteps","permutateIntervals","getDegreeFromInterval","fixed","getDegreeInChord","getPatternInChord","permutation","getDigitalPattern","renderDigitalPattern","getGuideTones","isFirstInPath","isBarStart","isFormStart","isOffbeat","otherDirection","totalDiff","weight","added","count","removed","kept","balance","changes","sortByDegree","diffDegrees","chain","closest","unshift","reverse","renderAbsoluteNotes","octave","absolute","getIntervals","smallestInterval","sortNotes","analyzeVoicing","sortedIntervals","maxInterval","spread","semitoneDifference","semitoneMovement","longestChild","isPitchClass","mapTree","tree","modifier","siblings","subtree","flattenTree","flat","expandTree","chordHasIntervals","has","isOptional","isForbidden","isDominantChord","isMajorChord","isMinorChord","isMinorTonic","getChordType","getChordNotes","validate","validateWithoutRoot","getVoicing","voices","previousVoicing","omitRoot","quartal","semitoneDistance","noteArray","slots","fill","factorial","__extends","extendStatics","setPrototypeOf","__proto__","__","constructor","create","Instrument_1","util_1","_super","getVoice","frequency","oscNode","createOscillator","gainNode","createGain","connect","lowestGain","startKeys","voice","stopVoice","stopVoices","Metronome","synth","ready","bars","Permutation","permutateElements","isValid","combinations","subcombinations","permutationComplexity","validations","permutateArray","combineValidators","validators","_i","binomial","combs","head","tailcombs","Permutation_1","Logger_1","Voicing","getNextVoicing","rangeBorders","maxVoices","maxDistance","minBottomDistance","minTopDistance","noTopDrop","noTopAdd","noBottomDrop","noBottomAdd","logging","sortChoices","filterChoices","getAllVoicePermutations","exit","pick","Logger","logVoicing","combination","firstNote","firstPick","firstNoteInRange","pick_1","choices","getAllChoices","choice","dropped","topNotes","bottomNotes","difference","bestPick","getDesiredDirection","pick_2","movement","voicingOptions","getAllNoteSelections","getVoicePermutations","validatePermutation","voicingValidator","minDistance","notesAtPositionValidator","validateInterval","required","getRequiredNotes","optional","getOptionalNotes","selection","getAvailableTensions","getAllTensions","requiredSteps","req","lastPitches","bottomInterval","bottomNote","leads","voiceLeading","origin","analyzeVoiceLeading","more","less","voicingIntervals","oblique","similar","parallel","topInterval","contrary","containsNote","voicing","selected","remaining","hasTonic","thresholds","distances","webpackUniversalModuleDefinition","factory","define","amd","modules","installedModules","__webpack_require__","moduleId","id","loaded","canonicalize","convertChangesToXML","convertChangesToDMP","merge","parsePatch","applyPatches","applyPatch","createPatch","createTwoFilesPatch","structuredPatch","diffArrays","diffJson","diffCss","diffSentences","diffTrimmedLines","diffLines","diffWordsWithSpace","diffWords","diffChars","Diff","_base","_base2","_interopRequireDefault","_character","_word","_line","_sentence","_css","_json","_array","_apply","_parse","_merge","_create","_dmp","_xml","obj","oldString","newString","self","done","castInput","removeEmpty","newLen","oldLen","editLength","maxEditLength","bestPath","newPos","components","oldPos","extractCommon","execEditLength","diagonalPath","basePath","addPath","removePath","_oldPos","canAdd","canRemove","clonePath","pushComponent","buildValues","useLongestToken","ret","commonCount","equals","left","right","comparator","ignoreCase","toLowerCase","chars","componentPos","componentLen","component","oldValue","tmp","lastComponent","pop","characterDiff","oldStr","newStr","wordDiff","_params","extendedWordChars","reWhitespace","ignoreWhitespace","generateOptions","lineDiff","retLines","linesAndNewlines","line","newlineIsToken","trim","sentenceDiff","cssDiff","jsonDiff","_typeof","Symbol","iterator","objectPrototypeToString","_options","undefinedReplacement","_options$stringifyRep","stringifyReplacer","JSON","stringify","oldObj","newObj","replacementStack","replacer","canonicalizedObj","toJSON","sortedKeys","_key","arrayDiff","oldArr","newArr","_distanceIterator","_distanceIterator2","source","uniDiff","lines","delimiters","hunks","compareLine","lineNumber","operation","patchContent","errorCount","fuzzFactor","minLine","removeEOFNL","addEOFNL","hunkFits","hunk","toPos","content","substr","maxLine","oldLines","localOffset","oldStart","diffOffset","_hunk","_toPos","newLines","delimiter","linedelimiters","previousOperation","_k","currentIndex","processIndex","complete","loadFile","err","updatedContent","patched","diffstr","list","parseIndex","header","parseFileHeader","parseHunk","strict","fileHeader","keyPrefix","fileName","chunkHeaderIndex","chunkHeaderLine","chunkHeader","newStart","addCount","removeCount","wantForward","backwardExhausted","forwardExhausted","calcLineCount","_toConsumableArray","arr2","_calcOldNewLineCount","calcOldNewLineCount","mine","theirs","base","loadPatch","newFileName","fileNameChanged","oldFileName","oldHeader","newHeader","selectField","mineIndex","theirsIndex","mineOffset","theirsOffset","mineCurrent","Infinity","theirsCurrent","hunkBefore","cloneHunk","mergedHunk","mergeLines","patch","conflict","check","mineLines","theirOffset","theirLines","their","insertLeading","theirCurrent","mutualChange","_hunk$lines","collectChange","_hunk$lines2","removal","insertTrailing","myChanges","theirChanges","allRemoves","arrayStartsWith","skipRemoveSuperset","_hunk$lines3","_hunk$lines4","arrayEqual","_hunk$lines5","swap","collectContext","merged","_hunk$lines6","insert","matchChanges","matchIndex","contextChanges","conflicted","change","prev","removeChanges","delta","changeContent","myCount","theirCount","contextLines","entry","oldRangeStart","newRangeStart","curRange","oldLine","newLine","_loop","_curRange","_curRange2","_curRange3","contextSize","oldEOFNewline","newEOFNewline","escapeHTML","JsDiff","Snippet","snippet","parsed","parse","wrapPipes","string","formatForDiff","minify","format","linebreaks","parseBars","cells","h","pipeIndex","char","columnChars","getCellBounds","col","row","rowlength","rowLeft","urlsafe","formatted","nest","parse2","testFormat","repeatStart","repeatEnd","expand","rendered","expanded","snippetA","snippetB","diffFormat","Voicing_1","Snippet_1","logCustom","logFn","logLegend","groupCollapsed","table","emoji","groupEnd","logSheet","composer","tempo","style","logLabel","icon","logChoice","logNotes","labels","idle","span","allNotes","keyboard","isActive","isUsed","isIdle","isAdded","css","konsole","movedUp","movedDown","equilibrium","bestMatch","lucky","wrong","topAdded","topRemoved","bottomRemoved","bottomAdded","rootless","noOblique","noChange","fewChoices","description","Pulse_1","Metronome_1","Band","musicians","onMeasure","setupMix","metronome","addMember","musician","resume","then","comp","play","Musician","instrument","getGain","eightFour","eightOff","halfTriplet","swing","bass","crash","ride","hihat","solo","Musician_1","swing_1","Pianist","playedNotes","playedChords","groove","rollFactor","grooveKey","voicings","exact","playChord","concurrency","arpeggio","ceil","getLastVoicing","scorenotes","Drummer","kick","snare","rimshot","patterns","Bassist","playBass","Sampler","buffers","samples","sources","loadSources","getBuffer","buffer","fetch","arrayBuffer","decodeAudioData","decodedData","getSource","createBufferSource","getSources","hasLoaded","loadSource","allLoaded","playSounds","sounds","sound","playSource","Kick","setup","osc","trigger","setValueAtTime","exponentialRampToValueAtTime","Snare","noiseBuffer","bufferSize","sampleRate","createBuffer","output","getChannelData","noise","noiseFilter","createBiquadFilter","noiseEnvelope","oscEnvelope","Kick_1","Snare_1","PlasticDrums","missing","Improvisation","rules","get","fromCache","rule","getRuleFactories","enhance","mutate","reducer","originKey","factories","Improvisation_1","permutator","groovePattern","reach","lineBreaks","fixRange","startRandom","firstNoteInPattern","randomNote","lastNote","material","nextNotes","getStraightBar","straightNotes","fixedNotesPerChord","pendulum","softForce","comfort","exclude","barNumber","comfortSwitchBars","isComfortZone","beatPattern","barStart","notesPerChord","patternPractise","advancedPermutator","drill","excludeNotes","guideTones","guideTonesFlipped","chordTones","fullScale","scalePendulum","digitalPattern","digitalPendulum","digitalWalker","digitalPractiseUp","digitalPractiseDown","heptatonicPractise","defaultMethod","improvisationMethods","methods_1","Improvisor","method","useMethod","improvise","Band_1","Pianist_1","Bassist_1","Drummer_1","PlasticDrums_1","Improvisor_1","Trio","piano","drums","instruments","setupInstruments","pianist","bassist","drummer","soloist","RealParser","getChord","iRealChord","modifiers","over","parseSheet","getSheet","token","lastBarEnded","annots","sectionStart","hasCodaSign","codaSign","houseStart","comments","text","headers","found","regExps","replacement","repl","replacements","out","newToken","parseChord","spacer","comment","alternate","chordRegex","iRealToken","MidiOut","navigator","midiInit","midiFail","outputs","size","inputs","input","onmidimessage","getMidiMessage","noteOn","message","send","velocity","Permutator","playPermutations","Sampler_1","Trio_1","util","RealParser_1","MidiOut_1","Permutator_1","rs","drumset","drumSamples","C1","Db1","D1","Eb1","E1","F1","Gb1","G1","Ab1","A1","Bb1","B1","C2","Db2","D2","Eb2","E2","F2","Gb2","G2","Ab2","A2","Bb2","B2","C3","Db3","D3","Eb3","E3","F3","Gb3","G3","Ab3","A3","Bb3","B3","C4","Db4","D4","Eb4","E4","F4","Gb4","G4","Ab4","A4","Bb4","B4","C5","Db5","D5","Eb5","E5","F5","Gb5","G5","Ab5","A5","Bb5","B5","C6","Db6","D6","Eb6","E6","F6","Gb6","G6","Ab6","A6","Bb6","B6","C7","Db7","D7","Eb7","E7","F7","Gb7","G7","Ab7","A7","Bb7","B7","window","webkitAudioContext","alert","playlist","iRealReader","decodeURI","link","band","onload","playJazz","document","getElementById","playFunk","playBossa","stopButton","slower","faster","searchInput","playChords","standardTitle","textarea","cheapSynths","usePiano","standard","getStandard","query","newStandard","songs","music","loadStandard","addEventListener","setTitle","innerHTML","leadsheet","selectCell","funk","bossa","bounds","focus","setSelectionRange"],"mappings":"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9B,UAAM,IAAIhD,KAAJ,CAAU,kCAAV,CAAN;AACH,CAFD;;AAIAN,QAAQwD,GAAR,GAAc,YAAY;AAAE,WAAO,GAAP;AAAY,CAAxC;AACAxD,QAAQyD,KAAR,GAAgB,UAAUC,GAAV,EAAe;AAC3B,UAAM,IAAIpD,KAAJ,CAAU,gCAAV,CAAN;AACH,CAFD;AAGAN,QAAQ2D,KAAR,GAAgB,YAAW;AAAE,WAAO,CAAP;AAAW,CAAxC;;;ACvLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A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","file":"demo.c3860e96.map","sourceRoot":"..","sourcesContent":["'use strict';\n\n//unscrambling hints from https://github.com/ironss/accompaniser/blob/master/irealb_parser.lua\n//strings are broken up in 50 character segments. each segment undergoes character substitution addressed by obfusc50()\nexports.ireal = function(s){\n  let r = '', p;\n\n  while(s.length > 50){\n    p = s.substring(0, 50);\n    s = s.substring(50)\n    if(s.length < 2){\n      r = r + p;\n    }else{\n      r = r + obfusc50(p);\n    }\n  }\n  r = r + s;\n  return r;\n}\n\nfunction obfusc50 (s){\n  //the first 5 characters are switched with the last 5\n  let newString = s.split('');\n  for(let i = 0; i < 5; i++){\n    newString[49 - i] = s[i];\n    newString[i] = s[49 - i];\n  }\n  //characters 10-24 are also switched\n  for(let i = 10; i < 24; i++){\n    newString[49 - i] = s[i];\n    newString[i] = s[49 - i];\n  }\n  return newString.join('');\n}\n","'use strict';\n\n//regex:\n//  letters A-G and W (W is an invisible slash chord)\n//  {1} only one of the aforementioned letters\n//  followed by zero or more of these: + - ^ h o # b digit\n//  followed by an optional group (to catch slash chords)\n//    that starts with a slash\n//    followed by A-G\n//    followed by optional # or b\n\nconst chordRegex = /[A-GW]{1}[\\+\\-\\^\\dhob#suad]*(\\/[A-G][#b]?)?/g;\nconst musicPrefix = \"1r34LbKcu7\";\nconst unscramble = require('./unscramble');\n\nclass Music {\n  constructor(data){\n    const parts = data.split(musicPrefix);\n    this.raw = unscramble.ireal(parts[1]);\n    //TODO: read the time signature\n    this.timeSignature = 'T44';\n    const musicData = removeNonMusicalInfo(this.raw);\n    this.measures = getMeasures(musicData)\n  }\n}\nmodule.exports = Music;\n\nfunction getMeasures(data){\n  let measures = data.split(/\\||LZ|K|Z|\\{|\\}|\\[|\\]/g)//measures are delimited by |, LZ, {, } (repeat markers), [, ] (double barlines). Also splitting on K because Kcl seems to indicate a repeat of the previous measure. Z is the end of a song usually.\n\n  measures = fillSingleRepeats(measures);\n  measures = fillDoubleRepeats(measures);\n\n  measures = measures.map((x, index, array) => x.match(chordRegex))\n    .filter(x => !!x)  //filter out blank measures. if empty measures like N.C. are needed this has to be modified\n\n  measures = fillInvisibleSlashChords(measures);\n\n  return measures;\n}\n\nfunction removeNonMusicalInfo(data){\n  //remove all the non-musical information\n  data = removeFromString(data, /<.*?>/); //comments delimited by carets < ... >, non-greedy match. do this first as these may contain other symbols that we look for later on.\n  data = removeFromString(data, /\\*\\s*\\*/); //stars with empty space in between *  *\n  data = removeFromString(data, /\\*\\w/); //section markers *A, *B, *C\n  data = removeFromString(data, /T\\d+/); //time signatures T44, T34\n  data = removeFromString(data, /N\\d/); //repeat markers N1, N2, ...\n  data = removeFromString(data, /Y+/); //vertical spacers\n  data = removeFromString(data, 'XyQ'); //empty space\n  data = removeFromString(data, /[npUSQ]/); //n: N.C, p: pause slash, U: END, S: Segno, Q: Coda, \n  //s: small (consider using s when implementing chord duration)\n  return data;\n}\n\nfunction fillDoubleRepeats(measures){\n  const r = m => m.indexOf('r') >= 0;\n\n  //an 'r' becomes the two previous measures (drawn as a double angled bar)\n  let repeatMeasureIdx = measures.findIndex(r);\n  while(repeatMeasureIdx != -1){\n    measures.splice(repeatMeasureIdx, 1, measures[repeatMeasureIdx - 2], measures[repeatMeasureIdx - 1]);\n    repeatMeasureIdx = measures.findIndex(r);\n  }\n  return measures;\n}\n\nfunction fillSingleRepeats(measures){\n  //the repeat marker is Kcl but we've already split on K, so only cl is left over\n  //x appears in its own measure, (drawn as a single angled bar)\n  const xcl = m => m.indexOf('x') >= 0 || m.indexOf('cl') >= 0;\n\n  let repeatMeasureIdx = measures.findIndex(xcl);\n  while(repeatMeasureIdx != -1){\n    measures[repeatMeasureIdx] = measures[repeatMeasureIdx - 1];\n    repeatMeasureIdx = measures.findIndex(xcl);\n  }\n  return measures;\n}\n\nfunction fillInvisibleSlashChords(measures){\n  const W = m => m.some(c => c[0] === 'W');\n\n  let invisibleMeasureIdx = measures.findIndex(W);\n  while(invisibleMeasureIdx != -1){\n    const curMeasure = measures[invisibleMeasureIdx];\n    const invisibleChordIdx = curMeasure.findIndex(c => c[0] === 'W')\n\n    if(invisibleChordIdx > 0){\n      const previousChord = curMeasure[invisibleChordIdx - 1].split(\"/\")[0];\n      curMeasure[invisibleChordIdx] = curMeasure[invisibleChordIdx].replace('W', previousChord);\n    }else{\n      const previousMeasure = measures[invisibleMeasureIdx - 1];\n      const previousChord = previousMeasure[previousMeasure.length - 1].split(\"/\")[0];\n      curMeasure[invisibleChordIdx] = curMeasure[invisibleChordIdx].replace('W', previousChord);\n    }\n    invisibleMeasureIdx = measures.findIndex(W);\n  }\n  return measures;\n}\n\nfunction removeFromString(string, toRemove){\n  return string.split(toRemove).join('');\n}\n\n","'use strict';\n\nconst Music = require('./Music');\nconst musicPrefix = \"1r34LbKcu7\";\n\nclass Song {\n  constructor(data){\n    const parts = data.split(/=+/).filter(x => x != \"\"); //split on one or more equal signs, remove the blanks\n    let offset = 0\n    this.title = parts[0];\n    this.composer = parts[1];\n    this.style = parts[2];\n    this.key = parts[3];\n    this.transpose = null;\n    if(parts[4].indexOf(musicPrefix) !== 0){\n      offset = 1;\n      this.transpose = parseInt(parts[4]) || null;\n    }\n    this.music = new Music(parts[4 + offset]);\n    this.compStyle = parts[5 + offset] || null;\n    this.bpm = parseInt(parts[6 + offset]) || null;\n    this.repeats = parseInt(parts[7 + offset]) || null;\n  }\n}\n\nmodule.exports = Song;","'use strict';\n\nconst Song = require('./Song');\nconst regex = /.*?irealb:\\/\\/([^\"]*)/;\n\nclass Playlist {\n  constructor(data){\n    const percentEncoded = regex.exec(data);\n    const percentDecoded = decodeURIComponent(percentEncoded[1]);\n    const parts = percentDecoded.split(\"===\");  //songs are separated by ===\n    if(parts.length > 1) this.name = parts.pop();  //playlist name\n    this.songs = parts.map(x => new Song(x));\n  }\n}\n\nmodule.exports = Playlist;","'use strict';\n\nconst Playlist = require('./Playlist');\n\n//class hierarchy: Playlist has many Songs. Song has one Music.\n\nmodule.exports = Playlist;","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","var isBrowser = (typeof window !== 'undefined')\n\nvar CLOCK_DEFAULTS = {\n  toleranceLate: 0.10,\n  toleranceEarly: 0.001\n}\n\n// ==================== Event ==================== //\nvar Event = function(clock, deadline, func) {\n  this.clock = clock\n  this.func = func\n  this._cleared = false // Flag used to clear an event inside callback\n\n  this.toleranceLate = clock.toleranceLate\n  this.toleranceEarly = clock.toleranceEarly\n  this._latestTime = null\n  this._earliestTime = null\n  this.deadline = null\n  this.repeatTime = null\n\n  this.schedule(deadline)\n}\n\n// Unschedules the event\nEvent.prototype.clear = function() {\n  this.clock._removeEvent(this)\n  this._cleared = true\n  return this\n}\n\n// Sets the event to repeat every `time` seconds.\nEvent.prototype.repeat = function(time) {\n  if (time === 0)\n    throw new Error('delay cannot be 0')\n  this.repeatTime = time\n  if (!this.clock._hasEvent(this))\n    this.schedule(this.deadline + this.repeatTime)\n  return this\n}\n\n// Sets the time tolerance of the event.\n// The event will be executed in the interval `[deadline - early, deadline + late]`\n// If the clock fails to execute the event in time, the event will be dropped.\nEvent.prototype.tolerance = function(values) {\n  if (typeof values.late === 'number')\n    this.toleranceLate = values.late\n  if (typeof values.early === 'number')\n    this.toleranceEarly = values.early\n  this._refreshEarlyLateDates()\n  if (this.clock._hasEvent(this)) {\n    this.clock._removeEvent(this)\n    this.clock._insertEvent(this)\n  }\n  return this\n}\n\n// Returns true if the event is repeated, false otherwise\nEvent.prototype.isRepeated = function() { return this.repeatTime !== null }\n\n// Schedules the event to be ran before `deadline`.\n// If the time is within the event tolerance, we handle the event immediately.\n// If the event was already scheduled at a different time, it is rescheduled.\nEvent.prototype.schedule = function(deadline) {\n  this._cleared = false\n  this.deadline = deadline\n  this._refreshEarlyLateDates()\n\n  if (this.clock.context.currentTime >= this._earliestTime) {\n    this._execute()\n  \n  } else if (this.clock._hasEvent(this)) {\n    this.clock._removeEvent(this)\n    this.clock._insertEvent(this)\n  \n  } else this.clock._insertEvent(this)\n}\n\nEvent.prototype.timeStretch = function(tRef, ratio) {\n  if (this.isRepeated())\n    this.repeatTime = this.repeatTime * ratio\n\n  var deadline = tRef + ratio * (this.deadline - tRef)\n  // If the deadline is too close or past, and the event has a repeat,\n  // we calculate the next repeat possible in the stretched space.\n  if (this.isRepeated()) {\n    while (this.clock.context.currentTime >= deadline - this.toleranceEarly)\n      deadline += this.repeatTime\n  }\n  this.schedule(deadline)\n}\n\n// Executes the event\nEvent.prototype._execute = function() {\n  if (this.clock._started === false) return\n  this.clock._removeEvent(this)\n\n  if (this.clock.context.currentTime < this._latestTime)\n    this.func(this)\n  else {\n    if (this.onexpired) this.onexpired(this)\n    console.warn('event expired')\n  }\n  // In the case `schedule` is called inside `func`, we need to avoid\n  // overrwriting with yet another `schedule`.\n  if (!this.clock._hasEvent(this) && this.isRepeated() && !this._cleared)\n    this.schedule(this.deadline + this.repeatTime) \n}\n\n// Updates cached times\nEvent.prototype._refreshEarlyLateDates = function() {\n  this._latestTime = this.deadline + this.toleranceLate\n  this._earliestTime = this.deadline - this.toleranceEarly\n}\n\n// ==================== WAAClock ==================== //\nvar WAAClock = module.exports = function(context, opts) {\n  var self = this\n  opts = opts || {}\n  this.tickMethod = opts.tickMethod || 'ScriptProcessorNode'\n  this.toleranceEarly = opts.toleranceEarly || CLOCK_DEFAULTS.toleranceEarly\n  this.toleranceLate = opts.toleranceLate || CLOCK_DEFAULTS.toleranceLate\n  this.context = context\n  this._events = []\n  this._started = false\n}\n\n// ---------- Public API ---------- //\n// Schedules `func` to run after `delay` seconds.\nWAAClock.prototype.setTimeout = function(func, delay) {\n  return this._createEvent(func, this._absTime(delay))\n}\n\n// Schedules `func` to run before `deadline`.\nWAAClock.prototype.callbackAtTime = function(func, deadline) {\n  return this._createEvent(func, deadline)\n}\n\n// Stretches `deadline` and `repeat` of all scheduled `events` by `ratio`, keeping\n// their relative distance to `tRef`. In fact this is equivalent to changing the tempo.\nWAAClock.prototype.timeStretch = function(tRef, events, ratio) {\n  events.forEach(function(event) { event.timeStretch(tRef, ratio) })\n  return events\n}\n\n// Removes all scheduled events and starts the clock \nWAAClock.prototype.start = function() {\n  if (this._started === false) {\n    var self = this\n    this._started = true\n    this._events = []\n\n    if (this.tickMethod === 'ScriptProcessorNode') {\n      var bufferSize = 256\n      // We have to keep a reference to the node to avoid garbage collection\n      this._clockNode = this.context.createScriptProcessor(bufferSize, 1, 1)\n      this._clockNode.connect(this.context.destination)\n      this._clockNode.onaudioprocess = function () {\n        process.nextTick(function() { self._tick() })\n      }\n    } else if (this.tickMethod === 'manual') null // _tick is called manually\n\n    else throw new Error('invalid tickMethod ' + this.tickMethod)\n  }\n}\n\n// Stops the clock\nWAAClock.prototype.stop = function() {\n  if (this._started === true) {\n    this._started = false\n    this._clockNode.disconnect()\n  }  \n}\n\n// ---------- Private ---------- //\n\n// This function is ran periodically, and at each tick it executes\n// events for which `currentTime` is included in their tolerance interval.\nWAAClock.prototype._tick = function() {\n  var event = this._events.shift()\n\n  while(event && event._earliestTime <= this.context.currentTime) {\n    event._execute()\n    event = this._events.shift()\n  }\n\n  // Put back the last event\n  if(event) this._events.unshift(event)\n}\n\n// Creates an event and insert it to the list\nWAAClock.prototype._createEvent = function(func, deadline) {\n  return new Event(this, deadline, func)\n}\n\n// Inserts an event to the list\nWAAClock.prototype._insertEvent = function(event) {\n  this._events.splice(this._indexByTime(event._earliestTime), 0, event)\n}\n\n// Removes an event from the list\nWAAClock.prototype._removeEvent = function(event) {\n  var ind = this._events.indexOf(event)\n  if (ind !== -1) this._events.splice(ind, 1)\n}\n\n// Returns true if `event` is in queue, false otherwise\nWAAClock.prototype._hasEvent = function(event) {\n return this._events.indexOf(event) !== -1\n}\n\n// Returns the index of the first event whose deadline is >= to `deadline`\nWAAClock.prototype._indexByTime = function(deadline) {\n  // performs a binary search\n  var low = 0\n    , high = this._events.length\n    , mid\n  while (low < high) {\n    mid = Math.floor((low + high) / 2)\n    if (this._events[mid]._earliestTime < deadline)\n      low = mid + 1\n    else high = mid\n  }\n  return low\n}\n\n// Converts from relative time to absolute time\nWAAClock.prototype._absTime = function(relTime) {\n  return relTime + this.context.currentTime\n}\n\n// Converts from absolute time to relative time \nWAAClock.prototype._relTime = function(absTime) {\n  return absTime - this.context.currentTime\n}","var WAAClock = require('./lib/WAAClock')\n\nmodule.exports = WAAClock\nif (typeof window !== 'undefined') window.WAAClock = WAAClock\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar waaclock_1 = __importDefault(require(\"waaclock\"));\nvar Pulse = /** @class */ (function () {\n    function Pulse(props) {\n        if (props === void 0) { props = {}; }\n        this.defaults = {\n            bpm: 120,\n            cycle: 4,\n            delay: 0\n        };\n        this.events = [];\n        this.callbackAtTime = false;\n        this.props = Object.assign({}, this.defaults, props);\n        this.context = this.props.context || new AudioContext();\n        this.clock = this.props.clock || new waaclock_1.default(this.context, { toleranceEarly: 0.1, toleranceLate: 0.1 });\n    }\n    Pulse.prototype.getMeasureLength = function (bpm, beatsPerMeasure) {\n        if (bpm === void 0) { bpm = this.props.bpm; }\n        if (beatsPerMeasure === void 0) { beatsPerMeasure = this.props.cycle; }\n        return 60 / bpm * beatsPerMeasure;\n    };\n    Pulse.prototype.arrayPulse = function (children, length, path, start, callback, deadline) {\n        var _this = this;\n        if (length === void 0) { length = 1; }\n        if (path === void 0) { path = []; }\n        if (start === void 0) { start = 0; }\n        //TODO: return promise on next one (for chaining)\n        if (!Array.isArray(children)) {\n            if (children === 0) {\n                return 0;\n            }\n            var item_1 = {\n                value: children,\n                length: length,\n                path: path,\n                start: start,\n                pulse: this,\n                cycle: this.props.cycle,\n                timeout: null\n            };\n            start += this.props.delay; // TODO: be able to add delay from arrayPulse fn directly\n            if (this.callbackAtTime) {\n                start += deadline ? deadline : this.context.currentTime;\n                item_1.timeout = this.clock.callbackAtTime(function (event) {\n                    return callback(Object.assign(item_1, { event: event, deadline: event.deadline }));\n                }, start);\n            }\n            else {\n                start += (deadline || this.context.currentTime) - this.context.currentTime;\n                item_1.timeout = this.clock.setTimeout(function (event) {\n                    return callback(Object.assign(item_1, { event: event, deadline: event.deadline }));\n                }, start);\n            }\n            this.events.push(item_1.timeout);\n            return item_1;\n        }\n        var childLength = length / children.length;\n        return {\n            length: length,\n            children: children.map(function (el, i) {\n                return _this.arrayPulse(el, childLength, path.concat([i]), start + i * childLength, callback, deadline);\n            })\n        };\n    };\n    Pulse.prototype.tickArray = function (array, callback, deadline, length) {\n        var _this = this;\n        array.push(1);\n        var l = length || this.getMeasureLength() * array.length;\n        this.start();\n        return new Promise(function (resolve, reject) {\n            _this.arrayPulse(array, l, [], 0, function (tick, start) {\n                if (tick.path[0] === array.length - 1) {\n                    resolve(tick);\n                }\n                else {\n                    callback(tick, start);\n                }\n            }, deadline);\n        });\n    };\n    Pulse.prototype.start = function () {\n        // console.log('start with', this.events.length, 'events');\n        var criticalEvents = 6000;\n        if (this.events.length > criticalEvents) {\n            console.warn('more than ', criticalEvents, 'events received. Consider using less \"times\" to keep the timing precies');\n        }\n        this.clock.start();\n    };\n    Pulse.prototype.stop = function () {\n        this.clock.stop();\n    };\n    Pulse.prototype.changeTempo = function (newTempo, timeout) {\n        var _this = this;\n        if (timeout === void 0) { timeout = 0.2; }\n        var factor = this.props.bpm / newTempo;\n        this.props.bpm = newTempo;\n        var events = this.events.filter(function (e) {\n            return e.deadline - _this.context.currentTime > timeout;\n        });\n        // TODO: stretch durations?!\n        this.clock.timeStretch(this.context.currentTime, events, factor);\n    };\n    return Pulse;\n}());\nexports.Pulse = Pulse;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Sheet_1 = require(\"./Sheet\");\n;\nvar Measure = /** @class */ (function () {\n    function Measure() {\n    }\n    Measure.from = function (measure) {\n        if (typeof measure === 'string') {\n            return {\n                chords: [measure]\n            };\n        }\n        if (Array.isArray(measure)) {\n            return {\n                chords: [].concat(measure)\n            };\n        }\n        return Object.assign({}, measure);\n        // return measure;\n    };\n    Measure.hasSign = function (sign, measure) {\n        measure = Measure.from(measure);\n        return !!measure.signs && measure.signs.includes(sign);\n    };\n    Measure.hasHouse = function (measure, number) {\n        measure = Measure.from(measure);\n        var house = measure.house;\n        if (!house) {\n            return false;\n        }\n        else if (number === undefined) {\n            return true;\n        }\n        if (!Array.isArray(house)) {\n            house = [house];\n        }\n        return house.includes(number);\n    };\n    Measure.getJumpSign = function (measure) {\n        var signs = (Measure.from(measure).signs || [])\n            .filter(function (s) { return Object.keys(Sheet_1.Sheet.jumpSigns).includes(s); });\n        if (signs.length > 1) {\n            console.warn('measure cannot contain more than one repeat sign', measure);\n        }\n        return Sheet_1.Sheet.jumpSigns[signs[0]];\n    };\n    Measure.hasJumpSign = function (measure) {\n        return Object.keys(Sheet_1.Sheet.jumpSigns)\n            .reduce(function (match, current) { return match || Measure.hasSign(current, measure); }, false);\n    };\n    return Measure;\n}());\nexports.Measure = Measure;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Measure_1 = require(\"./Measure\");\nvar Sheet = /** @class */ (function () {\n    function Sheet() {\n    }\n    Sheet.render = function (sheet, options) {\n        if (options === void 0) { options = {}; }\n        var state = __assign({ sheet: sheet, measures: [], forms: 1, nested: true, fallbackToZero: true, firstTime: true }, options);\n        state = __assign({}, state, Sheet.newForm(state));\n        var runs = 0;\n        while (runs < 100 && state.index < sheet.length) {\n            runs++;\n            state = Sheet.nextMeasure(state);\n        }\n        return state.measures /* .map(m => Measure.from(m)) */;\n    };\n    Sheet.nextMeasure = function (state) {\n        state = __assign({}, state, Sheet.nextSection(state)); // moves to the right house (if any)\n        var sheet = state.sheet, index = state.index, measures = state.measures;\n        state = __assign({}, state, { measures: measures.concat([__assign({}, Measure_1.Measure.from(sheet[index]), { index: index // add index for mapping\n                 })]) }, Sheet.nextIndex(state));\n        return Sheet.nextForm(state);\n    };\n    Sheet.nextIndex = function (state) {\n        var _a;\n        var sheet = state.sheet, index = state.index, jumps = state.jumps, nested = state.nested, fallbackToZero = state.fallbackToZero;\n        if (!Sheet.shouldJump({ sheet: sheet, index: index, jumps: jumps })) {\n            return {\n                index: index + 1\n            };\n        }\n        var braces = [Sheet.getJumpDestination({ sheet: sheet, index: index, fallbackToZero: fallbackToZero, nested: nested }), index];\n        jumps = Sheet.wipeKeys(jumps, [braces[0], braces[1] - 1]); // wipes indices inside braces\n        return {\n            index: braces[0],\n            jumps: __assign({}, jumps, (_a = {}, _a[braces[1]] = (jumps[braces[1]] || 0) + 1, _a))\n        };\n    };\n    Sheet.newForm = function (state) {\n        return __assign({}, state, { index: 0, jumps: {}, visits: {}, lastTime: state.forms === 1 });\n    };\n    Sheet.nextForm = function (state, force) {\n        if (force === void 0) { force = false; }\n        var sheet = state.sheet, index = state.index, forms = state.forms;\n        if (force || (index >= sheet.length && forms > 1)) {\n            return Sheet.newForm(__assign({}, state, { firstTime: false, forms: forms - 1 }));\n        }\n        return state;\n    };\n    // moves the index to the current house (if any)\n    Sheet.nextSection = function (state) {\n        var _a;\n        var sheet = state.sheet, index = state.index, visits = state.visits, firstTime = state.firstTime, lastTime = state.lastTime;\n        // skip intro when not firstTime\n        if (!firstTime && Measure_1.Measure.from(sheet[index]).section === 'IN') {\n            return {\n                index: Sheet.getNextSectionIndex({ sheet: sheet, index: index }),\n            };\n        }\n        // skip coda when not last time\n        if (Measure_1.Measure.hasSign('Coda', sheet[index]) && !Sheet.readyForFineOrCoda(state)) {\n            return Sheet.nextForm(state, true);\n        }\n        if (!Measure_1.Measure.hasHouse(sheet[index], 1)) {\n            return {};\n        }\n        var next = Sheet.getNextHouseIndex({ sheet: sheet, index: index, visits: visits });\n        if (next === -1) {\n            next = index;\n            visits = {}; // reset visits\n        }\n        return {\n            visits: __assign({}, visits, (_a = {}, _a[next] = (visits[next] || 0) + 1, _a)),\n            index: next\n        };\n    };\n    /** Starts at a given index, stops when the pair functions returned equally often */\n    Sheet.findPair = function (sheet, index, pairs, move, stack) {\n        if (move === void 0) { move = 1; }\n        if (stack === void 0) { stack = 0; }\n        var match = -1; // start with no match\n        while (match === -1 && index >= 0 && index < sheet.length) {\n            if (pairs[0](sheet[index], { sheet: sheet, index: index })) { // same sign\n                stack++;\n            }\n            if (pairs[1](sheet[index], { sheet: sheet, index: index })) { // pair sign\n                stack--;\n            }\n            if (stack === 0) { // all pairs resolved > match!\n                match = index;\n            }\n            else {\n                index += move;\n            }\n        }\n        return match;\n    };\n    Sheet.findMatch = function (sheet, index, find, move) {\n        if (move === void 0) { move = 1; }\n        var match = -1; // start with no match\n        while (match === -1 && index >= 0 && index < sheet.length) {\n            if (find(sheet[index], { sheet: sheet, index: index })) {\n                match = index;\n            }\n            else {\n                index += move;\n            }\n        }\n        return match;\n    };\n    // simple matching for brace start, ignores nested repeats\n    Sheet.getJumpDestination = function (state) {\n        var sheet = state.sheet, index = state.index, fallbackToZero = state.fallbackToZero, nested = state.nested;\n        var sign = Measure_1.Measure.getJumpSign(sheet[index]);\n        // if fine > jump till end\n        if (sign.fine) {\n            return sheet.length;\n        }\n        // if no pair given => da capo\n        if (!sign.pair) {\n            return 0;\n        }\n        // if nested mode on and opening brace is searched, use getBracePair..\n        if (nested !== false && sign.pair === '{') {\n            return Sheet.getBracePair({ sheet: sheet, index: index, fallbackToZero: fallbackToZero });\n        }\n        var destination = Sheet.findMatch(sheet, index, function (m) { return Measure_1.Measure.hasSign(sign.pair, m); }, sign.move || -1); // default move back\n        if (fallbackToZero) {\n            // default to zero when searching repeat start (could be forgotten)\n            return destination === -1 ? 0 : destination;\n        }\n        return destination;\n    };\n    // returns the index of the repeat sign that pairs with the given index\n    Sheet.getBracePair = function (_a) {\n        var sheet = _a.sheet, index = _a.index, fallbackToZero = _a.fallbackToZero;\n        if (fallbackToZero === undefined) {\n            fallbackToZero = true;\n        }\n        if (Measure_1.Measure.hasSign('{', sheet[index])) {\n            return Sheet.findPair(sheet, index, [\n                function (m) { return Measure_1.Measure.hasSign('{', m); },\n                function (m) { return Measure_1.Measure.hasSign('}', m); },\n            ], 1);\n        }\n        else if (Measure_1.Measure.hasSign('}', sheet[index])) {\n            var pair = Sheet.findPair(sheet, index, [\n                function (m, state) {\n                    // this logic could be infinitely complex, having many side effects and interpretations\n                    // the current behaviour is similar to musescore or ireal handling braces\n                    if (!Measure_1.Measure.hasSign('}', m)) {\n                        return false;\n                    }\n                    if (index === state.index) {\n                        return true;\n                    }\n                    var relatedHouse = Sheet.getRelatedHouse({ sheet: sheet, index: state.index });\n                    return relatedHouse === -1;\n                },\n                function (m) { return Measure_1.Measure.hasSign('{', m); }\n            ], -1);\n            if (fallbackToZero) {\n                return pair === -1 ? 0 : pair; // default to zero when searching repeat start (could be forgotten)\n            }\n            return pair;\n        }\n        return -1;\n    };\n    // returns true if the house at the given index has not been visited enough times\n    Sheet.canVisitHouse = function (_a) {\n        var sheet = _a.sheet, index = _a.index, visits = _a.visits;\n        var houses = sheet[index].house;\n        if (houses === undefined) {\n            return false;\n        }\n        if (!Array.isArray(houses)) {\n            houses = [houses];\n        }\n        var visited = visits[index] || 0;\n        return visited < houses.length;\n    };\n    // returns the next house that can be visited (from the given index)\n    Sheet.getNextHouseIndex = function (_a, move) {\n        var sheet = _a.sheet, index = _a.index, visits = _a.visits;\n        if (move === void 0) { move = 1; }\n        return Sheet.findMatch(sheet, index, function (m, step) { return Measure_1.Measure.hasHouse(m) && Sheet.canVisitHouse({ sheet: sheet, index: step.index, visits: visits }); }, move);\n    };\n    Sheet.getNextSectionIndex = function (_a, move) {\n        var sheet = _a.sheet, index = _a.index;\n        if (move === void 0) { move = 1; }\n        return Sheet.findMatch(sheet, index + 1, function (m) { return Measure_1.Measure.from(m).section !== undefined; }, 1);\n    };\n    // wipes all keys in the given range\n    Sheet.wipeKeys = function (numberMap, range) {\n        var wiped = {};\n        Object.keys(numberMap)\n            .map(function (i) { return parseInt(i); })\n            .filter(function (i) { return i < range[0] || i > range[1]; })\n            .forEach(function (i) { return wiped[i] = numberMap[i]; });\n        return wiped;\n    };\n    Sheet.getRelatedHouse = function (_a) {\n        var sheet = _a.sheet, index = _a.index;\n        var latestHouse = Sheet.findPair(sheet, index, [\n            function (m, state) { return index === state.index || Measure_1.Measure.hasSign('}', m); },\n            function (m) { return Measure_1.Measure.hasHouse(m); }\n        ], -1);\n        return latestHouse;\n    };\n    Sheet.isFirstHouse = function (_a) {\n        var sheet = _a.sheet, index = _a.index;\n        return Measure_1.Measure.hasHouse(sheet[index], 1);\n    };\n    Sheet.getAllowedJumps = function (_a) {\n        var sheet = _a.sheet, index = _a.index;\n        if (!Measure_1.Measure.hasJumpSign(sheet[index])) {\n            return 0;\n        }\n        var measure = Measure_1.Measure.from(sheet[index]);\n        if (measure.times !== undefined) {\n            return measure.times;\n        }\n        return 1;\n    };\n    Sheet.readyForFineOrCoda = function (_a) {\n        var sheet = _a.sheet, index = _a.index, jumps = _a.jumps, lastTime = _a.lastTime;\n        var signs = Object.keys(Sheet.jumpSigns)\n            .filter(function (s) { return s.includes('DC') || s.includes('DS'); });\n        var backJump = Sheet.findMatch(sheet, index, function (m) { return signs.reduce(function (match, sign) { return match || Measure_1.Measure.hasSign(sign, m); }, false); });\n        if (backJump === -1) {\n            return lastTime; // last time\n        }\n        return jumps[backJump] > 0;\n    };\n    Sheet.shouldJump = function (_a) {\n        var sheet = _a.sheet, index = _a.index, jumps = _a.jumps;\n        if (!Measure_1.Measure.hasJumpSign(sheet[index])) {\n            return false;\n        }\n        var sign = Measure_1.Measure.getJumpSign(sheet[index]);\n        if (sign.validator && !sign.validator({ sheet: sheet, index: index, jumps: jumps })) {\n            return false;\n        }\n        var allowedJumps = Sheet.getAllowedJumps({ sheet: sheet, index: index });\n        var timesJumped = jumps[index] || 0;\n        return timesJumped < allowedJumps;\n    };\n    Sheet.jumpSigns = {\n        '}': { pair: '{', move: -1 },\n        'DC': {},\n        'DS': { pair: 'Segno', move: -1 },\n        'DS.Fine': { pair: 'Segno', move: -1 },\n        'DS.Coda': { pair: 'Segno', move: -1 },\n        'DC.Fine': {},\n        'DC.Coda': {},\n        'Fine': {\n            fine: true,\n            validator: function (state) { return Sheet.readyForFineOrCoda(state); }\n        },\n        'ToCoda': {\n            pair: 'Coda', move: 1,\n            validator: function (state) { return Sheet.readyForFineOrCoda(state); }\n        }\n    };\n    return Sheet;\n}());\nexports.Sheet = Sheet;\n/*\nTODO:\n\nmore typings\nspecial sections:\nIN: only play the first time\nCODA: only play last time\n\ntest standards:\n- Alice in Wonderland (dc al 2nd ending)\n- All or Nothing at All (dc al coda)\n- Are you real (intro + coda)\n- Armageddon (intro)\n- The Bat (coda sign inside repeat): ireal plays coda directly first time..\n- Bennys Tune (intro+coda sign inside repeat): ireal plays coda directly first time..\n- Bess You Is My Woman (coda sign inside repeat): ireal plays coda directly first time..\n- Blessed Relief (nested repeats, with odd behaviour)\n- Blue in Green (coda)\n- Miles Ahead (coda)\n*/\n","var NAMES = \"C C# Db D D# Eb E F F# Gb G G# Ab A A# Bb B\".split(\" \");\r\nvar names = function (accTypes) {\r\n    return typeof accTypes !== \"string\"\r\n        ? NAMES.slice()\r\n        : NAMES.filter(function (n) {\r\n            var acc = n[1] || \" \";\r\n            return accTypes.indexOf(acc) !== -1;\r\n        });\r\n};\r\nvar SHARPS = names(\" #\");\r\nvar FLATS = names(\" b\");\r\nvar REGEX = /^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\\d*)\\s*(.*)$/;\r\nfunction tokenize(str) {\r\n    if (typeof str !== \"string\")\r\n        str = \"\";\r\n    var m = REGEX.exec(str);\r\n    return [m[1].toUpperCase(), m[2].replace(/x/g, \"##\"), m[3], m[4]];\r\n}\r\nvar NO_NOTE = Object.freeze({\r\n    pc: null,\r\n    name: null,\r\n    step: null,\r\n    alt: null,\r\n    oct: null,\r\n    octStr: null,\r\n    chroma: null,\r\n    midi: null,\r\n    freq: null\r\n});\r\nvar SEMI = [0, 2, 4, 5, 7, 9, 11];\r\nvar properties = function (str) {\r\n    var tokens = tokenize(str);\r\n    if (tokens[0] === \"\" || tokens[3] !== \"\")\r\n        return NO_NOTE;\r\n    var letter = tokens[0], acc = tokens[1], octStr = tokens[2];\r\n    var p = {\r\n        letter: letter,\r\n        acc: acc,\r\n        octStr: octStr,\r\n        pc: letter + acc,\r\n        name: letter + acc + octStr,\r\n        step: (letter.charCodeAt(0) + 3) % 7,\r\n        alt: acc[0] === \"b\" ? -acc.length : acc.length,\r\n        oct: octStr.length ? +octStr : null,\r\n        chroma: 0,\r\n        midi: null,\r\n        freq: null\r\n    };\r\n    p.chroma = (SEMI[p.step] + p.alt + 120) % 12;\r\n    p.midi = p.oct !== null ? SEMI[p.step] + p.alt + 12 * (p.oct + 1) : null;\r\n    p.freq = midiToFreq(p.midi);\r\n    return Object.freeze(p);\r\n};\r\nvar memo = function (fn, cache) {\r\n    if (cache === void 0) { cache = {}; }\r\n    return function (str) { return cache[str] || (cache[str] = fn(str)); };\r\n};\r\nvar props = memo(properties);\r\nvar name = function (str) { return props(str).name; };\r\nvar pc = function (str) { return props(str).pc; };\r\nvar isMidiRange = function (m) { return m >= 0 && m <= 127; };\r\nvar midi = function (note) {\r\n    if (typeof note !== \"number\" && typeof note !== \"string\") {\r\n        return null;\r\n    }\r\n    var midi = props(note).midi;\r\n    var value = midi || midi === 0 ? midi : +note;\r\n    return isMidiRange(value) ? value : null;\r\n};\r\nvar midiToFreq = function (midi, tuning) {\r\n    if (tuning === void 0) { tuning = 440; }\r\n    return typeof midi === \"number\" ? Math.pow(2, (midi - 69) / 12) * tuning : null;\r\n};\r\nvar freq = function (note) { return props(note).freq || midiToFreq(note); };\r\nvar L2 = Math.log(2);\r\nvar L440 = Math.log(440);\r\nvar freqToMidi = function (freq) {\r\n    var v = (12 * (Math.log(freq) - L440)) / L2 + 69;\r\n    return Math.round(v * 100) / 100;\r\n};\r\nvar chroma = function (str) { return props(str).chroma; };\r\nvar oct = function (str) { return props(str).oct; };\r\nvar LETTERS = \"CDEFGAB\";\r\nvar stepToLetter = function (step) { return LETTERS[step]; };\r\nvar fillStr = function (s, n) { return Array(n + 1).join(s); };\r\nvar numToStr = function (num, op) {\r\n    return typeof num !== \"number\" ? \"\" : op(num);\r\n};\r\nvar altToAcc = function (alt) {\r\n    return numToStr(alt, function (alt) { return (alt < 0 ? fillStr(\"b\", -alt) : fillStr(\"#\", alt)); });\r\n};\r\nvar from = function (fromProps, baseNote) {\r\n    if (fromProps === void 0) { fromProps = {}; }\r\n    if (baseNote === void 0) { baseNote = null; }\r\n    var _a = baseNote\r\n        ? Object.assign({}, props(baseNote), fromProps)\r\n        : fromProps, step = _a.step, alt = _a.alt, oct = _a.oct;\r\n    if (typeof step !== \"number\")\r\n        return null;\r\n    var letter = stepToLetter(step);\r\n    if (!letter)\r\n        return null;\r\n    var pc = letter + altToAcc(alt);\r\n    return oct || oct === 0 ? pc + oct : pc;\r\n};\r\nvar build = from;\r\nfunction fromMidi(num, sharps) {\r\n    if (sharps === void 0) { sharps = false; }\r\n    num = Math.round(num);\r\n    var pcs = sharps === true ? SHARPS : FLATS;\r\n    var pc = pcs[num % 12];\r\n    var o = Math.floor(num / 12) - 1;\r\n    return pc + o;\r\n}\r\nvar simplify = function (note, sameAcc) {\r\n    if (sameAcc === void 0) { sameAcc = true; }\r\n    var _a = props(note), alt = _a.alt, chroma = _a.chroma, midi = _a.midi;\r\n    if (chroma === null)\r\n        return null;\r\n    var alteration = alt;\r\n    var useSharps = sameAcc === false ? alteration < 0 : alteration > 0;\r\n    return midi === null\r\n        ? pc(fromMidi(chroma, useSharps))\r\n        : fromMidi(midi, useSharps);\r\n};\r\nvar enharmonic = function (note) { return simplify(note, false); };\n\nexport { names, tokenize, props, name, pc, midi, midiToFreq, freq, freqToMidi, chroma, oct, stepToLetter, altToAcc, from, build, fromMidi, simplify, enharmonic };\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-array.svg?style=flat-square)](https://www.npmjs.com/package/tonal-array)\n *\n * Tonal array utilities. Create ranges, sort notes, ...\n *\n * @example\n * import * as Array;\n * Array.sort([\"f\", \"a\", \"c\"]) // => [\"C\", \"F\", \"A\"]\n *\n * @example\n * const Array = require(\"tonal-array\")\n * Array.range(1, 4) // => [1, 2, 3, 4]\n *\n * @module Array\n */\nimport { props, name } from \"tonal-note\";\n\n// ascending range\nfunction ascR(b, n) {\n  for (var a = []; n--; a[n] = n + b){ ; }\n  return a;\n}\n// descending range\nfunction descR(b, n) {\n  for (var a = []; n--; a[n] = b - n){ ; }\n  return a;\n}\n\n/**\n * Create a numeric range\n *\n * @param {Number} from\n * @param {Number} to\n * @return {Array}\n *\n * @example\n * Array.range(-2, 2) // => [-2, -1, 0, 1, 2]\n * Array.range(2, -2) // => [2, 1, 0, -1, -2]\n */\nexport function range(a, b) {\n  return a === null || b === null\n    ? []\n    : a < b\n      ? ascR(a, b - a + 1)\n      : descR(a, a - b + 1);\n}\n/**\n *\n * Rotates a list a number of times. It\"s completly agnostic about the\n * contents of the list.\n *\n * @param {Integer} times - the number of rotations\n * @param {Array} array\n * @return {Array} the rotated array\n * @example\n * Array.rotate(1, [1, 2, 3]) // => [2, 3, 1]\n */\nexport function rotate(times, arr) {\n  var len = arr.length;\n  var n = ((times % len) + len) % len;\n  return arr.slice(n, len).concat(arr.slice(0, n));\n}\n\n/**\n * Return a copy of the array with the null values removed\n * @function\n * @param {Array} array\n * @return {Array}\n *\n * @example\n * Array.compact([\"a\", \"b\", null, \"c\"]) // => [\"a\", \"b\", \"c\"]\n */\nexport var compact = function (arr) { return arr.filter(function (n) { return n === 0 || n; }); };\n\n// a function that get note heights (with negative number for pitch classes)\nvar height = function (name) {\n  var m = props(name).midi;\n  return m !== null ? m : props(name + \"-100\").midi;\n};\n\n/**\n * Sort an array of notes in ascending order\n *\n * @param {String|Array} notes\n * @return {Array} sorted array of notes\n */\nexport function sort(src) {\n  return compact(src.map(name)).sort(function (a, b) { return height(a) > height(b); });\n}\n\n/**\n * Get sorted notes with duplicates removed\n *\n * @function\n * @param {Array} notes\n */\nexport function unique(arr) {\n  return sort(arr).filter(function (n, i, a) { return i === 0 || n !== a[i - 1]; });\n}\n\n/**\n * Randomizes the order of the specified array in-place, using the Fisher–Yates shuffle.\n *\n * @private\n * @function\n * @param {Array|String} arr - the array\n * @return {Array} the shuffled array\n *\n * @example\n * Array.shuffle([\"C\", \"D\", \"E\", \"F\"])\n */\nexport var shuffle = function (arr, rnd) {\n  if ( rnd === void 0 ) rnd = Math.random;\n\n  var i, t;\n  var m = arr.length;\n  while (m) {\n    i = (rnd() * m--) | 0;\n    t = arr[m];\n    arr[m] = arr[i];\n    arr[i] = t;\n  }\n  return arr;\n};\n\n/**\n * Get all permutations of an array\n * http://stackoverflow.com/questions/9960908/permutations-in-javascript\n *\n * @param {Array} array - the array\n * @return {Array<Array>} an array with all the permutations\n */\nexport var permutations = function (arr) {\n  if (arr.length === 0) { return [[]]; }\n  return permutations(arr.slice(1)).reduce(function(acc, perm) {\n    return acc.concat(\n      arr.map(function(e, pos) {\n        var newPerm = perm.slice();\n        newPerm.splice(pos, 0, arr[0]);\n        return newPerm;\n      })\n    );\n  }, []);\n};\n","var IVL_TNL = \"([-+]?\\\\d+)(d{1,4}|m|M|P|A{1,4})\";\r\nvar IVL_STR = \"(AA|A|P|M|m|d|dd)([-+]?\\\\d+)\";\r\nvar REGEX = new RegExp(\"^\" + IVL_TNL + \"|\" + IVL_STR + \"$\");\r\nvar SIZES = [0, 2, 4, 5, 7, 9, 11];\r\nvar TYPES = \"PMMPPMM\";\r\nvar CLASSES = [0, 1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1];\r\nvar NAMES = \"1P 2m 2M 3m 3M 4P 5P 6m 6M 7m 7M 8P\".split(\" \");\r\nvar names = function (types) {\r\n    return typeof types !== \"string\"\r\n        ? NAMES.slice()\r\n        : NAMES.filter(function (n) { return types.indexOf(n[1]) !== -1; });\r\n};\r\nvar tokenize = function (str) {\r\n    var m = REGEX.exec(\"\" + str);\r\n    if (m === null)\r\n        return null;\r\n    return (m[1] ? [m[1], m[2]] : [m[4], m[3]]);\r\n};\r\nvar NO_IVL = Object.freeze({\r\n    name: null,\r\n    num: null,\r\n    q: null,\r\n    step: null,\r\n    alt: null,\r\n    dir: null,\r\n    type: null,\r\n    simple: null,\r\n    semitones: null,\r\n    chroma: null,\r\n    oct: null\r\n});\r\nvar fillStr = function (s, n) { return Array(Math.abs(n) + 1).join(s); };\r\nvar qToAlt = function (type, q) {\r\n    if (q === \"M\" && type === \"M\")\r\n        return 0;\r\n    if (q === \"P\" && type === \"P\")\r\n        return 0;\r\n    if (q === \"m\" && type === \"M\")\r\n        return -1;\r\n    if (/^A+$/.test(q))\r\n        return q.length;\r\n    if (/^d+$/.test(q))\r\n        return type === \"P\" ? -q.length : -q.length - 1;\r\n    return null;\r\n};\r\nvar altToQ = function (type, alt) {\r\n    if (alt === 0)\r\n        return type === \"M\" ? \"M\" : \"P\";\r\n    else if (alt === -1 && type === \"M\")\r\n        return \"m\";\r\n    else if (alt > 0)\r\n        return fillStr(\"A\", alt);\r\n    else if (alt < 0)\r\n        return fillStr(\"d\", type === \"P\" ? alt : alt + 1);\r\n    else\r\n        return null;\r\n};\r\nvar numToStep = function (num) { return (Math.abs(num) - 1) % 7; };\r\nvar properties = function (str) {\r\n    var t = tokenize(str);\r\n    if (t === null)\r\n        return NO_IVL;\r\n    var p = {\r\n        num: 0,\r\n        q: \"d\",\r\n        name: \"\",\r\n        type: \"M\",\r\n        step: 0,\r\n        dir: -1,\r\n        simple: 1,\r\n        alt: 0,\r\n        oct: 0,\r\n        semitones: 0,\r\n        chroma: 0,\r\n        ic: 0\r\n    };\r\n    p.num = +t[0];\r\n    p.q = t[1];\r\n    p.step = numToStep(p.num);\r\n    p.type = TYPES[p.step];\r\n    if (p.type === \"M\" && p.q === \"P\")\r\n        return NO_IVL;\r\n    p.name = \"\" + p.num + p.q;\r\n    p.dir = p.num < 0 ? -1 : 1;\r\n    p.simple = (p.num === 8 || p.num === -8\r\n        ? p.num\r\n        : p.dir * (p.step + 1));\r\n    p.alt = qToAlt(p.type, p.q);\r\n    p.oct = Math.floor((Math.abs(p.num) - 1) / 7);\r\n    p.semitones = p.dir * (SIZES[p.step] + p.alt + 12 * p.oct);\r\n    p.chroma = ((((p.dir * (SIZES[p.step] + p.alt)) % 12) + 12) %\r\n        12);\r\n    return Object.freeze(p);\r\n};\r\nvar cache = {};\r\nfunction props(str) {\r\n    if (typeof str !== \"string\")\r\n        return NO_IVL;\r\n    return cache[str] || (cache[str] = properties(str));\r\n}\r\nvar num = function (str) { return props(str).num; };\r\nvar name = function (str) { return props(str).name; };\r\nvar semitones = function (str) { return props(str).semitones; };\r\nvar chroma = function (str) { return props(str).chroma; };\r\nvar ic = function (ivl) {\r\n    if (typeof ivl === \"string\")\r\n        ivl = props(ivl).chroma;\r\n    return typeof ivl === \"number\" ? CLASSES[ivl % 12] : null;\r\n};\r\nvar build = function (_a) {\r\n    var _b = _a === void 0 ? {} : _a, num = _b.num, step = _b.step, alt = _b.alt, _c = _b.oct, oct = _c === void 0 ? 1 : _c, dir = _b.dir;\r\n    if (step !== undefined)\r\n        num = step + 1 + 7 * oct;\r\n    if (num === undefined)\r\n        return null;\r\n    if (typeof alt !== \"number\")\r\n        return null;\r\n    var d = typeof dir !== \"number\" ? \"\" : dir < 0 ? \"-\" : \"\";\r\n    var type = TYPES[numToStep(num)];\r\n    return (d + num + altToQ(type, alt));\r\n};\r\nvar simplify = function (str) {\r\n    var p = props(str);\r\n    if (p === NO_IVL)\r\n        return null;\r\n    var intervalProps = p;\r\n    return intervalProps.simple + intervalProps.q;\r\n};\r\nvar invert = function (str) {\r\n    var p = props(str);\r\n    if (p === NO_IVL)\r\n        return null;\r\n    var intervalProps = p;\r\n    var step = (7 - intervalProps.step) % 7;\r\n    var alt = intervalProps.type === \"P\" ? -intervalProps.alt : -(intervalProps.alt + 1);\r\n    return build({ step: step, alt: alt, oct: intervalProps.oct, dir: intervalProps.dir });\r\n};\r\nvar IN = [1, 2, 2, 3, 3, 4, 5, 5, 6, 6, 7, 7];\r\nvar IQ = \"P m M m M P d P m M m M\".split(\" \");\r\nvar fromSemitones = function (num) {\r\n    var d = num < 0 ? -1 : 1;\r\n    var n = Math.abs(num);\r\n    var c = n % 12;\r\n    var o = Math.floor(n / 12);\r\n    return d * (IN[c] + 7 * o) + IQ[c];\r\n};\n\nexport { names, tokenize, qToAlt, altToQ, props, num, name, semitones, chroma, ic, build, simplify, invert, fromSemitones };\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-distance.svg)](https://www.npmjs.com/package/tonal-distance)\n * [![tonal](https://img.shields.io/badge/tonal-distance-yellow.svg)](https://github.com/danigb/tonal/tree/master/packages/tonal/distance)\n *\n * Transpose notes by intervals and find distances between notes\n *\n * @example\n * // es6\n * import * as Distance from \"tonal-distance\"\n * Distance.interval(\"C3\", \"C4\") // => \"1P\"\n *\n * @example\n * // es6 import selected functions\n * import { interval, semitones, transpose } from \"tonal-distance\"\n *\n * semitones(\"C\" ,\"D\") // => 2\n * interval(\"C4\", \"G4\") // => \"5P\"\n * transpose(\"C4\", \"P5\") // => \"G4\"\n *\n * @example\n * // included in tonal facade\n * const Tonal = require(\"tonal\");\n * Tonal.Distance.transpose(\"C4\", \"P5\")\n * Tonal.Distance.transposeBy(\"P5\", \"C4\")\n *\n * @module Distance\n */\nimport { props as noteProps, build as fromNote } from \"tonal-note\";\nimport { props as iprops, build as ibuild } from \"tonal-interval\";\n\n// Map from letter step to number of fifths starting from \"C\":\n// { C: 0, D: 2, E: 4, F: -1, G: 1, A: 3, B: 5 }\nvar FIFTHS = [0, 2, 4, -1, 1, 3, 5];\n\n// Given a number of fifths, return the octaves they span\nvar fOcts = function (f) { return Math.floor((f * 7) / 12); };\n\n// Get the number of octaves it span each step\nvar FIFTH_OCTS = FIFTHS.map(fOcts);\n\nvar encode = function (ref) {\n  var step = ref.step;\n  var alt = ref.alt;\n  var oct = ref.oct;\n  var dir = ref.dir; if ( dir === void 0 ) dir = 1;\n\n  var f = FIFTHS[step] + 7 * alt;\n  if (oct === null) { return [dir * f]; }\n  var o = oct - FIFTH_OCTS[step] - 4 * alt;\n  return [dir * f, dir * o];\n};\n\n// We need to get the steps from fifths\n// Fifths for CDEFGAB are [ 0, 2, 4, -1, 1, 3, 5 ]\n// We add 1 to fifths to avoid negative numbers, so:\n// for [\"F\", \"C\", \"G\", \"D\", \"A\", \"E\", \"B\"] we have:\nvar STEPS = [3, 0, 4, 1, 5, 2, 6];\n\n// Return the number of fifths as if it were unaltered\nfunction unaltered(f) {\n  var i = (f + 1) % 7;\n  return i < 0 ? 7 + i : i;\n}\n\nvar decode = function (f, o, dir) {\n  var step = STEPS[unaltered(f)];\n  var alt = Math.floor((f + 1) / 7);\n  if (o === undefined) { return { step: step, alt: alt, dir: dir }; }\n  var oct = o + 4 * alt + FIFTH_OCTS[step];\n  return { step: step, alt: alt, oct: oct, dir: dir };\n};\n\nvar memo = function (fn, cache) {\n  if ( cache === void 0 ) cache = {};\n\n  return function (str) { return cache[str] || (cache[str] = fn(str)); };\n};\n\nvar encoder = function (props) { return memo(function (str) {\n    var p = props(str);\n    return p.name === null ? null : encode(p);\n  }); };\n\nvar encodeNote = encoder(noteProps);\nvar encodeIvl = encoder(iprops);\n\n/**\n * Transpose a note by an interval. The note can be a pitch class.\n *\n * This function can be partially applied.\n *\n * @param {String} note\n * @param {String} interval\n * @return {String} the transposed note\n * @example\n * import { tranpose } from \"tonal-distance\"\n * transpose(\"d3\", \"3M\") // => \"F#3\"\n * // it works with pitch classes\n * transpose(\"D\", \"3M\") // => \"F#\"\n * // can be partially applied\n * [\"C\", \"D\", \"E\", \"F\", \"G\"].map(transpose(\"M3)) // => [\"E\", \"F#\", \"G#\", \"A\", \"B\"]\n */\nexport function transpose(note, interval) {\n  if (arguments.length === 1) { return function (i) { return transpose(note, i); }; }\n  var n = encodeNote(note);\n  var i = encodeIvl(interval);\n  if (n === null || i === null) { return null; }\n  var tr = n.length === 1 ? [n[0] + i[0]] : [n[0] + i[0], n[1] + i[1]];\n  return fromNote(decode(tr[0], tr[1]));\n}\n\n/**\n * Transpose a pitch class by a number of perfect fifths.\n *\n * It can be partially applied.\n *\n * @function\n * @param {String} pitchClass - the pitch class\n * @param {Integer} fifhts - the number of fifths\n * @return {String} the transposed pitch class\n *\n * @example\n * import { trFifths } from \"tonal-transpose\"\n * [0, 1, 2, 3, 4].map(trFifths(\"C\")) // => [\"C\", \"G\", \"D\", \"A\", \"E\"]\n * // or using tonal\n * Distance.trFifths(\"G4\", 1) // => \"D\"\n */\n\nexport function trFifths(note, fifths) {\n  if (arguments.length === 1) { return function (f) { return trFifths(note, f); }; }\n  var n = encodeNote(note);\n  if (n === null) { return null; }\n  return fromNote(decode(n[0] + fifths));\n}\n\n/**\n * Get the distance in fifths between pitch classes\n *\n * Can be partially applied.\n *\n * @param {String} to - note or pitch class\n * @param {String} from - note or pitch class\n */\nexport function fifths(from, to) {\n  if (arguments.length === 1) { return function (to) { return fifths(from, to); }; }\n  var f = encodeNote(from);\n  var t = encodeNote(to);\n  if (t === null || f === null) { return null; }\n  return t[0] - f[0];\n}\n\n/**\n * The same as transpose with the arguments inverted.\n *\n * Can be partially applied.\n *\n * @param {String} note\n * @param {String} interval\n * @return {String} the transposed note\n * @example\n * import { tranposeBy } from \"tonal-distance\"\n * transposeBy(\"3m\", \"5P\") // => \"7m\"\n */\nexport function transposeBy(interval, note) {\n  if (arguments.length === 1) { return function (n) { return transpose(n, interval); }; }\n  return transpose(note, interval);\n}\n\nvar isDescending = function (e) { return e[0] * 7 + e[1] * 12 < 0; };\nvar decodeIvl = function (i) { return isDescending(i) ? decode(-i[0], -i[1], -1) : decode(i[0], i[1], 1); };\n\nexport function addIntervals(ivl1, ivl2, dir) {\n  var i1 = encodeIvl(ivl1);\n  var i2 = encodeIvl(ivl2);\n  if (i1 === null || i2 === null) { return null; }\n  var i = [i1[0] + dir * i2[0], i1[1] + dir * i2[1]];\n  return ibuild(decodeIvl(i));\n}\n\n/**\n * Add two intervals\n *\n * Can be partially applied.\n *\n * @param {String} interval1\n * @param {String} interval2\n * @return {String} the resulting interval\n * @example\n * import { add } from \"tonal-distance\"\n * add(\"3m\", \"5P\") // => \"7m\"\n */\nexport function add(ivl1, ivl2) {\n  if (arguments.length === 1) { return function (i2) { return add(ivl1, i2); }; }\n  return addIntervals(ivl1, ivl2, 1);\n}\n\n/**\n * Subtract two intervals\n *\n * Can be partially applied\n *\n * @param {String} minuend\n * @param {String} subtrahend\n * @return {String} interval diference\n */\nexport function subtract(ivl1, ivl2) {\n  if (arguments.length === 1) { return function (i2) { return add(ivl1, i2); }; }\n  return addIntervals(ivl1, ivl2, -1);\n}\n\n/**\n * Find the interval between two pitches. It works with pitch classes\n * (both must be pitch classes and the interval is always ascending)\n *\n * Can be partially applied\n *\n * @param {String} from - distance from\n * @param {String} to - distance to\n * @return {String} the interval distance\n *\n * @example\n * import { interval } from \"tonal-distance\"\n * interval(\"C2\", \"C3\") // => \"P8\"\n * interval(\"G\", \"B\") // => \"M3\"\n *\n * @example\n * import * as Distance from \"tonal-distance\"\n * Distance.interval(\"M2\", \"P5\") // => \"P4\"\n */\nexport function interval(from, to) {\n  if (arguments.length === 1) { return function (t) { return interval(from, t); }; }\n  var f = encodeNote(from);\n  var t = encodeNote(to);\n  if (f === null || t === null || f.length !== t.length) { return null; }\n  var d =\n    f.length === 1\n      ? [t[0] - f[0], -Math.floor(((t[0] - f[0]) * 7) / 12)]\n      : [t[0] - f[0], t[1] - f[1]];\n  return ibuild(decodeIvl(d));\n}\n\n/**\n * Get the distance between two notes in semitones\n *\n * @param {String|Pitch} from - first note\n * @param {String|Pitch} to - last note\n * @return {Integer} the distance in semitones or null if not valid notes\n * @example\n * import { semitones } from \"tonal-distance\"\n * semitones(\"C3\", \"A2\") // => -3\n * // or use tonal\n * Tonal.Distance.semitones(\"C3\", \"G3\") // => 7\n */\nexport function semitones(from, to) {\n  if (arguments.length === 1) { return function (t) { return semitones(from, t); }; }\n  var f = noteProps(from);\n  var t = noteProps(to);\n  return f.midi !== null && t.midi !== null\n    ? t.midi - f.midi\n    : f.chroma !== null && t.chroma !== null\n      ? (t.chroma - f.chroma + 12) % 12\n      : null;\n}\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-pcset.svg?style=flat-square)](https://www.npmjs.com/package/tonal-pcset)\n * [![tonal](https://img.shields.io/badge/tonal-pcset-yellow.svg?style=flat-square)](https://www.npmjs.com/browse/keyword/tonal)\n *\n * `tonal-pcset` is a collection of functions to work with pitch class sets, oriented\n * to make comparations (isEqual, isSubset, isSuperset)\n *\n * This is part of [tonal](https://www.npmjs.com/package/tonal) music theory library.\n *\n * You can install via npm: `npm i --save tonal-pcset`\n *\n * ```js\n * // es6\n * import PcSet from \"tonal-pcset\"\n * var PcSet = require(\"tonal-pcset\")\n *\n * PcSet.isEqual(\"c2 d5 e6\", \"c6 e3 d1\") // => true\n * ```\n *\n * ## API documentation\n *\n * @module PcSet\n */\nimport { chroma as notechr } from \"tonal-note\";\nimport { chroma as ivlchr } from \"tonal-interval\";\nimport { rotate, range, compact } from \"tonal-array\";\n\nvar chr = function (str) { return notechr(str) || ivlchr(str) || 0; };\nvar pcsetNum = function (set) { return parseInt(chroma(set), 2); };\nvar clen = function (chroma) { return chroma.replace(/0/g, \"\").length; };\n\n/**\n * Get chroma of a pitch class set. A chroma identifies each set uniquely.\n * It\"s a 12-digit binary each presenting one semitone of the octave.\n *\n * Note that this function accepts a chroma as parameter and return it\n * without modification.\n *\n * @param {Array|String} set - the pitch class set\n * @return {String} a binary representation of the pitch class set\n * @example\n * PcSet.chroma([\"C\", \"D\", \"E\"]) // => \"1010100000000\"\n */\nexport function chroma(set) {\n  if (isChroma(set)) { return set; }\n  if (!Array.isArray(set)) { return \"\"; }\n  var b = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n  set.map(chr).forEach(function (i) {\n    b[i] = 1;\n  });\n  return b.join(\"\");\n}\n\nvar all = null;\n/**\n * Get a list of all possible chromas (all possible scales)\n * More information: http://allthescales.org/\n * @return {Array} an array of possible chromas from '10000000000' to '11111111111'\n *\n */\nexport function chromas(n) {\n  all = all || range(2048, 4095).map(function (n) { return n.toString(2); });\n  return typeof n === \"number\"\n    ? all.filter(function (chroma) { return clen(chroma) === n; })\n    : all.slice();\n}\n\n/**\n * Given a a list of notes or a pcset chroma, produce the rotations\n * of the chroma discarding the ones that starts with \"0\"\n *\n * This is used, for example, to get all the modes of a scale.\n *\n * @param {Array|String} set - the list of notes or pitchChr of the set\n * @param {Boolean} normalize - (Optional, true by default) remove all\n * the rotations that starts with \"0\"\n * @return {Array<String>} an array with all the modes of the chroma\n *\n * @example\n * PcSet.modes([\"C\", \"D\", \"E\"]).map(PcSet.intervals)\n */\nexport function modes(set, normalize) {\n  normalize = normalize !== false;\n  var binary = chroma(set).split(\"\");\n  return compact(\n    binary.map(function(_, i) {\n      var r = rotate(i, binary);\n      return normalize && r[0] === \"0\" ? null : r.join(\"\");\n    })\n  );\n}\n\nvar REGEX = /^[01]{12}$/;\n/**\n * Test if the given string is a pitch class set chroma.\n * @param {String} chroma - the pitch class set chroma\n * @return {Boolean} true if its a valid pcset chroma\n * @example\n * PcSet.isChroma(\"101010101010\") // => true\n * PcSet.isChroma(\"101001\") // => false\n */\nexport function isChroma(set) {\n  return REGEX.test(set);\n}\n\nvar IVLS = \"1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M\".split(\" \");\n/**\n * Given a pcset (notes or chroma) return it\"s intervals\n * @param {String|Array} pcset - the pitch class set (notes or chroma)\n * @return {Array} intervals or empty array if not valid pcset\n * @example\n * PcSet.intervals(\"1010100000000\") => [\"1P\", \"2M\", \"3M\"]\n */\nexport function intervals(set) {\n  if (!isChroma(set)) { return []; }\n  return compact(\n    set.split(\"\").map(function(d, i) {\n      return d === \"1\" ? IVLS[i] : null;\n    })\n  );\n}\n\n/**\n * Test if two pitch class sets are identical\n *\n * @param {Array|String} set1 - one of the pitch class sets\n * @param {Array|String} set2 - the other pitch class set\n * @return {Boolean} true if they are equal\n * @example\n * PcSet.isEqual([\"c2\", \"d3\"], [\"c5\", \"d2\"]) // => true\n */\nexport function isEqual(s1, s2) {\n  if (arguments.length === 1) { return function (s) { return isEqual(s1, s); }; }\n  return chroma(s1) === chroma(s2);\n}\n\n/**\n * Create a function that test if a collection of notes is a\n * subset of a given set\n *\n * The function can be partially applied\n *\n * @param {Array|String} set - an array of notes or a chroma set string to test against\n * @param {Array|String} notes - an array of notes or a chroma set\n * @return {boolean} true if notes is a subset of set, false otherwise\n * @example\n * const inCMajor = PcSet.isSubsetOf([\"C\", \"E\", \"G\"])\n * inCMajor([\"e6\", \"c4\"]) // => true\n * inCMajor([\"e6\", \"c4\", \"d3\"]) // => false\n */\nexport function isSubsetOf(set, notes) {\n  if (arguments.length > 1) { return isSubsetOf(set)(notes); }\n  set = pcsetNum(set);\n  return function(notes) {\n    notes = pcsetNum(notes);\n    return notes !== set && (notes & set) === notes;\n  };\n}\n\n/**\n * Create a function that test if a collectio of notes is a\n * superset of a given set (it contains all notes and at least one more)\n *\n * @param {Array|String} set - an array of notes or a chroma set string to test against\n * @param {Array|String} notes - an array of notes or a chroma set\n * @return {boolean} true if notes is a superset of set, false otherwise\n * @example\n * const extendsCMajor = PcSet.isSupersetOf([\"C\", \"E\", \"G\"])\n * extendsCMajor([\"e6\", \"a\", \"c4\", \"g2\"]) // => true\n * extendsCMajor([\"c6\", \"e4\", \"g3\"]) // => false\n */\nexport function isSupersetOf(set, notes) {\n  if (arguments.length > 1) { return isSupersetOf(set)(notes); }\n  set = pcsetNum(set);\n  return function(notes) {\n    notes = pcsetNum(notes);\n    return notes !== set && (notes | set) === notes;\n  };\n}\n\n/**\n * Test if a given pitch class set includes a note\n * @param {Array|String} set - the base set to test against\n * @param {String|Pitch} note - the note to test\n * @return {Boolean} true if the note is included in the pcset\n * @example\n * PcSet.includes([\"C\", \"D\", \"E\"], \"C4\") // => true\n * PcSet.includes([\"C\", \"D\", \"E\"], \"C#4\") // => false\n */\nexport function includes(set, note) {\n  if (arguments.length > 1) { return includes(set)(note); }\n  set = chroma(set);\n  return function(note) {\n    return set[chr(note)] === \"1\";\n  };\n}\n\n/**\n * Filter a list with a pitch class set\n *\n * @param {Array|String} set - the pitch class set notes\n * @param {Array|String} notes - the note list to be filtered\n * @return {Array} the filtered notes\n *\n * @example\n * PcSet.filter([\"C\", \"D\", \"E\"], [\"c2\", \"c#2\", \"d2\", \"c3\", \"c#3\", \"d3\"]) // => [ \"c2\", \"d2\", \"c3\", \"d3\" ])\n * PcSet.filter([\"C2\"], [\"c2\", \"c#2\", \"d2\", \"c3\", \"c#3\", \"d3\"]) // => [ \"c2\", \"c3\" ])\n */\nexport function filter(set, notes) {\n  if (arguments.length === 1) { return function (n) { return filter(set, n); }; }\n  return notes.filter(includes(set));\n}\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-dictionary.svg)](https://www.npmjs.com/package/tonal-dictionary)\n *\n * `tonal-dictionary` contains a dictionary of musical scales and chords\n *\n * This is part of [tonal](https://www.npmjs.com/package/tonal) music theory library.\n *\n * @example\n * // es6\n * import * as Dictionary from \"tonal-dictionary\"\n * // es5\n * const Dictionary = require(\"tonal-dictionary\")\n *\n * @example\n * Dictionary.chord(\"Maj7\") // => [\"1P\", \"3M\", \"5P\", \"7M\"]\n *\n * @module Dictionary\n */\nimport sdata from \"./data/scales.json\";\nimport cdata from \"./data/chords.json\";\nimport { chroma } from \"tonal-pcset\";\n\nexport var dictionary = function (raw) {\n  var keys = Object.keys(raw).sort();\n  var data = [];\n  var index = [];\n\n  var add = function (name, ivls, chroma) {\n    data[name] = ivls;\n    index[chroma] = index[chroma] || [];\n    index[chroma].push(name);\n  };\n\n  keys.forEach(function (key) {\n    var ivls = raw[key][0].split(\" \");\n    var alias = raw[key][1];\n    var chr = chroma(ivls);\n\n    add(key, ivls, chr);\n    if (alias) { alias.forEach(function (a) { return add(a, ivls, chr); }); }\n  });\n  var allKeys = Object.keys(data).sort();\n\n  var dict = function (name) { return data[name]; };\n  dict.names = function (p) {\n    if (typeof p === \"string\") { return (index[p] || []).slice(); }\n    else { return (p === true ? allKeys : keys).slice(); }\n  };\n  return dict;\n};\n\nexport var combine = function (a, b) {\n  var dict = function (name) { return a(name) || b(name); };\n  dict.names = function (p) { return a.names(p).concat(b.names(p)); };\n  return dict;\n};\n\n/**\n * A dictionary of scales: a function that given a scale name (without tonic)\n * returns an array of intervals\n *\n * @function\n * @param {String} name\n * @return {Array} intervals\n * @example\n * import { scale } from \"tonal-dictionary\"\n * scale(\"major\") // => [\"1P\", \"2M\", ...]\n * scale.names(); // => [\"major\", ...]\n */\nexport var scale = dictionary(sdata);\n\n/**\n * A dictionary of chords: a function that given a chord type\n * returns an array of intervals\n *\n * @function\n * @param {String} type\n * @return {Array} intervals\n * @example\n * import { chord } from \"tonal-dictionary\"\n * chord(\"Maj7\") // => [\"1P\", \"3M\", ...]\n * chord.names(); // => [\"Maj3\", ...]\n */\nexport var chord = dictionary(cdata);\nexport var pcset = combine(scale, chord);\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-scale.svg?style=flat-square)](https://www.npmjs.com/package/tonal-scale)\n *\n * A scale is a collection of pitches in ascending or descending order.\n *\n * This module provides functions to get and manipulate scales.\n *\n * @example\n * // es6\n * import * as Scale from \"tonal-scale\"\n * // es5\n * const Scale = require(\"tonal-scale\");\n *\n * @example\n * Scale.notes(\"Ab bebop\") // => [ \"Ab\", \"Bb\", \"C\", \"Db\", \"Eb\", \"F\", \"Gb\", \"G\" ]\n * Scale.names() => [\"major\", \"minor\", ...]\n * @module Scale\n */\nimport { name as noteName, pc } from \"tonal-note\";\nimport {\n  modes as pcsetModes,\n  chroma,\n  isSubsetOf,\n  isSupersetOf\n} from \"tonal-pcset\";\nimport { transpose } from \"tonal-distance\";\nimport { scale, chord } from \"tonal-dictionary\";\nimport { compact, unique, rotate } from \"tonal-array\";\n\nvar NO_SCALE = Object.freeze({\n  name: null,\n  intervals: [],\n  names: [],\n  chroma: null,\n  setnum: null\n});\n\nvar properties = function (name) {\n  var intervals = scale(name);\n  if (!intervals) { return NO_SCALE; }\n  var s = { intervals: intervals, name: name };\n  s.chroma = chroma(intervals);\n  s.setnum = parseInt(s.chroma, 2);\n  s.names = scale.names(s.chroma);\n  return Object.freeze(s);\n};\n\nvar memoize = function (fn, cache) { return function (str) { return cache[str] || (cache[str] = fn(str)); }; };\n\n/**\n * Get scale properties. It returns an object with:\n * - name: the scale name\n * - names: a list with all possible names (includes the current)\n * - intervals: an array with the scale intervals\n * - chroma:  scale croma (see pcset)\n * - setnum: scale chroma number\n *\n * @function\n * @param {String} name - the scale name (without tonic)\n * @return {Object}\n */\nexport var props = memoize(properties, {});\n\n/**\n * Return the available scale names\n *\n * @function\n * @param {boolean} aliases - true to include aliases\n * @return {Array} the scale names\n *\n * @example\n * Scale.names() // => [\"maj7\", ...]\n */\nexport var names = scale.names;\n\n/**\n * Given a scale name, return its intervals. The name can be the type and\n * optionally the tonic (which is ignored)\n *\n * It retruns an empty array when no scale found\n *\n * @function\n * @param {String} name - the scale name (tonic and type, tonic is optional)\n * @return {Array<String>} the scale intervals if is a known scale or an empty\n * array if no scale found\n * @example\n * Scale.intervals(\"major\") // => [ \"1P\", \"2M\", \"3M\", \"4P\", \"5P\", \"6M\", \"7M\" ]\n */\nexport var intervals = function (name) {\n  var p = tokenize(name);\n  return props(p[1]).intervals;\n};\n\n/**\n * Get the notes (pitch classes) of a scale.\n *\n * Note that it always returns an array, and the values are only pitch classes.\n *\n * @function\n * @param {String} tonic\n * @param {String} nameOrTonic - the scale name or tonic (if 2nd param)\n * @param {String} [name] - the scale name without tonic\n * @return {Array} a pitch classes array\n *\n * @example\n * Scale.notes(\"C\", \"major\") // => [ \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\" ]\n * Scale.notes(\"C major\") // => [ \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\" ]\n * Scale.notes(\"C4\", \"major\") // => [ \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\" ]\n * Scale.notes(\"A4\", \"no-scale\") // => []\n * Scale.notes(\"blah\", \"major\") // => []\n */\nexport function notes(nameOrTonic, name) {\n  var p = tokenize(nameOrTonic);\n  name = name || p[1];\n  return intervals(name).map(transpose(p[0]));\n}\n\n/**\n * Check if the given name is a known scale from the scales dictionary\n *\n * @function\n * @param {String} name - the scale name\n * @return {Boolean}\n */\nexport function exists(name) {\n  var p = tokenize(name);\n  return scale(p[1]) !== undefined;\n}\n\n/**\n * Given a string with a scale name and (optionally) a tonic, split\n * that components.\n *\n * It retuns an array with the form [ name, tonic ] where tonic can be a\n * note name or null and name can be any arbitrary string\n * (this function doesn\"t check if that scale name exists)\n *\n * @function\n * @param {String} name - the scale name\n * @return {Array} an array [tonic, name]\n * @example\n * Scale.tokenize(\"C mixolydean\") // => [\"C\", \"mixolydean\"]\n * Scale.tokenize(\"anything is valid\") // => [\"\", \"anything is valid\"]\n * Scale.tokenize() // => [\"\", \"\"]\n */\nexport function tokenize(str) {\n  if (typeof str !== \"string\") { return [\"\", \"\"]; }\n  var i = str.indexOf(\" \");\n  var tonic = noteName(str.substring(0, i)) || noteName(str) || \"\";\n  var name = tonic !== \"\" ? str.substring(tonic.length + 1) : str;\n  return [tonic, name.length ? name : \"\"];\n}\n\n/**\n * Find mode names of a scale\n *\n * @function\n * @param {String} name - scale name\n */\nexport var modeNames = function (name) {\n  var ivls = intervals(name);\n  var tonics = notes(name);\n\n  return pcsetModes(ivls)\n    .map(function (chroma, i) {\n      var name = scale.names(chroma)[0];\n      if (name) { return [tonics[i] || ivls[i], name]; }\n    })\n    .filter(function (x) { return x; });\n};\n\n/**\n * Get all chords that fits a given scale\n *\n * @function\n * @param {String} name\n */\nexport var chords = function (name) {\n  var inScale = isSubsetOf(intervals(name));\n  return chord.names().filter(function (name) { return inScale(chord(name)); });\n};\n\n/**\n * Given an array of notes, return the scale: a pitch class set starting from\n * the first note of the array\n *\n * @function\n * @param {Array} notes\n * @return {Array}\n */\nexport var toScale = function (notes) {\n  var pcset = compact(notes.map(pc));\n  if (!pcset.length) { return pcset; }\n  var tonic = pcset[0];\n  var scale = unique(pcset);\n  return rotate(scale.indexOf(tonic), scale);\n};\n\n/**\n * Get all scales names that are a superset of the given one\n * (has the same notes and at least one more)\n *\n * @function\n * @param {String} name\n * @return {Array} a list of scale names\n */\nexport var supersets = function (name) {\n  if (!intervals(name).length) { return []; }\n  var isSuperset = isSupersetOf(intervals(name));\n  return scale.names().filter(function (name) { return isSuperset(scale(name)); });\n};\n\n/**\n * Find all scales names that are a subset of the given one\n * (has less notes but all from the given scale)\n *\n * @function\n * @param {String} name\n * @return {Array} a list of scale names\n */\nexport var subsets = function (name) {\n  var isSubset = isSubsetOf(intervals(name));\n  return scale.names().filter(function (name) { return isSubset(scale(name)); });\n};\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-chord.svg)](https://www.npmjs.com/package/tonal-chord)\n * [![tonal](https://img.shields.io/badge/tonal-chord-yellow.svg)](https://www.npmjs.com/browse/keyword/tonal)\n *\n * `tonal-chord` is a collection of functions to manipulate musical chords\n *\n * This is part of [tonal](https://www.npmjs.com/package/tonal) music theory library.\n *\n * @example\n * // es6\n * import * as Chord from \"tonal-chord\"\n * // es5\n * const Chord = require(\"tonal-chord\")\n *\n * @example\n * Chord.notes(\"CMaj7\") // => [\"C\", \"E\", \"G\", \"B\"]\n *\n * @module Chord\n */\nimport { tokenize as split } from \"tonal-note\";\nimport { transpose } from \"tonal-distance\";\nimport { chord } from \"tonal-dictionary\";\nimport { chroma, isSubsetOf, isSupersetOf } from \"tonal-pcset\";\n\n/**\n * Return the available chord names\n *\n * @function\n * @param {boolean} aliases - true to include aliases\n * @return {Array} the chord names\n *\n * @example\n * Chord.names() // => [\"maj7\", ...]\n */\nexport var names = chord.names;\n\nvar NO_CHORD = Object.freeze({\n  name: null,\n  names: [],\n  intervals: [],\n  chroma: null,\n  setnum: null\n});\n\nvar properties = function (name) {\n  var intervals = chord(name);\n  if (!intervals) { return NO_CHORD; }\n  var s = { intervals: intervals, name: name };\n  s.chroma = chroma(intervals);\n  s.setnum = parseInt(s.chroma, 2);\n  s.names = chord.names(s.chroma);\n  return s;\n};\n\nvar memo = function (fn, cache) {\n  if ( cache === void 0 ) cache = {};\n\n  return function (str) { return cache[str] || (cache[str] = fn(str)); };\n};\n\n/**\n * Get chord properties. It returns an object with:\n *\n * - name: the chord name\n * - names: a list with all possible names (includes the current)\n * - intervals: an array with the chord intervals\n * - chroma:  chord croma (see pcset)\n * - setnum: chord chroma number\n *\n * @function\n * @param {String} name - the chord name (without tonic)\n * @return {Object} an object with the properties or a object with all properties\n * set to null if not valid chord name\n */\nexport var props = memo(properties);\n\n/**\n * Get chord intervals. It always returns an array\n *\n * @function\n * @param {String} name - the chord name (optionally a tonic and type)\n * @return {Array<String>} a list of intervals or null if the type is not known\n */\nexport var intervals = function (name) { return props(tokenize(name)[1]).intervals; };\n\n/**\n * Get the chord notes of a chord. This function accepts either a chord name\n * (for example: \"Cmaj7\") or a list of notes.\n *\n * It always returns an array, even if the chord is not found.\n *\n * @function\n * @param {String} nameOrTonic - name of the chord or the tonic (if the second parameter is present)\n * @param {String} [name] - (Optional) name if the first parameter is the tonic\n * @return {Array} an array of notes or an empty array\n *\n * @example\n * Chord.notes(\"Cmaj7\") // => [\"C\", \"E\", \"G\", \"B\"]\n * Chord.notes(\"C\", \"maj7\") // => [\"C\", \"E\", \"G\", \"B\"]\n */\nexport function notes(nameOrTonic, name) {\n  if (name) { return props(name).intervals.map(transpose(nameOrTonic)); }\n  var ref = tokenize(nameOrTonic);\n  var tonic = ref[0];\n  var type = ref[1];\n  return props(type).intervals.map(transpose(tonic));\n}\n\n/**\n * Check if a given name correspond to a chord in the dictionary\n *\n * @function\n * @param {String} name\n * @return {Boolean}\n * @example\n * Chord.exists(\"CMaj7\") // => true\n * Chord.exists(\"Maj7\") // => true\n * Chord.exists(\"Ablah\") // => false\n */\nexport var exists = function (name) { return chord(tokenize(name)[1]) !== undefined; };\n\n/**\n * Get all chords names that are a superset of the given one\n * (has the same notes and at least one more)\n *\n * @function\n * @param {String} name\n * @return {Array} a list of chord names\n */\nexport var supersets = function (name) {\n  if (!intervals(name).length) { return []; }\n  var isSuperset = isSupersetOf(intervals(name));\n  return chord.names().filter(function (name) { return isSuperset(chord(name)); });\n};\n\n/**\n * Find all chords names that are a subset of the given one\n * (has less notes but all from the given chord)\n *\n * @function\n * @param {String} name\n * @return {Array} a list of chord names\n */\nexport var subsets = function (name) {\n  var isSubset = isSubsetOf(intervals(name));\n  return chord.names().filter(function (name) { return isSubset(chord(name)); });\n};\n\n// 6, 64, 7, 9, 11 and 13 are consider part of the chord\n// (see https://github.com/danigb/tonal/issues/55)\nvar NUM_TYPES = /^(6|64|7|9|11|13)$/;\n/**\n * Tokenize a chord name. It returns an array with the tonic and chord type\n * If not tonic is found, all the name is considered the chord name.\n *\n * This function does NOT check if the chord type exists or not. It only tries\n * to split the tonic and chord type.\n *\n * @function\n * @param {String} name - the chord name\n * @return {Array} an array with [type, tonic]\n * @example\n * Chord.tokenize(\"Cmaj7\") // => [ \"C\", \"maj7\" ]\n * Chord.tokenize(\"C7\") // => [ \"C\", \"7\" ]\n * Chord.tokenize(\"mMaj7\") // => [ \"\", \"mMaj7\" ]\n * Chord.tokenize(\"Cnonsense\") // => [ \"C\", \"nonsense\" ]\n */\nexport function tokenize(name) {\n  var p = split(name);\n  if (p[0] === \"\") { return [\"\", name]; }\n  // aug is augmented (see https://github.com/danigb/tonal/issues/55)\n  if (p[0] === \"A\" && p[3] === \"ug\") { return [\"\", \"aug\"]; }\n\n  if (NUM_TYPES.test(p[2])) {\n    return [p[0] + p[1], p[2] + p[3]];\n  } else {\n    return [p[0] + p[1] + p[2], p[3]];\n  }\n}\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-key.svg?style=flat-square)](https://www.npmjs.com/package/tonal-key)\n *\n * The `Tonal` module is a facade to the rest of the modules. They are namespaced,\n * so for example to use `pc` function from `tonal-note` you have to write:\n * `Tonal.Note.pc`\n *\n * It exports the following modules:\n * - Note\n * - Interval\n * - Distance\n * - Scale\n * - Chord\n * - PcSet\n *\n * Additionally this facade exports some functions without namespace (see \"Methods\" below)\n *\n * @example\n * // es6 modules\n * import * as Tonal from \"tonal\"\n * Tonal.Note.name(\"cx\") // => \"C##\"\n *\n * @example\n * import { Note } from \"tonal\"\n * Note.name(\"bb\") // => \"Bb\"\n *\n * @example\n * // es5 node modules\n * var Tonal = require(\"tonal\");\n * Tonal.Distance.transpose(Tonal.Note.pc(\"C#2\"), \"M3\") // => \"E#\"\n * Tonal.Chord.notes(\"Dmaj7\") // => [\"D\", \"F#\", \"A\", \"C#\"]\n *\n * @module Tonal\n */\nimport * as Array from \"tonal-array\";\nimport * as Note from \"tonal-note\";\nimport * as Interval from \"tonal-interval\";\nimport * as Distance from \"tonal-distance\";\nimport * as Dictionary from \"tonal-dictionary\";\nimport * as Scale from \"tonal-scale\";\nimport * as Chord from \"tonal-chord\";\nimport * as PcSet from \"tonal-pcset\";\n\nexport { Array, Note, Interval, Distance, Scale, Chord, PcSet, Dictionary };\n\n/**\n * Transpose a note by an interval\n * @function\n * @param {String} note\n * @param {String} interval\n * @return {String} the transported note\n * @see Distance.transpose\n */\nexport const transpose = Distance.transpose;\n\n/**\n * Get the interval from two notes\n * @function\n * @param {String} from\n * @param {String} to\n * @return {String} the interval in reverse shorthand notation\n * @see Distance.interval\n */\nexport const interval = Distance.interval;\n\n/**\n * Get note properties\n * @function\n * @param {String} note - the note name\n * @return {Object}\n * @see Note.props\n * @example\n * Tonal.note(\"A4\").chroma // => 9\n */\nexport const note = Note.props;\n\n/**\n * Get midi note number\n * @function\n * @param {String} note\n * @return {Number}\n * @see Note.midi\n * @example\n * Tonal.midi(\"A4\") // => 49\n */\nexport const midi = Note.midi;\n\n/**\n * Get note frequency using equal tempered tuning at 440\n * @function\n * @param {String} note\n * @return {Number}\n * @see Note.freq\n * @example\n * Tonal.freq(\"A4\") // => 440\n */\nexport const freq = Note.freq;\n\n/**\n * Get intervals from a chord type\n * @function\n * @param {String} type - the chord type (no tonic)\n * @return {Array} an array of intervals or undefined if the chord type is not known\n * @see Dictionary.chord\n * @example\n * Tonal.chord(\"m7b5\") // => [\"1P\", \"3m\", \"5d\", \"7m\"]\n */\nexport const chord = Dictionary.chord;\n\n/**\n * Get intervals from scale name\n * @function\n * @param {String} name - the scale name (without tonic)\n * @return {Array} an array of intervals or undefiend if the scale is not kown\n * @example\n * Tonal.scale(\"major\") // => [\"1P\", \"2M\", \"3M\"...]\n */\nexport const scale = Dictionary.scale;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tonal_1 = require(\"tonal\");\nvar tonal_2 = require(\"tonal\");\nvar tonal_3 = require(\"tonal\");\nvar tonal_4 = require(\"tonal\");\nvar Harmony = /** @class */ (function () {\n    function Harmony() {\n    }\n    Harmony.isBlack = function (note) {\n        return tonal_1.Note.props(note)['acc'] !== '';\n    };\n    Harmony.isSameNote = function (noteA, noteB) {\n        return tonal_1.Note.midi(noteA) === tonal_1.Note.midi(noteB);\n    };\n    Harmony.getTonalChord = function (chord) {\n        if (!chord) {\n            return null;\n        }\n        chord = chord\n            .replace(/([A-G][b|#]?)(69)/, '$1M69')\n            .replace('-', 'm')\n            .replace('^', 'M')\n            .replace('h7', 'm7b5')\n            .replace('h', 'dim');\n        /**\n         * Chords that dont work:\n         * slash cords are ignored\n         * 7b9b5 does not work\n         *\n         */\n        var tokens = tonal_2.Chord.tokenize(chord);\n        var s = tokens[1].split('/');\n        return tokens[0] + (s[0] || 'M');\n    };\n    Harmony.getBassNote = function (chord) {\n        if (!chord) {\n            return null;\n        }\n        if (chord.includes('/')) {\n            return chord.split('/')[1];\n        }\n        return chord.match((/[A-G][b|#]?/))[0];\n    };\n    Harmony.getMidi = function (note, offset) {\n        if (offset === void 0) { offset = 0; }\n        return tonal_1.Note.midi(note) - offset;\n    };\n    Harmony.intervalComplement = function (interval) {\n        var fix = {\n            '8P': '1P',\n            '8d': '1A',\n            '8A': '1d',\n            '1A': '8d',\n            '1d': '8A',\n        };\n        var fixIndex = Object.keys(fix).find(function (key) { return interval.match(key); });\n        if (fixIndex) {\n            return fix[fixIndex];\n        }\n        return tonal_3.Interval.invert(interval);\n    };\n    Harmony.invertInterval = function (interval) {\n        if (!interval) {\n            return null;\n        }\n        var positive = interval.replace('-', '');\n        var complement = Harmony.intervalComplement(positive);\n        var isNegative = interval.length > positive.length;\n        return (isNegative ? '' : '-') + complement;\n    };\n    /** Transforms interval into one octave (octave+ get octaved down) */\n    Harmony.fixInterval = function (interval, simplify) {\n        if (interval === void 0) { interval = ''; }\n        if (simplify === void 0) { simplify = false; }\n        var fix = {\n            '0A': '1P',\n            '-0A': '1P',\n        };\n        if (simplify) {\n            fix = __assign({}, fix, { '8P': '1P', '-8P': '1P' });\n            interval = tonal_3.Interval.simplify(interval);\n        }\n        if (Object.keys(fix).includes(interval)) {\n            return fix[interval];\n        }\n        return interval;\n    };\n    /** inverts the interval if it does not go to the desired direction */\n    Harmony.forceDirection = function (interval, direction, noUnison) {\n        if (noUnison === void 0) { noUnison = false; }\n        var semitones = tonal_3.Interval.semitones(interval);\n        if ((direction === 'up' && semitones < 0) ||\n            (direction === 'down' && semitones > 0)) {\n            return Harmony.invertInterval(interval);\n        }\n        if (interval === '1P' && noUnison) {\n            return (direction === 'down' ? '-' : '') + '8P';\n        }\n        return interval;\n    };\n    // use Interval.ic?\n    Harmony.minInterval = function (interval, direction, noUnison) {\n        interval = Harmony.fixInterval(interval, true);\n        if (direction) {\n            return Harmony.forceDirection(interval, direction, noUnison);\n        }\n        var inversion = Harmony.invertInterval(interval);\n        if (Math.abs(tonal_3.Interval.semitones(inversion)) < Math.abs(tonal_3.Interval.semitones(interval))) {\n            interval = inversion;\n        }\n        return interval;\n    };\n    // returns array of intervals that lead the voices of chord A to chordB\n    Harmony.minIntervals = function (chordA, chordB) {\n        return chordA.map(function (n, i) { return Harmony.minInterval(tonal_4.Distance.interval(n, chordB[i])); });\n    };\n    Harmony.mapMinInterval = function (direction) {\n        return function (interval) { return Harmony.minInterval(interval, direction); };\n    };\n    // sort function\n    Harmony.sortMinInterval = function (preferredDirection, accessor) {\n        if (preferredDirection === void 0) { preferredDirection = 'up'; }\n        if (accessor === void 0) { accessor = (function (i) { return i; }); }\n        return function (a, b) {\n            var diff = Math.abs(tonal_3.Interval.semitones(accessor(a))) - Math.abs(tonal_3.Interval.semitones(accessor(b)));\n            if (diff === 0) {\n                return preferredDirection === 'up' ? -1 : 1;\n            }\n            return diff;\n        };\n    };\n    /** Returns the note with the least distance to \"from\" */\n    Harmony.getNearestNote = function (from, to, direction) {\n        var interval = Harmony.minInterval(tonal_4.Distance.interval(tonal_1.Note.pc(from), tonal_1.Note.pc(to)), direction);\n        return tonal_4.Distance.transpose(from, interval) + '';\n    };\n    /** Returns the note with the least distance to \"from\". TODO: add range */\n    Harmony.getNearestTargets = function (from, targets, preferredDirection, flip) {\n        if (preferredDirection === void 0) { preferredDirection = 'down'; }\n        if (flip === void 0) { flip = false; }\n        var intervals = targets\n            .map(function (target) { return tonal_4.Distance.interval(tonal_1.Note.pc(from), target); })\n            .map(Harmony.mapMinInterval(preferredDirection))\n            .sort(Harmony.sortMinInterval(preferredDirection));\n        /* if (flip) {\n            intervals = intervals.reverse();\n        } */\n        return intervals.map(function (i) { return tonal_4.Distance.transpose(from, i); });\n    };\n    Harmony.intervalMatrix = function (from, to) {\n        return to.map(function (note) { return from\n            .map(function (n) {\n            return tonal_4.Distance.interval(n, note);\n        })\n            .map(function (d) { return Harmony.minInterval(d); }); }\n        /* .map(i => i.slice(0, 2) === '--' ? i.slice(1) : i) */\n        );\n    };\n    return Harmony;\n}());\nexports.Harmony = Harmony;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar Instrument = /** @class */ (function () {\n    function Instrument(_a) {\n        var _b = _a === void 0 ? {} : _a, context = _b.context, gain = _b.gain, mix = _b.mix, onTrigger = _b.onTrigger, midiOffset = _b.midiOffset;\n        this.midiOffset = 0;\n        this.gain = 1;\n        this.activeEvents = [];\n        this.onTrigger = onTrigger;\n        this.midiOffset = midiOffset || this.midiOffset;\n        this.gain = gain || this.gain;\n        this.init({ context: context, mix: mix });\n    }\n    Instrument.prototype.init = function (_a) {\n        var context = _a.context, mix = _a.mix;\n        if (!context && (!mix || !mix.context)) {\n            console.warn(\"you should pass a context or a mix (gainNode) to a new Instrument. \\n            You can also Call init with {context,mix} to setup the Instrument later\");\n            return;\n        }\n        this.context = context || mix.context;\n        this.mix = mix || this.context.destination;\n    };\n    Instrument.prototype.playNotes = function (notes, settings) {\n        var _this = this;\n        if (settings === void 0) { settings = {}; }\n        var deadline = (settings.deadline || this.context.currentTime);\n        settings = Object.assign({\n            duration: 2000,\n            gain: 1,\n        }, settings, { deadline: deadline });\n        if (settings.interval) {\n            // call recursively with single notes at interval\n            return notes.map(function (note, index) {\n                _this.playNotes([note], Object.assign({}, settings, {\n                    interval: 0,\n                    deadline: deadline + index * settings.interval\n                }));\n            });\n        }\n        var midi = notes.map(function (note) { return Harmony_1.Harmony.getMidi(note, _this.midiOffset); });\n        var noteOff = settings.deadline + settings.duration / 1000;\n        var notesOn = notes.map(function (note, index) { return ({\n            note: note,\n            midi: midi[index],\n            gain: settings.gain,\n            noteOff: noteOff,\n            deadline: settings.deadline\n        }); });\n        if (settings.pulse && this.onTrigger) {\n            settings.pulse.clock.callbackAtTime(function (deadline) {\n                _this.activeEvents = _this.activeEvents.concat(notesOn);\n                _this.onTrigger({ on: notesOn, off: [], active: _this.activeEvents });\n            }, settings.deadline);\n        }\n        if (settings.duration && settings.pulse) {\n            settings.pulse.clock.callbackAtTime(function (deadline) {\n                // find out which notes need to be deactivated\n                var notesOff = notes\n                    .filter(function (note) { return !_this.activeEvents\n                    .find(function (event) {\n                    var keep = note === event.note && event.noteOff > deadline;\n                    if (keep) {\n                        console.log('keep', note);\n                    }\n                    return keep;\n                }); }).map(function (note) { return _this.activeEvents.find(function (e) { return e.note === note; }); });\n                _this.activeEvents = _this.activeEvents\n                    .filter(function (e) { return !notesOff.includes(e); });\n                if (_this.onTrigger) {\n                    _this.onTrigger({ on: [], off: notesOff, active: _this.activeEvents });\n                }\n            }, noteOff);\n        }\n        return this.playKeys(midi, settings);\n    };\n    Instrument.prototype.playKeys = function (keys, settings) {\n        // TODO: fire callbacks after keys.map((key,i)=>i*settings.interval)?\n    };\n    return Instrument;\n}());\nexports.Instrument = Instrument;\n","\"use strict\";\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Chord = __importStar(require(\"tonal-chord\"));\nvar Scale = __importStar(require(\"tonal-scale\"));\nexports.chords = [\n    {\n        symbol: 'm',\n        long: 'minor',\n        short: '-',\n        groups: ['Basic', 'Triads']\n    },\n    {\n        symbol: 'M',\n        long: 'major',\n        short: '△',\n        groups: ['Basic', 'Triads']\n    },\n    {\n        symbol: 'o',\n        groups: ['Basic', 'Symmetric', 'Triads'],\n        long: 'Vermindert'\n        /* short: 'o' */\n    },\n    {\n        symbol: 'M#5',\n        groups: ['Advanced', 'Symmetric', 'Triads'],\n        short: '△#5'\n    },\n    {\n        symbol: 'Msus4',\n        groups: ['Advanced', 'Symmetric'],\n        short: 'sus4'\n    },\n    {\n        symbol: 'Msus2',\n        groups: ['Advanced', 'Symmetric'],\n        short: 'sus2'\n    },\n    // 5 4 64 m#5 Mb5  7no5  \n    {\n        symbol: '7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Dominantsept'\n    },\n    {\n        symbol: '7#11',\n        groups: ['Advanced', 'Diatonic', 'Modes'],\n        long: 'Dominant #11'\n    },\n    {\n        symbol: 'M6',\n        groups: ['Advanced'],\n        long: 'major 6',\n        short: '6'\n    },\n    {\n        symbol: 'o7',\n        groups: ['Advanced', 'Symmetric', 'Diatonic'],\n        long: 'Vermindert 7',\n    },\n    {\n        symbol: 'm7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'minor 7',\n        short: '-7'\n    },\n    {\n        symbol: 'oM7',\n        groups: ['Expert'],\n        long: 'diminished major 7',\n        short: 'o△7'\n    },\n    {\n        symbol: 'm7b5',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Halbvermindert',\n        short: '-7b5'\n    },\n    {\n        symbol: '7#5',\n        groups: ['Advanced', 'Symmetric'],\n        long: 'Dominantsept #5'\n    },\n    {\n        symbol: 'Maj7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Major 7',\n        short: '△7'\n    },\n    {\n        symbol: 'mMaj7',\n        short: '-△7',\n        groups: ['Advanced', 'Diatonic']\n    },\n    {\n        symbol: 'M7#5',\n        groups: ['Advanced', 'Diatonic'],\n        short: '△7#5'\n    },\n    {\n        symbol: '7sus4',\n        groups: ['Advanced'],\n    },\n    {\n        symbol: '9',\n        groups: ['Advanced'],\n    },\n    {\n        symbol: 'M9',\n        groups: ['Advanced'],\n        short: '△9'\n    },\n    {\n        symbol: 'M69',\n        groups: ['Advanced'],\n        short: '69'\n    }\n    /*\n7b13 M7b5 m7#5 9no5  M7b6 7b5 Madd9 mb6b9 mb6M7 madd4 sus24 madd9 Maddb9 +add#9 M7sus4 7#5sus4 M#5add9 M7#5sus4\n11 m9 m6 9#5 7b9 7#9 M69 9b5 m69 mM9 7b6 m9b5 m9#5 7#11 M7b9 9b13 o7M7 M9b5 11b9 M9#5 7add6 M6#11 M7#11 7#5#9 13no5 9sus4 7#5b9 M9sus4 7sus4b9 m7add11 mMaj7b6 M9#5sus4\n13 m11 M13 9#11 13#9 13b5 13b9 m11b5 7b9#9 mM9b6 M9#11 9#5#11 7#9b13 7b9b13 13sus4 m11A 5 7#9#11 7b9#11 M69#11 7#11b13 M7#9#11 M7add13 7#5b9#11 7sus4b9b13\nm13 13#11 M13#11 13b9#11 9#11b13 13#9#11 7b9b13#11 7#9#11b13\n    */\n];\nexports.scales = [\n    {\n        symbol: 'major pentatonic',\n        groups: ['Basic', 'Pentatonic'],\n    },\n    {\n        symbol: 'minor pentatonic',\n        groups: ['Basic', 'Pentatonic'],\n    },\n    {\n        symbol: 'minor blues',\n        groups: ['Basic'],\n    },\n    // gregorian modes\n    {\n        symbol: 'major',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'dorian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'phrygian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'lydian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'mixolydian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'aeolian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'locrian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'whole tone',\n        groups: ['Advanced', 'Symmetric']\n    },\n    {\n        symbol: 'diminished',\n        groups: ['Advanced', 'Symmetric']\n    },\n    //HTGT ?\n    {\n        symbol: 'augmented',\n        groups: ['Advanced', 'Symmetric']\n    },\n    {\n        symbol: 'chromatic',\n        groups: ['Expert', 'Symmetric']\n    },\n    // harmonic minor modes\n    {\n        symbol: 'harmonic minor',\n        groups: ['Advanced', 'Diatonic']\n    },\n    // HM 2 locrian #6 !\n    {\n        symbol: 'ionian augmented',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'dorian #4',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'spanish',\n        groups: ['Advanced', 'Diatonic']\n    },\n    // HM 6 lydian #9\n    // HM 7 ???\n    // melodic minor modes\n    {\n        symbol: 'melodic minor',\n        groups: ['Advanced', 'Diatonic']\n    },\n    {\n        symbol: 'melodic minor second mode',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'lydian augmented',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'lydian dominant',\n        groups: ['Advanced', 'Diatonic'],\n        long: 'mixolydian #11'\n    },\n    {\n        symbol: 'melodic minor fifth mode',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'locrian #2',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'altered',\n        groups: ['Advanced', 'Diatonic']\n    },\n    //non european\n    {\n        symbol: 'kumoijoshi',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'iwato',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'pelog',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    // hyojo?\n    {\n        symbol: 'egyptian',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'in-sen',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'scriabin',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'ritusen',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'hirajoshi',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'malkos raga',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'vietnamese 1',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    /* {\n        symbol: 'vietnamese 2',\n        groups: ['Exotic', 'Pentatonic'] // = minor pentatonic\n    }, */\n    {\n        symbol: 'lydian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'mixolydian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'ionian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'locrian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'flat six pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'minor six pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'minor #7M pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'lydian #5P pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'whole tone pentatonic',\n        groups: ['Pentatonic', 'Symmetric']\n    },\n    {\n        symbol: 'flat three pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'super locrian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'major flat two pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'lydian dominant pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'neopolitan major pentatonic',\n        groups: ['Pentatonic']\n    }\n    /*\n    mystery #1 piongio    prometheus major blues minor hexatonic six tone symmetric prometheus neopolitan\n     persian  spanish  oriental flamenco balinese   todi raga enigmatic lydian #9 neopolitan locrian #2  lydian minor  locrian major  romanian minor harmonic major hungarian major hungarian minor lydian dominant   neopolitan minor neopolitan major lydian diminished leading whole tone augmented heptatonic double harmonic major double harmonic lydian melodic minor fifth mode melodic minor second mode\n    bebop kafi raga  purvi raga ichikosucho bebop minor minor bebop bebop major bebop locrian bebop dominant spanish heptatonic minor six diminished\n    composite blues\n    */\n];\nexports.symbols = { chords: exports.chords, scales: exports.scales };\nexports.levels = ['Basic', 'Advanced', 'Expert'];\nfunction groupFilter(group) {\n    return function (item) {\n        var level = Math.max(item.groups.filter(function (group) { return exports.levels.indexOf(group) !== -1; })\n            .map(function (group) { return exports.levels.indexOf(group) + 1; }));\n        var groups = level > 0 ? Array.from(new Set(exports.levels.slice(level).concat(item.groups))) : item.groups;\n        return groups.indexOf(group) !== -1;\n    };\n}\nexports.groupFilter = groupFilter;\nfunction scaleNames(group) {\n    if (group === void 0) { group = 'Basic'; }\n    if (!group || group === 'All') {\n        return Scale.names();\n    }\n    return exports.scales.filter(groupFilter(group))\n        .map(function (scale) { return scale.symbol; });\n}\nexports.scaleNames = scaleNames;\nfunction chordNames(group) {\n    if (group === void 0) { group = 'Basic'; }\n    if (!group || group === 'All') {\n        return Chord.names();\n    }\n    return exports.chords.filter(groupFilter(group))\n        .map(function (scale) { return scale.symbol; });\n}\nexports.chordNames = chordNames;\nfunction groupNames() {\n    return Array.from(new Set(exports.levels.concat(exports.scales.concat(exports.chords)\n        .map(function (item) { return item.groups; })\n        .reduce(function (groups, current) { return groups.concat(current); })))).concat(['All']);\n}\nexports.groupNames = groupNames;\nfunction symbolName(type, symbol, long) {\n    var pool = exports.symbols[type + 's'];\n    var match = pool.find(function (item) { return item.symbol === symbol; });\n    if (!match) {\n        return symbol;\n    }\n    /* return symbol; */\n    return (long ? match.long : match.short) || symbol;\n}\nexports.symbolName = symbolName;\nfunction scaleName(symbol, long) {\n    if (long === void 0) { long = false; }\n    return symbolName('scale', symbol, long);\n}\nexports.scaleName = scaleName;\nfunction chordName(symbol, long) {\n    if (long === void 0) { long = false; }\n    return symbolName('chord', symbol, long);\n}\nexports.chordName = chordName;\nfunction randomItem(array) {\n    return array[Math.floor(Math.random() * array.length)];\n}\nexports.randomItem = randomItem;\nfunction randomScale(group) {\n    return randomItem(scaleNames(group));\n}\nexports.randomScale = randomScale;\nfunction randomChord(group) {\n    return randomItem(chordNames(group));\n}\nexports.randomChord = randomChord;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tonal_1 = require(\"tonal\");\nvar Synthesizer_1 = require(\"../instruments/Synthesizer\");\nvar symbols_1 = require(\"../symbols\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar steps = {\n    '1P': ['1', '8'],\n    '2m': ['b9', 'b2'],\n    '2M': ['9', '2',],\n    '2A': ['#9', '#2'],\n    '3m': ['b3'],\n    '3M': ['3'],\n    '4P': ['11', '4'],\n    '4A': ['#11', '#4'],\n    '5d': ['b5'],\n    '5P': ['5'],\n    '5A': ['#5'],\n    '6m': ['b13', 'b6'],\n    '6M': ['13', '6'],\n    '7m': ['b7'],\n    '7M': ['7', '^7', 'maj7']\n};\n/*\nLower Interval Limits (just guidelines):\n2m: E3-F3\n2M: Eb3-F3\n3m: C3-Eb3\n3M: Bb2-D3\n4P: Bb2-Eb3\n5D: B2-F3\n5P: Bb1-F2\n6m: F2-Db3\n6M: F2-D3\n7m: F2-Eb3\n7m: F2-E3\n8P: -\n\nmore rough: top note should be D3 or higher.\ntaken from https://www.youtube.com/watch?v=iW6YeDJklhQ\n*/\nfunction randomNumber(n) {\n    return Math.floor(Math.random() * n);\n}\nexports.randomNumber = randomNumber;\nfunction arraySum(array) {\n    return array.reduce(function (s, i) { return s + i; }, 0);\n}\nexports.arraySum = arraySum;\nfunction randomElement(array, weighted) {\n    if (!weighted) {\n        return array[randomNumber(array.length)];\n    }\n    var r = randomNumber(arraySum(weighted)) + 1;\n    var total = weighted\n        .reduce(function (abs, w, i) { return abs.concat(w + (abs.length ? abs[i - 1] : 0)); }, []);\n    return array[total.indexOf(total.find(function (s, i) { return s >= r; }))];\n}\nexports.randomElement = randomElement;\nfunction shuffleArray(a) {\n    var _a;\n    for (var i = a.length - 1; i > 0; i--) {\n        var j = Math.floor(Math.random() * (i + 1));\n        _a = [a[j], a[i]], a[i] = _a[0], a[j] = _a[1];\n    }\n    return a;\n}\nexports.shuffleArray = shuffleArray;\n/** OLD SHEET / RHYTHM STUFF */\n/** Travels path along measures */\nfunction getPath(path, measures, traveled) {\n    if (traveled === void 0) { traveled = []; }\n    if (!Array.isArray(measures[path[0]]) || path.length === 1) {\n        return measures[Math.min(path[0], measures.length - 1)];\n    }\n    return this.getPath(path.slice(1), measures[path[0]], traveled.concat(path[0]));\n}\nexports.getPath = getPath;\nfunction getDuration(divisions, noteLength, measureLength) {\n    if (noteLength === void 0) { noteLength = 1; }\n    if (measureLength === void 0) { measureLength = 1; }\n    return noteLength * divisions.reduce(function (f, d) { return f / d; }, 1000) * measureLength; // fraction of one\n}\nexports.getDuration = getDuration;\nfunction resolveChords(pattern, measures, path, divisions) {\n    var _this = this;\n    if (divisions === void 0) { divisions = []; }\n    if (Array.isArray(pattern)) {\n        // division: array of children lengths down the path (to calculate fraction)\n        divisions = [].concat(divisions, [pattern.length]);\n        return pattern.map(function (p, i) { return _this.resolveChords(p, measures, path.concat([i]), divisions); });\n    }\n    if (pattern === 0) {\n        return 0;\n    }\n    var fraction = getDuration(divisions, pattern);\n    if (fraction === 0) {\n        console.warn('fraction is 0', pattern);\n    }\n    if (fraction === NaN) {\n        console.warn('fraction NaN', divisions, pattern);\n    }\n    return { chord: this.getPath(path, measures), pattern: pattern, path: path, divisions: divisions, fraction: fraction };\n}\nexports.resolveChords = resolveChords;\nfunction hasOff(pattern, division) {\n    if (division === void 0) { division = 3; }\n    return Array.isArray(pattern) && pattern.length === division && pattern[division - 1] !== 0;\n}\nexports.hasOff = hasOff;\n// replaces offs on last beat with next chord + erases next one\nfunction offbeatReducer(settings) {\n    var _this = this;\n    // TODO: find out why some offbeats sound sketchy\n    return function (measures, bar, index) {\n        var last = index > 0 ? measures[index - 1] : null;\n        if (last && _this.hasOff(last[settings.cycle - 1], settings.division)) {\n            last[settings.cycle - 1][settings.division - 1] = bar[0];\n            bar[0] = 0;\n        }\n        return measures.concat([bar]);\n    };\n}\nexports.offbeatReducer = offbeatReducer;\nfunction randomSynth(mix, allowed, settings) {\n    if (allowed === void 0) { allowed = ['sine', 'triangle', 'square', 'sawtooth']; }\n    if (settings === void 0) { settings = {}; }\n    var gains = {\n        sine: 0.9,\n        triangle: 0.8,\n        square: 0.2,\n        sawtooth: 0.3\n    };\n    var wave = randomElement(allowed);\n    return new Synthesizer_1.Synthesizer(Object.assign({ gain: gains[wave], type: wave, mix: mix }, settings));\n}\nexports.randomSynth = randomSynth;\nfunction adsr(_a, time, param) {\n    var attack = _a.attack, decay = _a.decay, sustain = _a.sustain, release = _a.release, gain = _a.gain, duration = _a.duration, endless = _a.endless;\n    // console.log('adsr', attack, decay, sustain, release, gain, duration, time);\n    param.linearRampToValueAtTime(gain, time + attack);\n    param.setTargetAtTime(sustain * gain, time + Math.min(attack + decay, duration), decay);\n    if (!endless) {\n        param.setTargetAtTime(0, time + Math.max(duration - attack - decay, attack + decay, duration), release);\n    }\n}\nexports.adsr = adsr;\nfunction randomDelay(maxMs) {\n    return Math.random() * maxMs * 2 / 1000;\n}\nexports.randomDelay = randomDelay;\nfunction isInRange(note, range) {\n    return tonal_1.Distance.semitones(note, range[0]) <= 0 && tonal_1.Distance.semitones(note, range[1]) >= 0;\n}\nexports.isInRange = isInRange;\nfunction transposeNotes(notes, interval) {\n    return notes.map(function (note) { return tonal_1.Distance.transpose(note, interval); });\n}\nexports.transposeNotes = transposeNotes;\nfunction transposeToRange(notes, range, times) {\n    if (times === void 0) { times = 0; }\n    if (times > 10) {\n        return notes;\n    }\n    if (notes.find(function (note) { return tonal_1.Distance.semitones(note, range[0]) > 0; })) {\n        notes = notes.map(function (note) { return tonal_1.Distance.transpose(note, '8P'); });\n        console.log('tp up');\n        return transposeToRange(notes, range, ++times);\n    }\n    if (notes.find(function (note) { return tonal_1.Distance.semitones(note, range[1]) < 0; })) {\n        console.log('tp down');\n        notes = notes.map(function (note) { return tonal_1.Distance.transpose(note, '-8P'); });\n        return transposeToRange(notes, range, ++times);\n    }\n    return notes;\n}\nexports.transposeToRange = transposeToRange;\nfunction getAverageMidi(notes, offset) {\n    return notes.reduce(function (sum, note) { return sum + Harmony_1.Harmony.getMidi(note, offset); }, 0) / notes.length;\n}\nexports.getAverageMidi = getAverageMidi;\nfunction getDistancesToRangeEnds(notes, range) {\n    if (notes.length > 2) {\n        notes = [notes[0], notes[notes.length - 1]];\n    }\n    var midi = notes.map(function (n) { return Harmony_1.Harmony.getMidi(n); });\n    var rangeMidi = range.map(function (n) { return Harmony_1.Harmony.getMidi(n); });\n    return [midi[0] - rangeMidi[0], rangeMidi[1] - midi[1]];\n}\nexports.getDistancesToRangeEnds = getDistancesToRangeEnds;\nfunction getRangePosition(note, range) {\n    note = Harmony_1.Harmony.getMidi(note);\n    range = range.map(function (n) { return Harmony_1.Harmony.getMidi(n); });\n    var semitones = [note - range[0], range[1] - range[0]];\n    return semitones[0] / semitones[1];\n}\nexports.getRangePosition = getRangePosition;\nfunction getRangeDirection(note, range, defaultDirection, border) {\n    if (defaultDirection === void 0) { defaultDirection = 'down'; }\n    if (border === void 0) { border = 0; }\n    var position = getRangePosition(note, range);\n    if (position <= border) {\n        return { direction: 'up', force: true };\n    }\n    if (position >= (1 - border)) {\n        return { direction: 'down', force: true };\n    }\n    return {\n        direction: defaultDirection, force: false\n    };\n}\nexports.getRangeDirection = getRangeDirection;\n// accepts both strings or numbers where negative means minor, \n// returns unified step string that can be turned into an interval\nfunction getStep(step) {\n    if (typeof step === 'number' && step < 0) {\n        step = 'b' + (step * -1);\n    }\n    return step + ''; // to string\n}\nexports.getStep = getStep;\nfunction getIntervalFromStep(step) {\n    step = getStep(step);\n    var interval = Object.keys(steps)\n        .find(function (i) { return steps[i].includes(step); });\n    if (!interval) {\n        // console.warn(`step ${step} has no defined inteval`);\n    }\n    return interval;\n}\nexports.getIntervalFromStep = getIntervalFromStep;\nfunction getStepsFromDegree(degree) {\n    return;\n}\nexports.getStepsFromDegree = getStepsFromDegree;\nfunction getStepsInChord(notes, chord, min) {\n    if (min === void 0) { min = false; }\n    var root = tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord))[0];\n    return notes.map(function (note) {\n        var interval = tonal_1.Distance.interval(root, tonal_1.Note.pc(note));\n        return getStepFromInterval(interval, min);\n    });\n}\nexports.getStepsInChord = getStepsInChord;\nfunction getStepInChord(note, chord, min) {\n    if (min === void 0) { min = false; }\n    return getStepFromInterval(tonal_1.Distance.interval(tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord))[0], tonal_1.Note.pc(note), min));\n}\nexports.getStepInChord = getStepInChord;\nfunction getChordScales(chord, group) {\n    if (group === void 0) { group = 'Diatonic'; }\n    var tokens = tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord));\n    /* const isSuperset = PcSet.isSupersetOf(Chord.intervals(tokens[1])); */\n    return symbols_1.scaleNames(group).filter(function (name) {\n        /* isSuperset(Scale.intervals(name)) */\n        return tonal_1.PcSet.isSupersetOf(tonal_1.Chord.intervals(tokens[1]), tonal_1.Scale.intervals(name));\n    });\n}\nexports.getChordScales = getChordScales;\nfunction pickChordScale(chord, group) {\n    if (group === void 0) { group = 'Diatonic'; }\n    var scales = getChordScales(chord);\n    if (!scales.length) {\n        console.warn(\"cannot pick chord scale: no scales found for chord \" + chord + \" in group \" + group);\n        return;\n    }\n    return scales[0];\n}\nexports.pickChordScale = pickChordScale;\nfunction findDegree(degreeOrStep, intervalsOrSteps) {\n    var intervals = intervalsOrSteps.map(function (i) { return isInterval(i) ? i : getIntervalFromStep(i); });\n    if (typeof degreeOrStep === 'number') { // is degree\n        var degree_1 = Math.abs(degreeOrStep);\n        return intervals.find(function (i) {\n            i = Harmony_1.Harmony.minInterval(i, 'up');\n            if (!steps[i]) {\n                console.error('interval', i, 'is not valid', intervals);\n            }\n            return !!(steps[i].find(function (step) { return getDegreeFromStep(step) === degree_1; }));\n        });\n    }\n    // is step\n    var step = getStep(degreeOrStep);\n    return intervals.find(function (i) { return i.includes(step) ||\n        i === getIntervalFromStep(step); });\n}\nexports.findDegree = findDegree;\nfunction hasDegree(degree, intervals) {\n    return !!findDegree(degree, intervals);\n}\nexports.hasDegree = hasDegree;\nfunction hasAllDegrees(degrees, intervals) {\n    return degrees.reduce(function (res, d) { return res && hasDegree(d, intervals); }, true);\n}\nexports.hasAllDegrees = hasAllDegrees;\nfunction getScaleDegree(degree, scale) {\n    return findDegree(degree, tonal_1.Scale.intervals(scale));\n}\nexports.getScaleDegree = getScaleDegree;\nfunction getScalePattern(pattern, scale) {\n    return pattern.map(function (degree) { return getScaleDegree(degree, scale); });\n}\nexports.getScalePattern = getScalePattern;\nfunction renderIntervals(intervals, root) {\n    return intervals.map(function (i) { return tonal_1.Distance.transpose(root, i); });\n}\nexports.renderIntervals = renderIntervals;\nfunction renderSteps(steps, root) {\n    return renderIntervals(steps.map(function (step) { return getIntervalFromStep(step); }), root);\n}\nexports.renderSteps = renderSteps;\nfunction permutateIntervals(intervals, pattern) {\n    return pattern.map(function (d) { return findDegree(d, intervals); });\n}\nexports.permutateIntervals = permutateIntervals;\nfunction getStepFromInterval(interval, min) {\n    if (min === void 0) { min = false; }\n    var step = steps[interval] || [];\n    if (min) {\n        return step[1] || step[0] || 0;\n    }\n    return step[0] || 0;\n}\nexports.getStepFromInterval = getStepFromInterval;\nfunction getDegreeFromInterval(interval, simplify) {\n    if (interval === void 0) { interval = '-1'; }\n    if (simplify === void 0) { simplify = false; }\n    var fixed = Harmony_1.Harmony.fixInterval(interval, simplify) || '';\n    var match = fixed.match(/[-]?([1-9])+/);\n    if (!match) {\n        return 0;\n    }\n    return Math.abs(parseInt(match[0], 10));\n}\nexports.getDegreeFromInterval = getDegreeFromInterval;\nfunction getDegreeFromStep(step) {\n    step = getStep(step);\n    return parseInt(step.match(/([1-9])+/)[0], 10);\n}\nexports.getDegreeFromStep = getDegreeFromStep;\nfunction getDegreeInChord(degree, chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var intervals = tonal_1.Chord.intervals(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    return tonal_1.Distance.transpose(tokens[0], findDegree(degree, intervals));\n}\nexports.getDegreeInChord = getDegreeInChord;\nfunction getPatternInChord(pattern, chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var intervals = tonal_1.Chord.intervals(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    var permutation;\n    if (hasAllDegrees(pattern, intervals)) {\n        permutation = permutateIntervals(intervals, pattern);\n    }\n    else {\n        // not all degrees of the pattern are in the chord > get scale\n        var scale = pickChordScale(chord);\n        permutation = permutateIntervals(tonal_1.Scale.intervals(scale), pattern);\n    }\n    if (tokens[0]) {\n        return renderIntervals(permutation, tokens[0]);\n    }\n    return permutation;\n}\nexports.getPatternInChord = getPatternInChord;\n// TODO: other way around: find fixed interval pattern in a scale\n// TODO: motives aka start pattern from same note in different scale\n// TODO: motives aka start pattern from different note in same scale\n// TODO: motives aka start pattern from different note in different scale\nfunction getDigitalPattern(chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var intervals = tonal_1.Chord.intervals(chord);\n    if (intervals.includes('3m')) {\n        return [1, 3, 4, 5];\n    }\n    else if (intervals.includes('3M')) {\n        return [1, 2, 3, 5];\n    }\n    else {\n        return [1, 1, 1, 1];\n    }\n}\nexports.getDigitalPattern = getDigitalPattern;\nfunction renderDigitalPattern(chord) {\n    return getPatternInChord(getDigitalPattern(chord), chord);\n}\nexports.renderDigitalPattern = renderDigitalPattern;\nfunction getGuideTones(chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    return getPatternInChord([3, 7], chord);\n}\nexports.getGuideTones = getGuideTones;\nfunction isFirstInPath(path, index) {\n    return path.slice(index)\n        .reduce(function (sum, value) { return sum + value; }, 0) === 0;\n}\nexports.isFirstInPath = isFirstInPath;\nfunction isBarStart(path) {\n    return isFirstInPath(path, 1);\n}\nexports.isBarStart = isBarStart;\nfunction isFormStart(path) {\n    return isFirstInPath(path, 0);\n}\nexports.isFormStart = isFormStart;\nfunction isOffbeat(path) {\n    return path[2] !== 0;\n}\nexports.isOffbeat = isOffbeat;\nfunction otherDirection(direction, defaultDirection) {\n    if (direction === 'up') {\n        return 'down';\n    }\n    else if (direction === 'down') {\n        return 'up';\n    }\n    return defaultDirection;\n}\nexports.otherDirection = otherDirection;\nfunction totalDiff(diff) {\n    var total = diff.reduce(function (weight, diff) {\n        weight.added += diff.added ? diff.count : 0;\n        weight.removed += diff.added ? diff.count : 0;\n        weight.kept += (!diff.added && !diff.removed) ? diff.count : 0;\n        return weight;\n    }, { added: 0, removed: 0, kept: 0, balance: 0 });\n    total.balance = total.added - total.removed;\n    total.changes = total.added + total.removed;\n    return total;\n}\nexports.totalDiff = totalDiff;\n/** Reorders the given notes to contain the given step as close as possible */\nfunction sortByDegree(notes, degree) {\n    degree = Math.max(degree, (degree + 8) % 8);\n    /* const semitones = Interval.semitones(interval); */\n    var diffDegrees = function (a, b) { return Math.abs(getDegreeFromInterval(tonal_1.Distance.interval(a, b) + '') - degree); };\n    /* const diffTones = (a, b) => Math.abs(Distance.interval(a, b) - semitones); */\n    notes = notes.slice(1).reduce(function (chain, note) {\n        var closest = notes\n            .filter(function (n) { return !chain.includes(n); })\n            .sort(function (a, b) { return diffDegrees(chain[0], a) < diffDegrees(chain[0], b) ? -1 : 1; });\n        chain.unshift(closest[0]);\n        return chain;\n    }, [notes[0]]).reverse();\n    return notes;\n}\nexports.sortByDegree = sortByDegree;\n/** Returns the given notes with octaves either moving bottom up or top down */\nfunction renderAbsoluteNotes(notes, octave, direction) {\n    if (octave === void 0) { octave = 3; }\n    if (direction === void 0) { direction = 'up'; }\n    return notes.reduce(function (absolute, current, index, notes) {\n        if (index === 0) {\n            return [current + octave];\n        }\n        var interval = tonal_1.Distance.interval(notes[index - 1], current);\n        interval = Harmony_1.Harmony.minInterval(interval, direction);\n        if (interval === '1P') {\n            interval = direction === 'down' ? '-8P' : '8P';\n        }\n        absolute.push(tonal_1.Distance.transpose(absolute[index - 1], interval + ''));\n        return absolute;\n    }, []);\n}\nexports.renderAbsoluteNotes = renderAbsoluteNotes;\nfunction getIntervals(notes) {\n    return notes.reduce(function (intervals, note, index, notes) {\n        if (index === 0) {\n            return [];\n        }\n        intervals.push(tonal_1.Distance.interval(notes[index - 1], note));\n        return intervals;\n    }, []);\n}\nexports.getIntervals = getIntervals;\nfunction isInterval(interval) {\n    return typeof tonal_1.Interval.semitones(interval) === 'number';\n}\nexports.isInterval = isInterval;\nfunction smallestInterval(intervals) {\n    return intervals.reduce(function (min, current) {\n        if (!min || tonal_1.Interval.semitones(current) < tonal_1.Interval.semitones(min)) {\n            return current;\n        }\n        return min;\n    });\n}\nexports.smallestInterval = smallestInterval;\nfunction sortNotes(notes, direction) {\n    if (direction === void 0) { direction = 'up'; }\n    return notes.sort(function (a, b) { return Harmony_1.Harmony.getMidi(a) - Harmony_1.Harmony.getMidi(b); });\n}\nexports.sortNotes = sortNotes;\nfunction analyzeVoicing(notes, root) {\n    if (!notes || notes.length < 2) {\n        throw new Error('Can only analyze Voicing with at least two notes');\n    }\n    notes = sortNotes(notes);\n    root = root || notes[0]; // TODO: get degrees\n    var intervals = getIntervals(notes);\n    var sortedIntervals = intervals.sort(Harmony_1.Harmony.sortMinInterval());\n    return {\n        notes: notes,\n        minInterval: sortedIntervals[0],\n        maxInterval: sortedIntervals[sortedIntervals.length - 1],\n        intervals: intervals,\n        spread: tonal_1.Distance.interval(notes[0], notes[notes.length - 1])\n    };\n}\nexports.analyzeVoicing = analyzeVoicing;\nfunction semitoneDifference(intervals) {\n    return intervals.reduce(function (semitones, interval) {\n        return semitones + Math.abs(tonal_1.Interval.semitones(interval));\n    }, 0);\n}\nexports.semitoneDifference = semitoneDifference;\nfunction semitoneMovement(intervals) {\n    return intervals.reduce(function (semitones, interval) {\n        return semitones + tonal_1.Interval.semitones(interval);\n    }, 0);\n}\nexports.semitoneMovement = semitoneMovement;\nfunction longestChild(array) {\n    return array.reduce(function (max, current) { return (current.length > max.length ? current : max); }, array[0]);\n}\nexports.longestChild = longestChild;\nfunction isPitchClass(note) {\n    return tonal_1.Note.pc(note) === note;\n}\nexports.isPitchClass = isPitchClass;\nfunction mapTree(tree, modifier, simplify, path, siblings, position) {\n    if (simplify === void 0) { simplify = false; }\n    if (path === void 0) { path = []; }\n    if (siblings === void 0) { siblings = []; }\n    if (position === void 0) { position = 0; }\n    // skip current tree if only one child\n    if (simplify && Array.isArray(tree) && tree.length === 1) {\n        return mapTree(tree[0], modifier, simplify, path, siblings, position);\n    }\n    var fraction = siblings.reduce(function (f, d) { return f / d; }, 1);\n    if (!Array.isArray(tree)) {\n        return modifier ? modifier(tree, { path: path, siblings: siblings, fraction: fraction, position: position }) : tree;\n    }\n    if (Array.isArray(tree)) {\n        siblings = siblings.concat([tree.length]);\n        fraction = fraction / tree.length;\n        return tree.map(function (subtree, index) {\n            return mapTree(subtree, modifier, simplify, path.concat([index]), siblings, position + index * fraction);\n        });\n    }\n}\nexports.mapTree = mapTree;\nfunction flattenTree(tree) {\n    var flat = [];\n    mapTree(tree, function (value, props) { return flat.push(Object.assign(props, { value: value })); });\n    return flat;\n}\nexports.flattenTree = flattenTree;\nfunction expandTree(tree) {\n    // TODO\n}\nexports.expandTree = expandTree;\n/* Returns true if the given intervals are all present in the chords interval structure\nIntervals can be appendend with \"?\" to indicate that those degrees could also be omitted\n(but when present they should match)\n*/\nfunction chordHasIntervals(chord, intervals) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var has = tonal_1.Chord.intervals(chord);\n    return intervals.reduce(function (match, current) {\n        var isOptional = current.includes('?');\n        var isForbidden = current.includes('!');\n        if (isOptional) {\n            current = current.replace('?', '');\n            return (!hasDegree(getDegreeFromInterval(current), has) ||\n                has.includes(current)) && match;\n        }\n        if (isForbidden) {\n            current = current.replace('!', '');\n            return !hasDegree(getDegreeFromInterval(current), has);\n        }\n        return has.includes(current) && match;\n    }, true);\n}\nexports.chordHasIntervals = chordHasIntervals;\nfunction isDominantChord(chord) {\n    return chordHasIntervals(chord, ['3M', '7m']) || chordHasIntervals(chord, ['!3', '4P', '7m']);\n}\nexports.isDominantChord = isDominantChord;\nfunction isMajorChord(chord) {\n    return chordHasIntervals(chord, ['3M', '7M?']);\n}\nexports.isMajorChord = isMajorChord;\nfunction isMinorChord(chord) {\n    return chordHasIntervals(chord, ['3m']);\n}\nexports.isMinorChord = isMinorChord;\nfunction isMinorTonic(chord) {\n    return chordHasIntervals(chord, ['3m', '5P', '13M?', '7M?']);\n}\nexports.isMinorTonic = isMinorTonic;\nfunction getChordType(chord) {\n    if (isDominantChord(chord)) {\n        return 'dominant';\n    }\n    if (isMajorChord(chord)) {\n        return 'major';\n    }\n    if (isMinorTonic(chord)) {\n        return 'minor-tonic';\n    }\n    if (isMinorChord(chord)) {\n        return 'minor';\n    }\n}\nexports.getChordType = getChordType;\nfunction getChordNotes(chord, validate) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    var notes = tonal_1.Chord.notes(chord);\n    return notes.filter(function (note) {\n        var interval = tonal_1.Distance.interval(tokens[0], note);\n        return !validate || validate(note, {\n            root: tokens[0],\n            symbol: tokens[1],\n            interval: interval,\n            step: getStepFromInterval(interval),\n            degree: getDegreeFromInterval(interval + '')\n        });\n    });\n}\nexports.getChordNotes = getChordNotes;\nfunction validateWithoutRoot(note, _a) {\n    var degree = _a.degree;\n    return degree !== 1;\n}\nexports.validateWithoutRoot = validateWithoutRoot;\n// OLD...\nfunction getVoicing(chord, _a) {\n    var _b = _a === void 0 ? {} : _a, voices = _b.voices, previousVoicing = _b.previousVoicing, omitRoot = _b.omitRoot, quartal = _b.quartal;\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    var notes = tonal_1.Chord.notes(chord);\n    if (omitRoot) {\n        notes = notes.filter(function (n) { return n !== tokens[0]; });\n    }\n    if (quartal) {\n    }\n    if (previousVoicing) {\n    }\n    return notes;\n}\nexports.getVoicing = getVoicing;\nfunction semitoneDistance(noteA, noteB) {\n    return tonal_1.Interval.semitones(tonal_1.Distance.interval(noteA, noteB) + '');\n}\nexports.semitoneDistance = semitoneDistance;\nfunction noteArray(range) {\n    var slots = tonal_1.Interval.semitones(tonal_1.Distance.interval(range[0], range[1]) + '');\n    return new Array(slots + 1)\n        .fill('')\n        .map(function (v, i) { return tonal_1.Distance.transpose(range[0], tonal_1.Interval.fromSemitones(i)) + ''; })\n        .map(function (n) { return tonal_1.Note.simplify(n); });\n}\nexports.noteArray = noteArray;\nfunction factorial(n) {\n    var value = 1;\n    for (var i = 2; i <= n; ++i) {\n        value *= i;\n    }\n    return value;\n}\nexports.factorial = factorial;\n// finds best combination following the given notes, based on minimal movement\n/* export function bestCombination(notes, combinations = []) {\n    return combinations.reduce((best, current) => {\n        const currentMovement = voicingDifference(notes, current);\n        const bestMovement = voicingDifference(notes, best);\n        if (Math.abs(currentMovement) < Math.abs(bestMovement)) {\n            return current;\n        }\n        return best;\n    });\n} */\n/* export function sortCombinationsByMovement(notes, combinations, direction: intervalDirection = 'up', min = true) {\n    const movements = combinations.map((combination) => ({\n        movement: voicingMovement(notes, combination, min),\n        combination\n    }));\n    let right = movements.filter(move => direction === 'up' ? move >= 0 : move <= 0);\n    if (!right.length) {\n        right = movements;\n    }\n    let sorted = right.sort((a, b) => a.movement - b.movement);\n    if (direction === 'down') {\n        sorted = sorted.reverse();\n    }\n    return sorted.map(movement => movement.combination);\n}\n */ \n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Instrument_1 = require(\"./Instrument\");\nvar tonal_1 = require(\"tonal\");\nvar util_1 = require(\"../util/util\");\nvar Synthesizer = /** @class */ (function (_super) {\n    __extends(Synthesizer, _super);\n    function Synthesizer(props) {\n        var _this = _super.call(this, props) || this;\n        _this.duration = 200;\n        _this.type = 'sine';\n        _this.gain = 0.9;\n        _this.attack = .05;\n        _this.decay = .05;\n        _this.sustain = .4;\n        _this.release = .1;\n        _this.duration = props.duration || _this.duration;\n        _this.type = props.type || _this.type;\n        _this.gain = props.gain || _this.gain;\n        return _this;\n    }\n    Synthesizer.prototype.getVoice = function (type, gain, key) {\n        if (type === void 0) { type = 'sine'; }\n        if (gain === void 0) { gain = 0; }\n        var frequency = tonal_1.Note.freq(key);\n        var oscNode = this.context.createOscillator();\n        oscNode.type = type;\n        var gainNode = this.context.createGain();\n        oscNode.connect(gainNode);\n        gainNode.gain.value = typeof gain === 'number' ? gain : 0.8;\n        gainNode.connect(this.mix);\n        oscNode.frequency.value = frequency;\n        return { oscNode: oscNode, gainNode: gainNode, key: key, frequency: frequency };\n    };\n    Synthesizer.prototype.lowestGain = function (a, b) {\n        return a.gain.gain.value < b.gain.gain.value ? -1 : 0;\n    };\n    Synthesizer.prototype.startKeys = function (keys, settings) {\n        if (settings === void 0) { settings = {}; }\n    };\n    Synthesizer.prototype.playKeys = function (keys, settings) {\n        var _this = this;\n        if (settings === void 0) { settings = {}; }\n        _super.prototype.playKeys.call(this, keys, settings); // fires callback   \n        //const time = this.context.currentTime + settings.deadline / 1000;\n        var time = settings.deadline || this.context.currentTime;\n        var interval = settings.interval || 0;\n        return keys.map(function (key, i) {\n            var delay = i * interval;\n            var _a = [\n                settings.endless,\n                settings.attack || _this.attack,\n                settings.decay || _this.decay,\n                settings.sustain || _this.sustain,\n                settings.release || _this.release,\n                (settings.duration || _this.duration) / 1000,\n                (settings.gain || 1) * _this.gain\n            ], endless = _a[0], attack = _a[1], decay = _a[2], sustain = _a[3], release = _a[4], duration = _a[5], gain = _a[6];\n            var voice = _this.getVoice(_this.type, 0, key);\n            util_1.adsr({ attack: attack, decay: decay, sustain: sustain, release: release, gain: gain, duration: duration, endless: endless }, time + delay, voice.gainNode.gain);\n            voice.oscNode.start(settings.deadline + delay);\n            return voice;\n        });\n    };\n    Synthesizer.prototype.stopVoice = function (voice, settings) {\n        if (settings === void 0) { settings = {}; }\n        if (!voice) {\n            return;\n        }\n        var time = settings.deadline || this.context.currentTime;\n        voice.gainNode.gain.setTargetAtTime(0, time, settings.release || this.release);\n        //voice.oscNode.stop()\n    };\n    Synthesizer.prototype.stopVoices = function (voices, settings) {\n        var _this = this;\n        voices.forEach(function (voice) {\n            _this.stopVoice(voice, settings);\n        });\n    };\n    return Synthesizer;\n}(Instrument_1.Instrument));\nexports.Synthesizer = Synthesizer;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Synthesizer_1 = require(\"./instruments/Synthesizer\");\nvar Metronome = /** @class */ (function () {\n    function Metronome(mix) {\n        this.synth = new Synthesizer_1.Synthesizer({ type: 'sine', gain: 1, mix: mix });\n        this.ready = this.synth.ready;\n    }\n    Metronome.prototype.count = function (pulse, bars) {\n        var _this = this;\n        if (bars === void 0) { bars = 1; }\n        var count = new Array(bars).fill([new Array(pulse.props.cycle).fill(1)]);\n        return pulse.tickArray(count, function (_a) {\n            var path = _a.path, deadline = _a.deadline;\n            _this.synth.playKeys([path[2] === 0 ? 90 : 78], { deadline: deadline, duration: 0.01, attack: .01, release: .01, decay: .01, sustain: 1 });\n        });\n    };\n    return Metronome;\n}());\nexports.Metronome = Metronome;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Permutation = /** @class */ (function () {\n    function Permutation() {\n    }\n    Permutation.permutateElements = function (array, validate, path) {\n        if (path === void 0) { path = []; }\n        var isValid = function (next) { return !validate || validate(path, next, array); };\n        if (array.length === 1) {\n            return isValid(array[0]) ? array : [];\n        }\n        return array.filter(isValid).reduce(function (combinations, el) { return combinations.concat(Permutation.permutateElements(array.filter(function (e) { return e !== el; }), validate, path.concat([el])).map(function (subcombinations) { return [\n            el\n        ].concat(subcombinations); })); }, []);\n    };\n    Permutation.permutationComplexity = function (array, validate, path) {\n        if (path === void 0) { path = []; }\n        var validations = 0;\n        Permutation.permutateElements(array, function (path, next, array) {\n            ++validations;\n            return !validate || validate(path, next, array);\n        }, path);\n        return validations;\n    };\n    Permutation.permutateArray = function (array) {\n        if (array.length === 1) {\n            return array;\n        }\n        return array.reduce(function (combinations, el) { return combinations.concat(Permutation.permutateArray(array.filter(function (e) { return e !== el; }))\n            .map(function (subcombinations) { return ([el].concat(subcombinations)); })); }, []);\n    };\n    // combine multiple validators\n    Permutation.combineValidators = function () {\n        var validators = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            validators[_i] = arguments[_i];\n        }\n        return function (path, next, array) { return validators\n            .reduce(function (result, validator) { return result && validator(path, next, array); }, true); };\n    };\n    //https://stackoverflow.com/questions/9960908/permutations-in-javascript\n    Permutation.combinations = function (array) {\n        var length = array.length, result = [array.slice()], c = new Array(length).fill(0), i = 1, k, p;\n        while (i < length) {\n            if (c[i] < i) {\n                k = i % 2 && c[i];\n                p = array[i];\n                array[i] = array[k];\n                array[k] = p;\n                ++c[i];\n                i = 1;\n                result.push(array.slice());\n            }\n            else {\n                c[i] = 0;\n                ++i;\n            }\n        }\n        return result;\n    };\n    // https://gist.github.com/axelpale/3118596\n    Permutation.binomial = function (set, k) {\n        var i, j, combs, head, tailcombs;\n        // There is no way to take e.g. sets of 5 elements from\n        // a set of 4.\n        if (k > set.length || k <= 0) {\n            return [];\n        }\n        // K-sized set has only one K-sized subset.\n        if (k == set.length) {\n            return [set];\n        }\n        // There is N 1-sized subsets in a N-sized set.\n        if (k == 1) {\n            combs = [];\n            for (i = 0; i < set.length; i++) {\n                combs.push([set[i]]);\n            }\n            return combs;\n        }\n        // Assert {1 < k < set.length}\n        // Algorithm description:\n        // To get k-combinations of a set, we want to join each element\n        // with all (k-1)-combinations of the other elements. The set of\n        // these k-sized sets would be the desired result. However, as we\n        // represent sets with lists, we need to take duplicates into\n        // account. To avoid producing duplicates and also unnecessary\n        // computing, we use the following approach: each element i\n        // divides the list into three: the preceding elements, the\n        // current element i, and the subsequent elements. For the first\n        // element, the list of preceding elements is empty. For element i,\n        // we compute the (k-1)-computations of the subsequent elements,\n        // join each with the element i, and store the joined to the set of\n        // computed k-combinations. We do not need to take the preceding\n        // elements into account, because they have already been the i:th\n        // element so they are already computed and stored. When the length\n        // of the subsequent list drops below (k-1), we cannot find any\n        // (k-1)-combs, hence the upper limit for the iteration:\n        combs = [];\n        for (i = 0; i < set.length - k + 1; i++) {\n            // head is a list that includes only our current element.\n            head = set.slice(i, i + 1);\n            // We take smaller combinations from the subsequent elements\n            tailcombs = Permutation.binomial(set.slice(i + 1), k - 1);\n            // For each (k-1)-combination we join it with the current\n            // and store it to the set of k-combinations.\n            for (j = 0; j < tailcombs.length; j++) {\n                combs.push(head.concat(tailcombs[j]));\n            }\n        }\n        return combs;\n    };\n    return Permutation;\n}());\nexports.Permutation = Permutation;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Permutation_1 = require(\"../util/Permutation\");\nvar Logger_1 = require(\"../util/Logger\");\nvar tonal_1 = require(\"tonal\");\nvar tonal_2 = require(\"tonal\");\nvar tonal_3 = require(\"tonal\");\nvar tonal_4 = require(\"tonal\");\nvar util_1 = require(\"../util/util\");\nvar Harmony_1 = require(\"./Harmony\");\nvar Voicing = /** @class */ (function () {\n    function Voicing() {\n    }\n    /** Returns the next voicing that should follow the previously played voicing.\n    */\n    Voicing.getNextVoicing = function (chord, previousVoicing, options) {\n        if (options === void 0) { options = {}; }\n        var _a = __assign({ range: ['C3', 'C5'], rangeBorders: [3, 3], maxVoices: 4, forceDirection: null, maxDistance: 7, minBottomDistance: 3, minTopDistance: 2, noTopDrop: true, noTopAdd: true, noBottomDrop: false, noBottomAdd: false, logging: true }, options), maxVoices = _a.maxVoices, range = _a.range, forceDirection = _a.forceDirection, rangeBorders = _a.rangeBorders, sortChoices = _a.sortChoices, filterChoices = _a.filterChoices, noTopDrop = _a.noTopDrop, noTopAdd = _a.noTopAdd, noBottomDrop = _a.noBottomDrop, noBottomAdd = _a.noBottomAdd, logging = _a.logging;\n        // make sure tonal can read the chord\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        if (chord === 'r') {\n            return null;\n        }\n        var combinations = Voicing.getAllVoicePermutations(chord, maxVoices, options);\n        var exit = function () {\n            var pick = [];\n            if (logging) {\n                Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick });\n            }\n            return pick;\n        };\n        if (!combinations.length) {\n            return exit();\n        }\n        if (!previousVoicing || !previousVoicing.length) { // no previous chord\n            // filter out combinations that are out of range\n            combinations = combinations.filter(function (combination) {\n                var firstNote = Harmony_1.Harmony.getNearestNote(range[0], combination[0], 'up');\n                var pick = util_1.renderAbsoluteNotes(combination, tonal_2.Note.oct(firstNote));\n                return util_1.isInRange(pick[0], range) && util_1.isInRange(pick[pick.length - 1], range);\n            });\n            var firstPick = combinations[0];\n            var firstNoteInRange = Harmony_1.Harmony.getNearestNote(range[0], firstPick[0], 'up');\n            var pick_1 = util_1.renderAbsoluteNotes(firstPick, tonal_2.Note.oct(firstNoteInRange));\n            if (logging) {\n                Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick_1 });\n            }\n            return pick_1;\n        }\n        var choices = Voicing.getAllChoices(combinations, previousVoicing, range)\n            .filter(function (choice) {\n            return (!noTopDrop || !choice.dropped.includes(choice.topNotes[0])) &&\n                (!noTopAdd || !choice.added.includes(choice.topNotes[1])) &&\n                (!noBottomDrop || !choice.dropped.includes(choice.bottomNotes[0])) &&\n                (!noBottomAdd || !choice.added.includes(choice.bottomNotes[1])) &&\n                (!filterChoices || filterChoices(choice));\n        })\n            .sort(sortChoices ?\n            function (a, b) { return sortChoices(a, b); } :\n            function (a, b) { return a.difference - b.difference; });\n        if (!choices.length) {\n            return exit();\n        }\n        var bestPick = choices[0].targets, choice;\n        var direction = Voicing.getDesiredDirection(previousVoicing, range, rangeBorders) || forceDirection;\n        if (!direction) {\n            var pick_2 = bestPick;\n            choice = choices[0];\n            if (logging) {\n                Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick_2, direction: direction, bestPick: bestPick, choice: choice, choices: choices });\n            }\n            return pick_2;\n        }\n        // sort after movement instead of difference\n        choice = choices.sort(function (a, b) {\n            return Math.abs(a.movement) - Math.abs(b.movement);\n        }).find(function (choice) {\n            if (direction === 'up') {\n                return choice.movement >= 0;\n            }\n            return choice.movement <= 0;\n        });\n        if (!choice) { // keep hanging in the corner of the range..\n            choice = choices[0];\n        }\n        var pick = choice.targets;\n        if (logging) {\n            Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick, direction: direction, bestPick: bestPick, choice: choice, choices: choices });\n        }\n        return pick;\n    };\n    /** Computes all valid voice permutations for a given chord and voice number.\n     * Runs getVoicePermutations for each possible selection of notes.\n     */\n    Voicing.getAllVoicePermutations = function (chord, length, voicingOptions) {\n        return Voicing.getAllNoteSelections(chord, length)\n            .reduce(function (combinations, combination) {\n            return combinations.concat(Voicing.getVoicePermutations(combination, voicingOptions));\n        }, []);\n    };\n    /** Get all permutations of the given notes that would make a good voicing. */\n    Voicing.getVoicePermutations = function (notes, options) {\n        if (options === void 0) { options = {}; }\n        if (notes.length === 1) {\n            return [notes];\n        }\n        var validator = options.validatePermutation || (function (path, next, array) { return true; });\n        return Permutation_1.Permutation.permutateElements(notes, Permutation_1.Permutation.combineValidators(validator, Voicing.voicingValidator(options)));\n    };\n    /** Configurable Validator that sorts out note combinations with untasty intervals.  */\n    Voicing.voicingValidator = function (options) {\n        options = __assign({ maxDistance: 6, minDistance: 1, minBottomDistance: 3, minTopDistance: 2 }, options);\n        return function (path, next, array) {\n            return Permutation_1.Permutation.combineValidators(Voicing.notesAtPositionValidator(options.topNotes, path.length + array.length - 1), Voicing.notesAtPositionValidator(options.bottomNotes, 0), Voicing.validateInterval(function (interval) { return tonal_4.Interval.semitones(interval) <= options.maxDistance; }), Voicing.validateInterval(function (interval) { return tonal_4.Interval.semitones(interval) >= options.minDistance; }), Voicing.validateInterval(function (interval, _a) {\n                var array = _a.array;\n                return array.length !== 1 || tonal_4.Interval.semitones(interval) >= options.minTopDistance;\n            }), Voicing.validateInterval(function (interval, _a) {\n                var path = _a.path;\n                return path.length !== 1 || tonal_4.Interval.semitones(interval) >= options.minBottomDistance;\n            }))(path, next, array);\n        };\n    };\n    /** Validates the interval to the next note. You can write your own logic inside the validate fn. */\n    Voicing.validateInterval = function (validate) {\n        return function (path, next, array) {\n            if (!path.length) {\n                return true;\n            }\n            var interval = tonal_3.Distance.interval(path[path.length - 1], next) + '';\n            return validate(interval, { path: path, next: next, array: array });\n        };\n    };\n    /** Returns all possible combinations of required and optional notes for a given chord and desired length.\n     * If the voices number is higher than the required notes of the chord, the rest number will be permutated from the optional notes */\n    Voicing.getAllNoteSelections = function (chord, voices) {\n        if (voices === void 0) { voices = 2; }\n        var required = Voicing.getRequiredNotes(chord);\n        if (voices === 1) {\n            return required.map(function (note) { return [note]; });\n        }\n        var fill = voices - required.length;\n        if (fill === 0) {\n            return [required];\n        }\n        if (fill < 0) { // required notes are enough\n            return Permutation_1.Permutation.binomial(required, voices);\n        }\n        var optional = Voicing.getOptionalNotes(chord, required);\n        if (fill >= optional.length) {\n            return [required.concat(optional)];\n        }\n        return Permutation_1.Permutation.binomial(optional, fill)\n            .map(function (selection) { return required.concat(selection); });\n    };\n    /** Get available tensions for a given chord. Omits tensions that kill the chord quality */\n    Voicing.getAvailableTensions = function (chord) {\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        var notes = tonal_1.Chord.notes(chord);\n        if (util_1.isDominantChord(chord)) {\n            return Voicing.getAllTensions(notes[0])\n                // filter out tensions that are part of the chord\n                .filter(function (note) { return !notes.find(function (n) { return util_1.semitoneDistance(notes[0], note) === util_1.semitoneDistance(notes[0], n); }); })\n                // filter out tensions that are a semitone above the 3 (if exists)\n                .filter(function (note) { return util_1.chordHasIntervals(chord, ['3!']) || util_1.semitoneDistance(util_1.getDegreeInChord(3, chord), note) > 1; })\n                // filter out tensions that are a semitone above the 4 (if exists => sus)\n                .filter(function (note) { return !util_1.chordHasIntervals(chord, ['4P']) || util_1.semitoneDistance(util_1.getDegreeInChord(4, chord), note) > 1; })\n                // filter out tensions that are a semitone above the 7\n                .filter(function (note) { return util_1.semitoneDistance(util_1.getDegreeInChord(7, chord), note) > 1; });\n        }\n        return notes.slice(0, 4)\n            // notes less than 3 semitones away from root are omitted (tensions 2M above would be in next octave)\n            .filter(function (note) { return note === notes[0] || util_1.semitoneDistance(note, notes[0]) > 2; })\n            // all tensions are a major second above a chord note\n            .map(function (note) { return tonal_3.Distance.transpose(note, '2M'); })\n            // tensions 2 semiontes below root are flat 7 => changes chord quality\n            .filter(function (note) { return util_1.semitoneDistance(note, notes[0]) !== 2; });\n        // omit tensions that end up on a chord note again?\n    };\n    /** Returns all Tensions that could be in any chord */\n    Voicing.getAllTensions = function (root) {\n        return ['b9', '9', '#9', '3', '11', '#11', 'b13', '13', '7']\n            .map(function (step) { return util_1.getIntervalFromStep(step); })\n            .map(function (interval) { return tonal_3.Distance.transpose(root, interval); });\n    };\n    /** Returns all notes that are required to outline a chord */\n    Voicing.getRequiredNotes = function (chord) {\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        var notes = tonal_1.Chord.notes(chord);\n        var intervals = tonal_1.Chord.intervals(chord);\n        var requiredSteps = [3, 7, 'b5', 6]; // order is important\n        if (!util_1.hasDegree(3, intervals)) {\n            requiredSteps.push(4); // fixes m6 chords\n        }\n        var required = requiredSteps.reduce(function (req, degree) {\n            if (util_1.hasDegree(degree, intervals)) {\n                req.push(util_1.getDegreeInChord(degree, chord));\n            }\n            return req;\n        }, []);\n        // WHY 3??\n        if (notes.length > 3 && !required.includes(notes[notes.length - 1])) {\n            required.push(notes[notes.length - 1]); // could check if is 5 than dont push\n        }\n        return required;\n    };\n    /** Returns all notes that are not required */\n    Voicing.getOptionalNotes = function (chord, required) {\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        var notes = tonal_1.Chord.notes(chord);\n        required = required || Voicing.getRequiredNotes(chord);\n        return notes.filter(function (note) { return !required.includes(note); });\n    };\n    /** Returns all possible note choices for the given combinations.\n     * Takes the bottom note of the previous voicing and computes the minimal intervals up and down to the next bottom note.\n     */\n    Voicing.getAllChoices = function (combinations, previousVoicing, range) {\n        var lastPitches = previousVoicing.map(function (note) { return tonal_2.Note.pc(note); });\n        return combinations\n            .map(function (combination) {\n            var bottomInterval = tonal_3.Distance.interval(lastPitches[0], combination[0]);\n            var bottomNotes = [\n                tonal_3.Distance.transpose(previousVoicing[0], Harmony_1.Harmony.minInterval(bottomInterval, 'down')),\n                tonal_3.Distance.transpose(previousVoicing[0], Harmony_1.Harmony.minInterval(bottomInterval, 'up')),\n            ];\n            if (bottomNotes[0] === bottomNotes[1]) {\n                bottomNotes = [bottomNotes[0]];\n            }\n            return { combination: combination, bottomNotes: bottomNotes };\n        })\n            .reduce(function (all, _a) {\n            var combination = _a.combination, bottomNotes = _a.bottomNotes;\n            return all.concat(bottomNotes.map(function (bottomNote) { return util_1.renderAbsoluteNotes(combination, tonal_2.Note.oct(bottomNote)); }));\n        }, [])\n            .filter(function (targets) {\n            return !range ||\n                util_1.isInRange(targets[0], range) &&\n                    util_1.isInRange(targets[targets.length - 1], range);\n        })\n            .reduce(function (all, targets) {\n            var leads = Voicing.voiceLeading(previousVoicing, targets);\n            return all.concat(leads);\n        }, []);\n    };\n    /** Analyzes all possible voice movements for all possible transitions. Handles inequal lengths */\n    Voicing.voiceLeading = function (origin, targets) {\n        // if same length > dont permutate\n        if (origin.length === targets.length) {\n            return Voicing.analyzeVoiceLeading(origin, targets);\n        }\n        var _a = [origin, targets].sort(function (a, b) { return b.length - a.length; }), more = _a[0], less = _a[1];\n        return Permutation_1.Permutation.binomial(more, less.length)\n            .map(function (selection) {\n            var _a, _b;\n            var from, to;\n            if (origin.length < targets.length) {\n                _a = [origin, selection], from = _a[0], to = _a[1];\n            }\n            else {\n                _b = [selection, targets], from = _b[0], to = _b[1];\n            }\n            return Voicing.analyzeVoiceLeading(from, to, origin, targets);\n        });\n    };\n    /** Analyzed the voice leading for the movement from > to.\n     * Origin and targets needs to be passed if the voice transition over unequal lengths\n     */\n    Voicing.analyzeVoiceLeading = function (from, to, origin, targets) {\n        var _a;\n        _a = [origin || from, targets || to], origin = _a[0], targets = _a[1];\n        var intervals = Voicing.voicingIntervals(from, to, false)\n            .map(function (interval) { return Harmony_1.Harmony.fixInterval(interval, false); });\n        /** Interval qualities */\n        var degrees = intervals.map(function (i) { return util_1.getDegreeFromInterval(i); });\n        /** Voices that did not move */\n        var oblique = from.filter(function (n, i) { return to.find(function (note) { return Harmony_1.Harmony.isSameNote(n, note); }); });\n        /** abs sum of semitones movements of voices */\n        var difference = util_1.semitoneDifference(intervals);\n        /** relative sum of semitone movements */\n        var movement = util_1.semitoneMovement(intervals);\n        /** voice differences did not cancel each other out > moved in same direction */\n        var similar = Math.abs(movement) === Math.abs(difference);\n        /** moves parallel if all interval qualities the same and in the same direction */\n        var parallel = difference > 0 && similar && degrees.reduce(function (match, degree, index) {\n            return match && (index === 0 || degrees[index - 1] === degree);\n        }, true);\n        // find out which notes have been dropped / added\n        var dropped = [], added = [];\n        if (origin.length < targets.length) {\n            added = targets.filter(function (n) { return !to.includes(n); });\n        }\n        else {\n            dropped = origin.filter(function (n) { return !from.includes(n); });\n        }\n        return {\n            from: from,\n            to: to,\n            origin: origin,\n            targets: targets,\n            intervals: intervals,\n            difference: difference,\n            movement: movement,\n            bottomInterval: intervals[0],\n            topInterval: intervals[intervals.length - 1],\n            topNotes: [origin[origin.length - 1], targets[targets.length - 1]],\n            bottomNotes: [origin[0], targets[0]],\n            similar: similar,\n            contrary: !similar,\n            parallel: parallel,\n            oblique: oblique,\n            degrees: degrees,\n            added: added,\n            dropped: dropped,\n        };\n    };\n    /** Returns true if the given note is contained in the given voicing. */\n    Voicing.containsNote = function (note, voicing, enharmonic) {\n        if (enharmonic === void 0) { enharmonic = true; }\n        if (!enharmonic) {\n            return voicing.includes(note);\n        }\n        return !!voicing.find(function (n) { return Harmony_1.Harmony.isSameNote(note, n); });\n    };\n    /** Returns the intervals between the given chord voicings.\n     * Can be passed pitch classes or absolute notes.\n     * The two voicings should have the same length. */\n    Voicing.voicingIntervals = function (chordA, chordB, min, direction) {\n        if (min === void 0) { min = true; }\n        if (chordA.length !== chordB.length) {\n            // console.log('voicingIntervals: not the same length..');\n        }\n        var intervals = chordA.map(function (n, i) {\n            var interval = tonal_3.Distance.interval(n, chordB[i]);\n            if (min === false) {\n                return interval;\n            }\n            if (util_1.isPitchClass(n) && util_1.isPitchClass(chordB[i])) {\n                return Harmony_1.Harmony.minInterval(interval, direction);\n            }\n            return interval;\n        });\n        return intervals;\n    };\n    /** Validates the current permutation to have a note at a certain position (array index) */\n    Voicing.notesAtPositionValidator = function (notes, position) {\n        if (notes === void 0) { notes = []; }\n        return function (selected, note, remaining) {\n            return !notes.length || selected.length !== position || notes.includes(note);\n        };\n    };\n    /** Returns true if the given voicing contains its root */\n    Voicing.hasTonic = function (voicing, chord) {\n        var tokens = tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord));\n        return voicing.map(function (n) { return tonal_2.Note.pc(n); }).includes(tokens[0]);\n    };\n    /** Returns the best direction to move for a given voicing in a range.\n     * Outputs a direction as soon as the semitone distance of one of the outer notes is below the given threshold\n     */\n    Voicing.getDesiredDirection = function (voicing, range, thresholds) {\n        if (thresholds === void 0) { thresholds = [3, 3]; }\n        var distances = util_1.getDistancesToRangeEnds([voicing[0], voicing[voicing.length - 1]], range);\n        if (distances[0] < thresholds[0] && distances[1] < thresholds[1]) {\n            console.error('range is too small to fit the comfy zone');\n            return;\n        }\n        if (distances[0] < thresholds[0]) {\n            return 'up';\n        }\n        if (distances[1] < thresholds[1]) {\n            return 'down';\n        }\n    };\n    return Voicing;\n}());\nexports.Voicing = Voicing;\n/**\n *\n\n\n\n    static getPossibleVoicings(chord, voices = 4) {\n        const required = getRequiredNotes(chord);\n        const optional = getOptionalNotes(chord);\n        const tensions = getAvailableTensions(chord);\n        return { required, optional, tensions };\n    }\n    static voicingDifference(chordA, chordB, min = true) {\n        return semitoneDifference(Voicing.voicingIntervals(chordA, chordB, min));\n    }\n\n    static voicingMovement(chordA, chordB, min = true, direction?: intervalDirection) {\n        return semitoneMovement(Voicing.voicingIntervals(chordA, chordB, min, direction));\n    }\n\n    static bestVoiceLeading(chordA, chordB, sortFn?) {\n        sortFn = sortFn || ((a, b) => a.difference - b.difference);\n        const voices = Voicing.voiceLeading(chordA, chordB)\n            .sort((best, current) => {\n                return sortFn(best, current);\n            }, null);\n        return voices[0];\n    }\n\n    static minVoiceMovement(chordA, chordB) {\n        [chordA, chordB] = [chordA, chordB].sort((a, b) => b.length - a.length);\n        const picks = Permutation.binomial(chordA, chordB.length);\n        return picks.reduce((min, current) => {\n            const diff = Voicing.voicingMovement(current, chordB, false);\n            if (Math.abs(diff) < Math.abs(min)) {\n                return diff;\n            }\n            return min;\n        }, 100);\n    }\n\n    static getVoices(chord, voices = 4, rootless = false, tension = 1) {\n        // THE PROBLEM: TENSION MUST BE CHOSEN WHEN SELECTING THE OPTIMAL VOICING!\n        chord = Harmony.getTonalChord(chord);\n        const tokens = Chord.tokenize(chord);\n        const required = Voicing.getRequiredNotes(chord);\n        let optional = Voicing.getOptionalNotes(chord, required);\n        let choices = [].concat(required);\n        const remaining = () => voices - choices.length;\n        if (tension > 0) {\n            choices = choices.concat(Voicing.getAvailableTensions(chord).slice(0, tension));\n        }\n        if (remaining() > 0) {\n            choices = choices.concat(optional);\n        }\n        if (remaining() < 0 && rootless) {\n            choices = choices.filter(n => n !== tokens[0]);\n        }\n        if (remaining() > 0) {\n            // console.warn(`${remaining} notes must be doubled!!!`);\n            choices = choices.concat(required, optional).slice(0, voices);\n        }\n        return choices.slice(0, voices);\n    }\n */ \n","/*!\n\n diff v3.5.0\n\nSoftware License Agreement (BSD License)\n\nCopyright (c) 2009-2015, Kevin Decker <kpdecker@gmail.com>\n\nAll rights reserved.\n\nRedistribution and use of this software in source and binary forms, with or without modification,\nare permitted provided that the following conditions are met:\n\n* Redistributions of source code must retain the above\n  copyright notice, this list of conditions and the\n  following disclaimer.\n\n* Redistributions in binary form must reproduce the above\n  copyright notice, this list of conditions and the\n  following disclaimer in the documentation and/or other\n  materials provided with the distribution.\n\n* Neither the name of Kevin Decker nor the names of its\n  contributors may be used to endorse or promote products\n  derived from this software without specific prior\n  written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\nIMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\nFITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR\nCONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER\nIN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\nOF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n@license\n*/\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"JsDiff\"] = factory();\n\telse\n\t\troot[\"JsDiff\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n\n\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.canonicalize = exports.convertChangesToXML = exports.convertChangesToDMP = exports.merge = exports.parsePatch = exports.applyPatches = exports.applyPatch = exports.createPatch = exports.createTwoFilesPatch = exports.structuredPatch = exports.diffArrays = exports.diffJson = exports.diffCss = exports.diffSentences = exports.diffTrimmedLines = exports.diffLines = exports.diffWordsWithSpace = exports.diffWords = exports.diffChars = exports.Diff = undefined;\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_character = __webpack_require__(2) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_word = __webpack_require__(3) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_line = __webpack_require__(5) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_sentence = __webpack_require__(6) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_css = __webpack_require__(7) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_json = __webpack_require__(8) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_array = __webpack_require__(9) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_apply = __webpack_require__(10) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_parse = __webpack_require__(11) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_merge = __webpack_require__(13) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_create = __webpack_require__(14) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_dmp = __webpack_require__(16) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_xml = __webpack_require__(17) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/* See LICENSE file for terms of use */\n\n\t/*\n\t * Text diff implementation.\n\t *\n\t * This library supports the following APIS:\n\t * JsDiff.diffChars: Character by character diff\n\t * JsDiff.diffWords: Word (as defined by \\b regex) diff which ignores whitespace\n\t * JsDiff.diffLines: Line based diff\n\t *\n\t * JsDiff.diffCss: Diff targeted at CSS content\n\t *\n\t * These methods are based on the implementation proposed in\n\t * \"An O(ND) Difference Algorithm and its Variations\" (Myers, 1986).\n\t * http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.4.6927\n\t */\n\texports. /*istanbul ignore end*/Diff = _base2['default'];\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffChars = _character.diffChars;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffWords = _word.diffWords;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffWordsWithSpace = _word.diffWordsWithSpace;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffLines = _line.diffLines;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffTrimmedLines = _line.diffTrimmedLines;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffSentences = _sentence.diffSentences;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffCss = _css.diffCss;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffJson = _json.diffJson;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffArrays = _array.diffArrays;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/structuredPatch = _create.structuredPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/createTwoFilesPatch = _create.createTwoFilesPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/createPatch = _create.createPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/applyPatch = _apply.applyPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/applyPatches = _apply.applyPatches;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/parsePatch = _parse.parsePatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/merge = _merge.merge;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/convertChangesToDMP = _dmp.convertChangesToDMP;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/convertChangesToXML = _xml.convertChangesToXML;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/canonicalize = _json.canonicalize;\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJEaWZmIiwiZGlmZkNoYXJzIiwiZGlmZldvcmRzIiwiZGlmZldvcmRzV2l0aFNwYWNlIiwiZGlmZkxpbmVzIiwiZGlmZlRyaW1tZWRMaW5lcyIsImRpZmZTZW50ZW5jZXMiLCJkaWZmQ3NzIiwiZGlmZkpzb24iLCJkaWZmQXJyYXlzIiwic3RydWN0dXJlZFBhdGNoIiwiY3JlYXRlVHdvRmlsZXNQYXRjaCIsImNyZWF0ZVBhdGNoIiwiYXBwbHlQYXRjaCIsImFwcGx5UGF0Y2hlcyIsInBhcnNlUGF0Y2giLCJtZXJnZSIsImNvbnZlcnRDaGFuZ2VzVG9ETVAiLCJjb252ZXJ0Q2hhbmdlc1RvWE1MIiwiY2Fub25pY2FsaXplIl0sIm1hcHBpbmdzIjoiOzs7Ozt1QkFnQkE7Ozs7dUJBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBRUE7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7Ozs7QUFqQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7O2dDQWtDRUEsSTt5REFFQUMsUzt5REFDQUMsUzt5REFDQUMsa0I7eURBQ0FDLFM7eURBQ0FDLGdCO3lEQUNBQyxhO3lEQUVBQyxPO3lEQUNBQyxRO3lEQUVBQyxVO3lEQUVBQyxlO3lEQUNBQyxtQjt5REFDQUMsVzt5REFDQUMsVTt5REFDQUMsWTt5REFDQUMsVTt5REFDQUMsSzt5REFDQUMsbUI7eURBQ0FDLG1CO3lEQUNBQyxZIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogU2VlIExJQ0VOU0UgZmlsZSBmb3IgdGVybXMgb2YgdXNlICovXG5cbi8qXG4gKiBUZXh0IGRpZmYgaW1wbGVtZW50YXRpb24uXG4gKlxuICogVGhpcyBsaWJyYXJ5IHN1cHBvcnRzIHRoZSBmb2xsb3dpbmcgQVBJUzpcbiAqIEpzRGlmZi5kaWZmQ2hhcnM6IENoYXJhY3RlciBieSBjaGFyYWN0ZXIgZGlmZlxuICogSnNEaWZmLmRpZmZXb3JkczogV29yZCAoYXMgZGVmaW5lZCBieSBcXGIgcmVnZXgpIGRpZmYgd2hpY2ggaWdub3JlcyB3aGl0ZXNwYWNlXG4gKiBKc0RpZmYuZGlmZkxpbmVzOiBMaW5lIGJhc2VkIGRpZmZcbiAqXG4gKiBKc0RpZmYuZGlmZkNzczogRGlmZiB0YXJnZXRlZCBhdCBDU1MgY29udGVudFxuICpcbiAqIFRoZXNlIG1ldGhvZHMgYXJlIGJhc2VkIG9uIHRoZSBpbXBsZW1lbnRhdGlvbiBwcm9wb3NlZCBpblxuICogXCJBbiBPKE5EKSBEaWZmZXJlbmNlIEFsZ29yaXRobSBhbmQgaXRzIFZhcmlhdGlvbnNcIiAoTXllcnMsIDE5ODYpLlxuICogaHR0cDovL2NpdGVzZWVyeC5pc3QucHN1LmVkdS92aWV3ZG9jL3N1bW1hcnk/ZG9pPTEwLjEuMS40LjY5MjdcbiAqL1xuaW1wb3J0IERpZmYgZnJvbSAnLi9kaWZmL2Jhc2UnO1xuaW1wb3J0IHtkaWZmQ2hhcnN9IGZyb20gJy4vZGlmZi9jaGFyYWN0ZXInO1xuaW1wb3J0IHtkaWZmV29yZHMsIGRpZmZXb3Jkc1dpdGhTcGFjZX0gZnJvbSAnLi9kaWZmL3dvcmQnO1xuaW1wb3J0IHtkaWZmTGluZXMsIGRpZmZUcmltbWVkTGluZXN9IGZyb20gJy4vZGlmZi9saW5lJztcbmltcG9ydCB7ZGlmZlNlbnRlbmNlc30gZnJvbSAnLi9kaWZmL3NlbnRlbmNlJztcblxuaW1wb3J0IHtkaWZmQ3NzfSBmcm9tICcuL2RpZmYvY3NzJztcbmltcG9ydCB7ZGlmZkpzb24sIGNhbm9uaWNhbGl6ZX0gZnJvbSAnLi9kaWZmL2pzb24nO1xuXG5pbXBvcnQge2RpZmZBcnJheXN9IGZyb20gJy4vZGlmZi9hcnJheSc7XG5cbmltcG9ydCB7YXBwbHlQYXRjaCwgYXBwbHlQYXRjaGVzfSBmcm9tICcuL3BhdGNoL2FwcGx5JztcbmltcG9ydCB7cGFyc2VQYXRjaH0gZnJvbSAnLi9wYXRjaC9wYXJzZSc7XG5pbXBvcnQge21lcmdlfSBmcm9tICcuL3BhdGNoL21lcmdlJztcbmltcG9ydCB7c3RydWN0dXJlZFBhdGNoLCBjcmVhdGVUd29GaWxlc1BhdGNoLCBjcmVhdGVQYXRjaH0gZnJvbSAnLi9wYXRjaC9jcmVhdGUnO1xuXG5pbXBvcnQge2NvbnZlcnRDaGFuZ2VzVG9ETVB9IGZyb20gJy4vY29udmVydC9kbXAnO1xuaW1wb3J0IHtjb252ZXJ0Q2hhbmdlc1RvWE1MfSBmcm9tICcuL2NvbnZlcnQveG1sJztcblxuZXhwb3J0IHtcbiAgRGlmZixcblxuICBkaWZmQ2hhcnMsXG4gIGRpZmZXb3JkcyxcbiAgZGlmZldvcmRzV2l0aFNwYWNlLFxuICBkaWZmTGluZXMsXG4gIGRpZmZUcmltbWVkTGluZXMsXG4gIGRpZmZTZW50ZW5jZXMsXG5cbiAgZGlmZkNzcyxcbiAgZGlmZkpzb24sXG5cbiAgZGlmZkFycmF5cyxcblxuICBzdHJ1Y3R1cmVkUGF0Y2gsXG4gIGNyZWF0ZVR3b0ZpbGVzUGF0Y2gsXG4gIGNyZWF0ZVBhdGNoLFxuICBhcHBseVBhdGNoLFxuICBhcHBseVBhdGNoZXMsXG4gIHBhcnNlUGF0Y2gsXG4gIG1lcmdlLFxuICBjb252ZXJ0Q2hhbmdlc1RvRE1QLFxuICBjb252ZXJ0Q2hhbmdlc1RvWE1MLFxuICBjYW5vbmljYWxpemVcbn07XG4iXX0=\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports['default'] = /*istanbul ignore end*/Diff;\n\tfunction Diff() {}\n\n\tDiff.prototype = {\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/diff: function diff(oldString, newString) {\n\t    /*istanbul ignore start*/var /*istanbul ignore end*/options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n\t    var callback = options.callback;\n\t    if (typeof options === 'function') {\n\t      callback = options;\n\t      options = {};\n\t    }\n\t    this.options = options;\n\n\t    var self = this;\n\n\t    function done(value) {\n\t      if (callback) {\n\t        setTimeout(function () {\n\t          callback(undefined, value);\n\t        }, 0);\n\t        return true;\n\t      } else {\n\t        return value;\n\t      }\n\t    }\n\n\t    // Allow subclasses to massage the input prior to running\n\t    oldString = this.castInput(oldString);\n\t    newString = this.castInput(newString);\n\n\t    oldString = this.removeEmpty(this.tokenize(oldString));\n\t    newString = this.removeEmpty(this.tokenize(newString));\n\n\t    var newLen = newString.length,\n\t        oldLen = oldString.length;\n\t    var editLength = 1;\n\t    var maxEditLength = newLen + oldLen;\n\t    var bestPath = [{ newPos: -1, components: [] }];\n\n\t    // Seed editLength = 0, i.e. the content starts with the same values\n\t    var oldPos = this.extractCommon(bestPath[0], newString, oldString, 0);\n\t    if (bestPath[0].newPos + 1 >= newLen && oldPos + 1 >= oldLen) {\n\t      // Identity per the equality and tokenizer\n\t      return done([{ value: this.join(newString), count: newString.length }]);\n\t    }\n\n\t    // Main worker method. checks all permutations of a given edit length for acceptance.\n\t    function execEditLength() {\n\t      for (var diagonalPath = -1 * editLength; diagonalPath <= editLength; diagonalPath += 2) {\n\t        var basePath = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\t        var addPath = bestPath[diagonalPath - 1],\n\t            removePath = bestPath[diagonalPath + 1],\n\t            _oldPos = (removePath ? removePath.newPos : 0) - diagonalPath;\n\t        if (addPath) {\n\t          // No one else is going to attempt to use this value, clear it\n\t          bestPath[diagonalPath - 1] = undefined;\n\t        }\n\n\t        var canAdd = addPath && addPath.newPos + 1 < newLen,\n\t            canRemove = removePath && 0 <= _oldPos && _oldPos < oldLen;\n\t        if (!canAdd && !canRemove) {\n\t          // If this path is a terminal then prune\n\t          bestPath[diagonalPath] = undefined;\n\t          continue;\n\t        }\n\n\t        // Select the diagonal that we want to branch from. We select the prior\n\t        // path whose position in the new string is the farthest from the origin\n\t        // and does not pass the bounds of the diff graph\n\t        if (!canAdd || canRemove && addPath.newPos < removePath.newPos) {\n\t          basePath = clonePath(removePath);\n\t          self.pushComponent(basePath.components, undefined, true);\n\t        } else {\n\t          basePath = addPath; // No need to clone, we've pulled it from the list\n\t          basePath.newPos++;\n\t          self.pushComponent(basePath.components, true, undefined);\n\t        }\n\n\t        _oldPos = self.extractCommon(basePath, newString, oldString, diagonalPath);\n\n\t        // If we have hit the end of both strings, then we are done\n\t        if (basePath.newPos + 1 >= newLen && _oldPos + 1 >= oldLen) {\n\t          return done(buildValues(self, basePath.components, newString, oldString, self.useLongestToken));\n\t        } else {\n\t          // Otherwise track this path as a potential candidate and continue.\n\t          bestPath[diagonalPath] = basePath;\n\t        }\n\t      }\n\n\t      editLength++;\n\t    }\n\n\t    // Performs the length of edit iteration. Is a bit fugly as this has to support the\n\t    // sync and async mode which is never fun. Loops over execEditLength until a value\n\t    // is produced.\n\t    if (callback) {\n\t      (function exec() {\n\t        setTimeout(function () {\n\t          // This should not happen, but we want to be safe.\n\t          /* istanbul ignore next */\n\t          if (editLength > maxEditLength) {\n\t            return callback();\n\t          }\n\n\t          if (!execEditLength()) {\n\t            exec();\n\t          }\n\t        }, 0);\n\t      })();\n\t    } else {\n\t      while (editLength <= maxEditLength) {\n\t        var ret = execEditLength();\n\t        if (ret) {\n\t          return ret;\n\t        }\n\t      }\n\t    }\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/pushComponent: function pushComponent(components, added, removed) {\n\t    var last = components[components.length - 1];\n\t    if (last && last.added === added && last.removed === removed) {\n\t      // We need to clone here as the component clone operation is just\n\t      // as shallow array clone\n\t      components[components.length - 1] = { count: last.count + 1, added: added, removed: removed };\n\t    } else {\n\t      components.push({ count: 1, added: added, removed: removed });\n\t    }\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/extractCommon: function extractCommon(basePath, newString, oldString, diagonalPath) {\n\t    var newLen = newString.length,\n\t        oldLen = oldString.length,\n\t        newPos = basePath.newPos,\n\t        oldPos = newPos - diagonalPath,\n\t        commonCount = 0;\n\t    while (newPos + 1 < newLen && oldPos + 1 < oldLen && this.equals(newString[newPos + 1], oldString[oldPos + 1])) {\n\t      newPos++;\n\t      oldPos++;\n\t      commonCount++;\n\t    }\n\n\t    if (commonCount) {\n\t      basePath.components.push({ count: commonCount });\n\t    }\n\n\t    basePath.newPos = newPos;\n\t    return oldPos;\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/equals: function equals(left, right) {\n\t    if (this.options.comparator) {\n\t      return this.options.comparator(left, right);\n\t    } else {\n\t      return left === right || this.options.ignoreCase && left.toLowerCase() === right.toLowerCase();\n\t    }\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/removeEmpty: function removeEmpty(array) {\n\t    var ret = [];\n\t    for (var i = 0; i < array.length; i++) {\n\t      if (array[i]) {\n\t        ret.push(array[i]);\n\t      }\n\t    }\n\t    return ret;\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/castInput: function castInput(value) {\n\t    return value;\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/tokenize: function tokenize(value) {\n\t    return value.split('');\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/join: function join(chars) {\n\t    return chars.join('');\n\t  }\n\t};\n\n\tfunction buildValues(diff, components, newString, oldString, useLongestToken) {\n\t  var componentPos = 0,\n\t      componentLen = components.length,\n\t      newPos = 0,\n\t      oldPos = 0;\n\n\t  for (; componentPos < componentLen; componentPos++) {\n\t    var component = components[componentPos];\n\t    if (!component.removed) {\n\t      if (!component.added && useLongestToken) {\n\t        var value = newString.slice(newPos, newPos + component.count);\n\t        value = value.map(function (value, i) {\n\t          var oldValue = oldString[oldPos + i];\n\t          return oldValue.length > value.length ? oldValue : value;\n\t        });\n\n\t        component.value = diff.join(value);\n\t      } else {\n\t        component.value = diff.join(newString.slice(newPos, newPos + component.count));\n\t      }\n\t      newPos += component.count;\n\n\t      // Common case\n\t      if (!component.added) {\n\t        oldPos += component.count;\n\t      }\n\t    } else {\n\t      component.value = diff.join(oldString.slice(oldPos, oldPos + component.count));\n\t      oldPos += component.count;\n\n\t      // Reverse add and remove so removes are output first to match common convention\n\t      // The diffing algorithm is tied to add then remove output and this is the simplest\n\t      // route to get the desired output with minimal overhead.\n\t      if (componentPos && components[componentPos - 1].added) {\n\t        var tmp = components[componentPos - 1];\n\t        components[componentPos - 1] = components[componentPos];\n\t        components[componentPos] = tmp;\n\t      }\n\t    }\n\t  }\n\n\t  // Special case handle for when one terminal is ignored (i.e. whitespace).\n\t  // For this case we merge the terminal into the prior string and drop the change.\n\t  // This is only available for string mode.\n\t  var lastComponent = components[componentLen - 1];\n\t  if (componentLen > 1 && typeof lastComponent.value === 'string' && (lastComponent.added || lastComponent.removed) && diff.equals('', lastComponent.value)) {\n\t    components[componentLen - 2].value += lastComponent.value;\n\t    components.pop();\n\t  }\n\n\t  return components;\n\t}\n\n\tfunction clonePath(path) {\n\t  return { newPos: path.newPos, components: path.components.slice(0) };\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2Jhc2UuanMiXSwibmFtZXMiOlsiRGlmZiIsInByb3RvdHlwZSIsImRpZmYiLCJvbGRTdHJpbmciLCJuZXdTdHJpbmciLCJvcHRpb25zIiwiY2FsbGJhY2siLCJzZWxmIiwiZG9uZSIsInZhbHVlIiwic2V0VGltZW91dCIsInVuZGVmaW5lZCIsImNhc3RJbnB1dCIsInJlbW92ZUVtcHR5IiwidG9rZW5pemUiLCJuZXdMZW4iLCJsZW5ndGgiLCJvbGRMZW4iLCJlZGl0TGVuZ3RoIiwibWF4RWRpdExlbmd0aCIsImJlc3RQYXRoIiwibmV3UG9zIiwiY29tcG9uZW50cyIsIm9sZFBvcyIsImV4dHJhY3RDb21tb24iLCJqb2luIiwiY291bnQiLCJleGVjRWRpdExlbmd0aCIsImRpYWdvbmFsUGF0aCIsImJhc2VQYXRoIiwiYWRkUGF0aCIsInJlbW92ZVBhdGgiLCJjYW5BZGQiLCJjYW5SZW1vdmUiLCJjbG9uZVBhdGgiLCJwdXNoQ29tcG9uZW50IiwiYnVpbGRWYWx1ZXMiLCJ1c2VMb25nZXN0VG9rZW4iLCJleGVjIiwicmV0IiwiYWRkZWQiLCJyZW1vdmVkIiwibGFzdCIsInB1c2giLCJjb21tb25Db3VudCIsImVxdWFscyIsImxlZnQiLCJyaWdodCIsImNvbXBhcmF0b3IiLCJpZ25vcmVDYXNlIiwidG9Mb3dlckNhc2UiLCJhcnJheSIsImkiLCJzcGxpdCIsImNoYXJzIiwiY29tcG9uZW50UG9zIiwiY29tcG9uZW50TGVuIiwiY29tcG9uZW50Iiwic2xpY2UiLCJtYXAiLCJvbGRWYWx1ZSIsInRtcCIsImxhc3RDb21wb25lbnQiLCJwb3AiLCJwYXRoIl0sIm1hcHBpbmdzIjoiOzs7NENBQXdCQSxJO0FBQVQsU0FBU0EsSUFBVCxHQUFnQixDQUFFOztBQUVqQ0EsS0FBS0MsU0FBTCxHQUFpQjtBQUFBLG1EQUNmQyxJQURlLGdCQUNWQyxTQURVLEVBQ0NDLFNBREQsRUFDMEI7QUFBQSx3REFBZEMsT0FBYyx1RUFBSixFQUFJOztBQUN2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RUFBd0JBLFNBQVNrQyxVQUFVL0IsS0FBM0MsQ0FBVixDQUFsQjtBQUNBSCxnQkFBVWtDLFVBQVUvQixLQUFwQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxVQUFJNkIsZ0JBQWdCakMsV0FBV2lDLGVBQWUsQ0FBMUIsRUFBNkJmLEtBQWpELEVBQXdEO0FBQ3RELFlBQUlxQixNQUFNdkMsV0FBV2lDLGVBQWUsQ0FBMUIsQ0FBVjtBQUNBakMsbUJBQVdpQyxlQUFlLENBQTFCLElBQStCakMsV0FBV2lDLFlBQVgsQ0FBL0I7QUFDQWpDLG1CQUFXaUMsWUFBWCxJQUEyQk0sR0FBM0I7QUFDRDtBQUNGO0FBQ0Y7O0FBRUQ7QUFDQTtBQUNBO0FBQ0EsTUFBSUMsZ0JBQWdCeEMsV0FBV2tDLGVBQWUsQ0FBMUIsQ0FBcEI7QUFDQSxNQUFJQSxlQUFlLENBQWYsSUFDRyxPQUFPTSxjQUFjckQsS0FBckIsS0FBK0IsUUFEbEMsS0FFSXFELGNBQWN0QixLQUFkLElBQXVCc0IsY0FBY3JCLE9BRnpDLEtBR0d2QyxLQUFLMkMsTUFBTCxDQUFZLEVBQVosRUFBZ0JpQixjQUFjckQsS0FBOUIsQ0FIUCxFQUc2QztBQUMzQ2EsZUFBV2tDLGVBQWUsQ0FBMUIsRUFBNkIvQyxLQUE3QixJQUFzQ3FELGNBQWNyRCxLQUFwRDtBQUNBYSxlQUFXeUMsR0FBWDtBQUNEOztBQUVELFNBQU96QyxVQUFQO0FBQ0Q7O0FBRUQsU0FBU1ksU0FBVCxDQUFtQjhCLElBQW5CLEVBQXlCO0FBQ3ZCLFNBQU8sRUFBRTNDLFFBQVEyQyxLQUFLM0MsTUFBZixFQUF1QkMsWUFBWTBDLEtBQUsxQyxVQUFMLENBQWdCb0MsS0FBaEIsQ0FBc0IsQ0FBdEIsQ0FBbkMsRUFBUDtBQUNEIiwiZmlsZSI6ImJhc2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBEaWZmKCkge31cblxuRGlmZi5wcm90b3R5cGUgPSB7XG4gIGRpZmYob2xkU3RyaW5nLCBuZXdTdHJpbmcsIG9wdGlvbnMgPSB7fSkge1xuICAgIGxldCBjYWxsYmFjayA9IG9wdGlvbnMuY2FsbGJhY2s7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjYWxsYmFjayA9IG9wdGlvbnM7XG4gICAgICBvcHRpb25zID0ge307XG4gICAgfVxuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG5cbiAgICBsZXQgc2VsZiA9IHRoaXM7XG5cbiAgICBmdW5jdGlvbiBkb25lKHZhbHVlKSB7XG4gICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgY2FsbGJhY2sodW5kZWZpbmVkLCB2YWx1ZSk7IH0sIDApO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBbGxvdyBzdWJjbGFzc2VzIHRvIG1hc3NhZ2UgdGhlIGlucHV0IHByaW9yIHRvIHJ1bm5pbmdcbiAgICBvbGRTdHJpbmcgPSB0aGlzLmNhc3RJbnB1dChvbGRTdHJpbmcpO1xuICAgIG5ld1N0cmluZyA9IHRoaXMuY2FzdElucHV0KG5ld1N0cmluZyk7XG5cbiAgICBvbGRTdHJpbmcgPSB0aGlzLnJlbW92ZUVtcHR5KHRoaXMudG9rZW5pemUob2xkU3RyaW5nKSk7XG4gICAgbmV3U3RyaW5nID0gdGhpcy5yZW1vdmVFbXB0eSh0aGlzLnRva2VuaXplKG5ld1N0cmluZykpO1xuXG4gICAgbGV0IG5ld0xlbiA9IG5ld1N0cmluZy5sZW5ndGgsIG9sZExlbiA9IG9sZFN0cmluZy5sZW5ndGg7XG4gICAgbGV0IGVkaXRMZW5ndGggPSAxO1xuICAgIGxldCBtYXhFZGl0TGVuZ3RoID0gbmV3TGVuICsgb2xkTGVuO1xuICAgIGxldCBiZXN0UGF0aCA9IFt7IG5ld1BvczogLTEsIGNvbXBvbmVudHM6IFtdIH1dO1xuXG4gICAgLy8gU2VlZCBlZGl0TGVuZ3RoID0gMCwgaS5lLiB0aGUgY29udGVudCBzdGFydHMgd2l0aCB0aGUgc2FtZSB2YWx1ZXNcbiAgICBsZXQgb2xkUG9zID0gdGhpcy5leHRyYWN0Q29tbW9uKGJlc3RQYXRoWzBdLCBuZXdTdHJpbmcsIG9sZFN0cmluZywgMCk7XG4gICAgaWYgKGJlc3RQYXRoWzBdLm5ld1BvcyArIDEgPj0gbmV3TGVuICYmIG9sZFBvcyArIDEgPj0gb2xkTGVuKSB7XG4gICAgICAvLyBJZGVudGl0eSBwZXIgdGhlIGVxdWFsaXR5IGFuZCB0b2tlbml6ZXJcbiAgICAgIHJldHVybiBkb25lKFt7dmFsdWU6IHRoaXMuam9pbihuZXdTdHJpbmcpLCBjb3VudDogbmV3U3RyaW5nLmxlbmd0aH1dKTtcbiAgICB9XG5cbiAgICAvLyBNYWluIHdvcmtlciBtZXRob2QuIGNoZWNrcyBhbGwgcGVybXV0YXRpb25zIG9mIGEgZ2l2ZW4gZWRpdCBsZW5ndGggZm9yIGFjY2VwdGFuY2UuXG4gICAgZnVuY3Rpb24gZXhlY0VkaXRMZW5ndGgoKSB7XG4gICAgICBmb3IgKGxldCBkaWFnb25hbFBhdGggPSAtMSAqIGVkaXRMZW5ndGg7IGRpYWdvbmFsUGF0aCA8PSBlZGl0TGVuZ3RoOyBkaWFnb25hbFBhdGggKz0gMikge1xuICAgICAgICBsZXQgYmFzZVBhdGg7XG4gICAgICAgIGxldCBhZGRQYXRoID0gYmVzdFBhdGhbZGlhZ29uYWxQYXRoIC0gMV0sXG4gICAgICAgICAgICByZW1vdmVQYXRoID0gYmVzdFBhdGhbZGlhZ29uYWxQYXRoICsgMV0sXG4gICAgICAgICAgICBvbGRQb3MgPSAocmVtb3ZlUGF0aCA/IHJlbW92ZVBhdGgubmV3UG9zIDogMCkgLSBkaWFnb25hbFBhdGg7XG4gICAgICAgIGlmIChhZGRQYXRoKSB7XG4gICAgICAgICAgLy8gTm8gb25lIGVsc2UgaXMgZ29pbmcgdG8gYXR0ZW1wdCB0byB1c2UgdGhpcyB2YWx1ZSwgY2xlYXIgaXRcbiAgICAgICAgICBiZXN0UGF0aFtkaWFnb25hbFBhdGggLSAxXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjYW5BZGQgPSBhZGRQYXRoICYmIGFkZFBhdGgubmV3UG9zICsgMSA8IG5ld0xlbixcbiAgICAgICAgICAgIGNhblJlbW92ZSA9IHJlbW92ZVBhdGggJiYgMCA8PSBvbGRQb3MgJiYgb2xkUG9zIDwgb2xkTGVuO1xuICAgICAgICBpZiAoIWNhbkFkZCAmJiAhY2FuUmVtb3ZlKSB7XG4gICAgICAgICAgLy8gSWYgdGhpcyBwYXRoIGlzIGEgdGVybWluYWwgdGhlbiBwcnVuZVxuICAgICAgICAgIGJlc3RQYXRoW2RpYWdvbmFsUGF0aF0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZWxlY3QgdGhlIGRpYWdvbmFsIHRoYXQgd2Ugd2FudCB0byBicmFuY2ggZnJvbS4gV2Ugc2VsZWN0IHRoZSBwcmlvclxuICAgICAgICAvLyBwYXRoIHdob3NlIHBvc2l0aW9uIGluIHRoZSBuZXcgc3RyaW5nIGlzIHRoZSBmYXJ0aGVzdCBmcm9tIHRoZSBvcmlnaW5cbiAgICAgICAgLy8gYW5kIGRvZXMgbm90IHBhc3MgdGhlIGJvdW5kcyBvZiB0aGUgZGlmZiBncmFwaFxuICAgICAgICBpZiAoIWNhbkFkZCB8fCAoY2FuUmVtb3ZlICYmIGFkZFBhdGgubmV3UG9zIDwgcmVtb3ZlUGF0aC5uZXdQb3MpKSB7XG4gICAgICAgICAgYmFzZVBhdGggPSBjbG9uZVBhdGgocmVtb3ZlUGF0aCk7XG4gICAgICAgICAgc2VsZi5wdXNoQ29tcG9uZW50KGJhc2VQYXRoLmNvbXBvbmVudHMsIHVuZGVmaW5lZCwgdHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYmFzZVBhdGggPSBhZGRQYXRoOyAgIC8vIE5vIG5lZWQgdG8gY2xvbmUsIHdlJ3ZlIHB1bGxlZCBpdCBmcm9tIHRoZSBsaXN0XG4gICAgICAgICAgYmFzZVBhdGgubmV3UG9zKys7XG4gICAgICAgICAgc2VsZi5wdXNoQ29tcG9uZW50KGJhc2VQYXRoLmNvbXBvbmVudHMsIHRydWUsIHVuZGVmaW5lZCk7XG4gICAgICAgIH1cblxuICAgICAgICBvbGRQb3MgPSBzZWxmLmV4dHJhY3RDb21tb24oYmFzZVBhdGgsIG5ld1N0cmluZywgb2xkU3RyaW5nLCBkaWFnb25hbFBhdGgpO1xuXG4gICAgICAgIC8vIElmIHdlIGhhdmUgaGl0IHRoZSBlbmQgb2YgYm90aCBzdHJpbmdzLCB0aGVuIHdlIGFyZSBkb25lXG4gICAgICAgIGlmIChiYXNlUGF0aC5uZXdQb3MgKyAxID49IG5ld0xlbiAmJiBvbGRQb3MgKyAxID49IG9sZExlbikge1xuICAgICAgICAgIHJldHVybiBkb25lKGJ1aWxkVmFsdWVzKHNlbGYsIGJhc2VQYXRoLmNvbXBvbmVudHMsIG5ld1N0cmluZywgb2xkU3RyaW5nLCBzZWxmLnVzZUxvbmdlc3RUb2tlbikpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIE90aGVyd2lzZSB0cmFjayB0aGlzIHBhdGggYXMgYSBwb3RlbnRpYWwgY2FuZGlkYXRlIGFuZCBjb250aW51ZS5cbiAgICAgICAgICBiZXN0UGF0aFtkaWFnb25hbFBhdGhdID0gYmFzZVBhdGg7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZWRpdExlbmd0aCsrO1xuICAgIH1cblxuICAgIC8vIFBlcmZvcm1zIHRoZSBsZW5ndGggb2YgZWRpdCBpdGVyYXRpb24uIElzIGEgYml0IGZ1Z2x5IGFzIHRoaXMgaGFzIHRvIHN1cHBvcnQgdGhlXG4gICAgLy8gc3luYyBhbmQgYXN5bmMgbW9kZSB3aGljaCBpcyBuZXZlciBmdW4uIExvb3BzIG92ZXIgZXhlY0VkaXRMZW5ndGggdW50aWwgYSB2YWx1ZVxuICAgIC8vIGlzIHByb2R1Y2VkLlxuICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgKGZ1bmN0aW9uIGV4ZWMoKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy8gVGhpcyBzaG91bGQgbm90IGhhcHBlbiwgYnV0IHdlIHdhbnQgdG8gYmUgc2FmZS5cbiAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgICAgICAgIGlmIChlZGl0TGVuZ3RoID4gbWF4RWRpdExlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCFleGVjRWRpdExlbmd0aCgpKSB7XG4gICAgICAgICAgICBleGVjKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCAwKTtcbiAgICAgIH0oKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdoaWxlIChlZGl0TGVuZ3RoIDw9IG1heEVkaXRMZW5ndGgpIHtcbiAgICAgICAgbGV0IHJldCA9IGV4ZWNFZGl0TGVuZ3RoKCk7XG4gICAgICAgIGlmIChyZXQpIHtcbiAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIHB1c2hDb21wb25lbnQoY29tcG9uZW50cywgYWRkZWQsIHJlbW92ZWQpIHtcbiAgICBsZXQgbGFzdCA9IGNvbXBvbmVudHNbY29tcG9uZW50cy5sZW5ndGggLSAxXTtcbiAgICBpZiAobGFzdCAmJiBsYXN0LmFkZGVkID09PSBhZGRlZCAmJiBsYXN0LnJlbW92ZWQgPT09IHJlbW92ZWQpIHtcbiAgICAgIC8vIFdlIG5lZWQgdG8gY2xvbmUgaGVyZSBhcyB0aGUgY29tcG9uZW50IGNsb25lIG9wZXJhdGlvbiBpcyBqdXN0XG4gICAgICAvLyBhcyBzaGFsbG93IGFycmF5IGNsb25lXG4gICAgICBjb21wb25lbnRzW2NvbXBvbmVudHMubGVuZ3RoIC0gMV0gPSB7Y291bnQ6IGxhc3QuY291bnQgKyAxLCBhZGRlZDogYWRkZWQsIHJlbW92ZWQ6IHJlbW92ZWQgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29tcG9uZW50cy5wdXNoKHtjb3VudDogMSwgYWRkZWQ6IGFkZGVkLCByZW1vdmVkOiByZW1vdmVkIH0pO1xuICAgIH1cbiAgfSxcbiAgZXh0cmFjdENvbW1vbihiYXNlUGF0aCwgbmV3U3RyaW5nLCBvbGRTdHJpbmcsIGRpYWdvbmFsUGF0aCkge1xuICAgIGxldCBuZXdMZW4gPSBuZXdTdHJpbmcubGVuZ3RoLFxuICAgICAgICBvbGRMZW4gPSBvbGRTdHJpbmcubGVuZ3RoLFxuICAgICAgICBuZXdQb3MgPSBiYXNlUGF0aC5uZXdQb3MsXG4gICAgICAgIG9sZFBvcyA9IG5ld1BvcyAtIGRpYWdvbmFsUGF0aCxcblxuICAgICAgICBjb21tb25Db3VudCA9IDA7XG4gICAgd2hpbGUgKG5ld1BvcyArIDEgPCBuZXdMZW4gJiYgb2xkUG9zICsgMSA8IG9sZExlbiAmJiB0aGlzLmVxdWFscyhuZXdTdHJpbmdbbmV3UG9zICsgMV0sIG9sZFN0cmluZ1tvbGRQb3MgKyAxXSkpIHtcbiAgICAgIG5ld1BvcysrO1xuICAgICAgb2xkUG9zKys7XG4gICAgICBjb21tb25Db3VudCsrO1xuICAgIH1cblxuICAgIGlmIChjb21tb25Db3VudCkge1xuICAgICAgYmFzZVBhdGguY29tcG9uZW50cy5wdXNoKHtjb3VudDogY29tbW9uQ291bnR9KTtcbiAgICB9XG5cbiAgICBiYXNlUGF0aC5uZXdQb3MgPSBuZXdQb3M7XG4gICAgcmV0dXJuIG9sZFBvcztcbiAgfSxcblxuICBlcXVhbHMobGVmdCwgcmlnaHQpIHtcbiAgICBpZiAodGhpcy5vcHRpb25zLmNvbXBhcmF0b3IpIHtcbiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuY29tcGFyYXRvcihsZWZ0LCByaWdodCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBsZWZ0ID09PSByaWdodFxuICAgICAgICB8fCAodGhpcy5vcHRpb25zLmlnbm9yZUNhc2UgJiYgbGVmdC50b0xvd2VyQ2FzZSgpID09PSByaWdodC50b0xvd2VyQ2FzZSgpKTtcbiAgICB9XG4gIH0sXG4gIHJlbW92ZUVtcHR5KGFycmF5KSB7XG4gICAgbGV0IHJldCA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChhcnJheVtpXSkge1xuICAgICAgICByZXQucHVzaChhcnJheVtpXSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG4gIH0sXG4gIGNhc3RJbnB1dCh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfSxcbiAgdG9rZW5pemUodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUuc3BsaXQoJycpO1xuICB9LFxuICBqb2luKGNoYXJzKSB7XG4gICAgcmV0dXJuIGNoYXJzLmpvaW4oJycpO1xuICB9XG59O1xuXG5mdW5jdGlvbiBidWlsZFZhbHVlcyhkaWZmLCBjb21wb25lbnRzLCBuZXdTdHJpbmcsIG9sZFN0cmluZywgdXNlTG9uZ2VzdFRva2VuKSB7XG4gIGxldCBjb21wb25lbnRQb3MgPSAwLFxuICAgICAgY29tcG9uZW50TGVuID0gY29tcG9uZW50cy5sZW5ndGgsXG4gICAgICBuZXdQb3MgPSAwLFxuICAgICAgb2xkUG9zID0gMDtcblxuICBmb3IgKDsgY29tcG9uZW50UG9zIDwgY29tcG9uZW50TGVuOyBjb21wb25lbnRQb3MrKykge1xuICAgIGxldCBjb21wb25lbnQgPSBjb21wb25lbnRzW2NvbXBvbmVudFBvc107XG4gICAgaWYgKCFjb21wb25lbnQucmVtb3ZlZCkge1xuICAgICAgaWYgKCFjb21wb25lbnQuYWRkZWQgJiYgdXNlTG9uZ2VzdFRva2VuKSB7XG4gICAgICAgIGxldCB2YWx1ZSA9IG5ld1N0cmluZy5zbGljZShuZXdQb3MsIG5ld1BvcyArIGNvbXBvbmVudC5jb3VudCk7XG4gICAgICAgIHZhbHVlID0gdmFsdWUubWFwKGZ1bmN0aW9uKHZhbHVlLCBpKSB7XG4gICAgICAgICAgbGV0IG9sZFZhbHVlID0gb2xkU3RyaW5nW29sZFBvcyArIGldO1xuICAgICAgICAgIHJldHVybiBvbGRWYWx1ZS5sZW5ndGggPiB2YWx1ZS5sZW5ndGggPyBvbGRWYWx1ZSA6IHZhbHVlO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb21wb25lbnQudmFsdWUgPSBkaWZmLmpvaW4odmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29tcG9uZW50LnZhbHVlID0gZGlmZi5qb2luKG5ld1N0cmluZy5zbGljZShuZXdQb3MsIG5ld1BvcyArIGNvbXBvbmVudC5jb3VudCkpO1xuICAgICAgfVxuICAgICAgbmV3UG9zICs9IGNvbXBvbmVudC5jb3VudDtcblxuICAgICAgLy8gQ29tbW9uIGNhc2VcbiAgICAgIGlmICghY29tcG9uZW50LmFkZGVkKSB7XG4gICAgICAgIG9sZFBvcyArPSBjb21wb25lbnQuY291bnQ7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbXBvbmVudC52YWx1ZSA9IGRpZmYuam9pbihvbGRTdHJpbmcuc2xpY2Uob2xkUG9zLCBvbGRQb3MgKyBjb21wb25lbnQuY291bnQpKTtcbiAgICAgIG9sZFBvcyArPSBjb21wb25lbnQuY291bnQ7XG5cbiAgICAgIC8vIFJldmVyc2UgYWRkIGFuZCByZW1vdmUgc28gcmVtb3ZlcyBhcmUgb3V0cHV0IGZpcnN0IHRvIG1hdGNoIGNvbW1vbiBjb252ZW50aW9uXG4gICAgICAvLyBUaGUgZGlmZmluZyBhbGdvcml0aG0gaXMgdGllZCB0byBhZGQgdGhlbiByZW1vdmUgb3V0cHV0IGFuZCB0aGlzIGlzIHRoZSBzaW1wbGVzdFxuICAgICAgLy8gcm91dGUgdG8gZ2V0IHRoZSBkZXNpcmVkIG91dHB1dCB3aXRoIG1pbmltYWwgb3ZlcmhlYWQuXG4gICAgICBpZiAoY29tcG9uZW50UG9zICYmIGNvbXBvbmVudHNbY29tcG9uZW50UG9zIC0gMV0uYWRkZWQpIHtcbiAgICAgICAgbGV0IHRtcCA9IGNvbXBvbmVudHNbY29tcG9uZW50UG9zIC0gMV07XG4gICAgICAgIGNvbXBvbmVudHNbY29tcG9uZW50UG9zIC0gMV0gPSBjb21wb25lbnRzW2NvbXBvbmVudFBvc107XG4gICAgICAgIGNvbXBvbmVudHNbY29tcG9uZW50UG9zXSA9IHRtcDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBTcGVjaWFsIGNhc2UgaGFuZGxlIGZvciB3aGVuIG9uZSB0ZXJtaW5hbCBpcyBpZ25vcmVkIChpLmUuIHdoaXRlc3BhY2UpLlxuICAvLyBGb3IgdGhpcyBjYXNlIHdlIG1lcmdlIHRoZSB0ZXJtaW5hbCBpbnRvIHRoZSBwcmlvciBzdHJpbmcgYW5kIGRyb3AgdGhlIGNoYW5nZS5cbiAgLy8gVGhpcyBpcyBvbmx5IGF2YWlsYWJsZSBmb3Igc3RyaW5nIG1vZGUuXG4gIGxldCBsYXN0Q29tcG9uZW50ID0gY29tcG9uZW50c1tjb21wb25lbnRMZW4gLSAxXTtcbiAgaWYgKGNvbXBvbmVudExlbiA+IDFcbiAgICAgICYmIHR5cGVvZiBsYXN0Q29tcG9uZW50LnZhbHVlID09PSAnc3RyaW5nJ1xuICAgICAgJiYgKGxhc3RDb21wb25lbnQuYWRkZWQgfHwgbGFzdENvbXBvbmVudC5yZW1vdmVkKVxuICAgICAgJiYgZGlmZi5lcXVhbHMoJycsIGxhc3RDb21wb25lbnQudmFsdWUpKSB7XG4gICAgY29tcG9uZW50c1tjb21wb25lbnRMZW4gLSAyXS52YWx1ZSArPSBsYXN0Q29tcG9uZW50LnZhbHVlO1xuICAgIGNvbXBvbmVudHMucG9wKCk7XG4gIH1cblxuICByZXR1cm4gY29tcG9uZW50cztcbn1cblxuZnVuY3Rpb24gY2xvbmVQYXRoKHBhdGgpIHtcbiAgcmV0dXJuIHsgbmV3UG9zOiBwYXRoLm5ld1BvcywgY29tcG9uZW50czogcGF0aC5jb21wb25lbnRzLnNsaWNlKDApIH07XG59XG4iXX0=\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.characterDiff = undefined;\n\texports. /*istanbul ignore end*/diffChars = diffChars;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var characterDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/characterDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tfunction diffChars(oldStr, newStr, options) {\n\t  return characterDiff.diff(oldStr, newStr, options);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2NoYXJhY3Rlci5qcyJdLCJuYW1lcyI6WyJkaWZmQ2hhcnMiLCJjaGFyYWN0ZXJEaWZmIiwib2xkU3RyIiwibmV3U3RyIiwib3B0aW9ucyIsImRpZmYiXSwibWFwcGluZ3MiOiI7Ozs7Z0NBR2dCQSxTLEdBQUFBLFM7O0FBSGhCOzs7Ozs7dUJBRU8sSUFBTUMseUZBQWdCLHdFQUF0QjtBQUNBLFNBQVNELFNBQVQsQ0FBbUJFLE1BQW5CLEVBQTJCQyxNQUEzQixFQUFtQ0MsT0FBbkMsRUFBNEM7QUFBRSxTQUFPSCxjQUFjSSxJQUFkLENBQW1CSCxNQUFuQixFQUEyQkMsTUFBM0IsRUFBbUNDLE9BQW5DLENBQVA7QUFBcUQiLCJmaWxlIjoiY2hhcmFjdGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IERpZmYgZnJvbSAnLi9iYXNlJztcblxuZXhwb3J0IGNvbnN0IGNoYXJhY3RlckRpZmYgPSBuZXcgRGlmZigpO1xuZXhwb3J0IGZ1bmN0aW9uIGRpZmZDaGFycyhvbGRTdHIsIG5ld1N0ciwgb3B0aW9ucykgeyByZXR1cm4gY2hhcmFjdGVyRGlmZi5kaWZmKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKTsgfVxuIl19\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.wordDiff = undefined;\n\texports. /*istanbul ignore end*/diffWords = diffWords;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffWordsWithSpace = diffWordsWithSpace;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_params = __webpack_require__(4) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/ // Based on https://en.wikipedia.org/wiki/Latin_script_in_Unicode\n\t//\n\t// Ranges and exceptions:\n\t// Latin-1 Supplement, 0080–00FF\n\t//  - U+00D7  × Multiplication sign\n\t//  - U+00F7  ÷ Division sign\n\t// Latin Extended-A, 0100–017F\n\t// Latin Extended-B, 0180–024F\n\t// IPA Extensions, 0250–02AF\n\t// Spacing Modifier Letters, 02B0–02FF\n\t//  - U+02C7  ˇ &#711;  Caron\n\t//  - U+02D8  ˘ &#728;  Breve\n\t//  - U+02D9  ˙ &#729;  Dot Above\n\t//  - U+02DA  ˚ &#730;  Ring Above\n\t//  - U+02DB  ˛ &#731;  Ogonek\n\t//  - U+02DC  ˜ &#732;  Small Tilde\n\t//  - U+02DD  ˝ &#733;  Double Acute Accent\n\t// Latin Extended Additional, 1E00–1EFF\n\tvar extendedWordChars = /^[A-Za-z\\xC0-\\u02C6\\u02C8-\\u02D7\\u02DE-\\u02FF\\u1E00-\\u1EFF]+$/;\n\n\tvar reWhitespace = /\\S/;\n\n\tvar wordDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/wordDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\twordDiff.equals = function (left, right) {\n\t  if (this.options.ignoreCase) {\n\t    left = left.toLowerCase();\n\t    right = right.toLowerCase();\n\t  }\n\t  return left === right || this.options.ignoreWhitespace && !reWhitespace.test(left) && !reWhitespace.test(right);\n\t};\n\twordDiff.tokenize = function (value) {\n\t  var tokens = value.split(/(\\s+|\\b)/);\n\n\t  // Join the boundary splits that we do not consider to be boundaries. This is primarily the extended Latin character set.\n\t  for (var i = 0; i < tokens.length - 1; i++) {\n\t    // If we have an empty string in the next field and we have only word chars before and after, merge\n\t    if (!tokens[i + 1] && tokens[i + 2] && extendedWordChars.test(tokens[i]) && extendedWordChars.test(tokens[i + 2])) {\n\t      tokens[i] += tokens[i + 2];\n\t      tokens.splice(i + 1, 2);\n\t      i--;\n\t    }\n\t  }\n\n\t  return tokens;\n\t};\n\n\tfunction diffWords(oldStr, newStr, options) {\n\t  options = /*istanbul ignore start*/(0, _params.generateOptions) /*istanbul ignore end*/(options, { ignoreWhitespace: true });\n\t  return wordDiff.diff(oldStr, newStr, options);\n\t}\n\n\tfunction diffWordsWithSpace(oldStr, newStr, options) {\n\t  return wordDiff.diff(oldStr, newStr, options);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL3dvcmQuanMiXSwibmFtZXMiOlsiZGlmZldvcmRzIiwiZGlmZldvcmRzV2l0aFNwYWNlIiwiZXh0ZW5kZWRXb3JkQ2hhcnMiLCJyZVdoaXRlc3BhY2UiLCJ3b3JkRGlmZiIsImVxdWFscyIsImxlZnQiLCJyaWdodCIsIm9wdGlvbnMiLCJpZ25vcmVDYXNlIiwidG9Mb3dlckNhc2UiLCJpZ25vcmVXaGl0ZXNwYWNlIiwidGVzdCIsInRva2VuaXplIiwidmFsdWUiLCJ0b2tlbnMiLCJzcGxpdCIsImkiLCJsZW5ndGgiLCJzcGxpY2UiLCJvbGRTdHIiLCJuZXdTdHIiLCJkaWZmIl0sIm1hcHBpbmdzIjoiOzs7O2dDQW1EZ0JBLFMsR0FBQUEsUzt5REFLQUMsa0IsR0FBQUEsa0I7O0FBeERoQjs7Ozt1QkFDQTs7Ozt3QkFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFNQyxvQkFBb0IsK0RBQTFCOztBQUVBLElBQU1DLGVBQWUsSUFBckI7O0FBRU8sSUFBTUMsK0VBQVcsd0VBQWpCO0FBQ1BBLFNBQVNDLE1BQVQsR0FBa0IsVUFBU0MsSUFBVCxFQUFlQyxLQUFmLEVBQXNCO0FBQ3RDLE1BQUksS0FBS0MsT0FBTCxDQUFhQyxVQUFqQixFQUE2QjtBQUMzQkgsV0FBT0EsS0FBS0ksV0FBTCxFQUFQO0FBQ0FILFlBQVFBLE1BQU1HLFdBQU4sRUFBUjtBQUNEO0FBQ0QsU0FBT0osU0FBU0MsS0FBVCxJQUFtQixLQUFLQyxPQUFMLENBQWFHLGdCQUFiLElBQWlDLENBQUNSLGFBQWFTLElBQWIsQ0FBa0JOLElBQWxCLENBQWxDLElBQTZELENBQUNILGFBQWFTLElBQWIsQ0FBa0JMLEtBQWxCLENBQXhGO0FBQ0QsQ0FORDtBQU9BSCxTQUFTUyxRQUFULEdBQW9CLFVBQVNDLEtBQVQsRUFBZ0I7QUFDbEMsTUFBSUMsU0FBU0QsTUFBTUUsS0FBTixDQUFZLFVBQVosQ0FBYjs7QUFFQTtBQUNBLE9BQUssSUFBSUMsSUFBSSxDQUFiLEVBQWdCQSxJQUFJRixPQUFPRyxNQUFQLEdBQWdCLENBQXBDLEVBQXVDRCxHQUF2QyxFQUE0QztBQUMxQztBQUNBLFFBQUksQ0FBQ0YsT0FBT0UsSUFBSSxDQUFYLENBQUQsSUFBa0JGLE9BQU9FLElBQUksQ0FBWCxDQUFsQixJQUNLZixrQkFBa0JVLElBQWxCLENBQXVCRyxPQUFPRSxDQUFQLENBQXZCLENBREwsSUFFS2Ysa0JBQWtCVSxJQUFsQixDQUF1QkcsT0FBT0UsSUFBSSxDQUFYLENBQXZCLENBRlQsRUFFZ0Q7QUFDOUNGLGFBQU9FLENBQVAsS0FBYUYsT0FBT0UsSUFBSSxDQUFYLENBQWI7QUFDQUYsYUFBT0ksTUFBUCxDQUFjRixJQUFJLENBQWxCLEVBQXFCLENBQXJCO0FBQ0FBO0FBQ0Q7QUFDRjs7QUFFRCxTQUFPRixNQUFQO0FBQ0QsQ0FoQkQ7O0FBa0JPLFNBQVNmLFNBQVQsQ0FBbUJvQixNQUFuQixFQUEyQkMsTUFBM0IsRUFBbUNiLE9BQW5DLEVBQTRDO0FBQ2pEQSxZQUFVLDhFQUFnQkEsT0FBaEIsRUFBeUIsRUFBQ0csa0JBQWtCLElBQW5CLEVBQXpCLENBQVY7QUFDQSxTQUFPUCxTQUFTa0IsSUFBVCxDQUFjRixNQUFkLEVBQXNCQyxNQUF0QixFQUE4QmIsT0FBOUIsQ0FBUDtBQUNEOztBQUVNLFNBQVNQLGtCQUFULENBQTRCbUIsTUFBNUIsRUFBb0NDLE1BQXBDLEVBQTRDYixPQUE1QyxFQUFxRDtBQUMxRCxTQUFPSixTQUFTa0IsSUFBVCxDQUFjRixNQUFkLEVBQXNCQyxNQUF0QixFQUE4QmIsT0FBOUIsQ0FBUDtBQUNEIiwiZmlsZSI6IndvcmQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgRGlmZiBmcm9tICcuL2Jhc2UnO1xuaW1wb3J0IHtnZW5lcmF0ZU9wdGlvbnN9IGZyb20gJy4uL3V0aWwvcGFyYW1zJztcblxuLy8gQmFzZWQgb24gaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTGF0aW5fc2NyaXB0X2luX1VuaWNvZGVcbi8vXG4vLyBSYW5nZXMgYW5kIGV4Y2VwdGlvbnM6XG4vLyBMYXRpbi0xIFN1cHBsZW1lbnQsIDAwODDigJMwMEZGXG4vLyAgLSBVKzAwRDcgIMOXIE11bHRpcGxpY2F0aW9uIHNpZ25cbi8vICAtIFUrMDBGNyAgw7cgRGl2aXNpb24gc2lnblxuLy8gTGF0aW4gRXh0ZW5kZWQtQSwgMDEwMOKAkzAxN0Zcbi8vIExhdGluIEV4dGVuZGVkLUIsIDAxODDigJMwMjRGXG4vLyBJUEEgRXh0ZW5zaW9ucywgMDI1MOKAkzAyQUZcbi8vIFNwYWNpbmcgTW9kaWZpZXIgTGV0dGVycywgMDJCMOKAkzAyRkZcbi8vICAtIFUrMDJDNyAgy4cgJiM3MTE7ICBDYXJvblxuLy8gIC0gVSswMkQ4ICDLmCAmIzcyODsgIEJyZXZlXG4vLyAgLSBVKzAyRDkgIMuZICYjNzI5OyAgRG90IEFib3ZlXG4vLyAgLSBVKzAyREEgIMuaICYjNzMwOyAgUmluZyBBYm92ZVxuLy8gIC0gVSswMkRCICDLmyAmIzczMTsgIE9nb25la1xuLy8gIC0gVSswMkRDICDLnCAmIzczMjsgIFNtYWxsIFRpbGRlXG4vLyAgLSBVKzAyREQgIMudICYjNzMzOyAgRG91YmxlIEFjdXRlIEFjY2VudFxuLy8gTGF0aW4gRXh0ZW5kZWQgQWRkaXRpb25hbCwgMUUwMOKAkzFFRkZcbmNvbnN0IGV4dGVuZGVkV29yZENoYXJzID0gL15bYS16QS1aXFx1e0MwfS1cXHV7RkZ9XFx1e0Q4fS1cXHV7RjZ9XFx1e0Y4fS1cXHV7MkM2fVxcdXsyQzh9LVxcdXsyRDd9XFx1ezJERX0tXFx1ezJGRn1cXHV7MUUwMH0tXFx1ezFFRkZ9XSskL3U7XG5cbmNvbnN0IHJlV2hpdGVzcGFjZSA9IC9cXFMvO1xuXG5leHBvcnQgY29uc3Qgd29yZERpZmYgPSBuZXcgRGlmZigpO1xud29yZERpZmYuZXF1YWxzID0gZnVuY3Rpb24obGVmdCwgcmlnaHQpIHtcbiAgaWYgKHRoaXMub3B0aW9ucy5pZ25vcmVDYXNlKSB7XG4gICAgbGVmdCA9IGxlZnQudG9Mb3dlckNhc2UoKTtcbiAgICByaWdodCA9IHJpZ2h0LnRvTG93ZXJDYXNlKCk7XG4gIH1cbiAgcmV0dXJuIGxlZnQgPT09IHJpZ2h0IHx8ICh0aGlzLm9wdGlvbnMuaWdub3JlV2hpdGVzcGFjZSAmJiAhcmVXaGl0ZXNwYWNlLnRlc3QobGVmdCkgJiYgIXJlV2hpdGVzcGFjZS50ZXN0KHJpZ2h0KSk7XG59O1xud29yZERpZmYudG9rZW5pemUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICBsZXQgdG9rZW5zID0gdmFsdWUuc3BsaXQoLyhcXHMrfFxcYikvKTtcblxuICAvLyBKb2luIHRoZSBib3VuZGFyeSBzcGxpdHMgdGhhdCB3ZSBkbyBub3QgY29uc2lkZXIgdG8gYmUgYm91bmRhcmllcy4gVGhpcyBpcyBwcmltYXJpbHkgdGhlIGV4dGVuZGVkIExhdGluIGNoYXJhY3RlciBzZXQuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdG9rZW5zLmxlbmd0aCAtIDE7IGkrKykge1xuICAgIC8vIElmIHdlIGhhdmUgYW4gZW1wdHkgc3RyaW5nIGluIHRoZSBuZXh0IGZpZWxkIGFuZCB3ZSBoYXZlIG9ubHkgd29yZCBjaGFycyBiZWZvcmUgYW5kIGFmdGVyLCBtZXJnZVxuICAgIGlmICghdG9rZW5zW2kgKyAxXSAmJiB0b2tlbnNbaSArIDJdXG4gICAgICAgICAgJiYgZXh0ZW5kZWRXb3JkQ2hhcnMudGVzdCh0b2tlbnNbaV0pXG4gICAgICAgICAgJiYgZXh0ZW5kZWRXb3JkQ2hhcnMudGVzdCh0b2tlbnNbaSArIDJdKSkge1xuICAgICAgdG9rZW5zW2ldICs9IHRva2Vuc1tpICsgMl07XG4gICAgICB0b2tlbnMuc3BsaWNlKGkgKyAxLCAyKTtcbiAgICAgIGktLTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdG9rZW5zO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGRpZmZXb3JkcyhvbGRTdHIsIG5ld1N0ciwgb3B0aW9ucykge1xuICBvcHRpb25zID0gZ2VuZXJhdGVPcHRpb25zKG9wdGlvbnMsIHtpZ25vcmVXaGl0ZXNwYWNlOiB0cnVlfSk7XG4gIHJldHVybiB3b3JkRGlmZi5kaWZmKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRpZmZXb3Jkc1dpdGhTcGFjZShvbGRTdHIsIG5ld1N0ciwgb3B0aW9ucykge1xuICByZXR1cm4gd29yZERpZmYuZGlmZihvbGRTdHIsIG5ld1N0ciwgb3B0aW9ucyk7XG59XG4iXX0=\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/generateOptions = generateOptions;\n\tfunction generateOptions(options, defaults) {\n\t  if (typeof options === 'function') {\n\t    defaults.callback = options;\n\t  } else if (options) {\n\t    for (var name in options) {\n\t      /* istanbul ignore else */\n\t      if (options.hasOwnProperty(name)) {\n\t        defaults[name] = options[name];\n\t      }\n\t    }\n\t  }\n\t  return defaults;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL3BhcmFtcy5qcyJdLCJuYW1lcyI6WyJnZW5lcmF0ZU9wdGlvbnMiLCJvcHRpb25zIiwiZGVmYXVsdHMiLCJjYWxsYmFjayIsIm5hbWUiLCJoYXNPd25Qcm9wZXJ0eSJdLCJtYXBwaW5ncyI6Ijs7O2dDQUFnQkEsZSxHQUFBQSxlO0FBQVQsU0FBU0EsZUFBVCxDQUF5QkMsT0FBekIsRUFBa0NDLFFBQWxDLEVBQTRDO0FBQ2pELE1BQUksT0FBT0QsT0FBUCxLQUFtQixVQUF2QixFQUFtQztBQUNqQ0MsYUFBU0MsUUFBVCxHQUFvQkYsT0FBcEI7QUFDRCxHQUZELE1BRU8sSUFBSUEsT0FBSixFQUFhO0FBQ2xCLFNBQUssSUFBSUcsSUFBVCxJQUFpQkgsT0FBakIsRUFBMEI7QUFDeEI7QUFDQSxVQUFJQSxRQUFRSSxjQUFSLENBQXVCRCxJQUF2QixDQUFKLEVBQWtDO0FBQ2hDRixpQkFBU0UsSUFBVCxJQUFpQkgsUUFBUUcsSUFBUixDQUFqQjtBQUNEO0FBQ0Y7QUFDRjtBQUNELFNBQU9GLFFBQVA7QUFDRCIsImZpbGUiOiJwYXJhbXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVPcHRpb25zKG9wdGlvbnMsIGRlZmF1bHRzKSB7XG4gIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGRlZmF1bHRzLmNhbGxiYWNrID0gb3B0aW9ucztcbiAgfSBlbHNlIGlmIChvcHRpb25zKSB7XG4gICAgZm9yIChsZXQgbmFtZSBpbiBvcHRpb25zKSB7XG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgICAgaWYgKG9wdGlvbnMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgICAgZGVmYXVsdHNbbmFtZV0gPSBvcHRpb25zW25hbWVdO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gZGVmYXVsdHM7XG59XG4iXX0=\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.lineDiff = undefined;\n\texports. /*istanbul ignore end*/diffLines = diffLines;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffTrimmedLines = diffTrimmedLines;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_params = __webpack_require__(4) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var lineDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/lineDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tlineDiff.tokenize = function (value) {\n\t  var retLines = [],\n\t      linesAndNewlines = value.split(/(\\n|\\r\\n)/);\n\n\t  // Ignore the final empty token that occurs if the string ends with a new line\n\t  if (!linesAndNewlines[linesAndNewlines.length - 1]) {\n\t    linesAndNewlines.pop();\n\t  }\n\n\t  // Merge the content and line separators into single tokens\n\t  for (var i = 0; i < linesAndNewlines.length; i++) {\n\t    var line = linesAndNewlines[i];\n\n\t    if (i % 2 && !this.options.newlineIsToken) {\n\t      retLines[retLines.length - 1] += line;\n\t    } else {\n\t      if (this.options.ignoreWhitespace) {\n\t        line = line.trim();\n\t      }\n\t      retLines.push(line);\n\t    }\n\t  }\n\n\t  return retLines;\n\t};\n\n\tfunction diffLines(oldStr, newStr, callback) {\n\t  return lineDiff.diff(oldStr, newStr, callback);\n\t}\n\tfunction diffTrimmedLines(oldStr, newStr, callback) {\n\t  var options = /*istanbul ignore start*/(0, _params.generateOptions) /*istanbul ignore end*/(callback, { ignoreWhitespace: true });\n\t  return lineDiff.diff(oldStr, newStr, options);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2xpbmUuanMiXSwibmFtZXMiOlsiZGlmZkxpbmVzIiwiZGlmZlRyaW1tZWRMaW5lcyIsImxpbmVEaWZmIiwidG9rZW5pemUiLCJ2YWx1ZSIsInJldExpbmVzIiwibGluZXNBbmROZXdsaW5lcyIsInNwbGl0IiwibGVuZ3RoIiwicG9wIiwiaSIsImxpbmUiLCJvcHRpb25zIiwibmV3bGluZUlzVG9rZW4iLCJpZ25vcmVXaGl0ZXNwYWNlIiwidHJpbSIsInB1c2giLCJvbGRTdHIiLCJuZXdTdHIiLCJjYWxsYmFjayIsImRpZmYiXSwibWFwcGluZ3MiOiI7Ozs7Z0NBOEJnQkEsUyxHQUFBQSxTO3lEQUNBQyxnQixHQUFBQSxnQjs7QUEvQmhCOzs7O3VCQUNBOzs7O3VCQUVPLElBQU1DLCtFQUFXLHdFQUFqQjtBQUNQQSxTQUFTQyxRQUFULEdBQW9CLFVBQVNDLEtBQVQsRUFBZ0I7QUFDbEMsTUFBSUMsV0FBVyxFQUFmO0FBQUEsTUFDSUMsbUJBQW1CRixNQUFNRyxLQUFOLENBQVksV0FBWixDQUR2Qjs7QUFHQTtBQUNBLE1BQUksQ0FBQ0QsaUJBQWlCQSxpQkFBaUJFLE1BQWpCLEdBQTBCLENBQTNDLENBQUwsRUFBb0Q7QUFDbERGLHFCQUFpQkcsR0FBakI7QUFDRDs7QUFFRDtBQUNBLE9BQUssSUFBSUMsSUFBSSxDQUFiLEVBQWdCQSxJQUFJSixpQkFBaUJFLE1BQXJDLEVBQTZDRSxHQUE3QyxFQUFrRDtBQUNoRCxRQUFJQyxPQUFPTCxpQkFBaUJJLENBQWpCLENBQVg7O0FBRUEsUUFBSUEsSUFBSSxDQUFKLElBQVMsQ0FBQyxLQUFLRSxPQUFMLENBQWFDLGNBQTNCLEVBQTJDO0FBQ3pDUixlQUFTQSxTQUFTRyxNQUFULEdBQWtCLENBQTNCLEtBQWlDRyxJQUFqQztBQUNELEtBRkQsTUFFTztBQUNMLFVBQUksS0FBS0MsT0FBTCxDQUFhRSxnQkFBakIsRUFBbUM7QUFDakNILGVBQU9BLEtBQUtJLElBQUwsRUFBUDtBQUNEO0FBQ0RWLGVBQVNXLElBQVQsQ0FBY0wsSUFBZDtBQUNEO0FBQ0Y7O0FBRUQsU0FBT04sUUFBUDtBQUNELENBeEJEOztBQTBCTyxTQUFTTCxTQUFULENBQW1CaUIsTUFBbkIsRUFBMkJDLE1BQTNCLEVBQW1DQyxRQUFuQyxFQUE2QztBQUFFLFNBQU9qQixTQUFTa0IsSUFBVCxDQUFjSCxNQUFkLEVBQXNCQyxNQUF0QixFQUE4QkMsUUFBOUIsQ0FBUDtBQUFpRDtBQUNoRyxTQUFTbEIsZ0JBQVQsQ0FBMEJnQixNQUExQixFQUFrQ0MsTUFBbEMsRUFBMENDLFFBQTFDLEVBQW9EO0FBQ3pELE1BQUlQLFVBQVUsOEVBQWdCTyxRQUFoQixFQUEwQixFQUFDTCxrQkFBa0IsSUFBbkIsRUFBMUIsQ0FBZDtBQUNBLFNBQU9aLFNBQVNrQixJQUFULENBQWNILE1BQWQsRUFBc0JDLE1BQXRCLEVBQThCTixPQUE5QixDQUFQO0FBQ0QiLCJmaWxlIjoibGluZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEaWZmIGZyb20gJy4vYmFzZSc7XG5pbXBvcnQge2dlbmVyYXRlT3B0aW9uc30gZnJvbSAnLi4vdXRpbC9wYXJhbXMnO1xuXG5leHBvcnQgY29uc3QgbGluZURpZmYgPSBuZXcgRGlmZigpO1xubGluZURpZmYudG9rZW5pemUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICBsZXQgcmV0TGluZXMgPSBbXSxcbiAgICAgIGxpbmVzQW5kTmV3bGluZXMgPSB2YWx1ZS5zcGxpdCgvKFxcbnxcXHJcXG4pLyk7XG5cbiAgLy8gSWdub3JlIHRoZSBmaW5hbCBlbXB0eSB0b2tlbiB0aGF0IG9jY3VycyBpZiB0aGUgc3RyaW5nIGVuZHMgd2l0aCBhIG5ldyBsaW5lXG4gIGlmICghbGluZXNBbmROZXdsaW5lc1tsaW5lc0FuZE5ld2xpbmVzLmxlbmd0aCAtIDFdKSB7XG4gICAgbGluZXNBbmROZXdsaW5lcy5wb3AoKTtcbiAgfVxuXG4gIC8vIE1lcmdlIHRoZSBjb250ZW50IGFuZCBsaW5lIHNlcGFyYXRvcnMgaW50byBzaW5nbGUgdG9rZW5zXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXNBbmROZXdsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgIGxldCBsaW5lID0gbGluZXNBbmROZXdsaW5lc1tpXTtcblxuICAgIGlmIChpICUgMiAmJiAhdGhpcy5vcHRpb25zLm5ld2xpbmVJc1Rva2VuKSB7XG4gICAgICByZXRMaW5lc1tyZXRMaW5lcy5sZW5ndGggLSAxXSArPSBsaW5lO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy5vcHRpb25zLmlnbm9yZVdoaXRlc3BhY2UpIHtcbiAgICAgICAgbGluZSA9IGxpbmUudHJpbSgpO1xuICAgICAgfVxuICAgICAgcmV0TGluZXMucHVzaChsaW5lKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmV0TGluZXM7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZGlmZkxpbmVzKG9sZFN0ciwgbmV3U3RyLCBjYWxsYmFjaykgeyByZXR1cm4gbGluZURpZmYuZGlmZihvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spOyB9XG5leHBvcnQgZnVuY3Rpb24gZGlmZlRyaW1tZWRMaW5lcyhvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spIHtcbiAgbGV0IG9wdGlvbnMgPSBnZW5lcmF0ZU9wdGlvbnMoY2FsbGJhY2ssIHtpZ25vcmVXaGl0ZXNwYWNlOiB0cnVlfSk7XG4gIHJldHVybiBsaW5lRGlmZi5kaWZmKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKTtcbn1cbiJdfQ==\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.sentenceDiff = undefined;\n\texports. /*istanbul ignore end*/diffSentences = diffSentences;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var sentenceDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/sentenceDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tsentenceDiff.tokenize = function (value) {\n\t  return value.split(/(\\S.+?[.!?])(?=\\s+|$)/);\n\t};\n\n\tfunction diffSentences(oldStr, newStr, callback) {\n\t  return sentenceDiff.diff(oldStr, newStr, callback);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL3NlbnRlbmNlLmpzIl0sIm5hbWVzIjpbImRpZmZTZW50ZW5jZXMiLCJzZW50ZW5jZURpZmYiLCJ0b2tlbml6ZSIsInZhbHVlIiwic3BsaXQiLCJvbGRTdHIiLCJuZXdTdHIiLCJjYWxsYmFjayIsImRpZmYiXSwibWFwcGluZ3MiOiI7Ozs7Z0NBUWdCQSxhLEdBQUFBLGE7O0FBUmhCOzs7Ozs7dUJBR08sSUFBTUMsdUZBQWUsd0VBQXJCO0FBQ1BBLGFBQWFDLFFBQWIsR0FBd0IsVUFBU0MsS0FBVCxFQUFnQjtBQUN0QyxTQUFPQSxNQUFNQyxLQUFOLENBQVksdUJBQVosQ0FBUDtBQUNELENBRkQ7O0FBSU8sU0FBU0osYUFBVCxDQUF1QkssTUFBdkIsRUFBK0JDLE1BQS9CLEVBQXVDQyxRQUF2QyxFQUFpRDtBQUFFLFNBQU9OLGFBQWFPLElBQWIsQ0FBa0JILE1BQWxCLEVBQTBCQyxNQUExQixFQUFrQ0MsUUFBbEMsQ0FBUDtBQUFxRCIsImZpbGUiOiJzZW50ZW5jZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEaWZmIGZyb20gJy4vYmFzZSc7XG5cblxuZXhwb3J0IGNvbnN0IHNlbnRlbmNlRGlmZiA9IG5ldyBEaWZmKCk7XG5zZW50ZW5jZURpZmYudG9rZW5pemUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUuc3BsaXQoLyhcXFMuKz9bLiE/XSkoPz1cXHMrfCQpLyk7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZGlmZlNlbnRlbmNlcyhvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spIHsgcmV0dXJuIHNlbnRlbmNlRGlmZi5kaWZmKG9sZFN0ciwgbmV3U3RyLCBjYWxsYmFjayk7IH1cbiJdfQ==\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.cssDiff = undefined;\n\texports. /*istanbul ignore end*/diffCss = diffCss;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var cssDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/cssDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tcssDiff.tokenize = function (value) {\n\t  return value.split(/([{}:;,]|\\s+)/);\n\t};\n\n\tfunction diffCss(oldStr, newStr, callback) {\n\t  return cssDiff.diff(oldStr, newStr, callback);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2Nzcy5qcyJdLCJuYW1lcyI6WyJkaWZmQ3NzIiwiY3NzRGlmZiIsInRva2VuaXplIiwidmFsdWUiLCJzcGxpdCIsIm9sZFN0ciIsIm5ld1N0ciIsImNhbGxiYWNrIiwiZGlmZiJdLCJtYXBwaW5ncyI6Ijs7OztnQ0FPZ0JBLE8sR0FBQUEsTzs7QUFQaEI7Ozs7Ozt1QkFFTyxJQUFNQyw2RUFBVSx3RUFBaEI7QUFDUEEsUUFBUUMsUUFBUixHQUFtQixVQUFTQyxLQUFULEVBQWdCO0FBQ2pDLFNBQU9BLE1BQU1DLEtBQU4sQ0FBWSxlQUFaLENBQVA7QUFDRCxDQUZEOztBQUlPLFNBQVNKLE9BQVQsQ0FBaUJLLE1BQWpCLEVBQXlCQyxNQUF6QixFQUFpQ0MsUUFBakMsRUFBMkM7QUFBRSxTQUFPTixRQUFRTyxJQUFSLENBQWFILE1BQWIsRUFBcUJDLE1BQXJCLEVBQTZCQyxRQUE3QixDQUFQO0FBQWdEIiwiZmlsZSI6ImNzcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEaWZmIGZyb20gJy4vYmFzZSc7XG5cbmV4cG9ydCBjb25zdCBjc3NEaWZmID0gbmV3IERpZmYoKTtcbmNzc0RpZmYudG9rZW5pemUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUuc3BsaXQoLyhbe306OyxdfFxccyspLyk7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZGlmZkNzcyhvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spIHsgcmV0dXJuIGNzc0RpZmYuZGlmZihvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spOyB9XG4iXX0=\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.jsonDiff = undefined;\n\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n\texports. /*istanbul ignore end*/diffJson = diffJson;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/canonicalize = canonicalize;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_line = __webpack_require__(5) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var objectPrototypeToString = Object.prototype.toString;\n\n\tvar jsonDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/jsonDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\t// Discriminate between two lines of pretty-printed, serialized JSON where one of them has a\n\t// dangling comma and the other doesn't. Turns out including the dangling comma yields the nicest output:\n\tjsonDiff.useLongestToken = true;\n\n\tjsonDiff.tokenize = /*istanbul ignore start*/_line.lineDiff /*istanbul ignore end*/.tokenize;\n\tjsonDiff.castInput = function (value) {\n\t  /*istanbul ignore start*/var _options = /*istanbul ignore end*/this.options,\n\t      undefinedReplacement = _options.undefinedReplacement,\n\t      _options$stringifyRep = _options.stringifyReplacer,\n\t      stringifyReplacer = _options$stringifyRep === undefined ? function (k, v) /*istanbul ignore start*/{\n\t    return (/*istanbul ignore end*/typeof v === 'undefined' ? undefinedReplacement : v\n\t    );\n\t  } : _options$stringifyRep;\n\n\n\t  return typeof value === 'string' ? value : JSON.stringify(canonicalize(value, null, null, stringifyReplacer), stringifyReplacer, '  ');\n\t};\n\tjsonDiff.equals = function (left, right) {\n\t  return (/*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/.prototype.equals.call(jsonDiff, left.replace(/,([\\r\\n])/g, '$1'), right.replace(/,([\\r\\n])/g, '$1'))\n\t  );\n\t};\n\n\tfunction diffJson(oldObj, newObj, options) {\n\t  return jsonDiff.diff(oldObj, newObj, options);\n\t}\n\n\t// This function handles the presence of circular references by bailing out when encountering an\n\t// object that is already on the \"stack\" of items being processed. Accepts an optional replacer\n\tfunction canonicalize(obj, stack, replacementStack, replacer, key) {\n\t  stack = stack || [];\n\t  replacementStack = replacementStack || [];\n\n\t  if (replacer) {\n\t    obj = replacer(key, obj);\n\t  }\n\n\t  var i = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\n\t  for (i = 0; i < stack.length; i += 1) {\n\t    if (stack[i] === obj) {\n\t      return replacementStack[i];\n\t    }\n\t  }\n\n\t  var canonicalizedObj = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\n\t  if ('[object Array]' === objectPrototypeToString.call(obj)) {\n\t    stack.push(obj);\n\t    canonicalizedObj = new Array(obj.length);\n\t    replacementStack.push(canonicalizedObj);\n\t    for (i = 0; i < obj.length; i += 1) {\n\t      canonicalizedObj[i] = canonicalize(obj[i], stack, replacementStack, replacer, key);\n\t    }\n\t    stack.pop();\n\t    replacementStack.pop();\n\t    return canonicalizedObj;\n\t  }\n\n\t  if (obj && obj.toJSON) {\n\t    obj = obj.toJSON();\n\t  }\n\n\t  if ( /*istanbul ignore start*/(typeof /*istanbul ignore end*/obj === 'undefined' ? 'undefined' : _typeof(obj)) === 'object' && obj !== null) {\n\t    stack.push(obj);\n\t    canonicalizedObj = {};\n\t    replacementStack.push(canonicalizedObj);\n\t    var sortedKeys = [],\n\t        _key = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\t    for (_key in obj) {\n\t      /* istanbul ignore else */\n\t      if (obj.hasOwnProperty(_key)) {\n\t        sortedKeys.push(_key);\n\t      }\n\t    }\n\t    sortedKeys.sort();\n\t    for (i = 0; i < sortedKeys.length; i += 1) {\n\t      _key = sortedKeys[i];\n\t      canonicalizedObj[_key] = canonicalize(obj[_key], stack, replacementStack, replacer, _key);\n\t    }\n\t    stack.pop();\n\t    replacementStack.pop();\n\t  } else {\n\t    canonicalizedObj = obj;\n\t  }\n\t  return canonicalizedObj;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2pzb24uanMiXSwibmFtZXMiOlsiZGlmZkpzb24iLCJjYW5vbmljYWxpemUiLCJvYmplY3RQcm90b3R5cGVUb1N0cmluZyIsIk9iamVjdCIsInByb3RvdHlwZSIsInRvU3RyaW5nIiwianNvbkRpZmYiLCJ1c2VMb25nZXN0VG9rZW4iLCJ0b2tlbml6ZSIsImNhc3RJbnB1dCIsInZhbHVlIiwib3B0aW9ucyIsInVuZGVmaW5lZFJlcGxhY2VtZW50Iiwic3RyaW5naWZ5UmVwbGFjZXIiLCJrIiwidiIsIkpTT04iLCJzdHJpbmdpZnkiLCJlcXVhbHMiLCJsZWZ0IiwicmlnaHQiLCJjYWxsIiwicmVwbGFjZSIsIm9sZE9iaiIsIm5ld09iaiIsImRpZmYiLCJvYmoiLCJzdGFjayIsInJlcGxhY2VtZW50U3RhY2siLCJyZXBsYWNlciIsImtleSIsImkiLCJsZW5ndGgiLCJjYW5vbmljYWxpemVkT2JqIiwicHVzaCIsIkFycmF5IiwicG9wIiwidG9KU09OIiwic29ydGVkS2V5cyIsImhhc093blByb3BlcnR5Iiwic29ydCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztnQ0FxQmdCQSxRLEdBQUFBLFE7eURBSUFDLFksR0FBQUEsWTs7QUF6QmhCOzs7O3VCQUNBOzs7O3VCQUVBLElBQU1DLDBCQUEwQkMsT0FBT0MsU0FBUCxDQUFpQkMsUUFBakQ7O0FBR08sSUFBTUMsK0VBQVcsd0VBQWpCO0FBQ1A7QUFDQTtBQUNBQSxTQUFTQyxlQUFULEdBQTJCLElBQTNCOztBQUVBRCxTQUFTRSxRQUFULEdBQW9CLGdFQUFTQSxRQUE3QjtBQUNBRixTQUFTRyxTQUFULEdBQXFCLFVBQVNDLEtBQVQsRUFBZ0I7QUFBQSxpRUFDK0UsS0FBS0MsT0FEcEY7QUFBQSxNQUM1QkMsb0JBRDRCLFlBQzVCQSxvQkFENEI7QUFBQSx1Q0FDTkMsaUJBRE07QUFBQSxNQUNOQSxpQkFETSx5Q0FDYyxVQUFDQyxDQUFELEVBQUlDLENBQUo7QUFBQSxtQ0FBVSxPQUFPQSxDQUFQ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QUFLVCxJQUFJLENBQVQsRUFBWUEsSUFBSU8sV0FBV04sTUFBM0IsRUFBbUNELEtBQUssQ0FBeEMsRUFBMkM7QUFDekNELGFBQU1RLFdBQVdQLENBQVgsQ0FBTjtBQUNBRSx1QkFBaUJILElBQWpCLElBQXdCN0IsYUFBYXlCLElBQUlJLElBQUosQ0FBYixFQUF1QkgsS0FBdkIsRUFBOEJDLGdCQUE5QixFQUFnREMsUUFBaEQsRUFBMERDLElBQTFELENBQXhCO0FBQ0Q7QUFDREgsVUFBTVMsR0FBTjtBQUNBUixxQkFBaUJRLEdBQWpCO0FBQ0QsR0FuQkQsTUFtQk87QUFDTEgsdUJBQW1CUCxHQUFuQjtBQUNEO0FBQ0QsU0FBT08sZ0JBQVA7QUFDRCIsImZpbGUiOiJqc29uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IERpZmYgZnJvbSAnLi9iYXNlJztcbmltcG9ydCB7bGluZURpZmZ9IGZyb20gJy4vbGluZSc7XG5cbmNvbnN0IG9iamVjdFByb3RvdHlwZVRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcblxuXG5leHBvcnQgY29uc3QganNvbkRpZmYgPSBuZXcgRGlmZigpO1xuLy8gRGlzY3JpbWluYXRlIGJldHdlZW4gdHdvIGxpbmVzIG9mIHByZXR0eS1wcmludGVkLCBzZXJpYWxpemVkIEpTT04gd2hlcmUgb25lIG9mIHRoZW0gaGFzIGFcbi8vIGRhbmdsaW5nIGNvbW1hIGFuZCB0aGUgb3RoZXIgZG9lc24ndC4gVHVybnMgb3V0IGluY2x1ZGluZyB0aGUgZGFuZ2xpbmcgY29tbWEgeWllbGRzIHRoZSBuaWNlc3Qgb3V0cHV0OlxuanNvbkRpZmYudXNlTG9uZ2VzdFRva2VuID0gdHJ1ZTtcblxuanNvbkRpZmYudG9rZW5pemUgPSBsaW5lRGlmZi50b2tlbml6ZTtcbmpzb25EaWZmLmNhc3RJbnB1dCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIGNvbnN0IHt1bmRlZmluZWRSZXBsYWNlbWVudCwgc3RyaW5naWZ5UmVwbGFjZXIgPSAoaywgdikgPT4gdHlwZW9mIHYgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkUmVwbGFjZW1lbnQgOiB2fSA9IHRoaXMub3B0aW9ucztcblxuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IHZhbHVlIDogSlNPTi5zdHJpbmdpZnkoY2Fub25pY2FsaXplKHZhbHVlLCBudWxsLCBudWxsLCBzdHJpbmdpZnlSZXBsYWNlciksIHN0cmluZ2lmeVJlcGxhY2VyLCAnICAnKTtcbn07XG5qc29uRGlmZi5lcXVhbHMgPSBmdW5jdGlvbihsZWZ0LCByaWdodCkge1xuICByZXR1cm4gRGlmZi5wcm90b3R5cGUuZXF1YWxzLmNhbGwoanNvbkRpZmYsIGxlZnQucmVwbGFjZSgvLChbXFxyXFxuXSkvZywgJyQxJyksIHJpZ2h0LnJlcGxhY2UoLywoW1xcclxcbl0pL2csICckMScpKTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBkaWZmSnNvbihvbGRPYmosIG5ld09iaiwgb3B0aW9ucykgeyByZXR1cm4ganNvbkRpZmYuZGlmZihvbGRPYmosIG5ld09iaiwgb3B0aW9ucyk7IH1cblxuLy8gVGhpcyBmdW5jdGlvbiBoYW5kbGVzIHRoZSBwcmVzZW5jZSBvZiBjaXJjdWxhciByZWZlcmVuY2VzIGJ5IGJhaWxpbmcgb3V0IHdoZW4gZW5jb3VudGVyaW5nIGFuXG4vLyBvYmplY3QgdGhhdCBpcyBhbHJlYWR5IG9uIHRoZSBcInN0YWNrXCIgb2YgaXRlbXMgYmVpbmcgcHJvY2Vzc2VkLiBBY2NlcHRzIGFuIG9wdGlvbmFsIHJlcGxhY2VyXG5leHBvcnQgZnVuY3Rpb24gY2Fub25pY2FsaXplKG9iaiwgc3RhY2ssIHJlcGxhY2VtZW50U3RhY2ssIHJlcGxhY2VyLCBrZXkpIHtcbiAgc3RhY2sgPSBzdGFjayB8fCBbXTtcbiAgcmVwbGFjZW1lbnRTdGFjayA9IHJlcGxhY2VtZW50U3RhY2sgfHwgW107XG5cbiAgaWYgKHJlcGxhY2VyKSB7XG4gICAgb2JqID0gcmVwbGFjZXIoa2V5LCBvYmopO1xuICB9XG5cbiAgbGV0IGk7XG5cbiAgZm9yIChpID0gMDsgaSA8IHN0YWNrLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgaWYgKHN0YWNrW2ldID09PSBvYmopIHtcbiAgICAgIHJldHVybiByZXBsYWNlbWVudFN0YWNrW2ldO1xuICAgIH1cbiAgfVxuXG4gIGxldCBjYW5vbmljYWxpemVkT2JqO1xuXG4gIGlmICgnW29iamVjdCBBcnJheV0nID09PSBvYmplY3RQcm90b3R5cGVUb1N0cmluZy5jYWxsKG9iaikpIHtcbiAgICBzdGFjay5wdXNoKG9iaik7XG4gICAgY2Fub25pY2FsaXplZE9iaiA9IG5ldyBBcnJheShvYmoubGVuZ3RoKTtcbiAgICByZXBsYWNlbWVudFN0YWNrLnB1c2goY2Fub25pY2FsaXplZE9iaik7XG4gICAgZm9yIChpID0gMDsgaSA8IG9iai5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgY2Fub25pY2FsaXplZE9ialtpXSA9IGNhbm9uaWNhbGl6ZShvYmpbaV0sIHN0YWNrLCByZXBsYWNlbWVudFN0YWNrLCByZXBsYWNlciwga2V5KTtcbiAgICB9XG4gICAgc3RhY2sucG9wKCk7XG4gICAgcmVwbGFjZW1lbnRTdGFjay5wb3AoKTtcbiAgICByZXR1cm4gY2Fub25pY2FsaXplZE9iajtcbiAgfVxuXG4gIGlmIChvYmogJiYgb2JqLnRvSlNPTikge1xuICAgIG9iaiA9IG9iai50b0pTT04oKTtcbiAgfVxuXG4gIGlmICh0eXBlb2Ygb2JqID09PSAnb2JqZWN0JyAmJiBvYmogIT09IG51bGwpIHtcbiAgICBzdGFjay5wdXNoKG9iaik7XG4gICAgY2Fub25pY2FsaXplZE9iaiA9IHt9O1xuICAgIHJlcGxhY2VtZW50U3RhY2sucHVzaChjYW5vbmljYWxpemVkT2JqKTtcbiAgICBsZXQgc29ydGVkS2V5cyA9IFtdLFxuICAgICAgICBrZXk7XG4gICAgZm9yIChrZXkgaW4gb2JqKSB7XG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgIHNvcnRlZEtleXMucHVzaChrZXkpO1xuICAgICAgfVxuICAgIH1cbiAgICBzb3J0ZWRLZXlzLnNvcnQoKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgc29ydGVkS2V5cy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAga2V5ID0gc29ydGVkS2V5c1tpXTtcbiAgICAgIGNhbm9uaWNhbGl6ZWRPYmpba2V5XSA9IGNhbm9uaWNhbGl6ZShvYmpba2V5XSwgc3RhY2ssIHJlcGxhY2VtZW50U3RhY2ssIHJlcGxhY2VyLCBrZXkpO1xuICAgIH1cbiAgICBzdGFjay5wb3AoKTtcbiAgICByZXBsYWNlbWVudFN0YWNrLnBvcCgpO1xuICB9IGVsc2Uge1xuICAgIGNhbm9uaWNhbGl6ZWRPYmogPSBvYmo7XG4gIH1cbiAgcmV0dXJuIGNhbm9uaWNhbGl6ZWRPYmo7XG59XG4iXX0=\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.arrayDiff = undefined;\n\texports. /*istanbul ignore end*/diffArrays = diffArrays;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var arrayDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/arrayDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tarrayDiff.tokenize = function (value) {\n\t  return value.slice();\n\t};\n\tarrayDiff.join = arrayDiff.removeEmpty = function (value) {\n\t  return value;\n\t};\n\n\tfunction diffArrays(oldArr, newArr, callback) {\n\t  return arrayDiff.diff(oldArr, newArr, callback);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2FycmF5LmpzIl0sIm5hbWVzIjpbImRpZmZBcnJheXMiLCJhcnJheURpZmYiLCJ0b2tlbml6ZSIsInZhbHVlIiwic2xpY2UiLCJqb2luIiwicmVtb3ZlRW1wdHkiLCJvbGRBcnIiLCJuZXdBcnIiLCJjYWxsYmFjayIsImRpZmYiXSwibWFwcGluZ3MiOiI7Ozs7Z0NBVWdCQSxVLEdBQUFBLFU7O0FBVmhCOzs7Ozs7dUJBRU8sSUFBTUMsaUZBQVksd0VBQWxCO0FBQ1BBLFVBQVVDLFFBQVYsR0FBcUIsVUFBU0MsS0FBVCxFQUFnQjtBQUNuQyxTQUFPQSxNQUFNQyxLQUFOLEVBQVA7QUFDRCxDQUZEO0FBR0FILFVBQVVJLElBQVYsR0FBaUJKLFVBQVVLLFdBQVYsR0FBd0IsVUFBU0gsS0FBVCxFQUFnQjtBQUN2RCxTQUFPQSxLQUFQO0FBQ0QsQ0FGRDs7QUFJTyxTQUFTSCxVQUFULENBQW9CTyxNQUFwQixFQUE0QkMsTUFBNUIsRUFBb0NDLFFBQXBDLEVBQThDO0FBQUUsU0FBT1IsVUFBVVMsSUFBVixDQUFlSCxNQUFmLEVBQXVCQyxNQUF2QixFQUErQkMsUUFBL0IsQ0FBUDtBQUFrRCIsImZpbGUiOiJhcnJheS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEaWZmIGZyb20gJy4vYmFzZSc7XG5cbmV4cG9ydCBjb25zdCBhcnJheURpZmYgPSBuZXcgRGlmZigpO1xuYXJyYXlEaWZmLnRva2VuaXplID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlLnNsaWNlKCk7XG59O1xuYXJyYXlEaWZmLmpvaW4gPSBhcnJheURpZmYucmVtb3ZlRW1wdHkgPSBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gdmFsdWU7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZGlmZkFycmF5cyhvbGRBcnIsIG5ld0FyciwgY2FsbGJhY2spIHsgcmV0dXJuIGFycmF5RGlmZi5kaWZmKG9sZEFyciwgbmV3QXJyLCBjYWxsYmFjayk7IH1cbiJdfQ==\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/applyPatch = applyPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/applyPatches = applyPatches;\n\n\tvar /*istanbul ignore start*/_parse = __webpack_require__(11) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_distanceIterator = __webpack_require__(12) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _distanceIterator2 = _interopRequireDefault(_distanceIterator);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/function applyPatch(source, uniDiff) {\n\t  /*istanbul ignore start*/var /*istanbul ignore end*/options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n\t  if (typeof uniDiff === 'string') {\n\t    uniDiff = /*istanbul ignore start*/(0, _parse.parsePatch) /*istanbul ignore end*/(uniDiff);\n\t  }\n\n\t  if (Array.isArray(uniDiff)) {\n\t    if (uniDiff.length > 1) {\n\t      throw new Error('applyPatch only works with a single input.');\n\t    }\n\n\t    uniDiff = uniDiff[0];\n\t  }\n\n\t  // Apply the diff to the input\n\t  var lines = source.split(/\\r\\n|[\\n\\v\\f\\r\\x85]/),\n\t      delimiters = source.match(/\\r\\n|[\\n\\v\\f\\r\\x85]/g) || [],\n\t      hunks = uniDiff.hunks,\n\t      compareLine = options.compareLine || function (lineNumber, line, operation, patchContent) /*istanbul ignore start*/{\n\t    return (/*istanbul ignore end*/line === patchContent\n\t    );\n\t  },\n\t      errorCount = 0,\n\t      fuzzFactor = options.fuzzFactor || 0,\n\t      minLine = 0,\n\t      offset = 0,\n\t      removeEOFNL = /*istanbul ignore start*/void 0 /*istanbul ignore end*/,\n\t      addEOFNL = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\n\t  /**\n\t   * Checks if the hunk exactly fits on the provided location\n\t   */\n\t  function hunkFits(hunk, toPos) {\n\t    for (var j = 0; j < hunk.lines.length; j++) {\n\t      var line = hunk.lines[j],\n\t          operation = line.length > 0 ? line[0] : ' ',\n\t          content = line.length > 0 ? line.substr(1) : line;\n\n\t      if (operation === ' ' || operation === '-') {\n\t        // Context sanity check\n\t        if (!compareLine(toPos + 1, lines[toPos], operation, content)) {\n\t          errorCount++;\n\n\t          if (errorCount > fuzzFactor) {\n\t            return false;\n\t          }\n\t        }\n\t        toPos++;\n\t      }\n\t    }\n\n\t    return true;\n\t  }\n\n\t  // Search best fit offsets for each hunk based on the previous ones\n\t  for (var i = 0; i < hunks.length; i++) {\n\t    var hunk = hunks[i],\n\t        maxLine = lines.length - hunk.oldLines,\n\t        localOffset = 0,\n\t        toPos = offset + hunk.oldStart - 1;\n\n\t    var iterator = /*istanbul ignore start*/(0, _distanceIterator2['default']) /*istanbul ignore end*/(toPos, minLine, maxLine);\n\n\t    for (; localOffset !== undefined; localOffset = iterator()) {\n\t      if (hunkFits(hunk, toPos + localOffset)) {\n\t        hunk.offset = offset += localOffset;\n\t        break;\n\t      }\n\t    }\n\n\t    if (localOffset === undefined) {\n\t      return false;\n\t    }\n\n\t    // Set lower text limit to end of the current hunk, so next ones don't try\n\t    // to fit over already patched text\n\t    minLine = hunk.offset + hunk.oldStart + hunk.oldLines;\n\t  }\n\n\t  // Apply patch hunks\n\t  var diffOffset = 0;\n\t  for (var _i = 0; _i < hunks.length; _i++) {\n\t    var _hunk = hunks[_i],\n\t        _toPos = _hunk.oldStart + _hunk.offset + diffOffset - 1;\n\t    diffOffset += _hunk.newLines - _hunk.oldLines;\n\n\t    if (_toPos < 0) {\n\t      // Creating a new file\n\t      _toPos = 0;\n\t    }\n\n\t    for (var j = 0; j < _hunk.lines.length; j++) {\n\t      var line = _hunk.lines[j],\n\t          operation = line.length > 0 ? line[0] : ' ',\n\t          content = line.length > 0 ? line.substr(1) : line,\n\t          delimiter = _hunk.linedelimiters[j];\n\n\t      if (operation === ' ') {\n\t        _toPos++;\n\t      } else if (operation === '-') {\n\t        lines.splice(_toPos, 1);\n\t        delimiters.splice(_toPos, 1);\n\t        /* istanbul ignore else */\n\t      } else if (operation === '+') {\n\t        lines.splice(_toPos, 0, content);\n\t        delimiters.splice(_toPos, 0, delimiter);\n\t        _toPos++;\n\t      } else if (operation === '\\\\') {\n\t        var previousOperation = _hunk.lines[j - 1] ? _hunk.lines[j - 1][0] : null;\n\t        if (previousOperation === '+') {\n\t          removeEOFNL = true;\n\t        } else if (previousOperation === '-') {\n\t          addEOFNL = true;\n\t        }\n\t      }\n\t    }\n\t  }\n\n\t  // Handle EOFNL insertion/removal\n\t  if (removeEOFNL) {\n\t    while (!lines[lines.length - 1]) {\n\t      lines.pop();\n\t      delimiters.pop();\n\t    }\n\t  } else if (addEOFNL) {\n\t    lines.push('');\n\t    delimiters.push('\\n');\n\t  }\n\t  for (var _k = 0; _k < lines.length - 1; _k++) {\n\t    lines[_k] = lines[_k] + delimiters[_k];\n\t  }\n\t  return lines.join('');\n\t}\n\n\t// Wrapper that supports multiple file patches via callbacks.\n\tfunction applyPatches(uniDiff, options) {\n\t  if (typeof uniDiff === 'string') {\n\t    uniDiff = /*istanbul ignore start*/(0, _parse.parsePatch) /*istanbul ignore end*/(uniDiff);\n\t  }\n\n\t  var currentIndex = 0;\n\t  function processIndex() {\n\t    var index = uniDiff[currentIndex++];\n\t    if (!index) {\n\t      return options.complete();\n\t    }\n\n\t    options.loadFile(index, function (err, data) {\n\t      if (err) {\n\t        return options.complete(err);\n\t      }\n\n\t      var updatedContent = applyPatch(data, index, options);\n\t      options.patched(index, updatedContent, function (err) {\n\t        if (err) {\n\t          return options.complete(err);\n\t        }\n\n\t        processIndex();\n\t      });\n\t    });\n\t  }\n\t  processIndex();\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYXRjaC9hcHBseS5qcyJdLCJuYW1lcyI6WyJhcHBseVBhdGNoIiwiYXBwbHlQYXRjaGVzIiwic291cmNlIiwidW5pRGlmZiIsIm9wdGlvbnMiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJFcnJvciIsImxpbmVzIiwic3BsaXQiLCJkZWxpbWl0ZXJzIiwibWF0Y2giLCJodW5rcyIsImNvbXBhcmVMaW5lIiwibGluZU51bWJlciIsImxpbmUiLCJvcGVyYXRpb24iLCJwYXRjaENvbnRlbnQiLCJlcnJvckNvdW50IiwiZnV6ekZhY3RvciIsIm1pbkxpbmUiLCJvZmZzZXQiLCJyZW1vdmVFT0ZOTCIsImFkZEVPRk5MIiwiaHVua0ZpdHMiLCJodW5rIiwidG9Qb3MiLCJqIiwiY29udGVudCIsInN1YnN0ciIsImkiLCJtYXhMaW5lIiwib2xkTGluZXMiLCJsb2NhbE9mZnNldCIsIm9sZFN0YXJ0IiwiaXRlcmF0b3IiLCJ1bmRlZmluZWQiLCJkaWZmT2Zmc2V0IiwibmV3TGluZXMiLCJkZWxpbWl0ZXIiLCJsaW5lZGVsaW1pdGVycyIsInNwbGljZSIsInByZXZpb3VzT3BlcmF0aW9uIiwicG9wIiwicHVzaCIsIl9rIiwiam9pbiIsImN1cnJlbnRJbmRleCIsInByb2Nlc3NJbmRleCIsImluZGV4IiwiY29tcGxldGUiLCJsb2FkRmlsZSIsImVyciIsImRhdGEiLCJ1cGRhdGVkQ29udGVudCIsInBhdGNoZWQiXSwibWFwcGluZ3MiOiI7OztnQ0FHZ0JBLFUsR0FBQUEsVTt5REFvSUFDLFksR0FBQUEsWTs7QUF2SWhCOztBQUNBOzs7Ozs7dUJBRU8sU0FBU0QsVUFBVCxDQUFvQkUsTUFBcEIsRUFBNEJDLE9BQTVCLEVBQW1EO0FBQUEsc0RBQWRDLE9BQWMsdUVBQUosRUFBSTs7QUFDeEQsTUFBSSxPQUFPRCxPQUFQLEtBQW1CLFFBQXZCLEVBQWlDO0FBQy9CQSxjQUFVLHdFQUFXQSxPQUFYLENBQVY7QUFDRDs7QUFFRCxNQUFJRSxNQUFNQyxP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QUFZO0FBQ1YsYUFBTzlDLFFBQVErQyxRQUFSLEVBQVA7QUFDRDs7QUFFRC9DLFlBQVFnRCxRQUFSLENBQWlCRixLQUFqQixFQUF3QixVQUFTRyxHQUFULEVBQWNDLElBQWQsRUFBb0I7QUFDMUMsVUFBSUQsR0FBSixFQUFTO0FBQ1AsZUFBT2pELFFBQVErQyxRQUFSLENBQWlCRSxHQUFqQixDQUFQO0FBQ0Q7O0FBRUQsVUFBSUUsaUJBQWlCdkQsV0FBV3NELElBQVgsRUFBaUJKLEtBQWpCLEVBQXdCOUMsT0FBeEIsQ0FBckI7QUFDQUEsY0FBUW9ELE9BQVIsQ0FBZ0JOLEtBQWhCLEVBQXVCSyxjQUF2QixFQUF1QyxVQUFTRixHQUFULEVBQWM7QUFDbkQsWUFBSUEsR0FBSixFQUFTO0FBQ1AsaUJBQU9qRCxRQUFRK0MsUUFBUixDQUFpQkUsR0FBakIsQ0FBUDtBQUNEOztBQUVESjtBQUNELE9BTkQ7QUFPRCxLQWJEO0FBY0Q7QUFDREE7QUFDRCIsImZpbGUiOiJhcHBseS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7cGFyc2VQYXRjaH0gZnJvbSAnLi9wYXJzZSc7XG5pbXBvcnQgZGlzdGFuY2VJdGVyYXRvciBmcm9tICcuLi91dGlsL2Rpc3RhbmNlLWl0ZXJhdG9yJztcblxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5UGF0Y2goc291cmNlLCB1bmlEaWZmLCBvcHRpb25zID0ge30pIHtcbiAgaWYgKHR5cGVvZiB1bmlEaWZmID09PSAnc3RyaW5nJykge1xuICAgIHVuaURpZmYgPSBwYXJzZVBhdGNoKHVuaURpZmYpO1xuICB9XG5cbiAgaWYgKEFycmF5LmlzQXJyYXkodW5pRGlmZikpIHtcbiAgICBpZiAodW5pRGlmZi5sZW5ndGggPiAxKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2FwcGx5UGF0Y2ggb25seSB3b3JrcyB3aXRoIGEgc2luZ2xlIGlucHV0LicpO1xuICAgIH1cblxuICAgIHVuaURpZmYgPSB1bmlEaWZmWzBdO1xuICB9XG5cbiAgLy8gQXBwbHkgdGhlIGRpZmYgdG8gdGhlIGlucHV0XG4gIGxldCBsaW5lcyA9IHNvdXJjZS5zcGxpdCgvXFxyXFxufFtcXG5cXHZcXGZcXHJcXHg4NV0vKSxcbiAgICAgIGRlbGltaXRlcnMgPSBzb3VyY2UubWF0Y2goL1xcclxcbnxbXFxuXFx2XFxmXFxyXFx4ODVdL2cpIHx8IFtdLFxuICAgICAgaHVua3MgPSB1bmlEaWZmLmh1bmtzLFxuXG4gICAgICBjb21wYXJlTGluZSA9IG9wdGlvbnMuY29tcGFyZUxpbmUgfHwgKChsaW5lTnVtYmVyLCBsaW5lLCBvcGVyYXRpb24sIHBhdGNoQ29udGVudCkgPT4gbGluZSA9PT0gcGF0Y2hDb250ZW50KSxcbiAgICAgIGVycm9yQ291bnQgPSAwLFxuICAgICAgZnV6ekZhY3RvciA9IG9wdGlvbnMuZnV6ekZhY3RvciB8fCAwLFxuICAgICAgbWluTGluZSA9IDAsXG4gICAgICBvZmZzZXQgPSAwLFxuXG4gICAgICByZW1vdmVFT0ZOTCxcbiAgICAgIGFkZEVPRk5MO1xuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgdGhlIGh1bmsgZXhhY3RseSBmaXRzIG9uIHRoZSBwcm92aWRlZCBsb2NhdGlvblxuICAgKi9cbiAgZnVuY3Rpb24gaHVua0ZpdHMoaHVuaywgdG9Qb3MpIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGh1bmsubGluZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgIGxldCBsaW5lID0gaHVuay5saW5lc1tqXSxcbiAgICAgICAgICBvcGVyYXRpb24gPSAobGluZS5sZW5ndGggPiAwID8gbGluZVswXSA6ICcgJyksXG4gICAgICAgICAgY29udGVudCA9IChsaW5lLmxlbmd0aCA+IDAgPyBsaW5lLnN1YnN0cigxKSA6IGxpbmUpO1xuXG4gICAgICBpZiAob3BlcmF0aW9uID09PSAnICcgfHwgb3BlcmF0aW9uID09PSAnLScpIHtcbiAgICAgICAgLy8gQ29udGV4dCBzYW5pdHkgY2hlY2tcbiAgICAgICAgaWYgKCFjb21wYXJlTGluZSh0b1BvcyArIDEsIGxpbmVzW3RvUG9zXSwgb3BlcmF0aW9uLCBjb250ZW50KSkge1xuICAgICAgICAgIGVycm9yQ291bnQrKztcblxuICAgICAgICAgIGlmIChlcnJvckNvdW50ID4gZnV6ekZhY3Rvcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0b1BvcysrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLy8gU2VhcmNoIGJlc3QgZml0IG9mZnNldHMgZm9yIGVhY2ggaHVuayBiYXNlZCBvbiB0aGUgcHJldmlvdXMgb25lc1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGh1bmtzLmxlbmd0aDsgaSsrKSB7XG4gICAgbGV0IGh1bmsgPSBodW5rc1tpXSxcbiAgICAgICAgbWF4TGluZSA9IGxpbmVzLmxlbmd0aCAtIGh1bmsub2xkTGluZXMsXG4gICAgICAgIGxvY2FsT2Zmc2V0ID0gMCxcbiAgICAgICAgdG9Qb3MgPSBvZmZzZXQgKyBodW5rLm9sZFN0YXJ0IC0gMTtcblxuICAgIGxldCBpdGVyYXRvciA9IGRpc3RhbmNlSXRlcmF0b3IodG9Qb3MsIG1pbkxpbmUsIG1heExpbmUpO1xuXG4gICAgZm9yICg7IGxvY2FsT2Zmc2V0ICE9PSB1bmRlZmluZWQ7IGxvY2FsT2Zmc2V0ID0gaXRlcmF0b3IoKSkge1xuICAgICAgaWYgKGh1bmtGaXRzKGh1bmssIHRvUG9zICsgbG9jYWxPZmZzZXQpKSB7XG4gICAgICAgIGh1bmsub2Zmc2V0ID0gb2Zmc2V0ICs9IGxvY2FsT2Zmc2V0O1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobG9jYWxPZmZzZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFNldCBsb3dlciB0ZXh0IGxpbWl0IHRvIGVuZCBvZiB0aGUgY3VycmVudCBodW5rLCBzbyBuZXh0IG9uZXMgZG9uJ3QgdHJ5XG4gICAgLy8gdG8gZml0IG92ZXIgYWxyZWFkeSBwYXRjaGVkIHRleHRcbiAgICBtaW5MaW5lID0gaHVuay5vZmZzZXQgKyBodW5rLm9sZFN0YXJ0ICsgaHVuay5vbGRMaW5lcztcbiAgfVxuXG4gIC8vIEFwcGx5IHBhdGNoIGh1bmtzXG4gIGxldCBkaWZmT2Zmc2V0ID0gMDtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBodW5rcy5sZW5ndGg7IGkrKykge1xuICAgIGxldCBodW5rID0gaHVua3NbaV0sXG4gICAgICAgIHRvUG9zID0gaHVuay5vbGRTdGFydCArIGh1bmsub2Zmc2V0ICsgZGlmZk9mZnNldCAtIDE7XG4gICAgZGlmZk9mZnNldCArPSBodW5rLm5ld0xpbmVzIC0gaHVuay5vbGRMaW5lcztcblxuICAgIGlmICh0b1BvcyA8IDApIHsgLy8gQ3JlYXRpbmcgYSBuZXcgZmlsZVxuICAgICAgdG9Qb3MgPSAwO1xuICAgIH1cblxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgaHVuay5saW5lcy5sZW5ndGg7IGorKykge1xuICAgICAgbGV0IGxpbmUgPSBodW5rLmxpbmVzW2pdLFxuICAgICAgICAgIG9wZXJhdGlvbiA9IChsaW5lLmxlbmd0aCA+IDAgPyBsaW5lWzBdIDogJyAnKSxcbiAgICAgICAgICBjb250ZW50ID0gKGxpbmUubGVuZ3RoID4gMCA/IGxpbmUuc3Vic3RyKDEpIDogbGluZSksXG4gICAgICAgICAgZGVsaW1pdGVyID0gaHVuay5saW5lZGVsaW1pdGVyc1tqXTtcblxuICAgICAgaWYgKG9wZXJhdGlvbiA9PT0gJyAnKSB7XG4gICAgICAgIHRvUG9zKys7XG4gICAgICB9IGVsc2UgaWYgKG9wZXJhdGlvbiA9PT0gJy0nKSB7XG4gICAgICAgIGxpbmVzLnNwbGljZSh0b1BvcywgMSk7XG4gICAgICAgIGRlbGltaXRlcnMuc3BsaWNlKHRvUG9zLCAxKTtcbiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovXG4gICAgICB9IGVsc2UgaWYgKG9wZXJhdGlvbiA9PT0gJysnKSB7XG4gICAgICAgIGxpbmVzLnNwbGljZSh0b1BvcywgMCwgY29udGVudCk7XG4gICAgICAgIGRlbGltaXRlcnMuc3BsaWNlKHRvUG9zLCAwLCBkZWxpbWl0ZXIpO1xuICAgICAgICB0b1BvcysrO1xuICAgICAgfSBlbHNlIGlmIChvcGVyYXRpb24gPT09ICdcXFxcJykge1xuICAgICAgICBsZXQgcHJldmlvdXNPcGVyYXRpb24gPSBodW5rLmxpbmVzW2ogLSAxXSA/IGh1bmsubGluZXNbaiAtIDFdWzBdIDogbnVsbDtcbiAgICAgICAgaWYgKHByZXZpb3VzT3BlcmF0aW9uID09PSAnKycpIHtcbiAgICAgICAgICByZW1vdmVFT0ZOTCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAocHJldmlvdXNPcGVyYXRpb24gPT09ICctJykge1xuICAgICAgICAgIGFkZEVPRk5MID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIEhhbmRsZSBFT0ZOTCBpbnNlcnRpb24vcmVtb3ZhbFxuICBpZiAocmVtb3ZlRU9GTkwpIHtcbiAgICB3aGlsZSAoIWxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdKSB7XG4gICAgICBsaW5lcy5wb3AoKTtcbiAgICAgIGRlbGltaXRlcnMucG9wKCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKGFkZEVPRk5MKSB7XG4gICAgbGluZXMucHVzaCgnJyk7XG4gICAgZGVsaW1pdGVycy5wdXNoKCdcXG4nKTtcbiAgfVxuICBmb3IgKGxldCBfayA9IDA7IF9rIDwgbGluZXMubGVuZ3RoIC0gMTsgX2srKykge1xuICAgIGxpbmVzW19rXSA9IGxpbmVzW19rXSArIGRlbGltaXRlcnNbX2tdO1xuICB9XG4gIHJldHVybiBsaW5lcy5qb2luKCcnKTtcbn1cblxuLy8gV3JhcHBlciB0aGF0IHN1cHBvcnRzIG11bHRpcGxlIGZpbGUgcGF0Y2hlcyB2aWEgY2FsbGJhY2tzLlxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5UGF0Y2hlcyh1bmlEaWZmLCBvcHRpb25zKSB7XG4gIGlmICh0eXBlb2YgdW5pRGlmZiA9PT0gJ3N0cmluZycpIHtcbiAgICB1bmlEaWZmID0gcGFyc2VQYXRjaCh1bmlEaWZmKTtcbiAgfVxuXG4gIGxldCBjdXJyZW50SW5kZXggPSAwO1xuICBmdW5jdGlvbiBwcm9jZXNzSW5kZXgoKSB7XG4gICAgbGV0IGluZGV4ID0gdW5pRGlmZltjdXJyZW50SW5kZXgrK107XG4gICAgaWYgKCFpbmRleCkge1xuICAgICAgcmV0dXJuIG9wdGlvbnMuY29tcGxldGUoKTtcbiAgICB9XG5cbiAgICBvcHRpb25zLmxvYWRGaWxlKGluZGV4LCBmdW5jdGlvbihlcnIsIGRhdGEpIHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuY29tcGxldGUoZXJyKTtcbiAgICAgIH1cblxuICAgICAgbGV0IHVwZGF0ZWRDb250ZW50ID0gYXBwbHlQYXRjaChkYXRhLCBpbmRleCwgb3B0aW9ucyk7XG4gICAgICBvcHRpb25zLnBhdGNoZWQoaW5kZXgsIHVwZGF0ZWRDb250ZW50LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIHJldHVybiBvcHRpb25zLmNvbXBsZXRlKGVycik7XG4gICAgICAgIH1cblxuICAgICAgICBwcm9jZXNzSW5kZXgoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIHByb2Nlc3NJbmRleCgpO1xufVxuIl19\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/parsePatch = parsePatch;\n\tfunction parsePatch(uniDiff) {\n\t  /*istanbul ignore start*/var /*istanbul ignore end*/options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t  var diffstr = uniDiff.split(/\\r\\n|[\\n\\v\\f\\r\\x85]/),\n\t      delimiters = uniDiff.match(/\\r\\n|[\\n\\v\\f\\r\\x85]/g) || [],\n\t      list = [],\n\t      i = 0;\n\n\t  function parseIndex() {\n\t    var index = {};\n\t    list.push(index);\n\n\t    // Parse diff metadata\n\t    while (i < diffstr.length) {\n\t      var line = diffstr[i];\n\n\t      // File header found, end parsing diff metadata\n\t      if (/^(\\-\\-\\-|\\+\\+\\+|@@)\\s/.test(line)) {\n\t        break;\n\t      }\n\n\t      // Diff index\n\t      var header = /^(?:Index:|diff(?: -r \\w+)+)\\s+(.+?)\\s*$/.exec(line);\n\t      if (header) {\n\t        index.index = header[1];\n\t      }\n\n\t      i++;\n\t    }\n\n\t    // Parse file headers if they are defined. Unified diff requires them, but\n\t    // there's no technical issues to have an isolated hunk without file header\n\t    parseFileHeader(index);\n\t    parseFileHeader(index);\n\n\t    // Parse hunks\n\t    index.hunks = [];\n\n\t    while (i < diffstr.length) {\n\t      var _line = diffstr[i];\n\n\t      if (/^(Index:|diff|\\-\\-\\-|\\+\\+\\+)\\s/.test(_line)) {\n\t        break;\n\t      } else if (/^@@/.test(_line)) {\n\t        index.hunks.push(parseHunk());\n\t      } else if (_line && options.strict) {\n\t        // Ignore unexpected content unless in strict mode\n\t        throw new Error('Unknown line ' + (i + 1) + ' ' + JSON.stringify(_line));\n\t      } else {\n\t        i++;\n\t      }\n\t    }\n\t  }\n\n\t  // Parses the --- and +++ headers, if none are found, no lines\n\t  // are consumed.\n\t  function parseFileHeader(index) {\n\t    var fileHeader = /^(---|\\+\\+\\+)\\s+(.*)$/.exec(diffstr[i]);\n\t    if (fileHeader) {\n\t      var keyPrefix = fileHeader[1] === '---' ? 'old' : 'new';\n\t      var data = fileHeader[2].split('\\t', 2);\n\t      var fileName = data[0].replace(/\\\\\\\\/g, '\\\\');\n\t      if (/^\".*\"$/.test(fileName)) {\n\t        fileName = fileName.substr(1, fileName.length - 2);\n\t      }\n\t      index[keyPrefix + 'FileName'] = fileName;\n\t      index[keyPrefix + 'Header'] = (data[1] || '').trim();\n\n\t      i++;\n\t    }\n\t  }\n\n\t  // Parses a hunk\n\t  // This assumes that we are at the start of a hunk.\n\t  function parseHunk() {\n\t    var chunkHeaderIndex = i,\n\t        chunkHeaderLine = diffstr[i++],\n\t        chunkHeader = chunkHeaderLine.split(/@@ -(\\d+)(?:,(\\d+))? \\+(\\d+)(?:,(\\d+))? @@/);\n\n\t    var hunk = {\n\t      oldStart: +chunkHeader[1],\n\t      oldLines: +chunkHeader[2] || 1,\n\t      newStart: +chunkHeader[3],\n\t      newLines: +chunkHeader[4] || 1,\n\t      lines: [],\n\t      linedelimiters: []\n\t    };\n\n\t    var addCount = 0,\n\t        removeCount = 0;\n\t    for (; i < diffstr.length; i++) {\n\t      // Lines starting with '---' could be mistaken for the \"remove line\" operation\n\t      // But they could be the header for the next file. Therefore prune such cases out.\n\t      if (diffstr[i].indexOf('--- ') === 0 && i + 2 < diffstr.length && diffstr[i + 1].indexOf('+++ ') === 0 && diffstr[i + 2].indexOf('@@') === 0) {\n\t        break;\n\t      }\n\t      var operation = diffstr[i].length == 0 && i != diffstr.length - 1 ? ' ' : diffstr[i][0];\n\n\t      if (operation === '+' || operation === '-' || operation === ' ' || operation === '\\\\') {\n\t        hunk.lines.push(diffstr[i]);\n\t        hunk.linedelimiters.push(delimiters[i] || '\\n');\n\n\t        if (operation === '+') {\n\t          addCount++;\n\t        } else if (operation === '-') {\n\t          removeCount++;\n\t        } else if (operation === ' ') {\n\t          addCount++;\n\t          removeCount++;\n\t        }\n\t      } else {\n\t        break;\n\t      }\n\t    }\n\n\t    // Handle the empty block count case\n\t    if (!addCount && hunk.newLines === 1) {\n\t      hunk.newLines = 0;\n\t    }\n\t    if (!removeCount && hunk.oldLines === 1) {\n\t      hunk.oldLines = 0;\n\t    }\n\n\t    // Perform optional sanity checking\n\t    if (options.strict) {\n\t      if (addCount !== hunk.newLines) {\n\t        throw new Error('Added line count did not match for hunk at line ' + (chunkHeaderIndex + 1));\n\t      }\n\t      if (removeCount !== hunk.oldLines) {\n\t        throw new Error('Removed line count did not match for hunk at line ' + (chunkHeaderIndex + 1));\n\t      }\n\t    }\n\n\t    return hunk;\n\t  }\n\n\t  while (i < diffstr.length) {\n\t    parseIndex();\n\t  }\n\n\t  return list;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYXRjaC9wYXJzZS5qcyJdLCJuYW1lcyI6WyJwYXJzZVBhdGNoIiwidW5pRGlmZiIsIm9wdGlvbnMiLCJkaWZmc3RyIiwic3BsaXQiLCJkZWxpbWl0ZXJzIiwibWF0Y2giLCJsaXN0IiwiaSIsInBhcnNlSW5kZXgiLCJpbmRleCIsInB1c2giLCJsZW5ndGgiLCJsaW5lIiwidGVzdCIsImhlYWRlciIsImV4ZWMiLCJwYXJzZUZpbGVIZWFkZXIiLCJodW5rcyIsInBhcnNlSHVuayIsInN0cmljdCIsIkVycm9yIiwiSlNPTiIsInN0cmluZ2lmeSIsImZpbGVIZWFkZXIiLCJrZXlQcmVmaXgiLCJkYXRhIiwiZmlsZU5hbWUiLCJyZXBsYWNlIiwic3Vic3RyIiwidHJpbSIsImNodW5rSGVhZGVySW5kZXgiLCJjaHVua0hlYWRlckxpbmUiLCJjaHVua0hlYWRlciIsImh1bmsiLCJvbGRTdGFydCIsIm9sZExpbmVzIiwibmV3U3RhcnQiLCJuZXdMaW5lcyIsImxpbmVzIiwibGluZWRlbGltaXRlcnMiLCJhZGRDb3VudCIsInJlbW92ZUNvdW50IiwiaW5kZXhPZiIsIm9wZXJhdGlvbiJdLCJtYXBwaW5ncyI6Ijs7O2dDQUFnQkEsVSxHQUFBQSxVO0FBQVQsU0FBU0EsVUFBVCxDQUFvQkMsT0FBcEIsRUFBMkM7QUFBQSxzREFBZEMsT0FBYyx1RUFBSixFQUFJOztBQUNoRCxNQUFJQyxVQUFVRixRQUFRRyxLQUFSLENBQWMscUJBQWQsQ0FBZDtBQUFBLE1BQ0lDLGFBQWFKLFFBQVFLLEtBQVIsQ0FBYyxzQkFBZCxLQUF5QyxFQUQxRDtBQUFBLE1BRUlDLE9BQU8sRUFGWDtBQUFBLE1BR0lDLElBQUksQ0FIUjs7QUFLQSxXQUFTQyxVQUFULEdBQXNCO0FBQ3BCLFFBQUlDLFFBQVEsRUFBWjtBQUNBSCxTQUFLSSxJQUFMLENBQVVELEtBQVY7O0FBRUE7QUFDQSxXQUFPRixJQUFJTCxRQUFRUyxNQUFuQixFQUEyQjtBQUN6QixVQUFJQyxPQUFPVixRQUFR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QW9CO0FBQ2xCLFVBQUlxQixhQUFhUCxLQUFLSSxRQUF0QixFQUFnQztBQUM5QixjQUFNLElBQUlqQixLQUFKLENBQVUsc0RBQXNEVSxtQkFBbUIsQ0FBekUsQ0FBVixDQUFOO0FBQ0Q7QUFDRCxVQUFJVyxnQkFBZ0JSLEtBQUtFLFFBQXpCLEVBQW1DO0FBQ2pDLGNBQU0sSUFBSWYsS0FBSixDQUFVLHdEQUF3RFUsbUJBQW1CLENBQTNFLENBQVYsQ0FBTjtBQUNEO0FBQ0Y7O0FBRUQsV0FBT0csSUFBUDtBQUNEOztBQUVELFNBQU8xQixJQUFJTCxRQUFRUyxNQUFuQixFQUEyQjtBQUN6Qkg7QUFDRDs7QUFFRCxTQUFPRixJQUFQO0FBQ0QiLCJmaWxlIjoicGFyc2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gcGFyc2VQYXRjaCh1bmlEaWZmLCBvcHRpb25zID0ge30pIHtcbiAgbGV0IGRpZmZzdHIgPSB1bmlEaWZmLnNwbGl0KC9cXHJcXG58W1xcblxcdlxcZlxcclxceDg1XS8pLFxuICAgICAgZGVsaW1pdGVycyA9IHVuaURpZmYubWF0Y2goL1xcclxcbnxbXFxuXFx2XFxmXFxyXFx4ODVdL2cpIHx8IFtdLFxuICAgICAgbGlzdCA9IFtdLFxuICAgICAgaSA9IDA7XG5cbiAgZnVuY3Rpb24gcGFyc2VJbmRleCgpIHtcbiAgICBsZXQgaW5kZXggPSB7fTtcbiAgICBsaXN0LnB1c2goaW5kZXgpO1xuXG4gICAgLy8gUGFyc2UgZGlmZiBtZXRhZGF0YVxuICAgIHdoaWxlIChpIDwgZGlmZnN0ci5sZW5ndGgpIHtcbiAgICAgIGxldCBsaW5lID0gZGlmZnN0cltpXTtcblxuICAgICAgLy8gRmlsZSBoZWFkZXIgZm91bmQsIGVuZCBwYXJzaW5nIGRpZmYgbWV0YWRhdGFcbiAgICAgIGlmICgvXihcXC1cXC1cXC18XFwrXFwrXFwrfEBAKVxccy8udGVzdChsaW5lKSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgLy8gRGlmZiBpbmRleFxuICAgICAgbGV0IGhlYWRlciA9ICgvXig/OkluZGV4OnxkaWZmKD86IC1yIFxcdyspKylcXHMrKC4rPylcXHMqJC8pLmV4ZWMobGluZSk7XG4gICAgICBpZiAoaGVhZGVyKSB7XG4gICAgICAgIGluZGV4LmluZGV4ID0gaGVhZGVyWzFdO1xuICAgICAgfVxuXG4gICAgICBpKys7XG4gICAgfVxuXG4gICAgLy8gUGFyc2UgZmlsZSBoZWFkZXJzIGlmIHRoZXkgYXJlIGRlZmluZWQuIFVuaWZpZWQgZGlmZiByZXF1aXJlcyB0aGVtLCBidXRcbiAgICAvLyB0aGVyZSdzIG5vIHRlY2huaWNhbCBpc3N1ZXMgdG8gaGF2ZSBhbiBpc29sYXRlZCBodW5rIHdpdGhvdXQgZmlsZSBoZWFkZXJcbiAgICBwYXJzZUZpbGVIZWFkZXIoaW5kZXgpO1xuICAgIHBhcnNlRmlsZUhlYWRlcihpbmRleCk7XG5cbiAgICAvLyBQYXJzZSBodW5rc1xuICAgIGluZGV4Lmh1bmtzID0gW107XG5cbiAgICB3aGlsZSAoaSA8IGRpZmZzdHIubGVuZ3RoKSB7XG4gICAgICBsZXQgbGluZSA9IGRpZmZzdHJbaV07XG5cbiAgICAgIGlmICgvXihJbmRleDp8ZGlmZnxcXC1cXC1cXC18XFwrXFwrXFwrKVxccy8udGVzdChsaW5lKSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSBpZiAoL15AQC8udGVzdChsaW5lKSkge1xuICAgICAgICBpbmRleC5odW5rcy5wdXNoKHBhcnNlSHVuaygpKTtcbiAgICAgIH0gZWxzZSBpZiAobGluZSAmJiBvcHRpb25zLnN0cmljdCkge1xuICAgICAgICAvLyBJZ25vcmUgdW5leHBlY3RlZCBjb250ZW50IHVubGVzcyBpbiBzdHJpY3QgbW9kZVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gbGluZSAnICsgKGkgKyAxKSArICcgJyArIEpTT04uc3RyaW5naWZ5KGxpbmUpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGkrKztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBQYXJzZXMgdGhlIC0tLSBhbmQgKysrIGhlYWRlcnMsIGlmIG5vbmUgYXJlIGZvdW5kLCBubyBsaW5lc1xuICAvLyBhcmUgY29uc3VtZWQuXG4gIGZ1bmN0aW9uIHBhcnNlRmlsZUhlYWRlcihpbmRleCkge1xuICAgIGNvbnN0IGZpbGVIZWFkZXIgPSAoL14oLS0tfFxcK1xcK1xcKylcXHMrKC4qKSQvKS5leGVjKGRpZmZzdHJbaV0pO1xuICAgIGlmIChmaWxlSGVhZGVyKSB7XG4gICAgICBsZXQga2V5UHJlZml4ID0gZmlsZUhlYWRlclsxXSA9PT0gJy0tLScgPyAnb2xkJyA6ICduZXcnO1xuICAgICAgY29uc3QgZGF0YSA9IGZpbGVIZWFkZXJbMl0uc3BsaXQoJ1xcdCcsIDIpO1xuICAgICAgbGV0IGZpbGVOYW1lID0gZGF0YVswXS5yZXBsYWNlKC9cXFxcXFxcXC9nLCAnXFxcXCcpO1xuICAgICAgaWYgKC9eXCIuKlwiJC8udGVzdChmaWxlTmFtZSkpIHtcbiAgICAgICAgZmlsZU5hbWUgPSBmaWxlTmFtZS5zdWJzdHIoMSwgZmlsZU5hbWUubGVuZ3RoIC0gMik7XG4gICAgICB9XG4gICAgICBpbmRleFtrZXlQcmVmaXggKyAnRmlsZU5hbWUnXSA9IGZpbGVOYW1lO1xuICAgICAgaW5kZXhba2V5UHJlZml4ICsgJ0hlYWRlciddID0gKGRhdGFbMV0gfHwgJycpLnRyaW0oKTtcblxuICAgICAgaSsrO1xuICAgIH1cbiAgfVxuXG4gIC8vIFBhcnNlcyBhIGh1bmtcbiAgLy8gVGhpcyBhc3N1bWVzIHRoYXQgd2UgYXJlIGF0IHRoZSBzdGFydCBvZiBhIGh1bmsuXG4gIGZ1bmN0aW9uIHBhcnNlSHVuaygpIHtcbiAgICBsZXQgY2h1bmtIZWFkZXJJbmRleCA9IGksXG4gICAgICAgIGNodW5rSGVhZGVyTGluZSA9IGRpZmZzdHJbaSsrXSxcbiAgICAgICAgY2h1bmtIZWFkZXIgPSBjaHVua0hlYWRlckxpbmUuc3BsaXQoL0BAIC0oXFxkKykoPzosKFxcZCspKT8gXFwrKFxcZCspKD86LChcXGQrKSk/IEBALyk7XG5cbiAgICBsZXQgaHVuayA9IHtcbiAgICAgIG9sZFN0YXJ0OiArY2h1bmtIZWFkZXJbMV0sXG4gICAgICBvbGRMaW5lczogK2NodW5rSGVhZGVyWzJdIHx8IDEsXG4gICAgICBuZXdTdGFydDogK2NodW5rSGVhZGVyWzNdLFxuICAgICAgbmV3TGluZXM6ICtjaHVua0hlYWRlcls0XSB8fCAxLFxuICAgICAgbGluZXM6IFtdLFxuICAgICAgbGluZWRlbGltaXRlcnM6IFtdXG4gICAgfTtcblxuICAgIGxldCBhZGRDb3VudCA9IDAsXG4gICAgICAgIHJlbW92ZUNvdW50ID0gMDtcbiAgICBmb3IgKDsgaSA8IGRpZmZzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgIC8vIExpbmVzIHN0YXJ0aW5nIHdpdGggJy0tLScgY291bGQgYmUgbWlzdGFrZW4gZm9yIHRoZSBcInJlbW92ZSBsaW5lXCIgb3BlcmF0aW9uXG4gICAgICAvLyBCdXQgdGhleSBjb3VsZCBiZSB0aGUgaGVhZGVyIGZvciB0aGUgbmV4dCBmaWxlLiBUaGVyZWZvcmUgcHJ1bmUgc3VjaCBjYXNlcyBvdXQuXG4gICAgICBpZiAoZGlmZnN0cltpXS5pbmRleE9mKCctLS0gJykgPT09IDBcbiAgICAgICAgICAgICYmIChpICsgMiA8IGRpZmZzdHIubGVuZ3RoKVxuICAgICAgICAgICAgJiYgZGlmZnN0cltpICsgMV0uaW5kZXhPZignKysrICcpID09PSAwXG4gICAgICAgICAgICAmJiBkaWZmc3RyW2kgKyAyXS5pbmRleE9mKCdAQCcpID09PSAwKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBsZXQgb3BlcmF0aW9uID0gKGRpZmZzdHJbaV0ubGVuZ3RoID09IDAgJiYgaSAhPSAoZGlmZnN0ci5sZW5ndGggLSAxKSkgPyAnICcgOiBkaWZmc3RyW2ldWzBdO1xuXG4gICAgICBpZiAob3BlcmF0aW9uID09PSAnKycgfHwgb3BlcmF0aW9uID09PSAnLScgfHwgb3BlcmF0aW9uID09PSAnICcgfHwgb3BlcmF0aW9uID09PSAnXFxcXCcpIHtcbiAgICAgICAgaHVuay5saW5lcy5wdXNoKGRpZmZzdHJbaV0pO1xuICAgICAgICBodW5rLmxpbmVkZWxpbWl0ZXJzLnB1c2goZGVsaW1pdGVyc1tpXSB8fCAnXFxuJyk7XG5cbiAgICAgICAgaWYgKG9wZXJhdGlvbiA9PT0gJysnKSB7XG4gICAgICAgICAgYWRkQ291bnQrKztcbiAgICAgICAgfSBlbHNlIGlmIChvcGVyYXRpb24gPT09ICctJykge1xuICAgICAgICAgIHJlbW92ZUNvdW50Kys7XG4gICAgICAgIH0gZWxzZSBpZiAob3BlcmF0aW9uID09PSAnICcpIHtcbiAgICAgICAgICBhZGRDb3VudCsrO1xuICAgICAgICAgIHJlbW92ZUNvdW50Kys7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhhbmRsZSB0aGUgZW1wdHkgYmxvY2sgY291bnQgY2FzZVxuICAgIGlmICghYWRkQ291bnQgJiYgaHVuay5uZXdMaW5lcyA9PT0gMSkge1xuICAgICAgaHVuay5uZXdMaW5lcyA9IDA7XG4gICAgfVxuICAgIGlmICghcmVtb3ZlQ291bnQgJiYgaHVuay5vbGRMaW5lcyA9PT0gMSkge1xuICAgICAgaHVuay5vbGRMaW5lcyA9IDA7XG4gICAgfVxuXG4gICAgLy8gUGVyZm9ybSBvcHRpb25hbCBzYW5pdHkgY2hlY2tpbmdcbiAgICBpZiAob3B0aW9ucy5zdHJpY3QpIHtcbiAgICAgIGlmIChhZGRDb3VudCAhPT0gaHVuay5uZXdMaW5lcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FkZGVkIGxpbmUgY291bnQgZGlkIG5vdCBtYXRjaCBmb3IgaHVuayBhdCBsaW5lICcgKyAoY2h1bmtIZWFkZXJJbmRleCArIDEpKTtcbiAgICAgIH1cbiAgICAgIGlmIChyZW1vdmVDb3VudCAhPT0gaHVuay5vbGRMaW5lcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlbW92ZWQgbGluZSBjb3VudCBkaWQgbm90IG1hdGNoIGZvciBodW5rIGF0IGxpbmUgJyArIChjaHVua0hlYWRlckluZGV4ICsgMSkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBodW5rO1xuICB9XG5cbiAgd2hpbGUgKGkgPCBkaWZmc3RyLmxlbmd0aCkge1xuICAgIHBhcnNlSW5kZXgoKTtcbiAgfVxuXG4gIHJldHVybiBsaXN0O1xufVxuIl19\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/\"use strict\";\n\n\texports.__esModule = true;\n\n\texports[\"default\"] = /*istanbul ignore end*/function (start, minLine, maxLine) {\n\t  var wantForward = true,\n\t      backwardExhausted = false,\n\t      forwardExhausted = false,\n\t      localOffset = 1;\n\n\t  return function iterator() {\n\t    if (wantForward && !forwardExhausted) {\n\t      if (backwardExhausted) {\n\t        localOffset++;\n\t      } else {\n\t        wantForward = false;\n\t      }\n\n\t      // Check if trying to fit beyond text length, and if not, check it fits\n\t      // after offset location (or desired location on first iteration)\n\t      if (start + localOffset <= maxLine) {\n\t        return localOffset;\n\t      }\n\n\t      forwardExhausted = true;\n\t    }\n\n\t    if (!backwardExhausted) {\n\t      if (!forwardExhausted) {\n\t        wantForward = true;\n\t      }\n\n\t      // Check if trying to fit before text beginning, and if not, check it fits\n\t      // before offset location\n\t      if (minLine <= start - localOffset) {\n\t        return -localOffset++;\n\t      }\n\n\t      backwardExhausted = true;\n\t      return iterator();\n\t    }\n\n\t    // We tried to fit hunk before text beginning and beyond text length, then\n\t    // hunk can't fit on the text. Return undefined\n\t  };\n\t};\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL2Rpc3RhbmNlLWl0ZXJhdG9yLmpzIl0sIm5hbWVzIjpbInN0YXJ0IiwibWluTGluZSIsIm1heExpbmUiLCJ3YW50Rm9yd2FyZCIsImJhY2t3YXJkRXhoYXVzdGVkIiwiZm9yd2FyZEV4aGF1c3RlZCIsImxvY2FsT2Zmc2V0IiwiaXRlcmF0b3IiXSwibWFwcGluZ3MiOiI7Ozs7NENBR2UsVUFBU0EsS0FBVCxFQUFnQkMsT0FBaEIsRUFBeUJDLE9BQXpCLEVBQWtDO0FBQy9DLE1BQUlDLGNBQWMsSUFBbEI7QUFBQSxNQUNJQyxvQkFBb0IsS0FEeEI7QUFBQSxNQUVJQyxtQkFBbUIsS0FGdkI7QUFBQSxNQUdJQyxjQUFjLENBSGxCOztBQUtBLFNBQU8sU0FBU0MsUUFBVCxHQUFvQjtBQUN6QixRQUFJSixlQUFlLENBQUNFLGdCQUFwQixFQUFzQztBQUNwQyxVQUFJRCxpQkFBSixFQUF1QjtBQUNyQkU7QUFDRCxPQUZELE1BRU87QUFDTEgsc0JBQWMsS0FBZDtBQUNEOztBQUVEO0FBQ0E7QUFDQSxVQUFJSCxRQUFRTSxXQUFSLElBQXVCSixPQUEzQixFQUFvQztBQUNsQyxlQUFPSSxXQUFQO0FBQ0Q7O0FBRURELHlCQUFtQixJQUFuQjtBQUNEOztBQUVELFFBQUksQ0FBQ0QsaUJBQUwsRUFBd0I7QUFDdEIsVUFBSSxDQUFDQyxnQkFBTCxFQUF1QjtBQUNyQkYsc0JBQWMsSUFBZDtBQUNEOztBQUVEO0FBQ0E7QUFDQSxVQUFJRixXQUFXRCxRQUFRTSxXQUF2QixFQUFvQztBQUNsQyxlQUFPLENBQUNBLGFBQVI7QUFDRDs7QUFFREYsMEJBQW9CLElBQXBCO0FBQ0EsYUFBT0csVUFBUDtBQUNEOztBQUVEO0FBQ0E7QUFDRCxHQWxDRDtBQW1DRCxDIiwiZmlsZSI6ImRpc3RhbmNlLWl0ZXJhdG9yLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gSXRlcmF0b3IgdGhhdCB0cmF2ZXJzZXMgaW4gdGhlIHJhbmdlIG9mIFttaW4sIG1heF0sIHN0ZXBwaW5nXG4vLyBieSBkaXN0YW5jZSBmcm9tIGEgZ2l2ZW4gc3RhcnQgcG9zaXRpb24uIEkuZS4gZm9yIFswLCA0XSwgd2l0aFxuLy8gc3RhcnQgb2YgMiwgdGhpcyB3aWxsIGl0ZXJhdGUgMiwgMywgMSwgNCwgMC5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHN0YXJ0LCBtaW5MaW5lLCBtYXhMaW5lKSB7XG4gIGxldCB3YW50Rm9yd2FyZCA9IHRydWUsXG4gICAgICBiYWNrd2FyZEV4aGF1c3RlZCA9IGZhbHNlLFxuICAgICAgZm9yd2FyZEV4aGF1c3RlZCA9IGZhbHNlLFxuICAgICAgbG9jYWxPZmZzZXQgPSAxO1xuXG4gIHJldHVybiBmdW5jdGlvbiBpdGVyYXRvcigpIHtcbiAgICBpZiAod2FudEZvcndhcmQgJiYgIWZvcndhcmRFeGhhdXN0ZWQpIHtcbiAgICAgIGlmIChiYWNrd2FyZEV4aGF1c3RlZCkge1xuICAgICAgICBsb2NhbE9mZnNldCsrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgd2FudEZvcndhcmQgPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdHJ5aW5nIHRvIGZpdCBiZXlvbmQgdGV4dCBsZW5ndGgsIGFuZCBpZiBub3QsIGNoZWNrIGl0IGZpdHNcbiAgICAgIC8vIGFmdGVyIG9mZnNldCBsb2NhdGlvbiAob3IgZGVzaXJlZCBsb2NhdGlvbiBvbiBmaXJzdCBpdGVyYXRpb24pXG4gICAgICBpZiAoc3RhcnQgKyBsb2NhbE9mZnNldCA8PSBtYXhMaW5lKSB7XG4gICAgICAgIHJldHVybiBsb2NhbE9mZnNldDtcbiAgICAgIH1cblxuICAgICAgZm9yd2FyZEV4aGF1c3RlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKCFiYWNrd2FyZEV4aGF1c3RlZCkge1xuICAgICAgaWYgKCFmb3J3YXJkRXhoYXVzdGVkKSB7XG4gICAgICAgIHdhbnRGb3J3YXJkID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdHJ5aW5nIHRvIGZpdCBiZWZvcmUgdGV4dCBiZWdpbm5pbmcsIGFuZCBpZiBub3QsIGNoZWNrIGl0IGZpdHNcbiAgICAgIC8vIGJlZm9yZSBvZmZzZXQgbG9jYXRpb25cbiAgICAgIGlmIChtaW5MaW5lIDw9IHN0YXJ0IC0gbG9jYWxPZmZzZXQpIHtcbiAgICAgICAgcmV0dXJuIC1sb2NhbE9mZnNldCsrO1xuICAgICAgfVxuXG4gICAgICBiYWNrd2FyZEV4aGF1c3RlZCA9IHRydWU7XG4gICAgICByZXR1cm4gaXRlcmF0b3IoKTtcbiAgICB9XG5cbiAgICAvLyBXZSB0cmllZCB0byBmaXQgaHVuayBiZWZvcmUgdGV4dCBiZWdpbm5pbmcgYW5kIGJleW9uZCB0ZXh0IGxlbmd0aCwgdGhlblxuICAgIC8vIGh1bmsgY2FuJ3QgZml0IG9uIHRoZSB0ZXh0LiBSZXR1cm4gdW5kZWZpbmVkXG4gIH07XG59XG4iXX0=\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/calcLineCount = calcLineCount;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/merge = merge;\n\n\tvar /*istanbul ignore start*/_create = __webpack_require__(14) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_parse = __webpack_require__(11) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_array = __webpack_require__(15) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n\t/*istanbul ignore end*/function calcLineCount(hunk) {\n\t  /*istanbul ignore start*/var _calcOldNewLineCount = /*istanbul ignore end*/calcOldNewLineCount(hunk.lines),\n\t      oldLines = _calcOldNewLineCount.oldLines,\n\t      newLines = _calcOldNewLineCount.newLines;\n\n\t  if (oldLines !== undefined) {\n\t    hunk.oldLines = oldLines;\n\t  } else {\n\t    delete hunk.oldLines;\n\t  }\n\n\t  if (newLines !== undefined) {\n\t    hunk.newLines = newLines;\n\t  } else {\n\t    delete hunk.newLines;\n\t  }\n\t}\n\n\tfunction merge(mine, theirs, base) {\n\t  mine = loadPatch(mine, base);\n\t  theirs = loadPatch(theirs, base);\n\n\t  var ret = {};\n\n\t  // For index we just let it pass through as it doesn't have any necessary meaning.\n\t  // Leaving sanity checks on this to the API consumer that may know more about the\n\t  // meaning in their own context.\n\t  if (mine.index || theirs.index) {\n\t    ret.index = mine.index || theirs.index;\n\t  }\n\n\t  if (mine.newFileName || theirs.newFileName) {\n\t    if (!fileNameChanged(mine)) {\n\t      // No header or no change in ours, use theirs (and ours if theirs does not exist)\n\t      ret.oldFileName = theirs.oldFileName || mine.oldFileName;\n\t      ret.newFileName = theirs.newFileName || mine.newFileName;\n\t      ret.oldHeader = theirs.oldHeader || mine.oldHeader;\n\t      ret.newHeader = theirs.newHeader || mine.newHeader;\n\t    } else if (!fileNameChanged(theirs)) {\n\t      // No header or no change in theirs, use ours\n\t      ret.oldFileName = mine.oldFileName;\n\t      ret.newFileName = mine.newFileName;\n\t      ret.oldHeader = mine.oldHeader;\n\t      ret.newHeader = mine.newHeader;\n\t    } else {\n\t      // Both changed... figure it out\n\t      ret.oldFileName = selectField(ret, mine.oldFileName, theirs.oldFileName);\n\t      ret.newFileName = selectField(ret, mine.newFileName, theirs.newFileName);\n\t      ret.oldHeader = selectField(ret, mine.oldHeader, theirs.oldHeader);\n\t      ret.newHeader = selectField(ret, mine.newHeader, theirs.newHeader);\n\t    }\n\t  }\n\n\t  ret.hunks = [];\n\n\t  var mineIndex = 0,\n\t      theirsIndex = 0,\n\t      mineOffset = 0,\n\t      theirsOffset = 0;\n\n\t  while (mineIndex < mine.hunks.length || theirsIndex < theirs.hunks.length) {\n\t    var mineCurrent = mine.hunks[mineIndex] || { oldStart: Infinity },\n\t        theirsCurrent = theirs.hunks[theirsIndex] || { oldStart: Infinity };\n\n\t    if (hunkBefore(mineCurrent, theirsCurrent)) {\n\t      // This patch does not overlap with any of the others, yay.\n\t      ret.hunks.push(cloneHunk(mineCurrent, mineOffset));\n\t      mineIndex++;\n\t      theirsOffset += mineCurrent.newLines - mineCurrent.oldLines;\n\t    } else if (hunkBefore(theirsCurrent, mineCurrent)) {\n\t      // This patch does not overlap with any of the others, yay.\n\t      ret.hunks.push(cloneHunk(theirsCurrent, theirsOffset));\n\t      theirsIndex++;\n\t      mineOffset += theirsCurrent.newLines - theirsCurrent.oldLines;\n\t    } else {\n\t      // Overlap, merge as best we can\n\t      var mergedHunk = {\n\t        oldStart: Math.min(mineCurrent.oldStart, theirsCurrent.oldStart),\n\t        oldLines: 0,\n\t        newStart: Math.min(mineCurrent.newStart + mineOffset, theirsCurrent.oldStart + theirsOffset),\n\t        newLines: 0,\n\t        lines: []\n\t      };\n\t      mergeLines(mergedHunk, mineCurrent.oldStart, mineCurrent.lines, theirsCurrent.oldStart, theirsCurrent.lines);\n\t      theirsIndex++;\n\t      mineIndex++;\n\n\t      ret.hunks.push(mergedHunk);\n\t    }\n\t  }\n\n\t  return ret;\n\t}\n\n\tfunction loadPatch(param, base) {\n\t  if (typeof param === 'string') {\n\t    if (/^@@/m.test(param) || /^Index:/m.test(param)) {\n\t      return (/*istanbul ignore start*/(0, _parse.parsePatch) /*istanbul ignore end*/(param)[0]\n\t      );\n\t    }\n\n\t    if (!base) {\n\t      throw new Error('Must provide a base reference or pass in a patch');\n\t    }\n\t    return (/*istanbul ignore start*/(0, _create.structuredPatch) /*istanbul ignore end*/(undefined, undefined, base, param)\n\t    );\n\t  }\n\n\t  return param;\n\t}\n\n\tfunction fileNameChanged(patch) {\n\t  return patch.newFileName && patch.newFileName !== patch.oldFileName;\n\t}\n\n\tfunction selectField(index, mine, theirs) {\n\t  if (mine === theirs) {\n\t    return mine;\n\t  } else {\n\t    index.conflict = true;\n\t    return { mine: mine, theirs: theirs };\n\t  }\n\t}\n\n\tfunction hunkBefore(test, check) {\n\t  return test.oldStart < check.oldStart && test.oldStart + test.oldLines < check.oldStart;\n\t}\n\n\tfunction cloneHunk(hunk, offset) {\n\t  return {\n\t    oldStart: hunk.oldStart, oldLines: hunk.oldLines,\n\t    newStart: hunk.newStart + offset, newLines: hunk.newLines,\n\t    lines: hunk.lines\n\t  };\n\t}\n\n\tfunction mergeLines(hunk, mineOffset, mineLines, theirOffset, theirLines) {\n\t  // This will generally result in a conflicted hunk, but there are cases where the context\n\t  // is the only overlap where we can successfully merge the content here.\n\t  var mine = { offset: mineOffset, lines: mineLines, index: 0 },\n\t      their = { offset: theirOffset, lines: theirLines, index: 0 };\n\n\t  // Handle any leading content\n\t  insertLeading(hunk, mine, their);\n\t  insertLeading(hunk, their, mine);\n\n\t  // Now in the overlap content. Scan through and select the best changes from each.\n\t  while (mine.index < mine.lines.length && their.index < their.lines.length) {\n\t    var mineCurrent = mine.lines[mine.index],\n\t        theirCurrent = their.lines[their.index];\n\n\t    if ((mineCurrent[0] === '-' || mineCurrent[0] === '+') && (theirCurrent[0] === '-' || theirCurrent[0] === '+')) {\n\t      // Both modified ...\n\t      mutualChange(hunk, mine, their);\n\t    } else if (mineCurrent[0] === '+' && theirCurrent[0] === ' ') {\n\t      /*istanbul ignore start*/var _hunk$lines;\n\n\t      /*istanbul ignore end*/ // Mine inserted\n\t      /*istanbul ignore start*/(_hunk$lines = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/collectChange(mine)));\n\t    } else if (theirCurrent[0] === '+' && mineCurrent[0] === ' ') {\n\t      /*istanbul ignore start*/var _hunk$lines2;\n\n\t      /*istanbul ignore end*/ // Theirs inserted\n\t      /*istanbul ignore start*/(_hunk$lines2 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines2 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/collectChange(their)));\n\t    } else if (mineCurrent[0] === '-' && theirCurrent[0] === ' ') {\n\t      // Mine removed or edited\n\t      removal(hunk, mine, their);\n\t    } else if (theirCurrent[0] === '-' && mineCurrent[0] === ' ') {\n\t      // Their removed or edited\n\t      removal(hunk, their, mine, true);\n\t    } else if (mineCurrent === theirCurrent) {\n\t      // Context identity\n\t      hunk.lines.push(mineCurrent);\n\t      mine.index++;\n\t      their.index++;\n\t    } else {\n\t      // Context mismatch\n\t      conflict(hunk, collectChange(mine), collectChange(their));\n\t    }\n\t  }\n\n\t  // Now push anything that may be remaining\n\t  insertTrailing(hunk, mine);\n\t  insertTrailing(hunk, their);\n\n\t  calcLineCount(hunk);\n\t}\n\n\tfunction mutualChange(hunk, mine, their) {\n\t  var myChanges = collectChange(mine),\n\t      theirChanges = collectChange(their);\n\n\t  if (allRemoves(myChanges) && allRemoves(theirChanges)) {\n\t    // Special case for remove changes that are supersets of one another\n\t    if ( /*istanbul ignore start*/(0, _array.arrayStartsWith) /*istanbul ignore end*/(myChanges, theirChanges) && skipRemoveSuperset(their, myChanges, myChanges.length - theirChanges.length)) {\n\t      /*istanbul ignore start*/var _hunk$lines3;\n\n\t      /*istanbul ignore end*/ /*istanbul ignore start*/(_hunk$lines3 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines3 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/myChanges));\n\t      return;\n\t    } else if ( /*istanbul ignore start*/(0, _array.arrayStartsWith) /*istanbul ignore end*/(theirChanges, myChanges) && skipRemoveSuperset(mine, theirChanges, theirChanges.length - myChanges.length)) {\n\t      /*istanbul ignore start*/var _hunk$lines4;\n\n\t      /*istanbul ignore end*/ /*istanbul ignore start*/(_hunk$lines4 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines4 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/theirChanges));\n\t      return;\n\t    }\n\t  } else if ( /*istanbul ignore start*/(0, _array.arrayEqual) /*istanbul ignore end*/(myChanges, theirChanges)) {\n\t    /*istanbul ignore start*/var _hunk$lines5;\n\n\t    /*istanbul ignore end*/ /*istanbul ignore start*/(_hunk$lines5 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines5 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/myChanges));\n\t    return;\n\t  }\n\n\t  conflict(hunk, myChanges, theirChanges);\n\t}\n\n\tfunction removal(hunk, mine, their, swap) {\n\t  var myChanges = collectChange(mine),\n\t      theirChanges = collectContext(their, myChanges);\n\t  if (theirChanges.merged) {\n\t    /*istanbul ignore start*/var _hunk$lines6;\n\n\t    /*istanbul ignore end*/ /*istanbul ignore start*/(_hunk$lines6 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines6 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/theirChanges.merged));\n\t  } else {\n\t    conflict(hunk, swap ? theirChanges : myChanges, swap ? myChanges : theirChanges);\n\t  }\n\t}\n\n\tfunction conflict(hunk, mine, their) {\n\t  hunk.conflict = true;\n\t  hunk.lines.push({\n\t    conflict: true,\n\t    mine: mine,\n\t    theirs: their\n\t  });\n\t}\n\n\tfunction insertLeading(hunk, insert, their) {\n\t  while (insert.offset < their.offset && insert.index < insert.lines.length) {\n\t    var line = insert.lines[insert.index++];\n\t    hunk.lines.push(line);\n\t    insert.offset++;\n\t  }\n\t}\n\tfunction insertTrailing(hunk, insert) {\n\t  while (insert.index < insert.lines.length) {\n\t    var line = insert.lines[insert.index++];\n\t    hunk.lines.push(line);\n\t  }\n\t}\n\n\tfunction collectChange(state) {\n\t  var ret = [],\n\t      operation = state.lines[state.index][0];\n\t  while (state.index < state.lines.length) {\n\t    var line = state.lines[state.index];\n\n\t    // Group additions that are immediately after subtractions and treat them as one \"atomic\" modify change.\n\t    if (operation === '-' && line[0] === '+') {\n\t      operation = '+';\n\t    }\n\n\t    if (operation === line[0]) {\n\t      ret.push(line);\n\t      state.index++;\n\t    } else {\n\t      break;\n\t    }\n\t  }\n\n\t  return ret;\n\t}\n\tfunction collectContext(state, matchChanges) {\n\t  var changes = [],\n\t      merged = [],\n\t      matchIndex = 0,\n\t      contextChanges = false,\n\t      conflicted = false;\n\t  while (matchIndex < matchChanges.length && state.index < state.lines.length) {\n\t    var change = state.lines[state.index],\n\t        match = matchChanges[matchIndex];\n\n\t    // Once we've hit our add, then we are done\n\t    if (match[0] === '+') {\n\t      break;\n\t    }\n\n\t    contextChanges = contextChanges || change[0] !== ' ';\n\n\t    merged.push(match);\n\t    matchIndex++;\n\n\t    // Consume any additions in the other block as a conflict to attempt\n\t    // to pull in the remaining context after this\n\t    if (change[0] === '+') {\n\t      conflicted = true;\n\n\t      while (change[0] === '+') {\n\t        changes.push(change);\n\t        change = state.lines[++state.index];\n\t      }\n\t    }\n\n\t    if (match.substr(1) === change.substr(1)) {\n\t      changes.push(change);\n\t      state.index++;\n\t    } else {\n\t      conflicted = true;\n\t    }\n\t  }\n\n\t  if ((matchChanges[matchIndex] || '')[0] === '+' && contextChanges) {\n\t    conflicted = true;\n\t  }\n\n\t  if (conflicted) {\n\t    return changes;\n\t  }\n\n\t  while (matchIndex < matchChanges.length) {\n\t    merged.push(matchChanges[matchIndex++]);\n\t  }\n\n\t  return {\n\t    merged: merged,\n\t    changes: changes\n\t  };\n\t}\n\n\tfunction allRemoves(changes) {\n\t  return changes.reduce(function (prev, change) {\n\t    return prev && change[0] === '-';\n\t  }, true);\n\t}\n\tfunction skipRemoveSuperset(state, removeChanges, delta) {\n\t  for (var i = 0; i < delta; i++) {\n\t    var changeContent = removeChanges[removeChanges.length - delta + i].substr(1);\n\t    if (state.lines[state.index + i] !== ' ' + changeContent) {\n\t      return false;\n\t    }\n\t  }\n\n\t  state.index += delta;\n\t  return true;\n\t}\n\n\tfunction calcOldNewLineCount(lines) {\n\t  var oldLines = 0;\n\t  var newLines = 0;\n\n\t  lines.forEach(function (line) {\n\t    if (typeof line !== 'string') {\n\t      var myCount = calcOldNewLineCount(line.mine);\n\t      var theirCount = calcOldNewLineCount(line.theirs);\n\n\t      if (oldLines !== undefined) {\n\t        if (myCount.oldLines === theirCount.oldLines) {\n\t          oldLines += myCount.oldLines;\n\t        } else {\n\t          oldLines = undefined;\n\t        }\n\t      }\n\n\t      if (newLines !== undefined) {\n\t        if (myCount.newLines === theirCount.newLines) {\n\t          newLines += myCount.newLines;\n\t        } else {\n\t          newLines = undefined;\n\t        }\n\t      }\n\t    } else {\n\t      if (newLines !== undefined && (line[0] === '+' || line[0] === ' ')) {\n\t        newLines++;\n\t      }\n\t      if (oldLines !== undefined && (line[0] === '-' || line[0] === ' ')) {\n\t        oldLines++;\n\t      }\n\t    }\n\t  });\n\n\t  return { oldLines: oldLines, newLines: newLines };\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYXRjaC9tZXJnZS5qcyJdLCJuYW1lcyI6WyJjYWxjTGluZUNvdW50IiwibWVyZ2UiLCJodW5rIiwiY2FsY09sZE5ld0xpbmVDb3VudCIsImxpbmVzIiwib2xkTGluZXMiLCJuZXdMaW5lcyIsInVuZGVmaW5lZCIsIm1pbmUiLCJ0aGVpcnMiLCJiYXNlIiwibG9hZFBhdGNoIiwicmV0IiwiaW5kZXgiLCJuZXdGaWxlTmFtZSIsImZpbGVOYW1lQ2hhbmdlZCIsIm9sZEZpbGVOYW1lIiwib2xkSGVhZGVyIiwibmV3SGVhZGVyIiwic2VsZWN0RmllbGQiLCJodW5rcyIsIm1pbmVJbmRleCIsInRoZWlyc0luZGV4IiwibWluZU9mZnNldCIsInRoZWlyc09mZnNldCIsImxlbmd0aCIsIm1pbmVDdXJyZW50Iiwib2xkU3RhcnQiLCJJbmZpbml0eSIsInRoZWlyc0N1cnJlbnQiLCJodW5rQmVmb3JlIiwicHVzaCIsImNsb25lSHVuayIsIm1lcmdlZEh1bmsiLCJNYXRoIiwibWluIiwibmV3U3RhcnQiLCJtZXJnZUxpbmVzIiwicGFyYW0iLCJ0ZXN0IiwiRXJyb3IiLCJwYXRjaCIsImNvbmZsaWN0IiwiY2hlY2siLCJvZmZzZXQiLCJtaW5lTGluZXMiLCJ0aGVpck9mZnNldCIsInRoZWlyTGluZXMiLCJ0aGVpciIsImluc2VydExlYWRpbmciLCJ0aGVpckN1cnJlbnQiLCJtdXR1YWxDaGFuZ2UiLCJjb2xsZWN0Q2hhbmdlIiwicmVtb3ZhbCIsImluc2VydFRyYWlsaW5nIiwibXlDaGFuZ2VzIiwidGhlaXJDaGFuZ2VzIiwiYWxsUmVtb3ZlcyIsInNraXBSZW1vdmVTdXBlcnNldCIsInN3YXAiLCJjb2xsZWN0Q29udGV4dCIsIm1lcmdlZCIsImluc2VydCIsImxpbmUiLCJzdGF0ZSIsIm9wZXJhdGlvbiIsIm1hdGNoQ2hhbmdlcyIsImNoYW5nZXMiLCJtYXRjaEluZGV4IiwiY29udGV4dENoYW5nZXMiLCJjb25mbGljdGVkIiwiY2hhbmdlIiwibWF0Y2giLCJzdWJzdHIiLCJyZWR1Y2UiLCJwcmV2IiwicmVtb3ZlQ2hhbmdlcyIsImRlbHRhIiwiaSIsImNoYW5nZUNvbnRlbnQiLCJmb3JFYWNoIiwibXlDb3VudCIsInRoZWlyQ291bnQiXSwibWFwcGluZ3MiOiI7OztnQ0FLZ0JBLGEsR0FBQUEsYTt5REFnQkFDLEssR0FBQUEsSzs7QUFyQmhCOztBQUNBOztBQUVBOzs7O3VCQUVPLFNBQVNELGFBQVQsQ0FBdUJFLElBQXZCLEVBQTZCO0FBQUEsNkVBQ0xDLG9CQUFvQkQsS0FBS0UsS0FBekIsQ0FESztBQUFBLE1BQzNCQyxRQUQyQix3QkFDM0JBLFFBRDJCO0FBQUEsTUFDakJDLFFBRGlCLHdCQUNqQkEsUUFEaUI7O0FBR2xDLE1BQUlELGFBQWFFLFNBQWpCLEVBQTRCO0FBQzFCTCxTQUFLRyxRQUFMLEdBQWdCQSxRQUFoQjtBQUNELEdBRkQsTUFFTztBQUNMLFdBQU9ILEtBQUtHLFFBQVo7QUFDRDs7QUFFRCxNQUFJQyxhQUFhQyxTQUFqQixFQUE0QjtBQUMxQkwsU0FBS0ksUUFBTCxHQUFnQkEsUUFBaEI7QUFDRCxHQUZELE1BRU87QUFDTCxXQUFPSixLQUFLSSxRQUFaO0FBQ0Q7QUFDRjs7QUFFTSxTQUFTTCxLQUFULENBQWVPLElBQWYsRUFBcUJDLE1BQXJCLEVBQTZCQyxJQUE3QixFQUFtQztBQUN4Q0YsU0FBT0csVUFBVUgsSUFBVixFQUFnQkUsSUFBaEIsQ0FBUDtBQUNBRCxXQUFTRSxVQUFVRixNQUFWLEVBQWtCQyxJQUFsQixDQUFUOztBQUVBLE1BQUlFLE1BQU0sRUFBVjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFJSixLQUFLSyxLQUFMLElBQWNKLE9BQU9JLEtBQXpCLEVBQWdDO0FBQzlCRCxRQUFJQyxLQUFKLEdBQVlMLEtBQUtLLEtBQUwsSUFBY0osT0FBT0ksS0FBakM7QUFDRDs7QUFFRCxNQUFJTCxLQUFLTSxXQUFMLElBQW9CTCxPQUFPSyxXQUEvQixFQUE0QztBQUMxQyxRQUFJLENBQUNDLGdCQUFnQlAsSUFBaEIsQ0FBTCxF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Q0Q7QUFDRjs7QUFFRCxVQUFJRCxhQUFhQyxTQUFqQixFQUE0QjtBQUMxQixZQUFJMEUsUUFBUTNFLFFBQVIsS0FBcUI0RSxXQUFXNUUsUUFBcEMsRUFBOEM7QUFDNUNBLHNCQUFZMkUsUUFBUTNFLFFBQXBCO0FBQ0QsU0FGRCxNQUVPO0FBQ0xBLHFCQUFXQyxTQUFYO0FBQ0Q7QUFDRjtBQUNGLEtBbkJELE1BbUJPO0FBQ0wsVUFBSUQsYUFBYUMsU0FBYixLQUEyQndELEtBQUssQ0FBTCxNQUFZLEdBQVosSUFBbUJBLEtBQUssQ0FBTCxNQUFZLEdBQTFELENBQUosRUFBb0U7QUFDbEV6RDtBQUNEO0FBQ0QsVUFBSUQsYUFBYUUsU0FBYixLQUEyQndELEtBQUssQ0FBTCxNQUFZLEdBQVosSUFBbUJBLEtBQUssQ0FBTCxNQUFZLEdBQTFELENBQUosRUFBb0U7QUFDbEUxRDtBQUNEO0FBQ0Y7QUFDRixHQTVCRDs7QUE4QkEsU0FBTyxFQUFDQSxrQkFBRCxFQUFXQyxrQkFBWCxFQUFQO0FBQ0QiLCJmaWxlIjoibWVyZ2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge3N0cnVjdHVyZWRQYXRjaH0gZnJvbSAnLi9jcmVhdGUnO1xuaW1wb3J0IHtwYXJzZVBhdGNofSBmcm9tICcuL3BhcnNlJztcblxuaW1wb3J0IHthcnJheUVxdWFsLCBhcnJheVN0YXJ0c1dpdGh9IGZyb20gJy4uL3V0aWwvYXJyYXknO1xuXG5leHBvcnQgZnVuY3Rpb24gY2FsY0xpbmVDb3VudChodW5rKSB7XG4gIGNvbnN0IHtvbGRMaW5lcywgbmV3TGluZXN9ID0gY2FsY09sZE5ld0xpbmVDb3VudChodW5rLmxpbmVzKTtcblxuICBpZiAob2xkTGluZXMgIT09IHVuZGVmaW5lZCkge1xuICAgIGh1bmsub2xkTGluZXMgPSBvbGRMaW5lcztcbiAgfSBlbHNlIHtcbiAgICBkZWxldGUgaHVuay5vbGRMaW5lcztcbiAgfVxuXG4gIGlmIChuZXdMaW5lcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaHVuay5uZXdMaW5lcyA9IG5ld0xpbmVzO1xuICB9IGVsc2Uge1xuICAgIGRlbGV0ZSBodW5rLm5ld0xpbmVzO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXJnZShtaW5lLCB0aGVpcnMsIGJhc2UpIHtcbiAgbWluZSA9IGxvYWRQYXRjaChtaW5lLCBiYXNlKTtcbiAgdGhlaXJzID0gbG9hZFBhdGNoKHRoZWlycywgYmFzZSk7XG5cbiAgbGV0IHJldCA9IHt9O1xuXG4gIC8vIEZvciBpbmRleCB3ZSBqdXN0IGxldCBpdCBwYXNzIHRocm91Z2ggYXMgaXQgZG9lc24ndCBoYXZlIGFueSBuZWNlc3NhcnkgbWVhbmluZy5cbiAgLy8gTGVhdmluZyBzYW5pdHkgY2hlY2tzIG9uIHRoaXMgdG8gdGhlIEFQSSBjb25zdW1lciB0aGF0IG1heSBrbm93IG1vcmUgYWJvdXQgdGhlXG4gIC8vIG1lYW5pbmcgaW4gdGhlaXIgb3duIGNvbnRleHQuXG4gIGlmIChtaW5lLmluZGV4IHx8IHRoZWlycy5pbmRleCkge1xuICAgIHJldC5pbmRleCA9IG1pbmUuaW5kZXggfHwgdGhlaXJzLmluZGV4O1xuICB9XG5cbiAgaWYgKG1pbmUubmV3RmlsZU5hbWUgfHwgdGhlaXJzLm5ld0ZpbGVOYW1lKSB7XG4gICAgaWYgKCFmaWxlTmFtZUNoYW5nZWQobWluZSkpIHtcbiAgICAgIC8vIE5vIGhlYWRlciBvciBubyBjaGFuZ2UgaW4gb3VycywgdXNlIHRoZWlycyAoYW5kIG91cnMgaWYgdGhlaXJzIGRvZXMgbm90IGV4aXN0KVxuICAgICAgcmV0Lm9sZEZpbGVOYW1lID0gdGhlaXJzLm9sZEZpbGVOYW1lIHx8IG1pbmUub2xkRmlsZU5hbWU7XG4gICAgICByZXQubmV3RmlsZU5hbWUgPSB0aGVpcnMubmV3RmlsZU5hbWUgfHwgbWluZS5uZXdGaWxlTmFtZTtcbiAgICAgIHJldC5vbGRIZWFkZXIgPSB0aGVpcnMub2xkSGVhZGVyIHx8IG1pbmUub2xkSGVhZGVyO1xuICAgICAgcmV0Lm5ld0hlYWRlciA9IHRoZWlycy5uZXdIZWFkZXIgfHwgbWluZS5uZXdIZWFkZXI7XG4gICAgfSBlbHNlIGlmICghZmlsZU5hbWVDaGFuZ2VkKHRoZWlycykpIHtcbiAgICAgIC8vIE5vIGhlYWRlciBvciBubyBjaGFuZ2UgaW4gdGhlaXJzLCB1c2Ugb3Vyc1xuICAgICAgcmV0Lm9sZEZpbGVOYW1lID0gbWluZS5vbGRGaWxlTmFtZTtcbiAgICAgIHJldC5uZXdGaWxlTmFtZSA9IG1pbmUubmV3RmlsZU5hbWU7XG4gICAgICByZXQub2xkSGVhZGVyID0gbWluZS5vbGRIZWFkZXI7XG4gICAgICByZXQubmV3SGVhZGVyID0gbWluZS5uZXdIZWFkZXI7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEJvdGggY2hhbmdlZC4uLiBmaWd1cmUgaXQgb3V0XG4gICAgICByZXQub2xkRmlsZU5hbWUgPSBzZWxlY3RGaWVsZChyZXQsIG1pbmUub2xkRmlsZU5hbWUsIHRoZWlycy5vbGRGaWxlTmFtZSk7XG4gICAgICByZXQubmV3RmlsZU5hbWUgPSBzZWxlY3RGaWVsZChyZXQsIG1pbmUubmV3RmlsZU5hbWUsIHRoZWlycy5uZXdGaWxlTmFtZSk7XG4gICAgICByZXQub2xkSGVhZGVyID0gc2VsZWN0RmllbGQocmV0LCBtaW5lLm9sZEhlYWRlciwgdGhlaXJzLm9sZEhlYWRlcik7XG4gICAgICByZXQubmV3SGVhZGVyID0gc2VsZWN0RmllbGQocmV0LCBtaW5lLm5ld0hlYWRlciwgdGhlaXJzLm5ld0hlYWRlcik7XG4gICAgfVxuICB9XG5cbiAgcmV0Lmh1bmtzID0gW107XG5cbiAgbGV0IG1pbmVJbmRleCA9IDAsXG4gICAgICB0aGVpcnNJbmRleCA9IDAsXG4gICAgICBtaW5lT2Zmc2V0ID0gMCxcbiAgICAgIHRoZWlyc09mZnNldCA9IDA7XG5cbiAgd2hpbGUgKG1pbmVJbmRleCA8IG1pbmUuaHVua3MubGVuZ3RoIHx8IHRoZWlyc0luZGV4IDwgdGhlaXJzLmh1bmtzLmxlbmd0aCkge1xuICAgIGxldCBtaW5lQ3VycmVudCA9IG1pbmUuaHVua3NbbWluZUluZGV4XSB8fCB7b2xkU3RhcnQ6IEluZmluaXR5fSxcbiAgICAgICAgdGhlaXJzQ3VycmVudCA9IHRoZWlycy5odW5rc1t0aGVpcnNJbmRleF0gfHwge29sZFN0YXJ0OiBJbmZpbml0eX07XG5cbiAgICBpZiAoaHVua0JlZm9yZShtaW5lQ3VycmVudCwgdGhlaXJzQ3VycmVudCkpIHtcbiAgICAgIC8vIFRoaXMgcGF0Y2ggZG9lcyBub3Qgb3ZlcmxhcCB3aXRoIGFueSBvZiB0aGUgb3RoZXJzLCB5YXkuXG4gICAgICByZXQuaHVua3MucHVzaChjbG9uZUh1bmsobWluZUN1cnJlbnQsIG1pbmVPZmZzZXQpKTtcbiAgICAgIG1pbmVJbmRleCsrO1xuICAgICAgdGhlaXJzT2Zmc2V0ICs9IG1pbmVDdXJyZW50Lm5ld0xpbmVzIC0gbWluZUN1cnJlbnQub2xkTGluZXM7XG4gICAgfSBlbHNlIGlmIChodW5rQmVmb3JlKHRoZWlyc0N1cnJlbnQsIG1pbmVDdXJyZW50KSkge1xuICAgICAgLy8gVGhpcyBwYXRjaCBkb2VzIG5vdCBvdmVybGFwIHdpdGggYW55IG9mIHRoZSBvdGhlcnMsIHlheS5cbiAgICAgIHJldC5odW5rcy5wdXNoKGNsb25lSHVuayh0aGVpcnNDdXJyZW50LCB0aGVpcnNPZmZzZXQpKTtcbiAgICAgIHRoZWlyc0luZGV4Kys7XG4gICAgICBtaW5lT2Zmc2V0ICs9IHRoZWlyc0N1cnJlbnQubmV3TGluZXMgLSB0aGVpcnNDdXJyZW50Lm9sZExpbmVzO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBPdmVybGFwLCBtZXJnZSBhcyBiZXN0IHdlIGNhblxuICAgICAgbGV0IG1lcmdlZEh1bmsgPSB7XG4gICAgICAgIG9sZFN0YXJ0OiBNYXRoLm1pbihtaW5lQ3VycmVudC5vbGRTdGFydCwgdGhlaXJzQ3VycmVudC5vbGRTdGFydCksXG4gICAgICAgIG9sZExpbmVzOiAwLFxuICAgICAgICBuZXdTdGFydDogTWF0aC5taW4obWluZUN1cnJlbnQubmV3U3RhcnQgKyBtaW5lT2Zmc2V0LCB0aGVpcnNDdXJyZW50Lm9sZFN0YXJ0ICsgdGhlaXJzT2Zmc2V0KSxcbiAgICAgICAgbmV3TGluZXM6IDAsXG4gICAgICAgIGxpbmVzOiBbXVxuICAgICAgfTtcbiAgICAgIG1lcmdlTGluZXMobWVyZ2VkSHVuaywgbWluZUN1cnJlbnQub2xkU3RhcnQsIG1pbmVDdXJyZW50LmxpbmVzLCB0aGVpcnNDdXJyZW50Lm9sZFN0YXJ0LCB0aGVpcnNDdXJyZW50LmxpbmVzKTtcbiAgICAgIHRoZWlyc0luZGV4Kys7XG4gICAgICBtaW5lSW5kZXgrKztcblxuICAgICAgcmV0Lmh1bmtzLnB1c2gobWVyZ2VkSHVuayk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJldDtcbn1cblxuZnVuY3Rpb24gbG9hZFBhdGNoKHBhcmFtLCBiYXNlKSB7XG4gIGlmICh0eXBlb2YgcGFyYW0gPT09ICdzdHJpbmcnKSB7XG4gICAgaWYgKC9eQEAvbS50ZXN0KHBhcmFtKSB8fCAoL15JbmRleDovbS50ZXN0KHBhcmFtKSkpIHtcbiAgICAgIHJldHVybiBwYXJzZVBhdGNoKHBhcmFtKVswXTtcbiAgICB9XG5cbiAgICBpZiAoIWJhc2UpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTXVzdCBwcm92aWRlIGEgYmFzZSByZWZlcmVuY2Ugb3IgcGFzcyBpbiBhIHBhdGNoJyk7XG4gICAgfVxuICAgIHJldHVybiBzdHJ1Y3R1cmVkUGF0Y2godW5kZWZpbmVkLCB1bmRlZmluZWQsIGJhc2UsIHBhcmFtKTtcbiAgfVxuXG4gIHJldHVybiBwYXJhbTtcbn1cblxuZnVuY3Rpb24gZmlsZU5hbWVDaGFuZ2VkKHBhdGNoKSB7XG4gIHJldHVybiBwYXRjaC5uZXdGaWxlTmFtZSAmJiBwYXRjaC5uZXdGaWxlTmFtZSAhPT0gcGF0Y2gub2xkRmlsZU5hbWU7XG59XG5cbmZ1bmN0aW9uIHNlbGVjdEZpZWxkKGluZGV4LCBtaW5lLCB0aGVpcnMpIHtcbiAgaWYgKG1pbmUgPT09IHRoZWlycykge1xuICAgIHJldHVybiBtaW5lO1xuICB9IGVsc2Uge1xuICAgIGluZGV4LmNvbmZsaWN0ID0gdHJ1ZTtcbiAgICByZXR1cm4ge21pbmUsIHRoZWlyc307XG4gIH1cbn1cblxuZnVuY3Rpb24gaHVua0JlZm9yZSh0ZXN0LCBjaGVjaykge1xuICByZXR1cm4gdGVzdC5vbGRTdGFydCA8IGNoZWNrLm9sZFN0YXJ0XG4gICAgJiYgKHRlc3Qub2xkU3RhcnQgKyB0ZXN0Lm9sZExpbmVzKSA8IGNoZWNrLm9sZFN0YXJ0O1xufVxuXG5mdW5jdGlvbiBjbG9uZUh1bmsoaHVuaywgb2Zmc2V0KSB7XG4gIHJldHVybiB7XG4gICAgb2xkU3RhcnQ6IGh1bmsub2xkU3RhcnQsIG9sZExpbmVzOiBodW5rLm9sZExpbmVzLFxuICAgIG5ld1N0YXJ0OiBodW5rLm5ld1N0YXJ0ICsgb2Zmc2V0LCBuZXdMaW5lczogaHVuay5uZXdMaW5lcyxcbiAgICBsaW5lczogaHVuay5saW5lc1xuICB9O1xufVxuXG5mdW5jdGlvbiBtZXJnZUxpbmVzKGh1bmssIG1pbmVPZmZzZXQsIG1pbmVMaW5lcywgdGhlaXJPZmZzZXQsIHRoZWlyTGluZXMpIHtcbiAgLy8gVGhpcyB3aWxsIGdlbmVyYWxseSByZXN1bHQgaW4gYSBjb25mbGljdGVkIGh1bmssIGJ1dCB0aGVyZSBhcmUgY2FzZXMgd2hlcmUgdGhlIGNvbnRleHRcbiAgLy8gaXMgdGhlIG9ubHkgb3ZlcmxhcCB3aGVyZSB3ZSBjYW4gc3VjY2Vzc2Z1bGx5IG1lcmdlIHRoZSBjb250ZW50IGhlcmUuXG4gIGxldCBtaW5lID0ge29mZnNldDogbWluZU9mZnNldCwgbGluZXM6IG1pbmVMaW5lcywgaW5kZXg6IDB9LFxuICAgICAgdGhlaXIgPSB7b2Zmc2V0OiB0aGVpck9mZnNldCwgbGluZXM6IHRoZWlyTGluZXMsIGluZGV4OiAwfTtcblxuICAvLyBIYW5kbGUgYW55IGxlYWRpbmcgY29udGVudFxuICBpbnNlcnRMZWFkaW5nKGh1bmssIG1pbmUsIHRoZWlyKTtcbiAgaW5zZXJ0TGVhZGluZyhodW5rLCB0aGVpciwgbWluZSk7XG5cbiAgLy8gTm93IGluIHRoZSBvdmVybGFwIGNvbnRlbnQuIFNjYW4gdGhyb3VnaCBhbmQgc2VsZWN0IHRoZSBiZXN0IGNoYW5nZXMgZnJvbSBlYWNoLlxuICB3aGlsZSAobWluZS5pbmRleCA8IG1pbmUubGluZXMubGVuZ3RoICYmIHRoZWlyLmluZGV4IDwgdGhlaXIubGluZXMubGVuZ3RoKSB7XG4gICAgbGV0IG1pbmVDdXJyZW50ID0gbWluZS5saW5lc1ttaW5lLmluZGV4XSxcbiAgICAgICAgdGhlaXJDdXJyZW50ID0gdGhlaXIubGluZXNbdGhlaXIuaW5kZXhdO1xuXG4gICAgaWYgKChtaW5lQ3VycmVudFswXSA9PT0gJy0nIHx8IG1pbmVDdXJyZW50WzBdID09PSAnKycpXG4gICAgICAgICYmICh0aGVpckN1cnJlbnRbMF0gPT09ICctJyB8fCB0aGVpckN1cnJlbnRbMF0gPT09ICcrJykpIHtcbiAgICAgIC8vIEJvdGggbW9kaWZpZWQgLi4uXG4gICAgICBtdXR1YWxDaGFuZ2UoaHVuaywgbWluZSwgdGhlaXIpO1xuICAgIH0gZWxzZSBpZiAobWluZUN1cnJlbnRbMF0gPT09ICcrJyAmJiB0aGVpckN1cnJlbnRbMF0gPT09ICcgJykge1xuICAgICAgLy8gTWluZSBpbnNlcnRlZFxuICAgICAgaHVuay5saW5lcy5wdXNoKC4uLiBjb2xsZWN0Q2hhbmdlKG1pbmUpKTtcbiAgICB9IGVsc2UgaWYgKHRoZWlyQ3VycmVudFswXSA9PT0gJysnICYmIG1pbmVDdXJyZW50WzBdID09PSAnICcpIHtcbiAgICAgIC8vIFRoZWlycyBpbnNlcnRlZFxuICAgICAgaHVuay5saW5lcy5wdXNoKC4uLiBjb2xsZWN0Q2hhbmdlKHRoZWlyKSk7XG4gICAgfSBlbHNlIGlmIChtaW5lQ3VycmVudFswXSA9PT0gJy0nICYmIHRoZWlyQ3VycmVudFswXSA9PT0gJyAnKSB7XG4gICAgICAvLyBNaW5lIHJlbW92ZWQgb3IgZWRpdGVkXG4gICAgICByZW1vdmFsKGh1bmssIG1pbmUsIHRoZWlyKTtcbiAgICB9IGVsc2UgaWYgKHRoZWlyQ3VycmVudFswXSA9PT0gJy0nICYmIG1pbmVDdXJyZW50WzBdID09PSAnICcpIHtcbiAgICAgIC8vIFRoZWlyIHJlbW92ZWQgb3IgZWRpdGVkXG4gICAgICByZW1vdmFsKGh1bmssIHRoZWlyLCBtaW5lLCB0cnVlKTtcbiAgICB9IGVsc2UgaWYgKG1pbmVDdXJyZW50ID09PSB0aGVpckN1cnJlbnQpIHtcbiAgICAgIC8vIENvbnRleHQgaWRlbnRpdHlcbiAgICAgIGh1bmsubGluZXMucHVzaChtaW5lQ3VycmVudCk7XG4gICAgICBtaW5lLmluZGV4Kys7XG4gICAgICB0aGVpci5pbmRleCsrO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBDb250ZXh0IG1pc21hdGNoXG4gICAgICBjb25mbGljdChodW5rLCBjb2xsZWN0Q2hhbmdlKG1pbmUpLCBjb2xsZWN0Q2hhbmdlKHRoZWlyKSk7XG4gICAgfVxuICB9XG5cbiAgLy8gTm93IHB1c2ggYW55dGhpbmcgdGhhdCBtYXkgYmUgcmVtYWluaW5nXG4gIGluc2VydFRyYWlsaW5nKGh1bmssIG1pbmUpO1xuICBpbnNlcnRUcmFpbGluZyhodW5rLCB0aGVpcik7XG5cbiAgY2FsY0xpbmVDb3VudChodW5rKTtcbn1cblxuZnVuY3Rpb24gbXV0dWFsQ2hhbmdlKGh1bmssIG1pbmUsIHRoZWlyKSB7XG4gIGxldCBteUNoYW5nZXMgPSBjb2xsZWN0Q2hhbmdlKG1pbmUpLFxuICAgICAgdGhlaXJDaGFuZ2VzID0gY29sbGVjdENoYW5nZSh0aGVpcik7XG5cbiAgaWYgKGFsbFJlbW92ZXMobXlDaGFuZ2VzKSAmJiBhbGxSZW1vdmVzKHRoZWlyQ2hhbmdlcykpIHtcbiAgICAvLyBTcGVjaWFsIGNhc2UgZm9yIHJlbW92ZSBjaGFuZ2VzIHRoYXQgYXJlIHN1cGVyc2V0cyBvZiBvbmUgYW5vdGhlclxuICAgIGlmIChhcnJheVN0YXJ0c1dpdGgobXlDaGFuZ2VzLCB0aGVpckNoYW5nZXMpXG4gICAgICAgICYmIHNraXBSZW1vdmVTdXBlcnNldCh0aGVpciwgbXlDaGFuZ2VzLCBteUNoYW5nZXMubGVuZ3RoIC0gdGhlaXJDaGFuZ2VzLmxlbmd0aCkpIHtcbiAgICAgIGh1bmsubGluZXMucHVzaCguLi4gbXlDaGFuZ2VzKTtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKGFycmF5U3RhcnRzV2l0aCh0aGVpckNoYW5nZXMsIG15Q2hhbmdlcylcbiAgICAgICAgJiYgc2tpcFJlbW92ZVN1cGVyc2V0KG1pbmUsIHRoZWlyQ2hhbmdlcywgdGhlaXJDaGFuZ2VzLmxlbmd0aCAtIG15Q2hhbmdlcy5sZW5ndGgpKSB7XG4gICAgICBodW5rLmxpbmVzLnB1c2goLi4uIHRoZWlyQ2hhbmdlcyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9IGVsc2UgaWYgKGFycmF5RXF1YWwobXlDaGFuZ2VzLCB0aGVpckNoYW5nZXMpKSB7XG4gICAgaHVuay5saW5lcy5wdXNoKC4uLiBteUNoYW5nZXMpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbmZsaWN0KGh1bmssIG15Q2hhbmdlcywgdGhlaXJDaGFuZ2VzKTtcbn1cblxuZnVuY3Rpb24gcmVtb3ZhbChodW5rLCBtaW5lLCB0aGVpciwgc3dhcCkge1xuICBsZXQgbXlDaGFuZ2VzID0gY29sbGVjdENoYW5nZShtaW5lKSxcbiAgICAgIHRoZWlyQ2hhbmdlcyA9IGNvbGxlY3RDb250ZXh0KHRoZWlyLCBteUNoYW5nZXMpO1xuICBpZiAodGhlaXJDaGFuZ2VzLm1lcmdlZCkge1xuICAgIGh1bmsubGluZXMucHVzaCguLi4gdGhlaXJDaGFuZ2VzLm1lcmdlZCk7XG4gIH0gZWxzZSB7XG4gICAgY29uZmxpY3QoaHVuaywgc3dhcCA/IHRoZWlyQ2hhbmdlcyA6IG15Q2hhbmdlcywgc3dhcCA/IG15Q2hhbmdlcyA6IHRoZWlyQ2hhbmdlcyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY29uZmxpY3QoaHVuaywgbWluZSwgdGhlaXIpIHtcbiAgaHVuay5jb25mbGljdCA9IHRydWU7XG4gIGh1bmsubGluZXMucHVzaCh7XG4gICAgY29uZmxpY3Q6IHRydWUsXG4gICAgbWluZTogbWluZSxcbiAgICB0aGVpcnM6IHRoZWlyXG4gIH0pO1xufVxuXG5mdW5jdGlvbiBpbnNlcnRMZWFkaW5nKGh1bmssIGluc2VydCwgdGhlaXIpIHtcbiAgd2hpbGUgKGluc2VydC5vZmZzZXQgPCB0aGVpci5vZmZzZXQgJiYgaW5zZXJ0LmluZGV4IDwgaW5zZXJ0LmxpbmVzLmxlbmd0aCkge1xuICAgIGxldCBsaW5lID0gaW5zZXJ0LmxpbmVzW2luc2VydC5pbmRleCsrXTtcbiAgICBodW5rLmxpbmVzLnB1c2gobGluZSk7XG4gICAgaW5zZXJ0Lm9mZnNldCsrO1xuICB9XG59XG5mdW5jdGlvbiBpbnNlcnRUcmFpbGluZyhodW5rLCBpbnNlcnQpIHtcbiAgd2hpbGUgKGluc2VydC5pbmRleCA8IGluc2VydC5saW5lcy5sZW5ndGgpIHtcbiAgICBsZXQgbGluZSA9IGluc2VydC5saW5lc1tpbnNlcnQuaW5kZXgrK107XG4gICAgaHVuay5saW5lcy5wdXNoKGxpbmUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNvbGxlY3RDaGFuZ2Uoc3RhdGUpIHtcbiAgbGV0IHJldCA9IFtdLFxuICAgICAgb3BlcmF0aW9uID0gc3RhdGUubGluZXNbc3RhdGUuaW5kZXhdWzBdO1xuICB3aGlsZSAoc3RhdGUuaW5kZXggPCBzdGF0ZS5saW5lcy5sZW5ndGgpIHtcbiAgICBsZXQgbGluZSA9IHN0YXRlLmxpbmVzW3N0YXRlLmluZGV4XTtcblxuICAgIC8vIEdyb3VwIGFkZGl0aW9ucyB0aGF0IGFyZSBpbW1lZGlhdGVseSBhZnRlciBzdWJ0cmFjdGlvbnMgYW5kIHRyZWF0IHRoZW0gYXMgb25lIFwiYXRvbWljXCIgbW9kaWZ5IGNoYW5nZS5cbiAgICBpZiAob3BlcmF0aW9uID09PSAnLScgJiYgbGluZVswXSA9PT0gJysnKSB7XG4gICAgICBvcGVyYXRpb24gPSAnKyc7XG4gICAgfVxuXG4gICAgaWYgKG9wZXJhdGlvbiA9PT0gbGluZVswXSkge1xuICAgICAgcmV0LnB1c2gobGluZSk7XG4gICAgICBzdGF0ZS5pbmRleCsrO1xuICAgIH0gZWxzZSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmV0O1xufVxuZnVuY3Rpb24gY29sbGVjdENvbnRleHQoc3RhdGUsIG1hdGNoQ2hhbmdlcykge1xuICBsZXQgY2hhbmdlcyA9IFtdLFxuICAgICAgbWVyZ2VkID0gW10sXG4gICAgICBtYXRjaEluZGV4ID0gMCxcbiAgICAgIGNvbnRleHRDaGFuZ2VzID0gZmFsc2UsXG4gICAgICBjb25mbGljdGVkID0gZmFsc2U7XG4gIHdoaWxlIChtYXRjaEluZGV4IDwgbWF0Y2hDaGFuZ2VzLmxlbmd0aFxuICAgICAgICAmJiBzdGF0ZS5pbmRleCA8IHN0YXRlLmxpbmVzLmxlbmd0aCkge1xuICAgIGxldCBjaGFuZ2UgPSBzdGF0ZS5saW5lc1tzdGF0ZS5pbmRleF0sXG4gICAgICAgIG1hdGNoID0gbWF0Y2hDaGFuZ2VzW21hdGNoSW5kZXhdO1xuXG4gICAgLy8gT25jZSB3ZSd2ZSBoaXQgb3VyIGFkZCwgdGhlbiB3ZSBhcmUgZG9uZVxuICAgIGlmIChtYXRjaFswXSA9PT0gJysnKSB7XG4gICAgICBicmVhaztcbiAgICB9XG5cbiAgICBjb250ZXh0Q2hhbmdlcyA9IGNvbnRleHRDaGFuZ2VzIHx8IGNoYW5nZVswXSAhPT0gJyAnO1xuXG4gICAgbWVyZ2VkLnB1c2gobWF0Y2gpO1xuICAgIG1hdGNoSW5kZXgrKztcblxuICAgIC8vIENvbnN1bWUgYW55IGFkZGl0aW9ucyBpbiB0aGUgb3RoZXIgYmxvY2sgYXMgYSBjb25mbGljdCB0byBhdHRlbXB0XG4gICAgLy8gdG8gcHVsbCBpbiB0aGUgcmVtYWluaW5nIGNvbnRleHQgYWZ0ZXIgdGhpc1xuICAgIGlmIChjaGFuZ2VbMF0gPT09ICcrJykge1xuICAgICAgY29uZmxpY3RlZCA9IHRydWU7XG5cbiAgICAgIHdoaWxlIChjaGFuZ2VbMF0gPT09ICcrJykge1xuICAgICAgICBjaGFuZ2VzLnB1c2goY2hhbmdlKTtcbiAgICAgICAgY2hhbmdlID0gc3RhdGUubGluZXNbKytzdGF0ZS5pbmRleF07XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG1hdGNoLnN1YnN0cigxKSA9PT0gY2hhbmdlLnN1YnN0cigxKSkge1xuICAgICAgY2hhbmdlcy5wdXNoKGNoYW5nZSk7XG4gICAgICBzdGF0ZS5pbmRleCsrO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25mbGljdGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBpZiAoKG1hdGNoQ2hhbmdlc1ttYXRjaEluZGV4XSB8fCAnJylbMF0gPT09ICcrJ1xuICAgICAgJiYgY29udGV4dENoYW5nZXMpIHtcbiAgICBjb25mbGljdGVkID0gdHJ1ZTtcbiAgfVxuXG4gIGlmIChjb25mbGljdGVkKSB7XG4gICAgcmV0dXJuIGNoYW5nZXM7XG4gIH1cblxuICB3aGlsZSAobWF0Y2hJbmRleCA8IG1hdGNoQ2hhbmdlcy5sZW5ndGgpIHtcbiAgICBtZXJnZWQucHVzaChtYXRjaENoYW5nZXNbbWF0Y2hJbmRleCsrXSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIG1lcmdlZCxcbiAgICBjaGFuZ2VzXG4gIH07XG59XG5cbmZ1bmN0aW9uIGFsbFJlbW92ZXMoY2hhbmdlcykge1xuICByZXR1cm4gY2hhbmdlcy5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgY2hhbmdlKSB7XG4gICAgcmV0dXJuIHByZXYgJiYgY2hhbmdlWzBdID09PSAnLSc7XG4gIH0sIHRydWUpO1xufVxuZnVuY3Rpb24gc2tpcFJlbW92ZVN1cGVyc2V0KHN0YXRlLCByZW1vdmVDaGFuZ2VzLCBkZWx0YSkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGRlbHRhOyBpKyspIHtcbiAgICBsZXQgY2hhbmdlQ29udGVudCA9IHJlbW92ZUNoYW5nZXNbcmVtb3ZlQ2hhbmdlcy5sZW5ndGggLSBkZWx0YSArIGldLnN1YnN0cigxKTtcbiAgICBpZiAoc3RhdGUubGluZXNbc3RhdGUuaW5kZXggKyBpXSAhPT0gJyAnICsgY2hhbmdlQ29udGVudCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHN0YXRlLmluZGV4ICs9IGRlbHRhO1xuICByZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gY2FsY09sZE5ld0xpbmVDb3VudChsaW5lcykge1xuICBsZXQgb2xkTGluZXMgPSAwO1xuICBsZXQgbmV3TGluZXMgPSAwO1xuXG4gIGxpbmVzLmZvckVhY2goZnVuY3Rpb24obGluZSkge1xuICAgIGlmICh0eXBlb2YgbGluZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIGxldCBteUNvdW50ID0gY2FsY09sZE5ld0xpbmVDb3VudChsaW5lLm1pbmUpO1xuICAgICAgbGV0IHRoZWlyQ291bnQgPSBjYWxjT2xkTmV3TGluZUNvdW50KGxpbmUudGhlaXJzKTtcblxuICAgICAgaWYgKG9sZExpbmVzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKG15Q291bnQub2xkTGluZXMgPT09IHRoZWlyQ291bnQub2xkTGluZXMpIHtcbiAgICAgICAgICBvbGRMaW5lcyArPSBteUNvdW50Lm9sZExpbmVzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9sZExpbmVzID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChuZXdMaW5lcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmIChteUNvdW50Lm5ld0xpbmVzID09PSB0aGVpckNvdW50Lm5ld0xpbmVzKSB7XG4gICAgICAgICAgbmV3TGluZXMgKz0gbXlDb3VudC5uZXdMaW5lcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdMaW5lcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAobmV3TGluZXMgIT09IHVuZGVmaW5lZCAmJiAobGluZVswXSA9PT0gJysnIHx8IGxpbmVbMF0gPT09ICcgJykpIHtcbiAgICAgICAgbmV3TGluZXMrKztcbiAgICAgIH1cbiAgICAgIGlmIChvbGRMaW5lcyAhPT0gdW5kZWZpbmVkICYmIChsaW5lWzBdID09PSAnLScgfHwgbGluZVswXSA9PT0gJyAnKSkge1xuICAgICAgICBvbGRMaW5lcysrO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHtvbGRMaW5lcywgbmV3TGluZXN9O1xufVxuIl19\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/structuredPatch = structuredPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/createTwoFilesPatch = createTwoFilesPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/createPatch = createPatch;\n\n\tvar /*istanbul ignore start*/_line = __webpack_require__(5) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n\t/*istanbul ignore end*/function structuredPatch(oldFileName, newFileName, oldStr, newStr, oldHeader, newHeader, options) {\n\t  if (!options) {\n\t    options = {};\n\t  }\n\t  if (typeof options.context === 'undefined') {\n\t    options.context = 4;\n\t  }\n\n\t  var diff = /*istanbul ignore start*/(0, _line.diffLines) /*istanbul ignore end*/(oldStr, newStr, options);\n\t  diff.push({ value: '', lines: [] }); // Append an empty value to make cleanup easier\n\n\t  function contextLines(lines) {\n\t    return lines.map(function (entry) {\n\t      return ' ' + entry;\n\t    });\n\t  }\n\n\t  var hunks = [];\n\t  var oldRangeStart = 0,\n\t      newRangeStart = 0,\n\t      curRange = [],\n\t      oldLine = 1,\n\t      newLine = 1;\n\n\t  /*istanbul ignore start*/var _loop = function _loop( /*istanbul ignore end*/i) {\n\t    var current = diff[i],\n\t        lines = current.lines || current.value.replace(/\\n$/, '').split('\\n');\n\t    current.lines = lines;\n\n\t    if (current.added || current.removed) {\n\t      /*istanbul ignore start*/var _curRange;\n\n\t      /*istanbul ignore end*/ // If we have previous context, start with that\n\t      if (!oldRangeStart) {\n\t        var prev = diff[i - 1];\n\t        oldRangeStart = oldLine;\n\t        newRangeStart = newLine;\n\n\t        if (prev) {\n\t          curRange = options.context > 0 ? contextLines(prev.lines.slice(-options.context)) : [];\n\t          oldRangeStart -= curRange.length;\n\t          newRangeStart -= curRange.length;\n\t        }\n\t      }\n\n\t      // Output our changes\n\t      /*istanbul ignore start*/(_curRange = /*istanbul ignore end*/curRange).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_curRange /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/lines.map(function (entry) {\n\t        return (current.added ? '+' : '-') + entry;\n\t      })));\n\n\t      // Track the updated file position\n\t      if (current.added) {\n\t        newLine += lines.length;\n\t      } else {\n\t        oldLine += lines.length;\n\t      }\n\t    } else {\n\t      // Identical context lines. Track line changes\n\t      if (oldRangeStart) {\n\t        // Close out any changes that have been output (or join overlapping)\n\t        if (lines.length <= options.context * 2 && i < diff.length - 2) {\n\t          /*istanbul ignore start*/var _curRange2;\n\n\t          /*istanbul ignore end*/ // Overlapping\n\t          /*istanbul ignore start*/(_curRange2 = /*istanbul ignore end*/curRange).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_curRange2 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/contextLines(lines)));\n\t        } else {\n\t          /*istanbul ignore start*/var _curRange3;\n\n\t          /*istanbul ignore end*/ // end the range and output\n\t          var contextSize = Math.min(lines.length, options.context);\n\t          /*istanbul ignore start*/(_curRange3 = /*istanbul ignore end*/curRange).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_curRange3 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/contextLines(lines.slice(0, contextSize))));\n\n\t          var hunk = {\n\t            oldStart: oldRangeStart,\n\t            oldLines: oldLine - oldRangeStart + contextSize,\n\t            newStart: newRangeStart,\n\t            newLines: newLine - newRangeStart + contextSize,\n\t            lines: curRange\n\t          };\n\t          if (i >= diff.length - 2 && lines.length <= options.context) {\n\t            // EOF is inside this hunk\n\t            var oldEOFNewline = /\\n$/.test(oldStr);\n\t            var newEOFNewline = /\\n$/.test(newStr);\n\t            if (lines.length == 0 && !oldEOFNewline) {\n\t              // special case: old has no eol and no trailing context; no-nl can end up before adds\n\t              curRange.splice(hunk.oldLines, 0, '\\\\ No newline at end of file');\n\t            } else if (!oldEOFNewline || !newEOFNewline) {\n\t              curRange.push('\\\\ No newline at end of file');\n\t            }\n\t          }\n\t          hunks.push(hunk);\n\n\t          oldRangeStart = 0;\n\t          newRangeStart = 0;\n\t          curRange = [];\n\t        }\n\t      }\n\t      oldLine += lines.length;\n\t      newLine += lines.length;\n\t    }\n\t  };\n\n\t  for (var i = 0; i < diff.length; i++) {\n\t    /*istanbul ignore start*/_loop( /*istanbul ignore end*/i);\n\t  }\n\n\t  return {\n\t    oldFileName: oldFileName, newFileName: newFileName,\n\t    oldHeader: oldHeader, newHeader: newHeader,\n\t    hunks: hunks\n\t  };\n\t}\n\n\tfunction createTwoFilesPatch(oldFileName, newFileName, oldStr, newStr, oldHeader, newHeader, options) {\n\t  var diff = structuredPatch(oldFileName, newFileName, oldStr, newStr, oldHeader, newHeader, options);\n\n\t  var ret = [];\n\t  if (oldFileName == newFileName) {\n\t    ret.push('Index: ' + oldFileName);\n\t  }\n\t  ret.push('===================================================================');\n\t  ret.push('--- ' + diff.oldFileName + (typeof diff.oldHeader === 'undefined' ? '' : '\\t' + diff.oldHeader));\n\t  ret.push('+++ ' + diff.newFileName + (typeof diff.newHeader === 'undefined' ? '' : '\\t' + diff.newHeader));\n\n\t  for (var i = 0; i < diff.hunks.length; i++) {\n\t    var hunk = diff.hunks[i];\n\t    ret.push('@@ -' + hunk.oldStart + ',' + hunk.oldLines + ' +' + hunk.newStart + ',' + hunk.newLines + ' @@');\n\t    ret.push.apply(ret, hunk.lines);\n\t  }\n\n\t  return ret.join('\\n') + '\\n';\n\t}\n\n\tfunction createPatch(fileName, oldStr, newStr, oldHeader, newHeader, options) {\n\t  return createTwoFilesPatch(fileName, fileName, oldStr, newStr, oldHeader, newHeader, options);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYXRjaC9jcmVhdGUuanMiXSwibmFtZXMiOlsic3RydWN0dXJlZFBhdGNoIiwiY3JlYXRlVHdvRmlsZXNQYXRjaCIsImNyZWF0ZVBhdGNoIiwib2xkRmlsZU5hbWUiLCJuZXdGaWxlTmFtZSIsIm9sZFN0ciIsIm5ld1N0ciIsIm9sZEhlYWRlciIsIm5ld0hlYWRlciIsIm9wdGlvbnMiLCJjb250ZXh0IiwiZGlmZiIsInB1c2giLCJ2YWx1ZSIsImxpbmVzIiwiY29udGV4dExpbmVzIiwibWFwIiwiZW50cnkiLCJodW5rcyIsIm9sZFJhbmdlU3RhcnQiLCJuZXdSYW5nZVN0YXJ0IiwiY3VyUmFuZ2UiLCJvbGRMaW5lIiwibmV3TGluZSIsImkiLCJjdXJyZW50IiwicmVwbGFjZSIsInNwbGl0IiwiYWRkZWQiLCJyZW1vdmVkIiwicHJldiIsInNsaWNlIiwibGVuZ3RoIiwiY29udGV4dFNpemUiLCJNYXRoIiwibWluIiwiaHVuayIsIm9sZFN0YXJ0Iiwib2xkTGluZXMiLCJuZXdTdGFydCIsIm5ld0xpbmVzIiwib2xkRU9GTmV3bGluZSIsInRlc3QiLCJuZXdFT0ZOZXdsaW5lIiwic3BsaWNlIiwicmV0IiwiYXBwbHkiLCJqb2luIiwiZmlsZU5hbWUiXSwibWFwcGluZ3MiOiI7OztnQ0FFZ0JBLGUsR0FBQUEsZTt5REFpR0FDLG1CLEdBQUFBLG1CO3lEQXdCQUMsVyxHQUFBQSxXOztBQTNIaEI7Ozs7dUJBRU8sU0FBU0YsZUFBVCxDQUF5QkcsV0FBekIsRUFBc0NDLFdBQXRDLEVBQW1EQyxNQUFuRCxFQUEyREMsTUFBM0QsRUFBbUVDLFNBQW5FLEVBQThFQyxTQUE5RSxFQUF5RkMsT0FBekYsRUFBa0c7QUFDdkcsTUFBSSxDQUFDQSxPQUFMLEVBQWM7QUFDWkEsY0FBVSxFQUFWO0FBQ0Q7QUFDRCxNQUFJLE9BQU9BLFFBQVFDLE9BQWYsS0FBMkIsV0FBL0IsRUFBNEM7QUFDMUNELFlBQVFDLE9BQVIsR0FBa0IsQ0FBbEI7QUFDRDs7QUFFRCxN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QUEvQyxFQUEwREMsU0FBMUQsRUFBcUVDLE9BQXJFLEVBQThFO0FBQ25GLFNBQU9SLG9CQUFvQitDLFFBQXBCLEVBQThCQSxRQUE5QixFQUF3QzNDLE1BQXhDLEVBQWdEQyxNQUFoRCxFQUF3REMsU0FBeEQsRUFBbUVDLFNBQW5FLEVBQThFQyxPQUE5RSxDQUFQO0FBQ0QiLCJmaWxlIjoiY3JlYXRlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtkaWZmTGluZXN9IGZyb20gJy4uL2RpZmYvbGluZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBzdHJ1Y3R1cmVkUGF0Y2gob2xkRmlsZU5hbWUsIG5ld0ZpbGVOYW1lLCBvbGRTdHIsIG5ld1N0ciwgb2xkSGVhZGVyLCBuZXdIZWFkZXIsIG9wdGlvbnMpIHtcbiAgaWYgKCFvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IHt9O1xuICB9XG4gIGlmICh0eXBlb2Ygb3B0aW9ucy5jb250ZXh0ID09PSAndW5kZWZpbmVkJykge1xuICAgIG9wdGlvbnMuY29udGV4dCA9IDQ7XG4gIH1cblxuICBjb25zdCBkaWZmID0gZGlmZkxpbmVzKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKTtcbiAgZGlmZi5wdXNoKHt2YWx1ZTogJycsIGxpbmVzOiBbXX0pOyAgIC8vIEFwcGVuZCBhbiBlbXB0eSB2YWx1ZSB0byBtYWtlIGNsZWFudXAgZWFzaWVyXG5cbiAgZnVuY3Rpb24gY29udGV4dExpbmVzKGxpbmVzKSB7XG4gICAgcmV0dXJuIGxpbmVzLm1hcChmdW5jdGlvbihlbnRyeSkgeyByZXR1cm4gJyAnICsgZW50cnk7IH0pO1xuICB9XG5cbiAgbGV0IGh1bmtzID0gW107XG4gIGxldCBvbGRSYW5nZVN0YXJ0ID0gMCwgbmV3UmFuZ2VTdGFydCA9IDAsIGN1clJhbmdlID0gW10sXG4gICAgICBvbGRMaW5lID0gMSwgbmV3TGluZSA9IDE7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgZGlmZi5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGN1cnJlbnQgPSBkaWZmW2ldLFxuICAgICAgICAgIGxpbmVzID0gY3VycmVudC5saW5lcyB8fCBjdXJyZW50LnZhbHVlLnJlcGxhY2UoL1xcbiQvLCAnJykuc3BsaXQoJ1xcbicpO1xuICAgIGN1cnJlbnQubGluZXMgPSBsaW5lcztcblxuICAgIGlmIChjdXJyZW50LmFkZGVkIHx8IGN1cnJlbnQucmVtb3ZlZCkge1xuICAgICAgLy8gSWYgd2UgaGF2ZSBwcmV2aW91cyBjb250ZXh0LCBzdGFydCB3aXRoIHRoYXRcbiAgICAgIGlmICghb2xkUmFuZ2VTdGFydCkge1xuICAgICAgICBjb25zdCBwcmV2ID0gZGlmZltpIC0gMV07XG4gICAgICAgIG9sZFJhbmdlU3RhcnQgPSBvbGRMaW5lO1xuICAgICAgICBuZXdSYW5nZVN0YXJ0ID0gbmV3TGluZTtcblxuICAgICAgICBpZiAocHJldikge1xuICAgICAgICAgIGN1clJhbmdlID0gb3B0aW9ucy5jb250ZXh0ID4gMCA/IGNvbnRleHRMaW5lcyhwcmV2LmxpbmVzLnNsaWNlKC1vcHRpb25zLmNvbnRleHQpKSA6IFtdO1xuICAgICAgICAgIG9sZFJhbmdlU3RhcnQgLT0gY3VyUmFuZ2UubGVuZ3RoO1xuICAgICAgICAgIG5ld1JhbmdlU3RhcnQgLT0gY3VyUmFuZ2UubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIE91dHB1dCBvdXIgY2hhbmdlc1xuICAgICAgY3VyUmFuZ2UucHVzaCguLi4gbGluZXMubWFwKGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgIHJldHVybiAoY3VycmVudC5hZGRlZCA/ICcrJyA6ICctJykgKyBlbnRyeTtcbiAgICAgIH0pKTtcblxuICAgICAgLy8gVHJhY2sgdGhlIHVwZGF0ZWQgZmlsZSBwb3NpdGlvblxuICAgICAgaWYgKGN1cnJlbnQuYWRkZWQpIHtcbiAgICAgICAgbmV3TGluZSArPSBsaW5lcy5sZW5ndGg7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvbGRMaW5lICs9IGxpbmVzLmxlbmd0aDtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSWRlbnRpY2FsIGNvbnRleHQgbGluZXMuIFRyYWNrIGxpbmUgY2hhbmdlc1xuICAgICAgaWYgKG9sZFJhbmdlU3RhcnQpIHtcbiAgICAgICAgLy8gQ2xvc2Ugb3V0IGFueSBjaGFuZ2VzIHRoYXQgaGF2ZSBiZWVuIG91dHB1dCAob3Igam9pbiBvdmVybGFwcGluZylcbiAgICAgICAgaWYgKGxpbmVzLmxlbmd0aCA8PSBvcHRpb25zLmNvbnRleHQgKiAyICYmIGkgPCBkaWZmLmxlbmd0aCAtIDIpIHtcbiAgICAgICAgICAvLyBPdmVybGFwcGluZ1xuICAgICAgICAgIGN1clJhbmdlLnB1c2goLi4uIGNvbnRleHRMaW5lcyhsaW5lcykpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGVuZCB0aGUgcmFuZ2UgYW5kIG91dHB1dFxuICAgICAgICAgIGxldCBjb250ZXh0U2l6ZSA9IE1hdGgubWluKGxpbmVzLmxlbmd0aCwgb3B0aW9ucy5jb250ZXh0KTtcbiAgICAgICAgICBjdXJSYW5nZS5wdXNoKC4uLiBjb250ZXh0TGluZXMobGluZXMuc2xpY2UoMCwgY29udGV4dFNpemUpKSk7XG5cbiAgICAgICAgICBsZXQgaHVuayA9IHtcbiAgICAgICAgICAgIG9sZFN0YXJ0OiBvbGRSYW5nZVN0YXJ0LFxuICAgICAgICAgICAgb2xkTGluZXM6IChvbGRMaW5lIC0gb2xkUmFuZ2VTdGFydCArIGNvbnRleHRTaXplKSxcbiAgICAgICAgICAgIG5ld1N0YXJ0OiBuZXdSYW5nZVN0YXJ0LFxuICAgICAgICAgICAgbmV3TGluZXM6IChuZXdMaW5lIC0gbmV3UmFuZ2VTdGFydCArIGNvbnRleHRTaXplKSxcbiAgICAgICAgICAgIGxpbmVzOiBjdXJSYW5nZVxuICAgICAgICAgIH07XG4gICAgICAgICAgaWYgKGkgPj0gZGlmZi5sZW5ndGggLSAyICYmIGxpbmVzLmxlbmd0aCA8PSBvcHRpb25zLmNvbnRleHQpIHtcbiAgICAgICAgICAgIC8vIEVPRiBpcyBpbnNpZGUgdGhpcyBodW5rXG4gICAgICAgICAgICBsZXQgb2xkRU9GTmV3bGluZSA9ICgvXFxuJC8udGVzdChvbGRTdHIpKTtcbiAgICAgICAgICAgIGxldCBuZXdFT0ZOZXdsaW5lID0gKC9cXG4kLy50ZXN0KG5ld1N0cikpO1xuICAgICAgICAgICAgaWYgKGxpbmVzLmxlbmd0aCA9PSAwICYmICFvbGRFT0ZOZXdsaW5lKSB7XG4gICAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb2xkIGhhcyBubyBlb2wgYW5kIG5vIHRyYWlsaW5nIGNvbnRleHQ7IG5vLW5sIGNhbiBlbmQgdXAgYmVmb3JlIGFkZHNcbiAgICAgICAgICAgICAgY3VyUmFuZ2Uuc3BsaWNlKGh1bmsub2xkTGluZXMsIDAsICdcXFxcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZpbGUnKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIW9sZEVPRk5ld2xpbmUgfHwgIW5ld0VPRk5ld2xpbmUpIHtcbiAgICAgICAgICAgICAgY3VyUmFuZ2UucHVzaCgnXFxcXCBObyBuZXdsaW5lIGF0IGVuZCBvZiBmaWxlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGh1bmtzLnB1c2goaHVuayk7XG5cbiAgICAgICAgICBvbGRSYW5nZVN0YXJ0ID0gMDtcbiAgICAgICAgICBuZXdSYW5nZVN0YXJ0ID0gMDtcbiAgICAgICAgICBjdXJSYW5nZSA9IFtdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBvbGRMaW5lICs9IGxpbmVzLmxlbmd0aDtcbiAgICAgIG5ld0xpbmUgKz0gbGluZXMubGVuZ3RoO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgb2xkRmlsZU5hbWU6IG9sZEZpbGVOYW1lLCBuZXdGaWxlTmFtZTogbmV3RmlsZU5hbWUsXG4gICAgb2xkSGVhZGVyOiBvbGRIZWFkZXIsIG5ld0hlYWRlcjogbmV3SGVhZGVyLFxuICAgIGh1bmtzOiBodW5rc1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVHdvRmlsZXNQYXRjaChvbGRGaWxlTmFtZSwgbmV3RmlsZU5hbWUsIG9sZFN0ciwgbmV3U3RyLCBvbGRIZWFkZXIsIG5ld0hlYWRlciwgb3B0aW9ucykge1xuICBjb25zdCBkaWZmID0gc3RydWN0dXJlZFBhdGNoKG9sZEZpbGVOYW1lLCBuZXdGaWxlTmFtZSwgb2xkU3RyLCBuZXdTdHIsIG9sZEhlYWRlciwgbmV3SGVhZGVyLCBvcHRpb25zKTtcblxuICBjb25zdCByZXQgPSBbXTtcbiAgaWYgKG9sZEZpbGVOYW1lID09IG5ld0ZpbGVOYW1lKSB7XG4gICAgcmV0LnB1c2goJ0luZGV4OiAnICsgb2xkRmlsZU5hbWUpO1xuICB9XG4gIHJldC5wdXNoKCc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Jyk7XG4gIHJldC5wdXNoKCctLS0gJyArIGRpZmYub2xkRmlsZU5hbWUgKyAodHlwZW9mIGRpZmYub2xkSGVhZGVyID09PSAndW5kZWZpbmVkJyA/ICcnIDogJ1xcdCcgKyBkaWZmLm9sZEhlYWRlcikpO1xuICByZXQucHVzaCgnKysrICcgKyBkaWZmLm5ld0ZpbGVOYW1lICsgKHR5cGVvZiBkaWZmLm5ld0hlYWRlciA9PT0gJ3VuZGVmaW5lZCcgPyAnJyA6ICdcXHQnICsgZGlmZi5uZXdIZWFkZXIpKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGRpZmYuaHVua3MubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBodW5rID0gZGlmZi5odW5rc1tpXTtcbiAgICByZXQucHVzaChcbiAgICAgICdAQCAtJyArIGh1bmsub2xkU3RhcnQgKyAnLCcgKyBodW5rLm9sZExpbmVzXG4gICAgICArICcgKycgKyBodW5rLm5ld1N0YXJ0ICsgJywnICsgaHVuay5uZXdMaW5lc1xuICAgICAgKyAnIEBAJ1xuICAgICk7XG4gICAgcmV0LnB1c2guYXBwbHkocmV0LCBodW5rLmxpbmVzKTtcbiAgfVxuXG4gIHJldHVybiByZXQuam9pbignXFxuJykgKyAnXFxuJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhdGNoKGZpbGVOYW1lLCBvbGRTdHIsIG5ld1N0ciwgb2xkSGVhZGVyLCBuZXdIZWFkZXIsIG9wdGlvbnMpIHtcbiAgcmV0dXJuIGNyZWF0ZVR3b0ZpbGVzUGF0Y2goZmlsZU5hbWUsIGZpbGVOYW1lLCBvbGRTdHIsIG5ld1N0ciwgb2xkSGVhZGVyLCBuZXdIZWFkZXIsIG9wdGlvbnMpO1xufVxuIl19\n\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/\"use strict\";\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/arrayEqual = arrayEqual;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/arrayStartsWith = arrayStartsWith;\n\tfunction arrayEqual(a, b) {\n\t  if (a.length !== b.length) {\n\t    return false;\n\t  }\n\n\t  return arrayStartsWith(a, b);\n\t}\n\n\tfunction arrayStartsWith(array, start) {\n\t  if (start.length > array.length) {\n\t    return false;\n\t  }\n\n\t  for (var i = 0; i < start.length; i++) {\n\t    if (start[i] !== array[i]) {\n\t      return false;\n\t    }\n\t  }\n\n\t  return true;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL2FycmF5LmpzIl0sIm5hbWVzIjpbImFycmF5RXF1YWwiLCJhcnJheVN0YXJ0c1dpdGgiLCJhIiwiYiIsImxlbmd0aCIsImFycmF5Iiwic3RhcnQiLCJpIl0sIm1hcHBpbmdzIjoiOzs7Z0NBQWdCQSxVLEdBQUFBLFU7eURBUUFDLGUsR0FBQUEsZTtBQVJULFNBQVNELFVBQVQsQ0FBb0JFLENBQXBCLEVBQXVCQyxDQUF2QixFQUEwQjtBQUMvQixNQUFJRCxFQUFFRSxNQUFGLEtBQWFELEVBQUVDLE1BQW5CLEVBQTJCO0FBQ3pCLFdBQU8sS0FBUDtBQUNEOztBQUVELFNBQU9ILGdCQUFnQkMsQ0FBaEIsRUFBbUJDLENBQW5CLENBQVA7QUFDRDs7QUFFTSxTQUFTRixlQUFULENBQXlCSSxLQUF6QixFQUFnQ0MsS0FBaEMsRUFBdUM7QUFDNUMsTUFBSUEsTUFBTUYsTUFBTixHQUFlQyxNQUFNRCxNQUF6QixFQUFpQztBQUMvQixXQUFPLEtBQVA7QUFDRDs7QUFFRCxPQUFLLElBQUlHLElBQUksQ0FBYixFQUFnQkEsSUFBSUQsTUFBTUYsTUFBMUIsRUFBa0NHLEdBQWxDLEVBQXVDO0FBQ3JDLFFBQUlELE1BQU1DLENBQU4sTUFBYUYsTUFBTUUsQ0FBTixDQUFqQixFQUEyQjtBQUN6QixhQUFPLEtBQVA7QUFDRDtBQUNGOztBQUVELFNBQU8sSUFBUDtBQUNEIiwiZmlsZSI6ImFycmF5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGFycmF5RXF1YWwoYSwgYikge1xuICBpZiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIGFycmF5U3RhcnRzV2l0aChhLCBiKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFycmF5U3RhcnRzV2l0aChhcnJheSwgc3RhcnQpIHtcbiAgaWYgKHN0YXJ0Lmxlbmd0aCA+IGFycmF5Lmxlbmd0aCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3RhcnQubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoc3RhcnRbaV0gIT09IGFycmF5W2ldKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59XG4iXX0=\n\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/\"use strict\";\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/convertChangesToDMP = convertChangesToDMP;\n\t// See: http://code.google.com/p/google-diff-match-patch/wiki/API\n\tfunction convertChangesToDMP(changes) {\n\t  var ret = [],\n\t      change = /*istanbul ignore start*/void 0 /*istanbul ignore end*/,\n\t      operation = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\t  for (var i = 0; i < changes.length; i++) {\n\t    change = changes[i];\n\t    if (change.added) {\n\t      operation = 1;\n\t    } else if (change.removed) {\n\t      operation = -1;\n\t    } else {\n\t      operation = 0;\n\t    }\n\n\t    ret.push([operation, change.value]);\n\t  }\n\t  return ret;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb252ZXJ0L2RtcC5qcyJdLCJuYW1lcyI6WyJjb252ZXJ0Q2hhbmdlc1RvRE1QIiwiY2hhbmdlcyIsInJldCIsImNoYW5nZSIsIm9wZXJhdGlvbiIsImkiLCJsZW5ndGgiLCJhZGRlZCIsInJlbW92ZWQiLCJwdXNoIiwidmFsdWUiXSwibWFwcGluZ3MiOiI7OztnQ0FDZ0JBLG1CLEdBQUFBLG1CO0FBRGhCO0FBQ08sU0FBU0EsbUJBQVQsQ0FBNkJDLE9BQTdCLEVBQXNDO0FBQzNDLE1BQUlDLE1BQU0sRUFBVjtBQUFBLE1BQ0lDLHdDQURKO0FBQUEsTUFFSUMsMkNBRko7QUFHQSxPQUFLLElBQUlDLElBQUksQ0FBYixFQUFnQkEsSUFBSUosUUFBUUssTUFBNUIsRUFBb0NELEdBQXBDLEVBQXlDO0FBQ3ZDRixhQUFTRixRQUFRSSxDQUFSLENBQVQ7QUFDQSxRQUFJRixPQUFPSSxLQUFYLEVBQWtCO0FBQ2hCSCxrQkFBWSxDQUFaO0FBQ0QsS0FGRCxNQUVPLElBQUlELE9BQU9LLE9BQVgsRUFBb0I7QUFDekJKLGtCQUFZLENBQUMsQ0FBYjtBQUNELEtBRk0sTUFFQTtBQUNMQSxrQkFBWSxDQUFaO0FBQ0Q7O0FBRURGLFFBQUlPLElBQUosQ0FBUyxDQUFDTCxTQUFELEVBQVlELE9BQU9PLEtBQW5CLENBQVQ7QUFDRDtBQUNELFNBQU9SLEdBQVA7QUFDRCIsImZpbGUiOiJkbXAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTZWU6IGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9nb29nbGUtZGlmZi1tYXRjaC1wYXRjaC93aWtpL0FQSVxuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRDaGFuZ2VzVG9ETVAoY2hhbmdlcykge1xuICBsZXQgcmV0ID0gW10sXG4gICAgICBjaGFuZ2UsXG4gICAgICBvcGVyYXRpb247XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY2hhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgIGNoYW5nZSA9IGNoYW5nZXNbaV07XG4gICAgaWYgKGNoYW5nZS5hZGRlZCkge1xuICAgICAgb3BlcmF0aW9uID0gMTtcbiAgICB9IGVsc2UgaWYgKGNoYW5nZS5yZW1vdmVkKSB7XG4gICAgICBvcGVyYXRpb24gPSAtMTtcbiAgICB9IGVsc2Uge1xuICAgICAgb3BlcmF0aW9uID0gMDtcbiAgICB9XG5cbiAgICByZXQucHVzaChbb3BlcmF0aW9uLCBjaGFuZ2UudmFsdWVdKTtcbiAgfVxuICByZXR1cm4gcmV0O1xufVxuIl19\n\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/convertChangesToXML = convertChangesToXML;\n\tfunction convertChangesToXML(changes) {\n\t  var ret = [];\n\t  for (var i = 0; i < changes.length; i++) {\n\t    var change = changes[i];\n\t    if (change.added) {\n\t      ret.push('<ins>');\n\t    } else if (change.removed) {\n\t      ret.push('<del>');\n\t    }\n\n\t    ret.push(escapeHTML(change.value));\n\n\t    if (change.added) {\n\t      ret.push('</ins>');\n\t    } else if (change.removed) {\n\t      ret.push('</del>');\n\t    }\n\t  }\n\t  return ret.join('');\n\t}\n\n\tfunction escapeHTML(s) {\n\t  var n = s;\n\t  n = n.replace(/&/g, '&amp;');\n\t  n = n.replace(/</g, '&lt;');\n\t  n = n.replace(/>/g, '&gt;');\n\t  n = n.replace(/\"/g, '&quot;');\n\n\t  return n;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb252ZXJ0L3htbC5qcyJdLCJuYW1lcyI6WyJjb252ZXJ0Q2hhbmdlc1RvWE1MIiwiY2hhbmdlcyIsInJldCIsImkiLCJsZW5ndGgiLCJjaGFuZ2UiLCJhZGRlZCIsInB1c2giLCJyZW1vdmVkIiwiZXNjYXBlSFRNTCIsInZhbHVlIiwiam9pbiIsInMiLCJuIiwicmVwbGFjZSJdLCJtYXBwaW5ncyI6Ijs7O2dDQUFnQkEsbUIsR0FBQUEsbUI7QUFBVCxTQUFTQSxtQkFBVCxDQUE2QkMsT0FBN0IsRUFBc0M7QUFDM0MsTUFBSUMsTUFBTSxFQUFWO0FBQ0EsT0FBSyxJQUFJQyxJQUFJLENBQWIsRUFBZ0JBLElBQUlGLFFBQVFHLE1BQTVCLEVBQW9DRCxHQUFwQyxFQUF5QztBQUN2QyxRQUFJRSxTQUFTSixRQUFRRSxDQUFSLENBQWI7QUFDQSxRQUFJRSxPQUFPQyxLQUFYLEVBQWtCO0FBQ2hCSixVQUFJSyxJQUFKLENBQVMsT0FBVDtBQUNELEtBRkQsTUFFTyxJQUFJRixPQUFPRyxPQUFYLEVBQW9CO0FBQ3pCTixVQUFJSyxJQUFKLENBQVMsT0FBVDtBQUNEOztBQUVETCxRQUFJSyxJQUFKLENBQVNFLFdBQVdKLE9BQU9LLEtBQWxCLENBQVQ7O0FBRUEsUUFBSUwsT0FBT0MsS0FBWCxFQUFrQjtBQUNoQkosVUFBSUssSUFBSixDQUFTLFFBQVQ7QUFDRCxLQUZELE1BRU8sSUFBSUYsT0FBT0csT0FBWCxFQUFvQjtBQUN6Qk4sVUFBSUssSUFBSixDQUFTLFFBQVQ7QUFDRDtBQUNGO0FBQ0QsU0FBT0wsSUFBSVMsSUFBSixDQUFTLEVBQVQsQ0FBUDtBQUNEOztBQUVELFNBQVNGLFVBQVQsQ0FBb0JHLENBQXBCLEVBQXVCO0FBQ3JCLE1BQUlDLElBQUlELENBQVI7QUFDQUMsTUFBSUEsRUFBRUMsT0FBRixDQUFVLElBQVYsRUFBZ0IsT0FBaEIsQ0FBSjtBQUNBRCxNQUFJQSxFQUFFQyxPQUFGLENBQVUsSUFBVixFQUFnQixNQUFoQixDQUFKO0FBQ0FELE1BQUlBLEVBQUVDLE9BQUYsQ0FBVSxJQUFWLEVBQWdCLE1BQWhCLENBQUo7QUFDQUQsTUFBSUEsRUFBRUMsT0FBRixDQUFVLElBQVYsRUFBZ0IsUUFBaEIsQ0FBSjs7QUFFQSxTQUFPRCxDQUFQO0FBQ0QiLCJmaWxlIjoieG1sLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRDaGFuZ2VzVG9YTUwoY2hhbmdlcykge1xuICBsZXQgcmV0ID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY2hhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgIGxldCBjaGFuZ2UgPSBjaGFuZ2VzW2ldO1xuICAgIGlmIChjaGFuZ2UuYWRkZWQpIHtcbiAgICAgIHJldC5wdXNoKCc8aW5zPicpO1xuICAgIH0gZWxzZSBpZiAoY2hhbmdlLnJlbW92ZWQpIHtcbiAgICAgIHJldC5wdXNoKCc8ZGVsPicpO1xuICAgIH1cblxuICAgIHJldC5wdXNoKGVzY2FwZUhUTUwoY2hhbmdlLnZhbHVlKSk7XG5cbiAgICBpZiAoY2hhbmdlLmFkZGVkKSB7XG4gICAgICByZXQucHVzaCgnPC9pbnM+Jyk7XG4gICAgfSBlbHNlIGlmIChjaGFuZ2UucmVtb3ZlZCkge1xuICAgICAgcmV0LnB1c2goJzwvZGVsPicpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmV0LmpvaW4oJycpO1xufVxuXG5mdW5jdGlvbiBlc2NhcGVIVE1MKHMpIHtcbiAgbGV0IG4gPSBzO1xuICBuID0gbi5yZXBsYWNlKC8mL2csICcmYW1wOycpO1xuICBuID0gbi5yZXBsYWNlKC88L2csICcmbHQ7Jyk7XG4gIG4gPSBuLnJlcGxhY2UoLz4vZywgJyZndDsnKTtcbiAgbiA9IG4ucmVwbGFjZSgvXCIvZywgJyZxdW90OycpO1xuXG4gIHJldHVybiBuO1xufVxuIl19\n\n\n/***/ })\n/******/ ])\n});\n;","\"use strict\";\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar JsDiff = __importStar(require(\"diff\"));\nvar Measure_1 = require(\"./Measure\");\nvar Sheet_1 = require(\"./Sheet\");\nvar Snippet = /** @class */ (function () {\n    function Snippet() {\n    }\n    Snippet.render = function (snippet, options) {\n        var parsed = Snippet.parse(snippet);\n        return Sheet_1.Sheet.render(parsed, options);\n    };\n    Snippet.wrapPipes = function (string) {\n        return (\"|\" + string + \"|\").replace(/\\|+/g, '|');\n    };\n    Snippet.formatForDiff = function (snippet) {\n        return Snippet.minify(snippet)\n            .replace(/\\|/g, ' | ').trim();\n    };\n    Snippet.format = function (snippet, linebreaks) {\n        if (linebreaks === void 0) { linebreaks = true; }\n        // replaces url chars back\n        var compact = Snippet.minify(snippet, false);\n        compact = Snippet.wrapPipes(compact);\n        if (linebreaks) {\n            compact = Snippet.parseBars(snippet).compact;\n        }\n        else {\n            compact = compact.replace(/\\n/g, '|');\n        }\n        return compact\n            .replace(/\\|+/g, '|')\n            .replace(/\\|( +)\\|( +)/g, ' $1 $2') // remove spacer bar pipes\n            .replace(/\\|( +)\\|([1-9])/g, ' $1|$2')\n            .replace(/^\\s+|\\s+$/g, ''); // remove spaces/line breaks from start/end\n    };\n    Snippet.parseBars = function (snippet) {\n        var compact = Snippet.minify(snippet, false);\n        compact = Snippet.wrapPipes(compact);\n        // insert spaces before first chord\n        var cells = compact.split('|').slice(1, -1);\n        cells = cells.map(function (bar, index) {\n            if (!bar[0].match(/[1-9:]/)) {\n                bar = '  ' + bar;\n            }\n            else if (bar[0] === ':') {\n                bar = ': ' + bar.slice(1);\n            }\n            return bar;\n        });\n        // find out indices of first houses\n        var houses = cells.reduce(function (offset, bar, index) {\n            if (bar[0] === '1') {\n                offset.push(index);\n            }\n            return offset;\n        }, []);\n        // insert empty cells before additional houses\n        cells = cells.reduce(function (cells, bar, index) {\n            if (bar[0].match(/[2-9]/)) {\n                var offset = houses.filter(function (h) { return h < index; }).reverse()[0];\n                cells = cells.concat(new Array(offset % 4).fill(''));\n            }\n            cells.push(bar);\n            return cells;\n        }, []);\n        // find out the maximal number of chars per column\n        var chars = cells.reduce(function (max, bar, index) {\n            max[index % 4] = Math.max(bar.length, max[index % 4] || 0);\n            return max;\n        }, []);\n        // fill up each bar with spaces\n        compact = cells.map(function (bar, index) {\n            var diff = chars[index % 4] - bar.length + 2;\n            if (diff > 0) {\n                bar += new Array(diff).fill(' ').join('');\n            }\n            // move double dots to end of bar\n            bar = bar.replace(/:(\\s+)$/, '$1:');\n            return bar;\n        }).join('|');\n        compact = Snippet.wrapPipes(compact);\n        // break string all 4 cells\n        var pipeIndex = -1;\n        compact = compact.split('').reduce(function (string, char, index) {\n            if (char === '|') {\n                pipeIndex++;\n            }\n            if (char === '|' && pipeIndex % 4 === 0 && index > 0 && index < compact.length - 1) {\n                char = \"|\\n|\";\n                pipeIndex = 0;\n            }\n            return string + char;\n        }, '');\n        return { compact: compact, cells: cells, houses: houses, chars: chars };\n    };\n    Snippet.columnChars = function (snippet) {\n        var bars = snippet.split('|');\n        var chars = bars.reduce(function (max, bar, index) {\n            max[index % 4] = Math.max(bar.length, max[index % 4] || 0);\n            return max;\n        }, []);\n    };\n    Snippet.getCellBounds = function (index, snippet) {\n        var _a = Snippet.parseBars(snippet), chars = _a.chars, cells = _a.cells, houses = _a.houses;\n        if (houses.length && index > houses[0]) {\n            var offset = (houses.filter(function (h) { return h < index; }).reverse()[0]) % 4;\n            index += offset;\n        }\n        index = index % cells.length;\n        var col = index % 4;\n        var row = Math.floor(index / 4);\n        var rowlength = chars.reduce(function (sum, current) { return sum + current + 3; }, 0) + 2;\n        var rowLeft = rowlength * row;\n        var left = rowLeft + chars.slice(0, col).reduce(function (sum, current, i) { return sum + current + 3; }, 0) + 1;\n        return [left, left + chars[col] + 2];\n    };\n    Snippet.minify = function (snippet, urlsafe) {\n        if (urlsafe === void 0) { urlsafe = false; }\n        var compact = (\"|\" + snippet + \"|\")\n            .replace(/\\n+/g, '|') // replace line breaks with pipes\n            .replace(/\\s+/g, ' ') // no repeated pipes\n            .replace(/\\s?\\|\\s?/g, '|') // no pipes with spaces\n            .replace(/\\s?\\:\\s?/g, ':') // no repeat with spaces\n            .replace(/\\|+/g, '|'); // no repeated pipes\n        if (urlsafe) {\n            // replaces url unfriendly chars\n            compact = compact\n                .replace(/\\|+/g, 'I')\n                .replace(/\\s+/g, '_')\n                .replace(/:/g, 'R')\n                .replace(/\\^/g, 'M')\n                .replace(/\\#/g, 'S')\n                .replace(/\\%/g, 'X');\n        }\n        else {\n            // replaces url unfriendly chars\n            compact = compact\n                .replace(/\\I+/g, '|')\n                .replace(/\\_+/g, ' ')\n                .replace(/R/g, ':')\n                .replace(/M/g, '^')\n                .replace(/X/g, 'x')\n                .replace(/S/g, '#');\n        }\n        return compact.slice(1, -1);\n    };\n    Snippet.parse = function (snippet, simplify) {\n        if (simplify === void 0) { simplify = true; }\n        var formatted = Snippet.format(snippet, false);\n        return formatted\n            .split('|') // split into measures\n            .map(function (measure) { return measure.split(' '); }) // split measures by spaces\n            .map(function (measure) { return measure.filter(function (chord) { return !!chord; }); }) // kill empty chords\n            .filter(function (measure) { return !measure || measure.length; }) // kill empty measures\n            .map(function (measure) { return ({ symbols: measure, signs: [] }); })\n            // parse symbols to chords and signs\n            .map(function (measure) {\n            // repeat start\n            if (measure.symbols[0][0] === ':') {\n                if (measure.symbols[0].length === 1) {\n                    measure.symbols = measure.symbols.slice(1);\n                }\n                measure.signs.unshift('{');\n            }\n            var last = measure.symbols[measure.symbols.length - 1];\n            // repeat end\n            if (last[last.length - 1] === ':') {\n                if (last.length === 1) {\n                    measure.symbols.pop();\n                }\n                measure.signs.push('}');\n            }\n            measure.symbols = measure.symbols.map(function (s) { return s.replace(/:/g, ''); });\n            var house = measure.symbols.find(function (s) { return s.match(/^[1-9]$/); });\n            if (house) {\n                measure.house = parseInt(house);\n            }\n            measure.symbols = measure.symbols.filter(function (s) { return !s.match(/^[1-9]$/); });\n            // houses\n            measure.chords = [].concat(measure.symbols);\n            delete measure.symbols;\n            return measure;\n        })\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.signs.length === 0) {\n                delete measure.signs;\n            }\n            if (measure.chords.length === 0) {\n                delete measure.chords;\n            }\n            return measure;\n        })\n            // kill empty measures\n            .filter(function (measure) { return Object.keys(measure).length > 0; })\n            // simplify => measures with only chords will be arrays\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.chords && Object.keys(measure).length === 1) {\n                return measure.chords.length === 1 ?\n                    measure.chords[0] : // simplify one chord measures\n                    measure.chords;\n            }\n            return measure;\n        });\n    };\n    Snippet.nest = function (string) {\n        var nested = string.split('.')\n            .map(function (group) { return group.trim(); })\n            .map(function (group) { return group.split(' '); })\n            .map(function (group) { return group.filter(function (chord) { return !!chord; }); }) // kill empty chords\n            .filter(function (group) { return !group || group.length; })\n            .map(function (group) { return group.length === 1 ? group[0] : group; });\n        nested = nested.length === 1 ? nested[0] : nested;\n        return nested;\n    };\n    Snippet.parse2 = function (snippet, simplify) {\n        if (simplify === void 0) { simplify = true; }\n        var formatted = Snippet.format(snippet, false);\n        return formatted\n            .split('|') // split into measures\n            .filter(function (measure) { return measure && measure.length; }) // kill empty measures\n            .map(function (measure) { return ({ symbols: measure.trim(), signs: [] }); })\n            // parse symbols to chords and signs\n            .map(function (measure) {\n            // repeat start\n            if (measure.symbols[0] === ':') {\n                measure.signs.unshift('{');\n            }\n            var last = measure.symbols[measure.symbols.length - 1];\n            // repeat end\n            if (last === ':') {\n                measure.signs.push('}');\n            }\n            measure.symbols = measure.symbols.replace(/:/g, '');\n            /* const house = measure.symbols[0].match(/^[1-9]$/);\n            if (house) {\n                measure.house = parseInt(house);\n                measure.symbols = measure.symbols.slice(1);\n            } */\n            measure.chords = [].concat(Snippet.nest(measure.symbols));\n            delete measure.symbols;\n            return measure;\n        })\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.signs.length === 0) {\n                delete measure.signs;\n            }\n            if (measure.chords.length === 0) {\n                delete measure.chords;\n            }\n            return measure;\n        })\n            // kill empty measures\n            .filter(function (measure) { return Object.keys(measure).length > 0; })\n            // simplify => measures with only chords will be arrays\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.chords && Object.keys(measure).length === 1) {\n                return measure.chords.length === 1 ?\n                    measure.chords[0] : // simplify one chord measures\n                    measure.chords;\n            }\n            return measure;\n        });\n    };\n    Snippet.testFormat = function (sheet) {\n        return sheet.map(function (m) { return Measure_1.Measure.from(m); }).map(function (m) { return m.chords; }).join(' ');\n    };\n    Snippet.from = function (sheet, format) {\n        if (format === void 0) { format = true; }\n        var snippet = sheet\n            .map(function (m) { return Measure_1.Measure.from(m); })\n            .reduce(function (snippet, _a) {\n            var signs = _a.signs, house = _a.house, chords = _a.chords;\n            var repeatStart = signs && signs.includes('{');\n            var repeatEnd = signs && signs.includes('}');\n            return snippet + (\"|\" + (repeatStart ? ':' : '') + (house || '') + \" \" + (chords ? chords.join(' ') : '') + (repeatEnd ? ':' : ''));\n        }, '');\n        if (format) {\n            return Snippet.format(snippet);\n        }\n        return Snippet.minify(snippet);\n    };\n    Snippet.expand = function (snippet, options) {\n        var rendered = Snippet.render(snippet, options);\n        rendered = rendered\n            .map(function (m) { return Measure_1.Measure.from(m); })\n            .map(function (m) {\n            delete m.house;\n            delete m.signs;\n            return m;\n        });\n        var expanded = Snippet.from(rendered);\n        return expanded;\n        /* return from(Sheet.render(render(snippet))); */\n    };\n    Snippet.diff = function (snippetA, snippetB) {\n        var diffFormat = [Snippet.formatForDiff(snippetA), Snippet.formatForDiff(snippetB)];\n        return JsDiff.diffWords(diffFormat[0], diffFormat[1]);\n    };\n    return Snippet;\n}());\nexports.Snippet = Snippet;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tonal_1 = require(\"tonal\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar Voicing_1 = require(\"../harmony/Voicing\");\nvar Snippet_1 = require(\"../sheet/Snippet\");\nvar util_1 = require(\"./util\");\nvar Logger = /** @class */ (function () {\n    function Logger() {\n    }\n    Logger.logCustom = function (args, logFn) {\n        if (logFn === void 0) { logFn = console.log; }\n        /* console.clear(); */\n        logFn.apply(console, args);\n    };\n    Logger.logLegend = function () {\n        if (console.groupCollapsed) {\n            console.groupCollapsed('Show Emoji Legend');\n            console.table(Logger.emoji);\n            console.groupEnd();\n        }\n        else {\n            console.log('Emoji Legend:', Logger.emoji);\n        }\n    };\n    Logger.logSheet = function (sheet) {\n        sheet = __assign({ title: 'Untitled', composer: 'Unkown', chords: [], forms: 3, tempo: 130, style: 'Swing' }, sheet);\n        var snippet = Snippet_1.Snippet.from(sheet.chords);\n        console.log(sheet.composer + \" - \" + sheet.title);\n        console.log(sheet.tempo + \"bpm, Style: \" + sheet.style);\n        console.log(snippet);\n        if (console.groupCollapsed) {\n            console.log('Sheet', sheet);\n            /* console.log('Groove', sheet.groove); */\n            console.groupCollapsed(\"show \" + sheet.forms + \" rendered forms\");\n            console.log(\"expanded view\\n\\n\" + Snippet_1.Snippet.expand(snippet, { forms: sheet.forms || 1 }));\n            console.groupEnd();\n        }\n    };\n    Logger.logLabel = function (key) {\n        if (!Logger.emoji[key]) {\n            return key;\n        }\n        return Logger.emoji[key].icon + ' ' + key;\n    };\n    Logger.logChoice = function (choice) {\n        var _a;\n        if (!choice) {\n            return;\n        }\n        var difference = choice.difference, origin = choice.origin, targets = choice.targets, from = choice.from, to = choice.to, movement = choice.movement, similar = choice.similar, added = choice.added, dropped = choice.dropped, contrary = choice.contrary, parallel = choice.parallel, topInterval = choice.topInterval, bottomInterval = choice.bottomInterval, topNotes = choice.topNotes, bottomNotes = choice.bottomNotes, intervals = choice.intervals, degrees = choice.degrees;\n        console.table((_a = {\n                difference: difference,\n                movement: movement,\n                origin: origin.join(' '),\n                dropped: dropped.join(' '),\n                added: added.join(' '),\n                targets: targets.join(' '),\n                /* from: from.join(' '),\n                to: to.join(' '), */\n                intervals: intervals.join(' '),\n                degrees: degrees.join(' ')\n            },\n            _a[Logger.logLabel('similar')] = similar,\n            _a[Logger.logLabel('contrary')] = contrary,\n            _a[Logger.logLabel('parallel')] = parallel,\n            _a.topNotes = topNotes.join(' '),\n            _a.topInterval = topInterval,\n            _a.bottomNotes = bottomNotes.join(' '),\n            _a.bottomInterval = bottomInterval,\n            _a));\n    };\n    Logger.logNotes = function (options) {\n        var _a = __assign({ labels: [] }, options), notes = _a.notes, active = _a.active, idle = _a.idle, added = _a.added, range = _a.range, labels = _a.labels;\n        var span = [\n            tonal_1.Distance.transpose(range[0], tonal_1.Interval.fromSemitones(-7)),\n            tonal_1.Distance.transpose(range[1], tonal_1.Interval.fromSemitones(12))\n        ];\n        var allNotes = util_1.noteArray(span);\n        var keyboard = allNotes.map(function (note, index) {\n            var isActive = active.find(function (n) { return Harmony_1.Harmony.isSameNote(note, n); });\n            var isUsed = notes.find(function (n) { return Harmony_1.Harmony.isSameNote(note, n); });\n            var i = notes.indexOf(isUsed);\n            var isIdle = idle.find(function (n) { return Harmony_1.Harmony.isSameNote(note, n); });\n            var isAdded = added.find(function (n) { return Harmony_1.Harmony.isSameNote(note, n); });\n            var isBlack = Harmony_1.Harmony.isBlack(note);\n            var css = '', sign = '_';\n            if (isAdded && !isBlack) {\n                css = 'background:green;color:white;';\n                sign = labels[i] || '█';\n            }\n            else if (isAdded && isBlack) {\n                css = 'background:darkgreen;color:white;';\n                sign = labels[i] || '█';\n            }\n            else if (isActive && isBlack) {\n                css = 'background:#a50909;color:white;';\n                sign = labels[i] || '█';\n            }\n            else if (isActive && !isBlack) {\n                css = 'background:#e52929;color:white;';\n                sign = labels[i] || '█';\n            }\n            else if (isIdle && !isBlack) {\n                css = 'background:gray;color:white;';\n                sign = labels[i] || '█';\n            }\n            else if (isIdle && isBlack) {\n                css = 'background:darkgray;color:white;';\n                sign = labels[i] || '█';\n            }\n            else {\n                css = isBlack ? 'color:black;' : 'color:#eee;';\n            }\n            var position = util_1.getRangePosition(note, range);\n            if (position < 0 || position > 1) {\n                if (active || idle || added) {\n                    css += 'color:red;';\n                    sign = ' ';\n                }\n                else {\n                    sign = ' ';\n                }\n            }\n            return {\n                sign: sign,\n                css: css\n            };\n        });\n        var args = [\n            keyboard.map(function (key) { return \"%c\" + key.sign; }).join('')\n        ].concat((keyboard.map(function (key) { return key.css + \";\"; })));\n        /* Snippet.logCustom(args); */\n        return args;\n    };\n    Logger.logVoicing = function (_a) {\n        var chord = _a.chord, previousVoicing = _a.previousVoicing, combinations = _a.combinations, bestPick = _a.bestPick, pick = _a.pick, range = _a.range, choice = _a.choice, direction = _a.direction, choices = _a.choices;\n        /* pick = pick.map(n => Note.simplify(n)); */\n        pick = pick || [];\n        previousVoicing = previousVoicing || [];\n        var idle = previousVoicing.filter(function (n) { return pick.find(function (p) { return Harmony_1.Harmony.isSameNote(n, p); }); });\n        var isIdle = choice && choice.oblique.length === choice.targets.length;\n        if (isIdle) {\n            return;\n        }\n        var active = pick.filter(function (n) { return !previousVoicing.find(function (p) { return Harmony_1.Harmony.isSameNote(n, p); }); });\n        var added = choice ? choice.added : [];\n        var degrees = util_1.getStepsInChord(pick, chord, true)\n            .map(function (step) { return util_1.getDegreeFromStep(step); })\n            .map(function (step) { return step === 8 ? 1 : step; });\n        var konsole = Logger.logNotes({ notes: pick, active: active, idle: idle, added: added, range: range, labels: degrees });\n        var movement = choice ? choice.movement : 0;\n        var difference = choice ? choice.difference : 0;\n        choices = choices || [];\n        if (movement > 0) {\n            konsole.push(Logger.emoji.movedUp.icon);\n        }\n        else if (movement < 0) {\n            konsole.push(Logger.emoji.movedDown.icon);\n        }\n        else {\n            konsole.push(Logger.emoji.equilibrium.icon);\n        }\n        if (!pick.length) {\n            konsole.push(Logger.emoji.error.icon);\n        }\n        // TODO replace force with filter of choices after isInRange\n        //      isInRange: checks if top and bottom note are inside the range\n        if (!direction) {\n            konsole.push(Logger.emoji.bestMatch.icon);\n        }\n        else {\n            if (bestPick !== pick) {\n                konsole.push(Logger.emoji.force.icon);\n            }\n            else {\n                konsole.push(Logger.emoji.lucky.icon);\n            }\n            // wrong direction?\n            if ((direction === 'up' && movement < 0) || (direction === 'down' && movement > 0)) {\n                konsole.push(Logger.emoji.wrong.icon);\n            }\n        }\n        if (choice) {\n            if (choice.similar) {\n                konsole.push(Logger.emoji.similar.icon);\n            }\n            if (choice.contrary) {\n                konsole.push(Logger.emoji.contrary.icon);\n            }\n            if (choice.parallel) {\n                konsole.push(Logger.emoji.parallel.icon);\n            }\n            if (choice.added.length && choice.added[choice.added.length - 1] === choice.topNotes[1]) {\n                konsole.push(Logger.emoji.topAdded.icon);\n            }\n            if (choice.dropped.length && choice.dropped[choice.dropped.length - 1] === choice.topNotes[0]) {\n                konsole.push(Logger.emoji.topRemoved.icon);\n            }\n            if (choice.dropped.length && choice.dropped[0] === choice.origin[0]) {\n                konsole.push(Logger.emoji.bottomRemoved.icon);\n            }\n            if (choice.added.length && choice.added[0] === choice.targets[0]) {\n                konsole.push(Logger.emoji.bottomAdded.icon);\n            }\n            if (!Voicing_1.Voicing.hasTonic(pick, chord)) {\n                konsole.push(Logger.emoji.rootless.icon);\n            }\n            if (!choice.parallel && choice.oblique.length === 0) {\n                konsole.push(Logger.emoji.noOblique.icon);\n            }\n            if (isIdle) {\n                konsole.push(Logger.emoji.noChange.icon);\n            }\n        }\n        if (choices.length) {\n            if (choices.length < pick.length) {\n                konsole.push(Logger.emoji.fewChoices.icon);\n            }\n        }\n        konsole.push(\"\" + chord);\n        if (console && console.table) {\n            Logger.logCustom(konsole, console.groupCollapsed);\n            console.log(previousVoicing.join(' ') + \" > \" + pick.join(' ') + \" (\" + (choices.indexOf(choice) + 1) + \". choice of \" + choices.length + \")\");\n            previousVoicing = previousVoicing || [];\n            if (choice) {\n                console.group('Choice:');\n                Logger.logChoice(choice);\n                console.groupEnd();\n                console.groupCollapsed('All Choices:');\n                choices.forEach(function (c) { return Logger.logChoice(c); });\n                console.groupEnd();\n                console.groupCollapsed('Combinations:');\n                console.log(combinations);\n                console.groupEnd();\n            }\n            console.groupEnd();\n        }\n        //console.log(`${ Snippet.voicing(voicing, ['G2', 'C5']) } ${ chord }: ${ voicing.join(' ') } `);\n        //console.log(`#${ event.path[1] + 1 }: ${ chord }: ${ latest } > ${ voicing }.moved ${ moves } (avg | ${ avgDiff } | total ${ totalMoves })`);\n        // console.log(chord, voicing);\n        // G#o7 2 (5.25) (4) [\"G3\", \"D4\", \"F4\", \"Bb4\"] > (4) [\"B2\", \"D3\", \"E#3\", \"G#3\"]\n        /* } */\n        return pick;\n    };\n    Logger.emoji = {\n        bestMatch: {\n            icon: '🎹',\n            description: 'The selected voicing had the best possible voice leading from the previous voicing'\n        },\n        force: {\n            icon: '💪',\n            description: 'Voicing had to be forced in the desired direction. The best pick would have gone in the wrong direction.'\n        },\n        lucky: {\n            icon: '🍀',\n            description: 'The best pick moved in the direction that would have been forced.'\n        },\n        wrong: {\n            icon: '💀',\n            description: 'Continued moving in the wrong direction'\n        },\n        similar: {\n            icon: '😇',\n            description: 'All voices are moving in the same direction'\n        },\n        parallel: {\n            icon: '⛓',\n            description: 'All voices are moving by parallel intervals'\n        },\n        contrary: {\n            icon: '👹',\n            description: 'Some voices were moving in opposite directions'\n        },\n        noOblique: {\n            icon: '🥌',\n            description: 'All voices changed position. (Not shown when parallel)'\n        },\n        noChange: {\n            icon: '🛋',\n            description: 'All voices remained in position.'\n        },\n        topAdded: {\n            icon: '🌤',\n            description: 'A top voice was added',\n        },\n        topRemoved: {\n            icon: '⛅',\n            description: 'A top voice was dropped'\n        },\n        bottomRemoved: {\n            icon: '🛫',\n            description: 'A bottom voice was dropped'\n        },\n        bottomAdded: {\n            icon: '🌳',\n            description: 'A bottom note was added'\n        },\n        movedUp: {\n            icon: '↗️',\n            description: 'The Voices generally moved up'\n        },\n        movedDown: {\n            icon: '↙️',\n            description: 'The Voices generally moved down'\n        },\n        equilibrium: {\n            icon: '☯️',\n            description: 'The Voices generally did not move anywhere'\n        },\n        fewChoices: {\n            icon: '❓',\n            description: 'There were very few valid combinations to choose from'\n        },\n        error: {\n            icon: '❌',\n            description: 'No notes could be selected. Some error happened.'\n        },\n        rootless: {\n            icon: '⛵',\n            description: 'The voicing does not contain its root note (tonic).'\n        }\n        // ️️️️️➡️↘️↗️⬇️⬆️⬅️\n    };\n    return Logger;\n}());\nexports.Logger = Logger;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Pulse_1 = require(\"./Pulse\");\nvar Sheet_1 = require(\"./sheet/Sheet\");\nvar Metronome_1 = require(\"./Metronome\");\nvar Logger_1 = require(\"./util/Logger\");\n/** Band */\nvar Band = /** @class */ (function () {\n    function Band(_a) {\n        var _b = _a === void 0 ? {} : _a, context = _b.context, musicians = _b.musicians, onMeasure = _b.onMeasure;\n        this.defaults = {\n            cycle: 4,\n            division: 3,\n            transpose: 0,\n            style: 'Medium Swing',\n        };\n        this.context = context || new AudioContext();\n        this.onMeasure = onMeasure;\n        this.musicians = musicians || [];\n        this.mix = this.setupMix(this.context);\n        this.metronome = new Metronome_1.Metronome(this.mix);\n    }\n    Band.prototype.setupMix = function (context) {\n        var mix = context.createGain();\n        mix.gain.value = 0.9;\n        mix.connect(context.destination);\n        return mix;\n    };\n    Band.prototype.addMember = function (musician) {\n        this.musicians = this.musicians.concat(musician);\n    };\n    Band.prototype.ready = function () {\n        return Promise.all([this.resume()].concat(this.musicians.map(function (m) { return m.ready; })));\n    };\n    Band.prototype.resume = function () {\n        var _this = this;\n        return this.context.resume ? this.context.resume().then(function () { return _this.context; }) : Promise.resolve(this.context);\n    };\n    Band.prototype.comp = function (sheet, settings) {\n        if (this.pulse) {\n            this.pulse.stop();\n        }\n        Logger_1.Logger.logLegend();\n        Logger_1.Logger.logSheet(sheet);\n        if (settings.onMeasure) {\n            this.onMeasure = settings.onMeasure;\n        }\n        var measures = Sheet_1.Sheet.render(sheet.chords, settings.render);\n        measures = measures.concat(measures);\n        settings = Object.assign(this.defaults, settings, { context: this.context });\n        this.play(measures, settings);\n    };\n    Band.prototype.play = function (measures, settings) {\n        var _this = this;\n        this.ready().then(function () {\n            _this.pulse = settings.pulse || new Pulse_1.Pulse(settings);\n            return _this.count(_this.pulse, settings.metronome ? null : 0);\n        }).then(function (tick) {\n            /* settings.deadline = tick.deadline; */\n            if (_this.onMeasure) {\n                // TODO: add onChord for setting tonics + circle chroma etc\n                _this.pulse.tickArray(measures.map(function (measure) { return ({ measure: measure }); }), function (tick) { return _this.onMeasure(tick.value.measure, tick); });\n            }\n            measures = measures.map(function (m) { return m.chords ? m.chords : m; });\n            console.log('Band#play', settings);\n            var musicians = (settings.musicians || _this.musicians);\n            musicians.forEach(function (musician) { return musician.play({ pulse: _this.pulse, measures: measures, settings: settings }); });\n            _this.pulse.start();\n        });\n    };\n    Band.prototype.count = function (pulse, bars) {\n        if (bars === void 0) { bars = 1; }\n        if (pulse.getMeasureLength() < 1.5) {\n            bars *= 2; //double countin bars when countin would be shorter than 1.5s\n        }\n        return this.metronome.count(pulse, bars);\n    };\n    return Band;\n}());\nexports.default = Band;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Musician = /** @class */ (function () {\n    function Musician(instrument) {\n        this.name = 'Musician';\n        this.gain = 1;\n        if (!instrument) {\n            console.warn('musician has no instrument', this);\n        }\n        this.instrument = instrument;\n        this.ready = this.instrument ? this.instrument.ready : Promise.resolve();\n    }\n    Musician.prototype.play = function (_a) {\n        var pulse = _a.pulse, measures = _a.measures, settings = _a.settings;\n        console.log('play..', pulse, measures, settings);\n    };\n    Musician.prototype.getGain = function (value) {\n        if (value === void 0) { value = 1; }\n        return value * this.gain * this.instrument.gain;\n    };\n    return Musician;\n}());\nexports.Musician = Musician;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nvar off = function () { return util_1.randomElement([0, [0, 0, 2]], [6, 1]); };\nvar eightFour = function () { return util_1.randomElement([[1, 0, 1], 1, [0, 0, 1, 1]], [4, 2, 1]); };\nvar eightOff = function () { return util_1.randomElement([[1, 0, 1], [0, 0, 1]], [4, 1]); };\nvar halfTriplet = function () { return util_1.randomElement([\n    [2, 0],\n    [[2, 0, 2], [0, 2, 0]],\n    [1, 1, 1, 1]\n], [2, 1, 1]); };\nexports.swing = {\n    name: 'Swing',\n    tempo: 130,\n    chords: function (_a) {\n        var measure = _a.measure, settings = _a.settings;\n        var r = Math.random() > 0.5 ? .6 : 0;\n        var t = settings.cycle + \"/\" + measure.length;\n        if (t === '4/1') {\n            return util_1.randomElement([\n                [[1, 0], [0, 0, 7], 0, 0],\n                [1, [0, 0, 2], 0, off()],\n                [[0, 0, 1], 0, 2, 0],\n                [[0, 0, 4], 0, 1, 0],\n                [2, 0, 0, 0],\n                [3, 0, 0, 0],\n                [1, 0, r, off()],\n                [[0, 0, 2], 0, r, 0],\n                [1.5, [0, 0, 2], 0, off()],\n            ]); //, [2, 1, 1]\n        }\n        if (t === '4/2') {\n            return util_1.randomElement([\n                [[1, 0], [0, 0, 7], 0, 0],\n                [1, [0, 0, 3], 0, 0],\n                [1, 0, 2, 0],\n                [2, 0, 1, 0],\n                [1, 0, .7, off()],\n                [[1, 0, 0], 0, .7, off()],\n                [[4, 0, 0], [0, 0, 2.8], 0, off()],\n            ]);\n        }\n        if (t === '4/3') {\n            return [1, [0, 0, 2], [0, 0, 4], 0];\n        }\n        if ('4/4') {\n            return util_1.randomElement([\n                [1, 1, 1, 1],\n                [[1, 0, 2], [0, 0, 2], 0, 1]\n            ]);\n        }\n    },\n    bass: function () { return util_1.randomElement([\n        [1, 1, 1, 1],\n    ]); },\n    crash: function (_a) {\n        var measures = _a.measures, index = _a.index;\n        var fill = index !== 0 && index % measures.length === 0;\n        if (fill) {\n            return [4, 0, 0, 0];\n        }\n        return [0, 0, 0, 0];\n    },\n    ride: function (_a) {\n        var measures = _a.measures, index = _a.index;\n        return util_1.randomElement([\n            [.6, [.9, 0, 1], .6, [.9, 0, 1]],\n            [.6, [.4, 0, 1], .8, [0, 0, 1],],\n            [.6, .9, [.6, 0, 1], 1],\n            [.6, .9, .6, [.9, 0, 1]],\n        ], [3, 2, 1, 2]);\n    },\n    hihat: function () { return [0, .8, 0, 1]; },\n    solo: function () { return util_1.randomElement([\n        [eightFour(), eightFour(), eightFour(), eightFour()],\n        [eightFour(), 2, 0, eightFour()],\n        [0, 0, eightFour(), eightFour()],\n        [[1, 0, 4], 0, eightFour(), eightFour()],\n        [3, 0, 0, eightFour()],\n        halfTriplet().concat(halfTriplet()),\n        [eightOff(), eightOff(), eightOff(), eightOff()],\n    ]); }\n    /* solo: () => [1, 1, 0, 1] */\n};\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nvar Musician_1 = require(\"./Musician\");\nvar swing_1 = require(\"../grooves/swing\");\nvar Voicing_1 = require(\"../harmony/Voicing\");\nvar tonal_1 = require(\"tonal\");\nvar Pianist = /** @class */ (function (_super) {\n    __extends(Pianist, _super);\n    function Pianist(instrument, props) {\n        if (props === void 0) { props = {}; }\n        var _this = _super.call(this, instrument) || this;\n        _this.name = 'Pianist';\n        _this.playedNotes = [];\n        _this.playedChords = [];\n        _this.defaults = { groove: swing_1.swing };\n        _this.min = Math.min;\n        _this.rollFactor = 1; // how much keyroll effect? controls interval between notes\n        _this.voicingOptions = {};\n        _this.props = Object.assign({}, _this.defaults, props || {});\n        return _this;\n    }\n    Pianist.prototype.play = function (_a) {\n        var _this = this;\n        var pulse = _a.pulse, measures = _a.measures, settings = _a.settings;\n        var groove = settings.groove || this.defaults.groove;\n        var grooveKey = 'chords';\n        this.voicingOptions = __assign({}, this.voicingOptions, settings.voicings || {});\n        // if no groove or groove without chords, or exact, play whats there\n        // TODO: exact timing is false with metronome\n        if (settings.exact || !groove || !groove[grooveKey]) {\n            if (!groove[grooveKey]) {\n                console.warn('Groove has no chords, Pianist will play exact.', groove);\n            }\n            measures = measures\n                .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); });\n            return pulse.tickArray(measures, function (_a) {\n                var value = _a.value, deadline = _a.deadline;\n                var fraction = util_1.getDuration(value.divisions, 1);\n                // TODO: find out why value fraction is NaN\n                var duration = fraction * pulse.getMeasureLength();\n                _this.playChord(value.chord || value, { deadline: deadline, duration: duration, pulse: pulse });\n            });\n        }\n        // else, play groovy\n        var pattern = groove[grooveKey];\n        measures = measures\n            // generate random patterns\n            .map(function (measure) { return pattern({ measures: measures, pulse: pulse, measure: measure, settings: settings })\n            .slice(0, Math.floor(settings.cycle)); })\n            // fill in chords\n            .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); })\n            // fix chords at last offbeat\n            .reduce(util_1.offbeatReducer(settings), []);\n        pulse.tickArray(measures, function (_a) {\n            var path = _a.path, value = _a.value, deadline = _a.deadline;\n            var measureLength = pulse.getMeasureLength();\n            var concurrency = settings.bpm / (_this.rollFactor || 1);\n            var interval = settings.arpeggio ? measureLength / settings.cycle : Math.random() / (concurrency * 20);\n            if (path[0] % 2 === 0 && !path[1] && !path[2]) {\n                interval = Math.random() / concurrency;\n            }\n            var duration = settings.arpeggio ? interval : value.fraction * measureLength;\n            var slice = settings.arpeggio ? Math.ceil(value.fraction / 1000 * 4) : null;\n            var gain = _this.getGain(value.gain);\n            _this.playChord(value.chord, { deadline: deadline, gain: gain, duration: duration, interval: interval, slice: slice, pulse: pulse });\n        }, settings.deadline);\n    };\n    Pianist.prototype.getLastVoicing = function () {\n        return this.playedNotes.length ? this.playedNotes[this.playedNotes.length - 1] : null;\n    };\n    // plays the given notes at the given interval\n    Pianist.prototype.playNotes = function (scorenotes, _a) {\n        var deadline = _a.deadline, interval = _a.interval, gain = _a.gain, duration = _a.duration, pulse = _a.pulse;\n        this.playedNotes.push([].concat(scorenotes));\n        this.instrument.playNotes(scorenotes, { deadline: deadline, interval: interval, gain: gain, duration: duration, pulse: pulse });\n    };\n    Pianist.prototype.playChord = function (chord, settings) {\n        if (chord === 'x') { // repeat\n            chord = this.playedChords[this.playedChords.length - 1];\n        }\n        if (!chord || chord === '0') {\n            this.playedChords.push('');\n            return;\n        }\n        this.playedChords.push(chord);\n        var notes = Voicing_1.Voicing.getNextVoicing(chord, this.getLastVoicing(), this.voicingOptions);\n        notes = notes.map(function (note) { return tonal_1.Note.simplify(note); });\n        settings.deadline += 0.02 + util_1.randomDelay(5);\n        this.playNotes(notes, settings);\n    };\n    return Pianist;\n}(Musician_1.Musician));\nexports.default = Pianist;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Musician_1 = require(\"./Musician\");\nvar swing_1 = require(\"../grooves/swing\");\nvar util_1 = require(\"../util/util\");\nvar Drummer = /** @class */ (function (_super) {\n    __extends(Drummer, _super);\n    function Drummer(instrument) {\n        var _this = _super.call(this, instrument) || this;\n        _this.name = 'Drummer';\n        _this.set = {\n            kick: 0,\n            snare: 1,\n            hihat: 2,\n            ride: 3,\n            crash: 4,\n            rimshot: 5\n        };\n        _this.defaults = { groove: swing_1.swing };\n        return _this;\n    }\n    Drummer.prototype.play = function (_a) {\n        var _this = this;\n        var measures = _a.measures, pulse = _a.pulse, settings = _a.settings;\n        var groove = settings.groove || this.defaults.groove;\n        Object.keys(groove)\n            .filter(function (t) { return Object.keys(_this.set).includes(t); }) // only use drum set patterns\n            .forEach(function (key) {\n            var patterns = measures\n                .map(function (measure, index) { return groove[key]({ measures: measures, index: index, measure: measure, settings: settings, pulse: pulse })\n                .slice(0, Math.floor(settings.cycle)); });\n            pulse.tickArray(patterns, function (_a) {\n                var deadline = _a.deadline, value = _a.value;\n                deadline += util_1.randomDelay(5);\n                _this.instrument.playKeys([_this.set[key]], { deadline: deadline, gain: _this.getGain(value) });\n            }, settings.deadline);\n        });\n    };\n    return Drummer;\n}(Musician_1.Musician));\nexports.default = Drummer;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nvar Musician_1 = require(\"./Musician\");\nvar tonal_1 = require(\"tonal\");\nvar swing_1 = require(\"../grooves/swing\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar Bassist = /** @class */ (function (_super) {\n    __extends(Bassist, _super);\n    function Bassist(instrument) {\n        var _this = _super.call(this, instrument) || this;\n        _this.name = 'Bassist';\n        _this.defaults = { groove: swing_1.swing };\n        _this.playedChords = [];\n        return _this;\n    }\n    Bassist.prototype.play = function (_a) {\n        var _this = this;\n        var measures = _a.measures, pulse = _a.pulse, settings = _a.settings;\n        var groove = settings.groove || this.defaults.groove;\n        var pattern = groove['bass'];\n        if (!pattern) {\n            console.warn('no bass pattern found in groove', groove);\n            return;\n        }\n        measures = measures\n            .map(function (measure) { return pattern({ measures: measures, measure: measure, settings: settings, pulse: pulse }).slice(0, Math.floor(settings.cycle)); })\n            .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); });\n        pulse.tickArray(measures, function (tick) {\n            _this.playBass(tick, measures, pulse);\n        }, settings.deadline);\n    };\n    Bassist.prototype.getStep = function (step, chord, octave) {\n        if (octave === void 0) { octave = 2; }\n        var tokens = tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord));\n        var interval = tonal_1.Chord.intervals(tokens[1]).find(function (i) { return parseInt(i[0]) === step; });\n        return tonal_1.Distance.transpose(tokens[0] + octave, interval);\n    };\n    Bassist.prototype.playBass = function (_a, measures, pulse) {\n        var value = _a.value, cycle = _a.cycle, path = _a.path, deadline = _a.deadline, interval = _a.interval;\n        var chord = value.chord;\n        if (chord === 'N.C.') {\n            return;\n        }\n        if (chord === 'x') {\n            chord = this.playedChords[this.playedChords.length - 1];\n        }\n        if (!chord || chord === '0') {\n            this.playedChords.push('');\n            return;\n        }\n        this.playedChords.push(chord);\n        var note;\n        var steps = [1, util_1.randomElement([3, 5]), 1, util_1.randomElement([3, 5])];\n        var octave = 2;\n        if (value.value === 1 && chord.split('/').length > 1) {\n            note = chord.split('/')[1] + octave;\n        }\n        else {\n            note = this.getStep(steps[path[1]], Harmony_1.Harmony.getTonalChord(chord), octave);\n        }\n        var duration = value.fraction * pulse.getMeasureLength();\n        deadline += util_1.randomDelay(10);\n        this.instrument.playNotes([note], { deadline: deadline, interval: interval, gain: this.getGain() * .7, duration: duration, pulse: pulse });\n    };\n    return Bassist;\n}(Musician_1.Musician));\nexports.default = Bassist;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Instrument_1 = require(\"./Instrument\");\nvar util_1 = require(\"../util/util\");\nvar Sampler = /** @class */ (function (_super) {\n    __extends(Sampler, _super);\n    function Sampler(options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, options) || this;\n        _this.buffers = {};\n        _this.duration = 10000;\n        _this.type = 'sine';\n        _this.gain = 1;\n        _this.attack = 0;\n        _this.decay = 0;\n        _this.sustain = 1;\n        _this.release = .2;\n        _this.gain = options.gain || _this.gain;\n        _this.gainNode = _this.context.createGain();\n        _this.gainNode.connect(_this.context.destination);\n        _this.duration = options.duration || _this.duration;\n        // this.overlap = options.overlap;\n        if (options.samples) {\n            _this.sources = options.samples;\n            _this.ready = _this.loadSources(options.samples);\n        }\n        return _this;\n    }\n    // returns buffer from buffer cache or loads buffer data from source\n    Sampler.prototype.getBuffer = function (src, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        if (this.buffers[src] && this.buffers[src].context === context) {\n            // console.log('buffer already present');\n            return Promise.resolve(this.buffers[src].buffer);\n        }\n        return fetch(src)\n            .then(function (res) { return res.arrayBuffer(); })\n            .then(function (buffer) {\n            return new Promise(function (resolve, reject) {\n                context.decodeAudioData(buffer, function (decodedData) {\n                    _this.buffers[src] = { buffer: decodedData, context: context };\n                    resolve(decodedData);\n                });\n            });\n        });\n    };\n    Sampler.prototype.getSource = function (buffer, connect) {\n        var source = this.context.createBufferSource();\n        connect = connect || this.gainNode;\n        source.buffer = buffer;\n        source.connect(connect);\n        return source;\n    };\n    Sampler.prototype.getSources = function (sources, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        if (!this.hasLoaded(sources)) {\n            console.error('not all sources loaded!!!');\n            return [];\n        }\n        return sources.map(function (source) { return _this.getSource(_this.buffers[source].buffer); });\n    };\n    // loads a sound file into the context\n    Sampler.prototype.loadSource = function (src, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        return this.getBuffer(src, context)\n            .then(function (decodedData) { return _this.getSource(decodedData); });\n    };\n    // loads multiple sources into the context\n    Sampler.prototype.loadSources = function (sources, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        sources.forEach(function (source, i) {\n            if (!source) {\n                console.warn(\"note at index \" + i + \" cannot be played!\");\n            }\n        });\n        return Promise.all(sources.filter(function (source) { return !!source; }).map(function (source) { return _this.loadSource(source, context); }));\n    };\n    Sampler.prototype.hasLoaded = function (sources, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        return sources.reduce(function (allLoaded, src) {\n            return allLoaded && _this.buffers[src] && _this.buffers[src].context === context;\n        }, true);\n    };\n    Sampler.prototype.playSounds = function (sounds, deadline, interval) {\n        if (deadline === void 0) { deadline = this.context.currentTime; }\n        if (interval === void 0) { interval = 0; }\n        sounds.forEach(function (sound, i) { return sound.start(deadline + interval * i); });\n    };\n    Sampler.prototype.playSource = function (source, settings) {\n        var gainNode = this.context.createGain();\n        if (!this.buffers[source]) {\n            console.warn('no buffer found for source', source);\n            return;\n        }\n        var sound = this.getSource(this.buffers[source].buffer, gainNode);\n        var _a = [\n            settings.attack || this.attack,\n            settings.decay || this.decay,\n            settings.sustain || this.sustain,\n            settings.release || this.release,\n            (settings.duration || this.duration) / 1000,\n            (settings.gain || 1) * this.gain\n        ], attack = _a[0], decay = _a[1], sustain = _a[2], release = _a[3], duration = _a[4], gain = _a[5];\n        var time = settings.deadline || this.context.currentTime;\n        //gainNode.gain.value = typeof settings.gain === 'number' ? settings.gain : this.gain;\n        gainNode.connect(this.mix);\n        util_1.adsr({ attack: attack, decay: decay, sustain: sustain, release: release, gain: gain, duration: duration }, time, gainNode.gain);\n        this.playSounds([sound], time); //, settings.interval\n    };\n    /* playSources(sources, deadline = 0, interval = 0) {\n        if (this.hasLoaded(sources, this.context)) {\n            this.playSounds(this.getSources(sources, this.context), deadline, interval)\n        } else {\n            console.warn('need to load');\n            this.loadSources(sources, this.context)\n                .then(sounds => this.playSounds(sounds, deadline, interval));\n        }\n    } */\n    Sampler.prototype.playKeys = function (keys, settings) {\n        var _this = this;\n        _super.prototype.playKeys.call(this, keys, settings);\n        keys.forEach(function (key, index) {\n            if (settings.delay) {\n                settings.deadline += settings.delay;\n            }\n            _this.playSource(_this.sources[key], settings);\n        });\n    };\n    return Sampler;\n}(Instrument_1.Instrument));\nexports.Sampler = Sampler;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Kick = /** @class */ (function () {\n    function Kick(context) {\n        this.context = context;\n    }\n    Kick.prototype.setup = function () {\n        this.osc = this.context.createOscillator();\n        this.gain = this.context.createGain();\n        this.osc.connect(this.gain);\n        this.gain.connect(this.context.destination);\n    };\n    Kick.prototype.trigger = function (time) {\n        this.setup();\n        this.osc.frequency.setValueAtTime(150, time);\n        this.gain.gain.setValueAtTime(1, time);\n        this.osc.frequency.exponentialRampToValueAtTime(0.01, time + 0.5);\n        this.gain.gain.exponentialRampToValueAtTime(0.01, time + 0.5);\n        this.osc.start(time);\n        this.osc.stop(time + 0.5);\n    };\n    return Kick;\n}());\nexports.Kick = Kick;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Snare = /** @class */ (function () {\n    function Snare(context) {\n        this.context = context;\n    }\n    Snare.prototype.noiseBuffer = function () {\n        var bufferSize = this.context.sampleRate;\n        var buffer = this.context.createBuffer(1, bufferSize, this.context.sampleRate);\n        var output = buffer.getChannelData(0);\n        for (var i = 0; i < bufferSize; i++) {\n            output[i] = Math.random() * 2 - 1;\n        }\n        return buffer;\n    };\n    Snare.prototype.setup = function () {\n        this.noise = this.context.createBufferSource();\n        this.noise.buffer = this.noiseBuffer();\n        var noiseFilter = this.context.createBiquadFilter();\n        noiseFilter.type = 'highpass';\n        noiseFilter.frequency.value = 1000;\n        this.noise.connect(noiseFilter);\n        this.noiseEnvelope = this.context.createGain();\n        noiseFilter.connect(this.noiseEnvelope);\n        this.noiseEnvelope.connect(this.context.destination);\n        this.osc = this.context.createOscillator();\n        this.osc.type = 'triangle';\n        this.oscEnvelope = this.context.createGain();\n        this.osc.connect(this.oscEnvelope);\n        this.oscEnvelope.connect(this.context.destination);\n    };\n    ;\n    Snare.prototype.trigger = function (time) {\n        this.setup();\n        this.noiseEnvelope.gain.setValueAtTime(1, time);\n        this.noiseEnvelope.gain.exponentialRampToValueAtTime(0.01, time + 0.2);\n        this.noise.start(time);\n        this.osc.frequency.setValueAtTime(100, time);\n        this.oscEnvelope.gain.setValueAtTime(0.7, time);\n        this.oscEnvelope.gain.exponentialRampToValueAtTime(0.01, time + 0.1);\n        this.osc.start(time);\n        this.osc.stop(time + 0.2);\n        this.noise.stop(time + 0.2);\n    };\n    ;\n    return Snare;\n}());\nexports.Snare = Snare;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Instrument_1 = require(\"./Instrument\");\nvar Kick_1 = require(\"./Kick\");\nvar Snare_1 = require(\"./Snare\");\nvar PlasticDrums = /** @class */ (function (_super) {\n    __extends(PlasticDrums, _super);\n    function PlasticDrums(options) {\n        var _this = _super.call(this, options) || this;\n        _this.keys = [\n            new Kick_1.Kick(_this.context),\n            new Snare_1.Snare(_this.context)\n        ];\n        return _this;\n    }\n    PlasticDrums.prototype.playKeys = function (keys, _a) {\n        var _this = this;\n        var deadline = _a.deadline, gain = _a.gain, value = _a.value;\n        var sounds = keys.filter(function (key) { return !!_this.keys[key]; }).map(function (key) { return _this.keys[key]; });\n        if (sounds.length < keys.length) {\n            var missing = keys.filter(function (key) { return !_this.keys[key]; });\n            // console.warn('PlasticDrums missing keys:', missing);\n        }\n        sounds.forEach(function (sound) { return sound.trigger(deadline); });\n    };\n    return PlasticDrums;\n}(Instrument_1.Instrument));\nexports.PlasticDrums = PlasticDrums;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Improvisation = /** @class */ (function () {\n    function Improvisation(rules) {\n        this.rules = rules;\n        this.cache = {};\n    }\n    Improvisation.prototype.get = function (key, fromCache) {\n        if (fromCache === void 0) { fromCache = false; }\n        if (fromCache) {\n            return this.cache[key];\n        }\n        var rule = this.rules[key];\n        if (rule === undefined) {\n            console.error('could not resolve key', key, '!');\n        }\n        if (typeof rule === 'function') {\n            rule = rule(this.getRuleFactories(key));\n        }\n        this.cache[key] = rule;\n        return rule;\n    };\n    Improvisation.prototype.enhance = function (rules) {\n        return new Improvisation(Object.assign({}, this.rules, rules));\n    };\n    Improvisation.prototype.mutate = function (reducer) {\n        this.rules = Object.assign({}, this.rules, reducer(this.getRuleFactories()));\n        return this;\n    };\n    Improvisation.prototype.getRuleFactories = function (originKey) {\n        var _this = this;\n        return Object.keys(this.rules)\n            .map(function (key) { return ({ key: key, factory: function () { return _this.get(key); } }); })\n            .reduce(function (factories, _a) {\n            var key = _a.key, factory = _a.factory;\n            var _b, _c;\n            return (Object.assign({}, factories, (_b = {}, _b[key] = factory, _b), (originKey ? (_c = {}, _c[originKey] = function () { return _this.cache[originKey]; }, _c) : {})));\n        }, {});\n    };\n    return Improvisation;\n}());\nexports.Improvisation = Improvisation;\n/**\n *\n * methods: { [method: string]: ImprovisationRules } = {\n        guideTones: {\n            pattern: [3, 7]\n        },\n        flippedGuideTones: {\n            pattern: [3, 7],\n            flip: true,\n        },\n        chordTones: {\n            pattern: [1, 3, 7],\n            variance: .5,\n            variety: .5,\n            drill: .5,\n            flip: ({ drill }) => Math.random() * Math.abs(drill()) > .5,\n        }\n    }\n */ \n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar swing_1 = require(\"../grooves/swing\");\nvar tonal_1 = require(\"tonal\");\nvar util_1 = require(\"../util/util\");\nvar Improvisation_1 = require(\"./Improvisation\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nexports.permutator = new Improvisation_1.Improvisation({\n    groove: swing_1.swing,\n    groovePattern: function (_a) {\n        var groove = _a.groove;\n        return groove()['solo'] || (function (m) {\n            return m.measure.map(function () { return [1]; });\n        });\n    },\n    octave: 4,\n    reach: 1,\n    lineBreaks: false,\n    direction: null,\n    force: false,\n    flip: false,\n    playedNotes: [],\n    fixRange: true,\n    startRandom: false,\n    range: ['Bb3', 'Bb5'],\n    /* chanceCurve: () => (distance, length) => (length - distance) * 10, */\n    firstNoteInPattern: function (_a) {\n        var pattern = _a.pattern, chord = _a.chord;\n        return util_1.getPatternInChord([pattern()[0]], chord());\n    },\n    firstNote: function (_a) {\n        var randomNote = _a.randomNote, firstNoteInPattern = _a.firstNoteInPattern, startRandom = _a.startRandom, octave = _a.octave;\n        return startRandom() ? randomNote() : firstNoteInPattern() + octave();\n    },\n    lastNote: function (_a) {\n        var playedNotes = _a.playedNotes;\n        return playedNotes().length ? playedNotes()[0] : null;\n    },\n    material: function (_a) {\n        var pattern = _a.pattern, chord = _a.chord;\n        return util_1.getPatternInChord(pattern(), chord());\n    },\n    randomNote: function (_a) {\n        var material = _a.material, octave = _a.octave;\n        return util_1.randomElement(material()) + octave();\n    },\n    nextNotes: function (_a) {\n        var fixRange = _a.fixRange, firstNote = _a.firstNote, chord = _a.chord, reach = _a.reach, lineBreaks = _a.lineBreaks, lastNote = _a.lastNote, range = _a.range, material = _a.material, direction = _a.direction, force = _a.force, flip = _a.flip;\n        var note;\n        if (!lastNote() || lineBreaks()) {\n            note = firstNote();\n        }\n        else {\n            var choices = material();\n            if (!choices.length) {\n                console.warn('no choice..');\n                return;\n            }\n            var targets = Harmony_1.Harmony.getNearestTargets(lastNote(), material(), direction(), flip());\n            targets = targets.slice(0, reach());\n            note = util_1.randomElement(targets);\n            note = tonal_1.Note.simplify(note, true);\n        }\n        if (fixRange()) {\n            note = util_1.transposeToRange([note], range())[0];\n        }\n        var step = util_1.getStepInChord(note, chord());\n        /* console.log(`${step} in ${chord()} = ${note}`); */\n        return [note];\n    }\n});\n/** MODIFIERS */\nvar getStraightBar = function (notes, cycle) {\n    if (cycle === void 0) { cycle = 4; }\n    return new Array(cycle).fill(new Array(Math.ceil(notes / cycle)).fill(1));\n};\nvar straightNotes = function (n, cycle) {\n    if (cycle === void 0) { cycle = 4; }\n    return ({\n        groove: null,\n        groovePattern: function () { return (function (m) {\n            return getStraightBar(n, cycle);\n        }); },\n    });\n};\nvar fixedNotesPerChord = function (n, cycle) {\n    if (cycle === void 0) { cycle = 4; }\n    return ({\n        groove: null,\n        groovePattern: function () { return (function (m) { return m.measure.map(function () {\n            return getStraightBar(n, cycle);\n        }); }); },\n    });\n};\nvar pendulum = function (defaultDirection, softForce, comfort) {\n    if (defaultDirection === void 0) { defaultDirection = 'up'; }\n    if (softForce === void 0) { softForce = false; }\n    if (comfort === void 0) { comfort = .4; }\n    return ({\n        exclude: 1,\n        force: !softForce ? true : function (_a) {\n            var lastNote = _a.lastNote, range = _a.range;\n            var position = util_1.getRangePosition(lastNote(), range());\n            return position < 0 || position > 1; // only force if out of range..    \n        },\n        fixRange: false,\n        direction: function (_a) {\n            var lastNote = _a.lastNote, range = _a.range, direction = _a.direction, barNumber = _a.barNumber, isBarStart = _a.isBarStart;\n            var position = util_1.getRangePosition(lastNote(), range());\n            var comfortSwitchBars = 1; // switch direction each x bars when in comfort zone\n            var isComfortZone = (position > comfort && position < 1 - comfort);\n            if ((position <= 0 && direction() === 'down') ||\n                (position >= 1 && direction() === 'up') ||\n                (isComfortZone && isBarStart() && barNumber() % comfortSwitchBars === 0)) {\n                /* console.log('change direction', otherDirection(direction(), defaultDirection)); */\n                return util_1.otherDirection(direction(), defaultDirection);\n            }\n            return direction() || defaultDirection;\n        }\n    });\n};\nvar beatPattern = function (_a) {\n    var pattern = _a.pattern, on = _a.on, off = _a.off, barStart = _a.barStart;\n    return ({\n        beatPattern: function (_a) {\n            var isBarStart = _a.isBarStart, isOffbeat = _a.isOffbeat;\n            if (isBarStart()) {\n                return barStart || on || pattern;\n            }\n            else if (!isOffbeat()) {\n                return on || pattern;\n            }\n            return off || pattern;\n        },\n        pattern: function (_a) {\n            var beatPattern = _a.beatPattern;\n            return beatPattern();\n        },\n    });\n};\nvar notesPerChord = function (n) { return (__assign({}, fixedNotesPerChord(1, n))); };\nvar patternPractise = function (direction, notes, lineBreaks) {\n    if (direction === void 0) { direction = 'up'; }\n    if (notes === void 0) { notes = 4; }\n    if (lineBreaks === void 0) { lineBreaks = false; }\n    return (__assign({}, straightNotes(notes), { firstNoteInPattern: function (_a) {\n            var pattern = _a.pattern, chord = _a.chord;\n            return util_1.getPatternInChord(direction === 'up' ? [pattern()[0]] : pattern().slice(-1), chord());\n        }, direction: direction, force: true, fixRange: false, lineBreaks: function (_a) {\n            var isBarStart = _a.isBarStart;\n            return lineBreaks ? isBarStart() : false;\n        }, exclude: 1, reach: 1 }));\n};\n/** FORMULAS */\nexports.advancedPermutator = exports.permutator.enhance({\n    drill: .5,\n    direction: function (_a) {\n        var drill = _a.drill;\n        return drill() > 0 ? 'up' : 'down';\n    },\n    force: function (_a) {\n        var drill = _a.drill;\n        return Math.random() * Math.abs(drill()) > .5;\n    },\n    exclude: 1,\n    reach: 1,\n    material: function (_a) {\n        var pattern = _a.pattern, chord = _a.chord, playedNotes = _a.playedNotes, exclude = _a.exclude;\n        var all = util_1.getPatternInChord(pattern(), chord());\n        if (!playedNotes().length) {\n            return all;\n        }\n        var excludeNotes = playedNotes()\n            .slice(0, exclude())\n            .map(function (n) { return tonal_1.Note.pc(n); });\n        return all.filter(function (n) { return !excludeNotes.includes(n); });\n    }\n});\nexports.guideTones = exports.advancedPermutator.enhance(__assign({ name: 'Guide Lines' }, notesPerChord(1), pendulum('down', true), { pattern: [3, 7], exclude: 0 }));\nexports.guideTonesFlipped = exports.guideTones.enhance({\n    name: 'Distant Guide Tones',\n    flip: true\n});\nexports.chordTones = exports.advancedPermutator.enhance({\n    name: 'Only Chord Tones',\n    pattern: [1, 3, 5, 7],\n    drill: .75,\n    direction: function (_a) {\n        var drill = _a.drill;\n        return drill() > 0 ? 'up' : 'down';\n    },\n});\n/* export const digitalPattern = advancedPermutator.enhance({\n    pattern: ({ chord }) => getDigitalPattern(chord()),\n    ...pendulum(),\n    ...straightNotes(4)\n}); */\nexports.fullScale = exports.advancedPermutator.enhance(__assign({ name: 'Heptatonic' }, beatPattern({ on: [1, 3, 5, 7], off: [1, 2, 3, 4, 5, 6, 7] }), pendulum()));\nexports.scalePendulum = exports.advancedPermutator.enhance(__assign({ name: 'Heptatonic Pendulum' }, beatPattern({ pattern: [1, 2, 3, 4, 5, 6, 7] }), pendulum(), straightNotes(8)));\nexports.digitalPattern = exports.advancedPermutator.enhance(__assign({ name: 'Digital Patterns', pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }, pendulum('up', true, .2), { exclude: 2, reach: 3 }));\nexports.digitalPendulum = exports.advancedPermutator.enhance(__assign({ name: 'Digital Pendulum', pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }, pendulum('up', false, 1), straightNotes(8), { \n    /* lineBreaks: ({ isBarStart }) => isBarStart(), */\n    exclude: 1, reach: 1 }));\nexports.digitalWalker = exports.advancedPermutator.enhance(__assign({ name: 'Digital Fourths', pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }, pendulum('up', true, .4), straightNotes(4), { lineBreaks: false, \n    /* lineBreaks: ({ isBarStart }) => isBarStart(), */\n    exclude: 2, reach: 2 }));\nexports.digitalPractiseUp = exports.advancedPermutator.enhance(__assign({ name: 'Digital Practise Up' }, patternPractise('up', 4, true), { pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }));\nexports.digitalPractiseDown = exports.advancedPermutator.enhance(__assign({ name: 'Digital Practise Down' }, patternPractise('down', 4, true), { pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }));\nexports.heptatonicPractise = exports.advancedPermutator.enhance(__assign({ name: 'Heptatonic Practise' }, patternPractise('up', 8, false), beatPattern({ barStart: [1], on: [3, 5, 7], off: [1, 2, 3, 4, 5, 6, 7] })));\nexports.defaultMethod = exports.guideTones;\nexports.improvisationMethods = {\n    guideTones: exports.guideTones,\n    guideTonesFlipped: exports.guideTonesFlipped,\n    chordTones: exports.chordTones,\n    digitalPattern: exports.digitalPattern,\n    digitalPendulum: exports.digitalPendulum,\n    digitalWalker: exports.digitalWalker,\n    fullScale: exports.fullScale,\n    scalePendulum: exports.scalePendulum,\n    digitalPractiseUp: exports.digitalPractiseUp,\n    digitalPractiseDown: exports.digitalPractiseDown,\n};\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar swing_1 = require(\"../grooves/swing\");\nvar methods_1 = require(\"../improvisation/methods\");\nvar util_1 = require(\"../util/util\");\nvar Musician_1 = require(\"./Musician\");\nvar Improvisor = /** @class */ (function (_super) {\n    __extends(Improvisor, _super);\n    function Improvisor(instrument, method) {\n        var _this = _super.call(this, instrument) || this;\n        _this.name = 'Improvisor';\n        _this.defaultMethod = methods_1.defaultMethod;\n        method = method || _this.defaultMethod;\n        _this.method = method /* .enhance({\n            range: ['F3', 'F5']\n        }) */;\n        return _this;\n    }\n    Improvisor.prototype.useMethod = function (method) {\n        this.method = method;\n    };\n    Improvisor.prototype.play = function (_a) {\n        var _this = this;\n        var measures = _a.measures, pulse = _a.pulse, settings = _a.settings;\n        if (settings.method) {\n            this.useMethod(settings.method);\n        }\n        var groove = settings.groove || swing_1.swing;\n        this.method.mutate(function () { return ({ groove: groove, playedNotes: [] }); });\n        var pattern = this.method.get('groovePattern');\n        measures = measures\n            .map(function (measure) { return pattern({ measures: measures, measure: measure, settings: settings, pulse: pulse }); }\n        /*     .slice(0, Math.floor(settings.cycle)) */\n        )\n            .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); });\n        pulse.tickArray(measures, function (tick) {\n            _this.improvise(tick, measures, pulse);\n        }, settings.deadline);\n    };\n    Improvisor.prototype.improvise = function (_a, measures, pulse) {\n        var _this = this;\n        var value = _a.value, deadline = _a.deadline, interval = _a.interval;\n        var chord = value.chord;\n        if (chord === 'N.C.') {\n            return;\n        }\n        this.method.mutate(function () { return ({\n            chord: chord,\n            isFormStart: util_1.isFormStart(value.path),\n            isBarStart: util_1.isBarStart(value.path),\n            isOffbeat: util_1.isOffbeat(value.path),\n            // TODO: is ChordStart\n            barNumber: value.path[0]\n        }); })\n            .mutate(function (_a) {\n            var nextNotes = _a.nextNotes, playedNotes = _a.playedNotes;\n            var pick = nextNotes();\n            var duration = value.fraction * pulse.getMeasureLength();\n            _this.instrument.playNotes(pick, { deadline: deadline, interval: interval, gain: _this.getGain(), duration: duration, pulse: pulse });\n            return {\n                playedNotes: [].concat(pick, playedNotes())\n            };\n        });\n    };\n    return Improvisor;\n}(Musician_1.Musician));\nexports.default = Improvisor;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"./util/util\");\nvar Band_1 = __importDefault(require(\"./Band\"));\nvar Pianist_1 = __importDefault(require(\"./musicians/Pianist\"));\nvar Bassist_1 = __importDefault(require(\"./musicians/Bassist\"));\nvar Drummer_1 = __importDefault(require(\"./musicians/Drummer\"));\nvar PlasticDrums_1 = require(\"./instruments/PlasticDrums\");\nvar Improvisor_1 = __importDefault(require(\"./musicians/Improvisor\"));\nvar Trio = /** @class */ (function (_super) {\n    __extends(Trio, _super);\n    function Trio(_a) {\n        var context = _a.context, piano = _a.piano, bass = _a.bass, drums = _a.drums, onMeasure = _a.onMeasure, solo = _a.solo;\n        var _this = _super.call(this, { context: context, onMeasure: onMeasure }) || this;\n        var instruments = _this.setupInstruments({ piano: piano, bass: bass, drums: drums });\n        _this.pianist = new Pianist_1.default(instruments.piano);\n        _this.bassist = new Bassist_1.default(instruments.bass);\n        _this.drummer = new Drummer_1.default(instruments.drums);\n        _this.musicians = [_this.pianist, _this.bassist, _this.drummer];\n        if (solo) {\n            // this.soloist = new Permutator(instruments.piano);\n            _this.soloist = new Improvisor_1.default(instruments.piano);\n            _this.musicians.push(_this.soloist);\n        }\n        return _this;\n    }\n    Trio.prototype.setupInstruments = function (_a) {\n        var piano = _a.piano, bass = _a.bass, drums = _a.drums;\n        bass = bass || util_1.randomSynth(this.mix);\n        piano = piano || util_1.randomSynth(this.mix);\n        drums = drums || new PlasticDrums_1.PlasticDrums({ mix: this.mix });\n        return { piano: piano, bass: bass, drums: drums };\n    };\n    return Trio;\n}(Band_1.default));\nexports.Trio = Trio;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Measure_1 = require(\"./Measure\");\n// extension of https://github.com/daumling/ireal-renderer/blob/master/src/ireal-renderer.js\nvar RealParser = /** @class */ (function () {\n    function RealParser() {\n    }\n    RealParser.getChord = function (iRealChord) {\n        return iRealChord.note + iRealChord.modifiers + (iRealChord.over ? '/' + this.getChord(iRealChord.over) : '');\n    };\n    RealParser.parseSheet = function (raw) {\n        var tokens = RealParser.parse(raw);\n        console.log('tokensss!', tokens);\n        return RealParser.getSheet(tokens);\n    };\n    RealParser.getSheet = function (tokens) {\n        var _this = this;\n        var parsed = tokens\n            .reduce(function (current, token, index, array) {\n            var lastBarEnded = ['{', '|', '[', '||' /* 'Z',  */ /* , ']' */]\n                .includes(token.bars || token.token);\n            var signs = token.annots || [];\n            var repeatStart = (token.bars || token.token) === '{';\n            var repeatEnd = (token.bars || token.token) === '}';\n            if (repeatStart) {\n                signs.push('{');\n            }\n            if (repeatEnd) {\n                signs.push('}');\n            }\n            // current.measure ends\n            if (lastBarEnded) {\n                if (current.measure) {\n                    // simplify measure if no signs\n                    /* if (Object.keys(current.measure).find(k=>k)) {\n                        current.measure = current.measure.chords;\n                    } */\n                    current.measures.push(current.measure);\n                }\n                current.measure = { chords: [] };\n            }\n            var sectionStart = signs.find(function (a) { return a.match(/^\\*[a-zA-Z]/); });\n            if (sectionStart) {\n                signs = signs.filter(function (s) { return s !== sectionStart; });\n                current.measure.section = sectionStart.replace('*', '');\n            }\n            var hasCodaSign = signs.includes('Q');\n            if (hasCodaSign) {\n                signs = signs.filter(function (s) { return s !== 'Q'; });\n                var codaSign = 'ToCoda';\n                if (!!current.measures.find(function (m) { return Measure_1.Measure.hasSign('ToCoda', m); })) {\n                    codaSign = 'Coda';\n                }\n                current.measure.signs = (current.measure.signs || []).concat([codaSign]);\n            }\n            var houseStart = signs.find(function (s) { return !!s.match(/^N./); });\n            if (houseStart) {\n                signs = signs.filter(function (s) { return s !== houseStart; });\n                current.measure.house = parseInt(houseStart.replace('N', ''));\n            }\n            var time = signs.find(function (a) { return a.match(/^T\\d\\d/); });\n            if (time) {\n                signs = signs.filter(function (s) { return s !== time; });\n                current.measure.time = time.replace('T', '');\n            }\n            if (token.chord) {\n                current.measure.chords.push(_this.getChord(token.chord));\n            }\n            else if (token.token === 'n') {\n                current.measure.chords.push(0);\n            }\n            var last = current.measures[current.measures.length - 1];\n            if (last && last.chords[0] === 'r') {\n                last.chords = current.measures[current.measures.length - 3].chords;\n                current.measure.chords = current.measures[current.measures.length - 2].chords;\n            }\n            if (last && current.measure.chords[0] === 'x') {\n                current.measure.chords = [].concat(last.chords);\n                current.measure.idle = true;\n            }\n            if (signs.length) {\n                current.measure.signs = (current.measure.signs || [])\n                    .concat(signs);\n            }\n            if (token.comments.length) {\n                current.measure.comments = (current.measure.comments || [])\n                    .concat(token.comments.map(function (c) { return c.trim(); }));\n            }\n            return current;\n        }, { measure: null, signs: null, measures: [] });\n        if (parsed.measure.chords.length) {\n            parsed.measures.push(parsed.measure);\n        }\n        return parsed.measures;\n    };\n    RealParser.parse = function (raw) {\n        var text = raw;\n        var arr = [], headers = [], comments = [];\n        var i;\n        text = text.trim();\n        // text = text.trimRight();\n        while (text) {\n            var found = false;\n            for (i = 0; i < RealParser.regExps.length; i++) {\n                var match = RealParser.regExps[i].exec(text);\n                if (match) {\n                    found = true;\n                    if (match.length <= 2) {\n                        var replacement = match[0];\n                        var repl = RealParser.replacements[replacement];\n                        arr = arr.concat(repl ? repl : [replacement]);\n                        text = text.substr(replacement.length);\n                    }\n                    else { // a chord\n                        arr.push(match);\n                        text = text.substr(match[0].length);\n                    }\n                    break;\n                }\n            }\n            if (!found) {\n                // ignore the comma separator\n                if (text[0] !== ',')\n                    arr.push(text[0]);\n                text = text.substr(1);\n            }\n        }\n        //\t\tconsole.log(arr);\n        // pass 2: extract prefixes, suffixes, annotations and comments\n        var out = [];\n        var obj = RealParser.newToken(out);\n        for (i = 0; i < arr.length; i++) {\n            var token = arr[i];\n            if (token instanceof Array) {\n                obj.chord = RealParser.parseChord(token);\n                token = \" \";\n            }\n            switch (token[0]) {\n                case ',':\n                    token = null;\n                    break; // separator\n                case 'S': // segno\n                case 'T': // time measurement\n                case 'Q': // coda\n                case 'N': // repeat\n                case 'U': // END\n                case 's': // small\n                case 'l': // normal\n                case 'f': // fermata\n                case '*':\n                    obj.annots.push(token);\n                    token = null;\n                    break;\n                case 'Y':\n                    obj.spacer++;\n                    token = null;\n                    break;\n                case 'r':\n                case 'x':\n                case 'W':\n                    obj.chord = new iRealChord(token, \"\", null, null);\n                    break;\n                case '<':\n                    token = token.substr(1, token.length - 2);\n                    token = token.replace(/XyQ/g, \"   \"); // weird; needs to be done\n                    obj.comments.push(token);\n                    token = null;\n                    break;\n                default:\n            }\n            if (token) {\n                if (\"]}Z\".indexOf(arr[i + 1]) >= 0)\n                    obj.bars += arr[++i];\n                if (\"{[|\".indexOf(token) >= 0) {\n                    obj.bars += token;\n                    token = null;\n                }\n            }\n            if (token && i < arr.length - 1) {\n                obj.token = token;\n                obj = RealParser.newToken(out);\n            }\n        }\n        return out;\n    };\n    RealParser.parseChord = function (match) {\n        var note = match[1] || \" \";\n        var modifiers = match[2] || \"\";\n        var comment = match[3] || \"\";\n        if (comment)\n            modifiers += comment.substr(1, comment.length - 2).replace(\"XyQ\", \"   \");\n        var over = match[4] || \"\";\n        if (over[0] === '/')\n            over = over.substr(1);\n        var alternate = match[5] || null;\n        if (alternate) {\n            match = RealParser.chordRegex.exec(alternate.substr(1, alternate.length - 2));\n            if (!match)\n                alternate = null;\n            else\n                alternate = this.parseChord(match);\n        }\n        // empty cell?\n        if (note === \" \" && !alternate && !over)\n            return null;\n        if (over) {\n            var offset = (over[1] === '#' || over[1] === 'b') ? 2 : 1;\n            over = new iRealChord(over.substr(0, offset), over.substr(offset), null, null);\n        }\n        else\n            over = null;\n        return new iRealChord(note, modifiers, over, alternate);\n    };\n    RealParser.newToken = function (arr) {\n        var obj = new iRealToken;\n        arr.push(obj);\n        return obj;\n    };\n    /**\n     * The RegExp for a complete chord. The match array contains:\n     * 1 - the base note\n     * 2 - the modifiers (+-ohd0123456789 and su for sus)\n     * 3 - any comments (may be e.g. add, sub, or private stuff)\n     * 4 - the \"over\" part starting with a slash\n     * 5 - the top chord as (chord)\n     * @type RegExp\n     */\n    RealParser.chordRegex = /^([ A-GW][b#]?)((?:sus|[\\+\\-\\^\\dhob#])*)(\\*.+?\\*)*(\\/[A-G][#b]?)?(\\(.*?\\))?/;\n    RealParser.regExps = [\n        /^\\*[a-zA-Z]/,\n        /^T\\d\\d/,\n        /^N./,\n        /^<.*?>/,\n        /^ \\(.*?\\)/,\n        RealParser.chordRegex,\n        /^LZ/,\n        /^XyQ/,\n        /^Kcl/ // repeat last bar\n    ];\n    RealParser.replacements = {\n        \"LZ\": [\" \", \"|\"],\n        \"XyQ\": [\" \", \" \", \" \"],\n        \"Kcl\": [\"|\", \"x\", \" \"]\n    };\n    return RealParser;\n}());\nexports.RealParser = RealParser;\nvar iRealChord = /** @class */ (function () {\n    function iRealChord(note, modifiers, over, alternate) {\n        this.note = note;\n        this.modifiers = modifiers;\n        this.over = over;\n        this.alternate = alternate;\n    }\n    return iRealChord;\n}());\nvar iRealToken = /** @class */ (function () {\n    function iRealToken() {\n        this.annots = [];\n        this.comments = [];\n        this.bars = \"\";\n        this.spacer = 0;\n        this.chord = null;\n    }\n    return iRealToken;\n}());\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Instrument_1 = require(\"./Instrument\");\nvar MidiOut = /** @class */ (function (_super) {\n    __extends(MidiOut, _super);\n    function MidiOut(props) {\n        var _this = _super.call(this, props) || this;\n        _this.gain = 0.9;\n        _this.output = 'Scarlett 6i6 USB';\n        _this.gain = props.gain || _this.gain;\n        if (!navigator['requestMIDIAccess']) {\n            console.warn('This browser does not support WebMIDI!');\n            return _this;\n        }\n        navigator['requestMIDIAccess']().then(function (midi) { return _this.midiInit(midi); }, _this.midiFail);\n        return _this;\n    }\n    MidiOut.prototype.midiInit = function (midi) {\n        var _this = this;\n        console.log('midi init', midi);\n        console.log(midi.outputs.size, 'outputs');\n        console.log(midi.inputs.size, 'inputs');\n        this.midi = midi;\n        midi.outputs.forEach(function (output) {\n            console.log('ouput', output);\n        });\n        midi.inputs.forEach(function (input) {\n            console.log('input', input);\n            input.onmidimessage = _this.getMidiMessage;\n        });\n        this.onTrigger = function (_a) {\n            var on = _a.on, off = _a.off;\n            on.forEach(function (_a) {\n                var midi = _a.midi, gain = _a.gain, deadline = _a.deadline;\n                _this.noteOn(midi, Math.round(gain * 127), deadline);\n            });\n            off.forEach(function (event) {\n                _this.noteOff(event.midi, Math.round(event.gain * 127));\n            });\n        };\n    };\n    MidiOut.prototype.midiFail = function () {\n        console.warn('could not get midi access!');\n    };\n    MidiOut.prototype.getMidiMessage = function (message) {\n        console.log('midi data', message.data, 'message', message);\n    };\n    MidiOut.prototype.send = function (message, deadline) {\n        var _this = this;\n        if (!this.midi) {\n            console.warn('tried to play keys but midi was not ready');\n            return;\n        }\n        console.log('send', message, deadline);\n        this.midi.outputs.forEach(function (output) {\n            if (true || output.name === _this.output) {\n                output.send(message);\n            }\n        });\n    };\n    MidiOut.prototype.noteOn = function (key, velocity, deadline) {\n        if (velocity === void 0) { velocity = 127; }\n        if (deadline === void 0) { deadline = 0; }\n        this.send([144, key, 0x7f], deadline); //velocity\n    };\n    MidiOut.prototype.noteOff = function (key, velocity, deadline) {\n        if (velocity === void 0) { velocity = 127; }\n        if (deadline === void 0) { deadline = 0; }\n        this.send([144, key, 0], deadline); //velocity\n    };\n    MidiOut.prototype.playKeys = function (keys, settings) {\n        if (settings === void 0) { settings = {}; }\n        /* if (!this.midi) {\n            console.warn('tried to play keys but midi was not ready');\n            return;\n        }\n        this.midi.outputs.forEach(output => {\n            console.log(keys, 'send to', output);\n            keys.forEach(key => {\n                output.send([144, key, 9]);\n            })\n        });\n    } */\n    };\n    return MidiOut;\n}(Instrument_1.Instrument));\nexports.MidiOut = MidiOut;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nvar Musician_1 = require(\"./Musician\");\nvar swing_1 = require(\"../grooves/swing\");\nvar Permutator = /** @class */ (function (_super) {\n    __extends(Permutator, _super);\n    function Permutator(instrument) {\n        var _this = _super.call(this, instrument) || this;\n        _this.defaults = { groove: swing_1.swing };\n        _this.playedChords = [];\n        return _this;\n    }\n    Permutator.prototype.play = function (_a) {\n        var _this = this;\n        var measures = _a.measures, pulse = _a.pulse, settings = _a.settings;\n        var groove = settings.groove || this.defaults.groove;\n        var pattern = groove['solo'] || (function (m) {\n            return m.measure.map(function (c) { return [1, 1, 1, 1]; });\n        }); // dont changes anything\n        measures = measures\n            .map(function (measure) { return pattern({ measures: measures, measure: measure, settings: settings, pulse: pulse }).slice(0, Math.floor(settings.cycle)); })\n            .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); });\n        pulse.tickArray(measures, function (tick) {\n            _this.playPermutations(tick, measures, pulse);\n        }, settings.deadline);\n    };\n    Permutator.prototype.playPermutations = function (_a, measures, pulse) {\n        var value = _a.value, cycle = _a.cycle, path = _a.path, deadline = _a.deadline, interval = _a.interval;\n        var chord = value.chord;\n        if (chord === 'N.C.') {\n            return;\n        }\n        if (chord === 'x') {\n            chord = this.playedChords[this.playedChords.length - 1];\n        }\n        if (!chord || chord === '0') {\n            this.playedChords.push('');\n            return;\n        }\n        this.playedChords.push(chord);\n        // digital patterns\n        var notes = util_1.renderDigitalPattern(chord);\n        var note = util_1.randomElement(notes) + '5';\n        // all scale notes with different chances\n        /* const notes = getPatternInChord([1, 2, 3, 4, 5, 6, 7], chord);\n        const note = randomElement(notes, [4, 3, 6, 1, 3, 4, 6]) + '5'; */\n        /* console.log('beat (starting from zero)', path[1]); */\n        var duration = value.fraction * pulse.getMeasureLength();\n        /* deadline += randomDelay(10); */\n        this.instrument.playNotes([note], { deadline: deadline, interval: interval, gain: 1, duration: duration, pulse: pulse });\n    };\n    return Permutator;\n}(Musician_1.Musician));\nexports.default = Permutator;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Band_1 = __importDefault(require(\"./Band\"));\nexports.Band = Band_1.default;\nvar Pianist_1 = __importDefault(require(\"./musicians/Pianist\"));\nexports.Pianist = Pianist_1.default;\nvar Drummer_1 = __importDefault(require(\"./musicians/Drummer\"));\nexports.Drummer = Drummer_1.default;\nvar Bassist_1 = __importDefault(require(\"./musicians/Bassist\"));\nexports.Bassist = Bassist_1.default;\nvar Instrument_1 = require(\"./instruments/Instrument\");\nexports.Instrument = Instrument_1.Instrument;\nvar Musician_1 = require(\"./musicians/Musician\");\nexports.Musician = Musician_1.Musician;\nvar Synthesizer_1 = require(\"./instruments/Synthesizer\");\nexports.Synthesizer = Synthesizer_1.Synthesizer;\nvar Sampler_1 = require(\"./instruments/Sampler\");\nexports.Sampler = Sampler_1.Sampler;\nvar PlasticDrums_1 = require(\"./instruments/PlasticDrums\");\nexports.PlasticDrums = PlasticDrums_1.PlasticDrums;\nvar Trio_1 = require(\"./Trio\");\nexports.Trio = Trio_1.Trio;\nvar util = __importStar(require(\"./util/util\"));\nexports.util = util;\nvar Pulse_1 = require(\"./Pulse\");\nexports.Pulse = Pulse_1.Pulse;\nvar RealParser_1 = require(\"./sheet/RealParser\");\nexports.RealParser = RealParser_1.RealParser;\nvar MidiOut_1 = require(\"./instruments/MidiOut\");\nexports.MidiOut = MidiOut_1.MidiOut;\nvar Permutator_1 = __importDefault(require(\"./musicians/Permutator\"));\nexports.Permutator = Permutator_1.default;\nvar Voicing_1 = require(\"./harmony/Voicing\");\nexports.Voicing = Voicing_1.Voicing;\nvar Permutation_1 = require(\"./util/Permutation\");\nexports.Permutation = Permutation_1.Permutation;\n","import { Note } from 'tonal';\nimport { Chord } from 'tonal';\nimport { Interval } from 'tonal';\nimport { Distance } from 'tonal';\n\nexport declare type intervalDirection = 'up' | 'down';\nexport declare type step = string | number;\n\nexport class Harmony {\n    static isBlack(note) {\n        return Note.props(note)['acc'] !== '';\n    }\n\n    static isSameNote(noteA, noteB) {\n        return Note.midi(noteA) === Note.midi(noteB);\n    }\n\n    static getTonalChord(chord: string) {\n        if (!chord) {\n            return null;\n        }\n        chord = chord\n            .replace(/([A-G][b|#]?)(69)/, '$1M69')\n            .replace('-', 'm')\n            .replace('^', 'M')\n            .replace('h7', 'm7b5')\n            .replace('h', 'dim');\n        /**\n         * Chords that dont work:\n         * slash cords are ignored\n         * 7b9b5 does not work\n         * \n         */\n        const tokens = Chord.tokenize(chord);\n        const s = tokens[1].split('/');\n        return tokens[0] + (s[0] || 'M');\n    }\n\n    static getBassNote(chord: string) {\n        if (!chord) {\n            return null;\n        }\n        if (chord.includes('/')) {\n            return chord.split('/')[1];\n        }\n        return chord.match((/[A-G][b|#]?/))[0];\n    }\n\n\n    static getMidi(note, offset = 0) {\n        return Note.midi(note) - offset;\n    }\n\n\n    static intervalComplement(interval) {\n        const fix = {\n            '8P': '1P',\n            '8d': '1A',\n            '8A': '1d',\n            '1A': '8d',\n            '1d': '8A',\n        }\n        const fixIndex = Object.keys(fix).find(key => interval.match(key));\n        if (fixIndex) {\n            return fix[fixIndex];\n        }\n\n        return Interval.invert(interval);\n    }\n\n    static invertInterval(interval) {\n        if (!interval) {\n            return null;\n        }\n        const positive = interval.replace('-', '');\n        const complement = Harmony.intervalComplement(positive);\n        const isNegative = interval.length > positive.length;\n        return (isNegative ? '' : '-') + complement;\n    }\n\n    /** Transforms interval into one octave (octave+ get octaved down) */\n    static fixInterval(interval = '', simplify = false) {\n        let fix: { [key: string]: string } = {\n            '0A': '1P',\n            '-0A': '1P',\n            /*  */\n        }\n        if (simplify) {\n            fix = {\n                ...fix,\n                '8P': '1P',\n                '-8P': '1P',\n                /* '-1A': '-2m',\n                '1A': '2m',\n                '8d': '7M',\n                '-8d': '-7M', */\n            }\n            interval = Interval.simplify(interval);\n        }\n        if (Object.keys(fix).includes(interval)) {\n            return fix[interval];\n        }\n        return interval;\n    }\n\n    /** inverts the interval if it does not go to the desired direction */\n    static forceDirection(interval, direction: intervalDirection, noUnison = false) {\n        const semitones = Interval.semitones(interval);\n        if ((direction === 'up' && semitones < 0) ||\n            (direction === 'down' && semitones > 0)) {\n            return Harmony.invertInterval(interval);\n        }\n        if (interval === '1P' && noUnison) {\n            return (direction === 'down' ? '-' : '') + '8P';\n        }\n        return interval;\n    }\n\n    // use Interval.ic?\n    static minInterval(interval, direction?: intervalDirection, noUnison?) {\n        interval = Harmony.fixInterval(interval, true);\n        if (direction) {\n            return Harmony.forceDirection(interval, direction, noUnison)\n        }\n        let inversion = Harmony.invertInterval(interval);\n        if (Math.abs(Interval.semitones(inversion)) < Math.abs(Interval.semitones(interval))) {\n            interval = inversion;\n        }\n        return interval;\n    }\n\n    // returns array of intervals that lead the voices of chord A to chordB\n    static minIntervals(chordA, chordB) {\n        return chordA.map((n, i) => Harmony.minInterval(Distance.interval(n, chordB[i])));\n    }\n\n    static mapMinInterval(direction?: intervalDirection) {\n        return (interval) => Harmony.minInterval(interval, direction);\n    }\n\n    // sort function\n    static sortMinInterval(preferredDirection: intervalDirection = 'up', accessor = (i => i)) {\n        return (a, b) => {\n            const diff = Math.abs(Interval.semitones(accessor(a))) - Math.abs(Interval.semitones(accessor(b)));\n            if (diff === 0) {\n                return preferredDirection === 'up' ? -1 : 1;\n            }\n            return diff;\n        }\n    }\n\n    /** Returns the note with the least distance to \"from\" */\n    static getNearestNote(from, to, direction?: intervalDirection) {\n        let interval = Harmony.minInterval(Distance.interval(Note.pc(from), Note.pc(to)), direction);\n        return Distance.transpose(from, interval) + '';\n    }\n\n    /** Returns the note with the least distance to \"from\". TODO: add range */\n    static getNearestTargets(from, targets, preferredDirection: intervalDirection = 'down', flip = false) {\n        let intervals = targets\n            .map((target) => Distance.interval(Note.pc(from), target))\n            .map(Harmony.mapMinInterval(preferredDirection))\n            .sort(Harmony.sortMinInterval(preferredDirection))\n        /* if (flip) {\n            intervals = intervals.reverse();\n        } */\n        return intervals.map(i => Distance.transpose(from, i));\n    }\n\n    static intervalMatrix(from, to) {\n        return to.map(note => from\n            .map(n => {\n                return Distance.interval(n, note)\n            })\n            .map(d => Harmony.minInterval(d))\n            /* .map(i => i.slice(0, 2) === '--' ? i.slice(1) : i) */\n        )\n    }\n\n}","import { Pulse } from \"../Pulse\";\nimport { Harmony } from '../harmony/Harmony';\n\nexport interface NoteEvent {\n    note: string;\n    midi?: number;\n    gain?: number;\n    off?: number;\n    deadline?: number;\n}\n\nexport class Instrument {\n    midiOffset = 0;\n    onTrigger: (events: { on: NoteEvent[], off: NoteEvent[], active: NoteEvent[] }) => any;\n    ready: Promise<any>;\n    gain = 1;\n\n    activeEvents = [];\n    context: any;\n    mix: any;\n    constructor({ context, gain, mix, onTrigger, midiOffset }: any = {}) {\n        this.onTrigger = onTrigger;\n        this.midiOffset = midiOffset || this.midiOffset;\n        this.gain = gain || this.gain;\n        this.init({ context, mix });\n    }\n\n    init({ context, mix }) {\n        if (!context && (!mix || !mix.context)) {\n            console.warn(`you should pass a context or a mix (gainNode) to a new Instrument. \n            You can also Call init with {context,mix} to setup the Instrument later`);\n            return;\n        }\n        this.context = context || mix.context;\n        this.mix = mix || this.context.destination;\n    }\n\n    playNotes(notes: string[], settings: any = {}) {\n        const deadline = (settings.deadline || this.context.currentTime);\n        settings = Object.assign({\n            duration: 2000,\n            gain: 1,\n        }, settings, { deadline });\n        if (settings.interval) {\n            // call recursively with single notes at interval\n            return notes.map((note, index) => {\n                this.playNotes([note], Object.assign({}, settings, {\n                    interval: 0,\n                    deadline: deadline + index * settings.interval\n                }))\n            });\n        }\n        const midi = notes.map(note => Harmony.getMidi(note, this.midiOffset));\n        const noteOff = settings.deadline + settings.duration / 1000;\n\n        const notesOn = notes.map((note, index) => ({\n            note,\n            midi: midi[index],\n            gain: settings.gain,\n            noteOff,\n            deadline: settings.deadline\n        }));\n\n        if (settings.pulse && this.onTrigger) {\n            settings.pulse.clock.callbackAtTime((deadline) => {\n                this.activeEvents = this.activeEvents.concat(notesOn);\n                this.onTrigger({ on: notesOn, off: [], active: this.activeEvents });\n            }, settings.deadline);\n        }\n        if (settings.duration && settings.pulse) {\n            settings.pulse.clock.callbackAtTime((deadline) => {\n                // find out which notes need to be deactivated\n                const notesOff = notes\n                    .filter(note => !this.activeEvents\n                        .find(event => {\n                            const keep = note === event.note && event.noteOff > deadline;\n                            if (keep) {\n                                console.log('keep', note);\n                            }\n                            return keep;\n                        })).map(note => this.activeEvents.find(e => e.note === note));\n\n                this.activeEvents = this.activeEvents\n                    .filter(e => !notesOff.includes(e));\n\n                if (this.onTrigger) {\n                    this.onTrigger({ on: [], off: notesOff, active: this.activeEvents });\n                }\n            }, noteOff);\n        }\n        return this.playKeys(midi, settings);\n    }\n\n    playKeys(keys: number[], settings?) {\n        // TODO: fire callbacks after keys.map((key,i)=>i*settings.interval)?\n    }\n}","import { Instrument } from './Instrument';\nimport { Note } from 'tonal';\nimport { adsr } from '../util/util';\n\nexport class Synthesizer extends Instrument {\n    duration = 200;\n    type = 'sine';\n    gain = 0.9;\n    attack = .05;\n    decay = .05;\n    sustain = .4;\n    release = .1;\n\n    constructor(props: any) {\n        super(props);\n        this.duration = props.duration || this.duration;\n        this.type = props.type || this.type;\n        this.gain = props.gain || this.gain;\n    }\n\n    getVoice(type = 'sine', gain = 0, key) {\n        const frequency = Note.freq(key);\n        const oscNode = this.context.createOscillator();\n        oscNode.type = type;\n        const gainNode = this.context.createGain();\n        oscNode.connect(gainNode);\n        gainNode.gain.value = typeof gain === 'number' ? gain : 0.8;\n        gainNode.connect(this.mix);\n        oscNode.frequency.value = frequency;\n        return { oscNode, gainNode, key, frequency };\n    }\n\n    lowestGain(a, b) {\n        return a.gain.gain.value < b.gain.gain.value ? -1 : 0;\n    }\n\n    startKeys(keys: number[], settings: any = {}) {\n\n    }\n\n    playKeys(keys: number[], settings: any = {}) {\n        super.playKeys(keys, settings); // fires callback   \n        //const time = this.context.currentTime + settings.deadline / 1000;\n        const time = settings.deadline || this.context.currentTime;\n        const interval = settings.interval || 0;\n        return keys.map((key, i) => {\n            const delay = i * interval;\n            const [endless, attack, decay, sustain, release, duration, gain] =\n                [\n                    settings.endless,\n                    settings.attack || this.attack,\n                    settings.decay || this.decay,\n                    settings.sustain || this.sustain,\n                    settings.release || this.release,\n                    (settings.duration || this.duration) / 1000,\n                    (settings.gain || 1) * this.gain\n                ]\n            const voice = this.getVoice(this.type, 0, key);\n            adsr({ attack, decay, sustain, release, gain, duration, endless }, time + delay, voice.gainNode.gain);\n            voice.oscNode.start(settings.deadline + delay);\n            return voice;\n        });\n    }\n\n    stopVoice(voice, settings: any = {}) {\n        if (!voice) {\n            return;\n        }\n        const time = settings.deadline || this.context.currentTime;\n        voice.gainNode.gain.setTargetAtTime(0, time, settings.release || this.release);\n        //voice.oscNode.stop()\n    }\n\n    stopVoices(voices, settings) {\n        voices.forEach(voice => {\n            this.stopVoice(voice, settings);\n        });\n    }\n}","import * as Chord from 'tonal-chord';\nimport * as Scale from 'tonal-scale';\n\nexport const chords = [\n    {\n        symbol: 'm',\n        long: 'minor',\n        short: '-',\n        groups: ['Basic', 'Triads']\n    },\n    {\n        symbol: 'M',\n        long: 'major',\n        short: '△',\n        groups: ['Basic', 'Triads']\n    },\n    {\n        symbol: 'o',\n        groups: ['Basic', 'Symmetric', 'Triads'],\n        long: 'Vermindert'\n        /* short: 'o' */\n    },\n    {\n        symbol: 'M#5', // = Mb6\n        groups: ['Advanced', 'Symmetric', 'Triads'],\n        short: '△#5'\n    },\n    {\n        symbol: 'Msus4',\n        groups: ['Advanced', 'Symmetric'],\n        short: 'sus4'\n    },\n    {\n        symbol: 'Msus2',\n        groups: ['Advanced', 'Symmetric'],\n        short: 'sus2'\n    },\n    // 5 4 64 m#5 Mb5  7no5  \n    {\n        symbol: '7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Dominantsept'\n    },\n    {\n        symbol: '7#11',\n        groups: ['Advanced', 'Diatonic', 'Modes'],\n        long: 'Dominant #11'\n    },\n    {\n        symbol: 'M6',\n        groups: ['Advanced'],\n        long: 'major 6',\n        short: '6'\n    },\n    {\n        symbol: 'o7',\n        groups: ['Advanced', 'Symmetric', 'Diatonic'], // HM 7 chord\n        long: 'Vermindert 7',\n    },\n    {\n        symbol: 'm7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'minor 7',\n        short: '-7'\n    },\n    {\n        symbol: 'oM7',\n        groups: ['Expert'],\n        long: 'diminished major 7',\n        short: 'o△7'\n    },\n    {\n        symbol: 'm7b5',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Halbvermindert',\n        short: '-7b5'\n    },\n    {\n        symbol: '7#5',\n        groups: ['Advanced', 'Symmetric'],\n        long: 'Dominantsept #5'\n    },\n    {\n        symbol: 'Maj7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Major 7',\n        short: '△7'\n    },\n    {\n        symbol: 'mMaj7',\n        short: '-△7',\n        groups: ['Advanced', 'Diatonic']\n    },\n    {\n        symbol: 'M7#5',\n        groups: ['Advanced', 'Diatonic'],\n        short: '△7#5'\n    },\n    {\n        symbol: '7sus4',\n        groups: ['Advanced'],\n    },\n    {\n        symbol: '9',\n        groups: ['Advanced'],\n    },\n    {\n        symbol: 'M9',\n        groups: ['Advanced'],\n        short: '△9'\n    },\n    {\n        symbol: 'M69',\n        groups: ['Advanced'],\n        short: '69'\n    }\n    /*\n7b13 M7b5 m7#5 9no5  M7b6 7b5 Madd9 mb6b9 mb6M7 madd4 sus24 madd9 Maddb9 +add#9 M7sus4 7#5sus4 M#5add9 M7#5sus4\n11 m9 m6 9#5 7b9 7#9 M69 9b5 m69 mM9 7b6 m9b5 m9#5 7#11 M7b9 9b13 o7M7 M9b5 11b9 M9#5 7add6 M6#11 M7#11 7#5#9 13no5 9sus4 7#5b9 M9sus4 7sus4b9 m7add11 mMaj7b6 M9#5sus4\n13 m11 M13 9#11 13#9 13b5 13b9 m11b5 7b9#9 mM9b6 M9#11 9#5#11 7#9b13 7b9b13 13sus4 m11A 5 7#9#11 7b9#11 M69#11 7#11b13 M7#9#11 M7add13 7#5b9#11 7sus4b9b13\nm13 13#11 M13#11 13b9#11 9#11b13 13#9#11 7b9b13#11 7#9#11b13\n    */\n];\n\nexport const scales = [\n    {\n        symbol: 'major pentatonic',\n        groups: ['Basic', 'Pentatonic'],\n    },\n    {\n        symbol: 'minor pentatonic',\n        groups: ['Basic', 'Pentatonic'],\n    },\n    {\n        symbol: 'minor blues',\n        groups: ['Basic'],\n    },\n    // gregorian modes\n    {\n        symbol: 'major',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'dorian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'phrygian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'lydian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'mixolydian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'aeolian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'locrian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'whole tone',\n        groups: ['Advanced', 'Symmetric']\n    },\n    {\n        symbol: 'diminished',\n        groups: ['Advanced', 'Symmetric']\n    },\n    //HTGT ?\n    {\n        symbol: 'augmented',\n        groups: ['Advanced', 'Symmetric']\n    },\n    {\n        symbol: 'chromatic',\n        groups: ['Expert', 'Symmetric']\n    },\n    // harmonic minor modes\n    {\n        symbol: 'harmonic minor', // HM 1\n        groups: ['Advanced', 'Diatonic']\n    },\n    // HM 2 locrian #6 !\n    {\n        symbol: 'ionian augmented', // HM 3\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'dorian #4', // HM 4\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'spanish', // HM 5\n        groups: ['Advanced', 'Diatonic']\n    },\n    // HM 6 lydian #9\n    // HM 7 ???\n\n    // melodic minor modes\n    {\n        symbol: 'melodic minor', // MM 1\n        groups: ['Advanced', 'Diatonic']\n    },\n    {\n        symbol: 'melodic minor second mode', // MM 2\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'lydian augmented', // MM 3\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'lydian dominant', // MM 4\n        groups: ['Advanced', 'Diatonic'],\n        long: 'mixolydian #11'\n    },\n    {\n        symbol: 'melodic minor fifth mode', // MM 5\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'locrian #2', // MM 6\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'altered', // MM 7\n        groups: ['Advanced', 'Diatonic']\n    },\n    //non european\n    {\n        symbol: 'kumoijoshi',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'iwato',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'pelog',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    // hyojo?\n    {\n        symbol: 'egyptian',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'in-sen',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'scriabin',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'ritusen',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'hirajoshi',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'malkos raga',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'vietnamese 1',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    /* {\n        symbol: 'vietnamese 2',\n        groups: ['Exotic', 'Pentatonic'] // = minor pentatonic\n    }, */\n    {\n        symbol: 'lydian pentatonic', // = China (Sikora S. 61)\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'mixolydian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'ionian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'locrian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'flat six pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'minor six pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'minor #7M pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'lydian #5P pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'whole tone pentatonic',\n        groups: ['Pentatonic', 'Symmetric']\n    },\n    {\n        symbol: 'flat three pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'super locrian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'major flat two pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'lydian dominant pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'neopolitan major pentatonic',\n        groups: ['Pentatonic']\n    }\n\n    /*            \n    mystery #1 piongio    prometheus major blues minor hexatonic six tone symmetric prometheus neopolitan\n     persian  spanish  oriental flamenco balinese   todi raga enigmatic lydian #9 neopolitan locrian #2  lydian minor  locrian major  romanian minor harmonic major hungarian major hungarian minor lydian dominant   neopolitan minor neopolitan major lydian diminished leading whole tone augmented heptatonic double harmonic major double harmonic lydian melodic minor fifth mode melodic minor second mode\n    bebop kafi raga  purvi raga ichikosucho bebop minor minor bebop bebop major bebop locrian bebop dominant spanish heptatonic minor six diminished\n    composite blues\n    */\n];\n\nexport const symbols = { chords, scales };\n\nexport const levels = ['Basic', 'Advanced', 'Expert'];\n\nexport function groupFilter(group) {\n    return (item) => {\n        const level = Math.max(item.groups.filter(group => levels.indexOf(group) !== -1)\n            .map(group => levels.indexOf(group) + 1));\n        const groups = level > 0 ? Array.from(new Set(levels.slice(level).concat(item.groups))) : item.groups;\n        return groups.indexOf(group) !== -1;\n    };\n}\n\nexport function scaleNames(group = 'Basic') {\n    if (!group || group === 'All') {\n        return Scale.names();\n    }\n    return scales.filter(groupFilter(group))\n        .map(scale => scale.symbol);\n}\nexport function chordNames(group = 'Basic') {\n    if (!group || group === 'All') {\n        return Chord.names();\n    }\n    return chords.filter(groupFilter(group))\n        .map(scale => scale.symbol);\n}\n\nexport function groupNames() {\n    return Array.from(new Set(levels.concat(scales.concat(chords)\n        .map(item => item.groups)\n        .reduce((groups, current) => groups.concat(current))))).concat(['All']);\n}\n\nexport function symbolName(type, symbol, long) {\n    const pool = symbols[type + 's'];\n    const match = pool.find(item => item.symbol === symbol);\n    if (!match) {\n        return symbol;\n    }\n    /* return symbol; */\n    return (long ? match.long : match.short) || symbol;\n}\n\nexport function scaleName(symbol, long = false) {\n    return symbolName('scale', symbol, long);\n}\n\nexport function chordName(symbol, long = false) {\n    return symbolName('chord', symbol, long);\n}\n\nexport function randomItem(array) {\n    return array[Math.floor(Math.random() * array.length)];\n}\n\nexport function randomScale(group) {\n    return randomItem(scaleNames(group));\n}\n\nexport function randomChord(group) {\n    return randomItem(chordNames(group));\n}","import { Chord, Distance, Interval, Note, PcSet, Scale } from 'tonal';\nimport { Synthesizer } from '../instruments/Synthesizer';\nimport { scaleNames } from '../symbols';\nimport { Harmony, step, intervalDirection } from '../harmony/Harmony';\n\nconst steps = {\n    '1P': ['1', '8'],\n    '2m': ['b9', 'b2'],\n    '2M': ['9', '2',],\n    '2A': ['#9', '#2'],\n    '3m': ['b3'],\n    '3M': ['3'],\n    '4P': ['11', '4'],\n    '4A': ['#11', '#4'],\n    '5d': ['b5'],\n    '5P': ['5'],\n    '5A': ['#5'],\n    '6m': ['b13', 'b6'],\n    '6M': ['13', '6'],\n    '7m': ['b7'],\n    '7M': ['7', '^7', 'maj7']\n};\n\n/*\nLower Interval Limits (just guidelines):\n2m: E3-F3\n2M: Eb3-F3\n3m: C3-Eb3\n3M: Bb2-D3\n4P: Bb2-Eb3\n5D: B2-F3\n5P: Bb1-F2\n6m: F2-Db3\n6M: F2-D3\n7m: F2-Eb3\n7m: F2-E3\n8P: -\n\nmore rough: top note should be D3 or higher.\ntaken from https://www.youtube.com/watch?v=iW6YeDJklhQ\n*/\n\nexport function randomNumber(n) {\n    return Math.floor(Math.random() * n)\n}\n\nexport function arraySum(array) {\n    return array.reduce((s, i) => s + i, 0);\n}\n\nexport function randomElement(array, weighted?) {\n    if (!weighted) {\n        return array[randomNumber(array.length)];\n    }\n    const r = randomNumber(arraySum(weighted)) + 1;\n    const total = weighted\n        .reduce((abs, w, i) => abs.concat(w + (abs.length ? abs[i - 1] : 0)), []);\n    return array[total.indexOf(total.find((s, i) => s >= r))];\n}\n\nexport function shuffleArray(a) {\n    for (let i = a.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [a[i], a[j]] = [a[j], a[i]];\n    }\n    return a;\n}\n\n/** OLD SHEET / RHYTHM STUFF */\n\n/** Travels path along measures */\nexport function getPath(path, measures, traveled = []) {\n    if (!Array.isArray(measures[path[0]]) || path.length === 1) {\n        return measures[Math.min(path[0], measures.length - 1)];\n    }\n    return this.getPath(path.slice(1), measures[path[0]], traveled.concat(path[0]));\n}\n\nexport function getDuration(divisions, noteLength = 1, measureLength = 1) {\n    return noteLength * divisions.reduce((f, d) => f / d, 1000) * measureLength; // fraction of one\n}\n\nexport function resolveChords(pattern, measures, path, divisions = []) {\n    if (Array.isArray(pattern)) {\n        // division: array of children lengths down the path (to calculate fraction)\n        divisions = [].concat(divisions, [pattern.length]);\n        return pattern.map((p, i) => this.resolveChords(p, measures, path.concat([i]), divisions));\n    }\n    if (pattern === 0) {\n        return 0;\n    }\n    const fraction = getDuration(divisions, pattern);\n    if (fraction === 0) {\n        console.warn('fraction is 0', pattern);\n    }\n    if (fraction === NaN) {\n        console.warn('fraction NaN', divisions, pattern);\n    }\n    return { chord: this.getPath(path, measures), pattern, path, divisions, fraction };\n}\n\nexport function hasOff(pattern, division = 3) {\n    return Array.isArray(pattern) && pattern.length === division && pattern[division - 1] !== 0;\n}\n\n// replaces offs on last beat with next chord + erases next one\nexport function offbeatReducer(settings) {\n    // TODO: find out why some offbeats sound sketchy\n    return (measures, bar, index) => {\n        const last = index > 0 ? measures[index - 1] : null;\n        if (last && this.hasOff(last[settings.cycle - 1], settings.division)) {\n            last[settings.cycle - 1][settings.division - 1] = bar[0];\n            bar[0] = 0;\n        }\n        return measures.concat([bar]);\n    };\n}\n\n\nexport function randomSynth(mix, allowed = ['sine', 'triangle', 'square', 'sawtooth'], settings = {}) {\n    const gains = {\n        sine: 0.9,\n        triangle: 0.8,\n        square: 0.2,\n        sawtooth: 0.3\n    }\n    const wave = randomElement(allowed);\n    return new Synthesizer(Object.assign({ gain: gains[wave], type: wave, mix }, settings));\n}\n\nexport interface ADSRParams {\n    attack?: number,\n    decay?: number,\n    sustain?: number,\n    release?: number,\n    gain?: number,\n    duration?: number,\n    endless?: boolean\n}\n\nexport function adsr({ attack, decay, sustain, release, gain, duration, endless }: ADSRParams, time, param) {\n    // console.log('adsr', attack, decay, sustain, release, gain, duration, time);\n    param.linearRampToValueAtTime(gain, time + attack);\n    param.setTargetAtTime(sustain * gain, time + Math.min(attack + decay, duration), decay);\n    if (!endless) {\n        param.setTargetAtTime(0, time + Math.max(duration - attack - decay, attack + decay, duration), release);\n    }\n}\n\nexport function randomDelay(maxMs) {\n    return Math.random() * maxMs * 2 / 1000;\n}\n\nexport function isInRange(note, range) {\n    return Distance.semitones(note, range[0]) <= 0 && Distance.semitones(note, range[1]) >= 0;\n}\n\nexport function transposeNotes(notes, interval) {\n    return notes.map(note => Distance.transpose(note, interval));\n}\n\nexport function transposeToRange(notes, range, times = 0) {\n    if (times > 10) {\n        return notes;\n    }\n    if (notes.find(note => Distance.semitones(note, range[0]) > 0)) {\n        notes = notes.map(note => Distance.transpose(note, '8P'));\n        console.log('tp up');\n        return transposeToRange(notes, range, ++times);\n    }\n    if (notes.find(note => Distance.semitones(note, range[1]) < 0)) {\n        console.log('tp down');\n        notes = notes.map(note => Distance.transpose(note, '-8P'));\n        return transposeToRange(notes, range, ++times);\n    }\n    return notes;\n}\n\nexport function getAverageMidi(notes, offset?) {\n    return notes.reduce((sum, note) => sum + Harmony.getMidi(note, offset), 0) / notes.length;\n}\n\nexport function getDistancesToRangeEnds(notes: string[], range: string[]) {\n    if (notes.length > 2) {\n        notes = [notes[0], notes[notes.length - 1]];\n    }\n    const midi = notes.map(n => Harmony.getMidi(n));\n    const rangeMidi = range.map(n => Harmony.getMidi(n));\n    return [midi[0] - rangeMidi[0], rangeMidi[1] - midi[1]];\n}\n\nexport function getRangePosition(note: string | number, range) {\n    note = Harmony.getMidi(note);\n    range = range.map(n => Harmony.getMidi(n));\n    const semitones = [note - range[0], range[1] - range[0]];\n    return semitones[0] / semitones[1];\n}\n\nexport function getRangeDirection(note, range, defaultDirection: intervalDirection = 'down', border = 0): { direction: intervalDirection, force: boolean } {\n    const position = getRangePosition(note, range);\n    if (position <= border) {\n        return { direction: 'up', force: true }\n    } if (position >= (1 - border)) {\n        return { direction: 'down', force: true }\n    }\n    return {\n        direction: defaultDirection, force: false\n    }\n}\n\n// accepts both strings or numbers where negative means minor, \n// returns unified step string that can be turned into an interval\nexport function getStep(step: step) {\n    if (typeof step === 'number' && step < 0) {\n        step = 'b' + (step * -1);\n    }\n    return step + ''; // to string\n}\n\nexport function getIntervalFromStep(step: step) {\n    step = getStep(step);\n    const interval = Object.keys(steps)\n        .find(i => steps[i].includes(step));\n    if (!interval) {\n        // console.warn(`step ${step} has no defined inteval`);\n    }\n    return interval;\n}\n\nexport function getStepsFromDegree(degree) {\n    return\n}\n\nexport function getStepsInChord(notes: string[], chord: string, min = false) {\n    const root = Chord.tokenize(Harmony.getTonalChord(chord))[0];\n    return notes.map(note => {\n        let interval = Distance.interval(root, Note.pc(note));\n        return getStepFromInterval(interval, min);\n    });\n}\nexport function getStepInChord(note, chord, min = false) {\n    return getStepFromInterval(\n        Distance.interval(\n            Chord.tokenize(Harmony.getTonalChord(chord))[0],\n            Note.pc(note), min)\n    );\n}\n\nexport function getChordScales(chord, group = 'Diatonic') {\n    const tokens = Chord.tokenize(Harmony.getTonalChord(chord));\n    /* const isSuperset = PcSet.isSupersetOf(Chord.intervals(tokens[1])); */\n    return scaleNames(group).filter(name =>\n        /* isSuperset(Scale.intervals(name)) */\n        PcSet.isSupersetOf(Chord.intervals(tokens[1]), Scale.intervals(name))\n    );\n}\n\nexport function pickChordScale(chord, group = 'Diatonic') {\n    const scales = getChordScales(chord);\n    if (!scales.length) {\n        console.warn(`cannot pick chord scale: no scales found for chord ${chord} in group ${group}`);\n        return;\n    }\n    return scales[0];\n}\n\n\nexport function findDegree(degreeOrStep: number | step, intervalsOrSteps: string[]) {\n    const intervals = intervalsOrSteps.map(i => isInterval(i) ? i : getIntervalFromStep(i));\n    if (typeof degreeOrStep === 'number') { // is degree\n        const degree = Math.abs(degreeOrStep);\n        return intervals.find(i => {\n            i = Harmony.minInterval(i, 'up');\n            if (!steps[i]) {\n                console.error('interval', i, 'is not valid', intervals);\n            }\n            return !!(steps[i].find(step => getDegreeFromStep(step) === degree));\n        });\n    }\n    // is step\n    const step = getStep(degreeOrStep);\n    return intervals.find(i => i.includes(step) ||\n        i === getIntervalFromStep(step));\n}\n\nexport function hasDegree(degree, intervals) {\n    return !!findDegree(degree, intervals);\n}\n\nexport function hasAllDegrees(degrees, intervals) {\n    return degrees.reduce((res, d) => res && hasDegree(d, intervals), true);\n}\n\nexport function getScaleDegree(degree, scale) {\n    return findDegree(degree, Scale.intervals(scale));\n}\n\n\nexport function getScalePattern(pattern, scale) {\n    return pattern.map(degree => getScaleDegree(degree, scale));\n}\n\nexport function renderIntervals(intervals, root) {\n    return intervals.map(i => Distance.transpose(root, i));\n}\n\nexport function renderSteps(steps, root) {\n    return renderIntervals(steps.map(step => getIntervalFromStep(step)), root);\n}\n\nexport function permutateIntervals(intervals, pattern) {\n    return pattern.map(d => findDegree(d, intervals));\n}\n\nexport function getStepFromInterval(interval, min = false) {\n    const step = steps[interval] || [];\n    if (min) {\n        return step[1] || step[0] || 0;\n    }\n    return step[0] || 0;\n}\n\nexport function getDegreeFromInterval(interval = '-1', simplify = false) {\n    const fixed = Harmony.fixInterval(interval, simplify) || '';\n    const match = fixed.match(/[-]?([1-9])+/);\n    if (!match) {\n        return 0;\n    }\n    return Math.abs(parseInt(match[0], 10));\n}\n\nexport function getDegreeFromStep(step: step) {\n    step = getStep(step);\n    return parseInt(step.match(/([1-9])+/)[0], 10);\n}\n\nexport function getDegreeInChord(degree, chord) {\n    chord = Harmony.getTonalChord(chord);\n    const intervals = Chord.intervals(chord);\n    const tokens = Chord.tokenize(chord);\n    return Distance.transpose(tokens[0], findDegree(degree, intervals));\n}\n\nexport function getPatternInChord(pattern, chord) {\n    chord = Harmony.getTonalChord(chord);\n    const intervals = Chord.intervals(chord);\n    const tokens = Chord.tokenize(chord);\n    let permutation;\n    if (hasAllDegrees(pattern, intervals)) {\n        permutation = permutateIntervals(intervals, pattern);\n    } else {\n        // not all degrees of the pattern are in the chord > get scale\n        const scale = pickChordScale(chord);\n        permutation = permutateIntervals(Scale.intervals(scale), pattern);\n    }\n    if (tokens[0]) {\n        return renderIntervals(permutation, tokens[0]);\n    }\n    return permutation;\n}\n\n// TODO: other way around: find fixed interval pattern in a scale\n// TODO: motives aka start pattern from same note in different scale\n// TODO: motives aka start pattern from different note in same scale\n// TODO: motives aka start pattern from different note in different scale\n\nexport function getDigitalPattern(chord) {\n    chord = Harmony.getTonalChord(chord);\n    const intervals = Chord.intervals(chord);\n    if (intervals.includes('3m')) {\n        return [1, 3, 4, 5];\n    } else if (intervals.includes('3M')) {\n        return [1, 2, 3, 5];\n    } else {\n        return [1, 1, 1, 1];\n    }\n}\n\nexport function renderDigitalPattern(chord) {\n    return getPatternInChord(getDigitalPattern(chord), chord);\n}\n\nexport function getGuideTones(chord) {\n    chord = Harmony.getTonalChord(chord);\n    return getPatternInChord([3, 7], chord);\n}\n\n\nexport function isFirstInPath(path, index) {\n    return path.slice(index)\n        .reduce((sum, value) => sum + value, 0) === 0;\n}\n\nexport function isBarStart(path) {\n    return isFirstInPath(path, 1);\n}\n\nexport function isFormStart(path) {\n    return isFirstInPath(path, 0);\n}\n\nexport function isOffbeat(path) {\n    return path[2] !== 0;\n}\n\n\nexport function otherDirection(direction, defaultDirection?) {\n    if (direction === 'up') {\n        return 'down';\n    } else if (direction === 'down') {\n        return 'up'\n    }\n    return defaultDirection;\n}\n\n\n\nexport function totalDiff(diff) {\n    const total = diff.reduce((weight, diff) => {\n        weight.added += diff.added ? diff.count : 0;\n        weight.removed += diff.added ? diff.count : 0;\n        weight.kept += (!diff.added && !diff.removed) ? diff.count : 0;\n        return weight;\n    }, { added: 0, removed: 0, kept: 0, balance: 0 });\n    total.balance = total.added - total.removed;\n    total.changes = total.added + total.removed;\n    return total;\n}\n\n/** Reorders the given notes to contain the given step as close as possible */\nexport function sortByDegree(notes, degree) {\n    degree = Math.max(degree, (degree + 8) % 8)\n    /* const semitones = Interval.semitones(interval); */\n    const diffDegrees = (a, b) => Math.abs(getDegreeFromInterval(Distance.interval(a, b) + '') - degree);\n    /* const diffTones = (a, b) => Math.abs(Distance.interval(a, b) - semitones); */\n    notes = notes.slice(1).reduce((chain, note) => {\n        const closest = notes\n            .filter(n => !chain.includes(n))\n            .sort((a, b) => diffDegrees(chain[0], a) < diffDegrees(chain[0], b) ? -1 : 1);\n        chain.unshift(closest[0]);\n        return chain;\n    }, [notes[0]]).reverse();\n\n    return notes;\n}\n\n/** Returns the given notes with octaves either moving bottom up or top down */\nexport function renderAbsoluteNotes(notes, octave = 3, direction: intervalDirection = 'up') {\n    return notes.reduce((absolute, current, index, notes) => {\n        if (index === 0) {\n            return [current + octave];\n        }\n        let interval = Distance.interval(notes[index - 1], current);\n        interval = Harmony.minInterval(interval, direction);\n        if (interval === '1P') {\n            interval = direction === 'down' ? '-8P' : '8P';\n        }\n        absolute.push(Distance.transpose(absolute[index - 1], interval + ''));\n        return absolute;\n    }, []);\n}\n\nexport function getIntervals(notes) {\n    return notes.reduce((intervals, note, index, notes) => {\n        if (index === 0) {\n            return [];\n        }\n        intervals.push(Distance.interval(notes[index - 1], note));\n        return intervals;\n    }, []);\n}\n\nexport function isInterval(interval) {\n    return typeof Interval.semitones(interval) === 'number';\n}\n\nexport function smallestInterval(intervals) {\n    return intervals.reduce((min, current) => {\n        if (!min || Interval.semitones(current) < Interval.semitones(min)) {\n            return current;\n        }\n        return min;\n    });\n}\n\nexport function sortNotes(notes, direction: intervalDirection = 'up') {\n    return notes.sort((a, b) => Harmony.getMidi(a) - Harmony.getMidi(b));\n}\n\nexport function analyzeVoicing(notes, root?) {\n    if (!notes || notes.length < 2) {\n        throw new Error('Can only analyze Voicing with at least two notes');\n    }\n    notes = sortNotes(notes);\n    root = root || notes[0]; // TODO: get degrees\n    const intervals = getIntervals(notes);\n    const sortedIntervals = intervals.sort(Harmony.sortMinInterval());\n    return {\n        notes,\n        minInterval: sortedIntervals[0],\n        maxInterval: sortedIntervals[sortedIntervals.length - 1],\n        intervals,\n        spread: Distance.interval(notes[0], notes[notes.length - 1])\n    }\n}\n\n\nexport function semitoneDifference(intervals) {\n    return intervals.reduce((semitones, interval) => {\n        return semitones + Math.abs(Interval.semitones(interval))\n    }, 0);\n}\nexport function semitoneMovement(intervals) {\n    return intervals.reduce((semitones, interval) => {\n        return semitones + Interval.semitones(interval)\n    }, 0);\n}\n\nexport function longestChild(array: any[][]) {\n    return array.reduce((max, current) => (current.length > max.length ? current : max), array[0]);\n}\n\nexport function isPitchClass(note) {\n    return Note.pc(note) === note;\n}\n\n\nexport function mapTree(\n    tree,\n    modifier?,\n    simplify = false,\n    path = [],\n    siblings = [],\n    position = 0) {\n    // skip current tree if only one child\n    if (simplify && Array.isArray(tree) && tree.length === 1) {\n        return mapTree(\n            tree[0], modifier, simplify,\n            path, siblings, position\n        );\n    }\n\n    let fraction = siblings.reduce((f, d) => f / d, 1);\n    if (!Array.isArray(tree)) {\n        return modifier ? modifier(tree, { path, siblings, fraction, position }) : tree;\n    }\n    if (Array.isArray(tree)) {\n        siblings = siblings.concat([tree.length]);\n        fraction = fraction / tree.length;\n        return tree.map((subtree, index) =>\n            mapTree(\n                subtree, modifier, simplify,\n                path.concat([index]),\n                siblings,\n                position + index * fraction\n            )\n        )\n    }\n}\n\nexport function flattenTree(tree) {\n    const flat = []\n    mapTree(tree, (value, props) => flat.push(Object.assign(props, { value })));\n    return flat;\n}\n\nexport function expandTree(tree) {\n    // TODO\n}\n\n/* Returns true if the given intervals are all present in the chords interval structure\nIntervals can be appendend with \"?\" to indicate that those degrees could also be omitted \n(but when present they should match)\n*/\nexport function chordHasIntervals(chord, intervals) {\n    chord = Harmony.getTonalChord(chord);\n    const has = Chord.intervals(chord);\n    return intervals.reduce((match, current) => {\n        const isOptional = current.includes('?');\n        const isForbidden = current.includes('!');\n        if (isOptional) {\n            current = current.replace('?', '');\n            return (!hasDegree(getDegreeFromInterval(current), has) ||\n                has.includes(current)) && match;\n        }\n        if (isForbidden) {\n            current = current.replace('!', '');\n            return !hasDegree(getDegreeFromInterval(current), has);\n        }\n        return has.includes(current) && match;\n    }, true);\n}\n\nexport function isDominantChord(chord) {\n    return chordHasIntervals(chord, ['3M', '7m']) || chordHasIntervals(chord, ['!3', '4P', '7m']);\n}\nexport function isMajorChord(chord) {\n    return chordHasIntervals(chord, ['3M', '7M?']);\n}\nexport function isMinorChord(chord) {\n    return chordHasIntervals(chord, ['3m']);\n}\nexport function isMinorTonic(chord) {\n    return chordHasIntervals(chord, ['3m', '5P', '13M?', '7M?']);\n}\n\nexport function getChordType(chord) {\n    if (isDominantChord(chord)) {\n        return 'dominant';\n    }\n    if (isMajorChord(chord)) {\n        return 'major';\n    }\n    if (isMinorTonic(chord)) {\n        return 'minor-tonic';\n    }\n    if (isMinorChord(chord)) {\n        return 'minor';\n    }\n}\n\nexport function getChordNotes(chord, validate?) {\n    chord = Harmony.getTonalChord(chord);\n    const tokens = Chord.tokenize(chord);\n    const notes = Chord.notes(chord);\n    return notes.filter(note => {\n        const interval = Distance.interval(tokens[0], note);\n        return !validate || validate(note, {\n            root: tokens[0],\n            symbol: tokens[1],\n            interval,\n            step: getStepFromInterval(interval),\n            degree: getDegreeFromInterval(interval + '')\n        });\n    });\n}\n\nexport function validateWithoutRoot(note, { degree }) {\n    return degree !== 1;\n}\n\n// OLD...\nexport function getVoicing(chord, { voices, previousVoicing, omitRoot, quartal }: {\n    previousVoicing?: string[],\n    voices?: number,\n    omitRoot?: boolean,\n    quartal?: boolean\n} = {}) {\n    chord = Harmony.getTonalChord(chord);\n    const tokens = Chord.tokenize(chord);\n    let notes = Chord.notes(chord);\n    if (omitRoot) {\n        notes = notes.filter(n => n !== tokens[0]);\n    }\n    if (quartal) {\n    }\n    if (previousVoicing) {\n\n    }\n    return notes;\n}\n\nexport function semitoneDistance(noteA, noteB) {\n    return Interval.semitones(Distance.interval(noteA, noteB) + '');\n}\n\nexport function noteArray(range) {\n    const slots = Interval.semitones(Distance.interval(range[0], range[1]) + '');\n    return new Array(slots + 1)\n        .fill('')\n        .map((v, i) => Distance.transpose(range[0], Interval.fromSemitones(i)) + '')\n        .map(n => Note.simplify(n))\n}\n\n\nexport function factorial(n) {\n    let value = 1;\n    for (let i = 2; i <= n; ++i) {\n        value *= i;\n    }\n    return value;\n}\n\n\n\n// finds best combination following the given notes, based on minimal movement\n/* export function bestCombination(notes, combinations = []) {\n    return combinations.reduce((best, current) => {\n        const currentMovement = voicingDifference(notes, current);\n        const bestMovement = voicingDifference(notes, best);\n        if (Math.abs(currentMovement) < Math.abs(bestMovement)) {\n            return current;\n        }\n        return best;\n    });\n} */\n\n/* export function sortCombinationsByMovement(notes, combinations, direction: intervalDirection = 'up', min = true) {\n    const movements = combinations.map((combination) => ({\n        movement: voicingMovement(notes, combination, min),\n        combination\n    }));\n    let right = movements.filter(move => direction === 'up' ? move >= 0 : move <= 0);\n    if (!right.length) {\n        right = movements;\n    }\n    let sorted = right.sort((a, b) => a.movement - b.movement);\n    if (direction === 'down') {\n        sorted = sorted.reverse();\n    }\n    return sorted.map(movement => movement.combination);\n}\n */","import { randomElement } from \"../util/util\";\n\nconst off = () => randomElement([0, [0, 1]], [6, 1]);\nconst eightFour = () => randomElement(\n    [[1, 1], 1],\n    [2, 1]\n);\nconst eightOff = () => randomElement(\n    [[1, 1], [0, 1]],\n    [2, 1]\n);\nconst halfTriplet = () => randomElement(\n    [[2, 0], [[2, 0, 2], [0, 2, 0]]],\n    [2, 1]\n);\n\nconst one = (v = 1) => randomElement([0, v]);\n\nexport const bossa = {\n    name: 'Bossa',\n    tempo: 160,\n    chords: ({ measure, settings }) => {\n        return randomElement([\n            [1, [0, 1], 0, [0, 3]],\n            [one(), [0, 3], 0, [0, 1]],\n            [one(), [0, 1], [0, 3], 0],\n            [one(), [0, 3], [0, 1], 0]\n        ])\n    },\n    bass: () =>\n        [1, [0, 3], 0, randomElement([0, 1])],\n    rimshot: ({ measure, settings }) => {\n        return [0, .8, 0, 0]\n    },\n    ride: ({ measures, index }) => {\n        return randomElement([\n            [[one(.6), .9, [.4, .5], [0, .8]]],\n            [[0, .9, [.4, .5], [one(.6), .8]]],\n        ])\n    },\n    hihat: () => [0, .8, 0, 1],\n    solo: () => randomElement([\n        [eightFour(), eightFour(), eightFour(), eightFour()],\n        [eightFour(), 2, 0, eightFour()],\n        [0, 0, eightFour(), eightOff()],\n        [[1, 4], 0, eightFour(), eightFour()],\n        [4, 0, 0, 0],\n        [...halfTriplet(), ...halfTriplet()],\n        [eightOff(), eightOff(), eightOff(), eightOff()],\n    ])\n};","import { randomElement } from \"../util/util\";\nexport const funk = {\n    name: 'Funk',\n    tempo: 90,\n    chords: () => randomElement([\n        [[2, 0, 0, 1], 0, [0, .6], [0, 3.5, 0, 0]],\n        [[1, 0, 0, 5], 0, [0, .6], [1, .5, 0, 0]],\n        [[1, 0, 0, 5], 0, [0, .6], [.5, 0, 2, 0]],\n        [[1, 0, 0, 5], 0, [0, .6], [0, 2, 0, 1]],\n        [[3, 0, 0, 0], 0, 2, 0]\n    ]),\n    bass: () => randomElement(\n        [\n            [[2, 0, 0, 1], [0, 1], 1, [0, 1]],\n            [[2, 0, 0, 0], [0, 1, 0, 1], [0, 0, 1, 0], [0, 0, 0, 1]],\n        ]\n    ),\n    kick: (t) => [[[1, .7], 0, [0, 1], 0]],\n    snare: (t) => [0, 1, [0, .2, 0, 0], [1, 0, 0, .6]],\n    hihat: (t) => [[.5, .6], [.4, .7], [.3, .6], [.5, .7]]\n};","import { randomElement } from \"../util/util\";\n\nconst off = () => randomElement([0, [0, 0, 2]], [6, 1]);\nconst eightFour = () => randomElement(\n    [[1, 0, 1], 1, [0, 0, 1, 1]],\n    [4, 2, 1]\n);\nconst eightOff = () => randomElement(\n    [[1, 0, 1], [0, 0, 1]],\n    [4, 1]\n);\nconst halfTriplet = () => randomElement(\n    [\n        [2, 0],\n        [[2, 0, 2], [0, 2, 0]],\n        [1, 1, 1, 1]\n    ],\n    [2, 1, 1]\n);\n\n\nexport const swing = {\n    name: 'Swing',\n    tempo: 130,\n    chords: ({ measure, settings }) => {\n        const r = Math.random() > 0.5 ? .6 : 0;\n        const t = `${settings.cycle}/${measure.length}`;\n        if (t === '4/1') {\n            return randomElement([\n                [[1, 0], [0, 0, 7], 0, 0],\n                [1, [0, 0, 2], 0, off()],\n                [[0, 0, 1], 0, 2, 0],\n                [[0, 0, 4], 0, 1, 0],\n                [2, 0, 0, 0],\n                [3, 0, 0, 0],\n                [1, 0, r, off()],\n                [[0, 0, 2], 0, r, 0],\n                [1.5, [0, 0, 2], 0, off()],\n            ]);//, [2, 1, 1]\n        }\n        if (t === '4/2') {\n            return randomElement([\n                [[1, 0], [0, 0, 7], 0, 0],\n                [1, [0, 0, 3], 0, 0],\n                [1, 0, 2, 0],\n                [2, 0, 1, 0],\n                [1, 0, .7, off()],\n                [[1, 0, 0], 0, .7, off()],\n                [[4, 0, 0], [0, 0, 2.8], 0, off()],\n            ]);\n        }\n\n        if (t === '4/3') {\n            return [1, [0, 0, 2], [0, 0, 4], 0];\n        }\n        if ('4/4') {\n            return randomElement([\n                [1, 1, 1, 1],\n                [[1, 0, 2], [0, 0, 2], 0, 1]\n            ]);\n        }\n    },\n    bass: () => randomElement([\n        [1, 1, 1, 1],\n    ]),\n    crash: ({ measures, index }) => {\n        const fill = index !== 0 && index % measures.length === 0;\n        if (fill) {\n            return [4, 0, 0, 0];\n        }\n        return [0, 0, 0, 0];\n    },\n    ride: ({ measures, index }) => {\n        return randomElement([\n            [.6, [.9, 0, 1], .6, [.9, 0, 1]],\n            [.6, [.4, 0, 1], .8, [0, 0, 1],],\n            [.6, .9, [.6, 0, 1], 1],\n            [.6, .9, .6, [.9, 0, 1]],\n        ], [3, 2, 1, 2])\n    },\n    hihat: () => [0, .8, 0, 1],\n    solo: () => randomElement([\n        [eightFour(), eightFour(), eightFour(), eightFour()],\n        [eightFour(), 2, 0, eightFour()],\n        [0, 0, eightFour(), eightFour()],\n        [[1, 0, 4], 0, eightFour(), eightFour()],\n        [3, 0, 0, eightFour()],\n        /* [0, 1, 2, 0], */\n        [...halfTriplet(), ...halfTriplet()],\n        [eightOff(), eightOff(), eightOff(), eightOff()],\n    ])\n    /* solo: () => [1, 1, 0, 1] */\n};","import { Measure, MeasureOrString } from './Measure';\n\nexport type Measures = Array<MeasureOrString>;\n\nexport type Leadsheet = {\n    name?: string,\n    composer?: string,\n    style?: string,\n    bpm?: number,\n    repeats?: number,\n    key?: string,\n    measures?: Measures,\n    chords?: Measures,\n    melody?: Measures,\n}\n\n\nexport type JumpSign = {\n    pair?: string,\n    move?: number,\n    fine?: boolean,\n    validator?: (state) => boolean,\n}\n\nexport type SheetState = {\n    measures?: [],\n    index?: number,\n    sheet?: Measures,\n    jumps?: { [key: number]: number },\n    visits?: { [key: number]: number },\n    nested?: boolean,\n    fallbackToZero?: boolean,\n    forms?: number;\n    firstTime?: boolean; // flips to false after first chorus is complete\n    lastTime?: boolean; // flips to true when last chorus starts\n}\n\n\nexport class Sheet {\n    static jumpSigns: { [sign: string]: JumpSign } = {\n        '}': { pair: '{', move: -1 },\n        'DC': {},\n        'DS': { pair: 'Segno', move: -1 },\n        'DS.Fine': { pair: 'Segno', move: -1 },\n        'DS.Coda': { pair: 'Segno', move: -1 },\n        'DC.Fine': {},\n        'DC.Coda': {},\n        'Fine': {\n            fine: true,\n            validator: (state) => Sheet.readyForFineOrCoda(state)\n        },\n        'ToCoda': {\n            pair: 'Coda', move: 1,\n            validator: (state) => Sheet.readyForFineOrCoda(state)\n        }\n    };\n\n    static render(sheet, options = {}): Measures {\n        let state: SheetState = {\n            sheet,\n            measures: [],\n            forms: 1,\n            nested: true,\n            fallbackToZero: true,\n            firstTime: true,\n            ...options\n        };\n        state = {\n            ...state,\n            ...Sheet.newForm(state)\n        };\n\n        let runs = 0;\n        while (runs < 100 && state.index < sheet.length) {\n            runs++;\n            state = Sheet.nextMeasure(state);\n        }\n        return state.measures/* .map(m => Measure.from(m)) */;\n    }\n\n    static nextMeasure(state): SheetState {\n        state = {\n            ...state,\n            ...Sheet.nextSection(state)\n        } // moves to the right house (if any)\n        let { sheet, index, measures } = state;\n        state = {\n            ...state,\n            measures: measures.concat([{\n                ...Measure.from(sheet[index]),\n                index: index // add index for mapping\n            }]),\n            ...Sheet.nextIndex(state),\n        }\n        return Sheet.nextForm(state);\n    }\n\n    static nextIndex(state): SheetState {\n        let { sheet, index, jumps, nested, fallbackToZero } = state;\n        if (!Sheet.shouldJump({ sheet, index, jumps })) {\n            return {\n                index: index + 1\n            };\n        }\n        const braces = [Sheet.getJumpDestination({ sheet, index, fallbackToZero, nested }), index];\n        jumps = Sheet.wipeKeys(jumps, [braces[0], braces[1] - 1]); // wipes indices inside braces\n        return {\n            index: braces[0],\n            jumps: { // count jumps up\n                ...jumps,\n                [braces[1]]: (jumps[braces[1]] || 0) + 1\n            }\n        }\n    }\n\n    static newForm(state): SheetState {\n        return {\n            ...state,\n            index: 0,\n            jumps: {},\n            visits: {},\n            lastTime: state.forms === 1,\n        }\n    }\n\n    static nextForm(state, force = false): SheetState {\n        let { sheet, index, forms } = state;\n        if (force || (index >= sheet.length && forms > 1)) {\n            return Sheet.newForm({\n                ...state,\n                firstTime: false,\n                forms: forms - 1\n            });\n        }\n        return state;\n    }\n\n    // moves the index to the current house (if any)\n    static nextSection(state: SheetState): SheetState {\n        let { sheet, index, visits, firstTime, lastTime } = state;\n        // skip intro when not firstTime\n        if (!firstTime && Measure.from(sheet[index]).section === 'IN') {\n            return {\n                index: Sheet.getNextSectionIndex({ sheet, index }),\n            }\n        }\n        // skip coda when not last time\n        if (Measure.hasSign('Coda', sheet[index]) && !Sheet.readyForFineOrCoda(state)) {\n            return Sheet.nextForm(state, true);\n        }\n        if (!Measure.hasHouse(sheet[index], 1)) {\n            return {};\n        }\n        let next = Sheet.getNextHouseIndex({ sheet, index, visits });\n        if (next === -1) {\n            next = index;\n            visits = {}; // reset visits\n        }\n        return {\n            visits: {\n                ...visits,\n                [next]: (visits[next] || 0) + 1\n            },\n            index: next\n        }\n    }\n    /** Starts at a given index, stops when the pair functions returned equally often */\n    static findPair(\n        sheet,\n        index: number,\n        pairs: Array<(measure?: Measure, options?: { sheet?: Measures, index?: number }) => boolean>,\n        move = 1,\n        stack = 0): number {\n        let match = -1; // start with no match\n        while (match === -1 && index >= 0 && index < sheet.length) {\n            if (pairs[0](sheet[index], { sheet, index })) { // same sign\n                stack++;\n            }\n            if (pairs[1](sheet[index], { sheet, index })) { // pair sign\n                stack--;\n            }\n            if (stack === 0) { // all pairs resolved > match!\n                match = index;\n            } else {\n                index += move;\n            }\n        }\n        return match;\n    }\n\n    static findMatch(\n        sheet,\n        index: number,\n        find: (measure?: Measure, options?: { sheet?: Measures, index?: number }) => boolean,\n        move = 1): number {\n        let match = -1; // start with no match\n        while (match === -1 && index >= 0 && index < sheet.length) {\n            if (find(sheet[index], { sheet, index })) {\n                match = index;\n            } else {\n                index += move;\n            }\n        }\n        return match;\n\n    }\n    // simple matching for brace start, ignores nested repeats\n    static getJumpDestination(state: SheetState): number {\n        let { sheet, index, fallbackToZero, nested } = state;\n        const sign = Measure.getJumpSign(sheet[index]);\n        // if fine > jump till end\n        if (sign.fine) { return sheet.length; }\n        // if no pair given => da capo\n        if (!sign.pair) { return 0; }\n        // if nested mode on and opening brace is searched, use getBracePair..\n        if (nested !== false && sign.pair === '{') {\n            return Sheet.getBracePair({ sheet, index, fallbackToZero });\n        }\n        const destination = Sheet.findMatch(sheet, index,\n            (m) => Measure.hasSign(sign.pair, m),\n            sign.move || -1); // default move back\n        if (fallbackToZero) {\n            // default to zero when searching repeat start (could be forgotten)\n            return destination === -1 ? 0 : destination;\n        }\n        return destination;\n    }\n\n    // returns the index of the repeat sign that pairs with the given index\n    static getBracePair(\n        { sheet, index, fallbackToZero }: { sheet: Measures, index: number, fallbackToZero?: boolean }\n    ): number {\n        if (fallbackToZero === undefined) {\n            fallbackToZero = true;\n        }\n        if (Measure.hasSign('{', sheet[index])) {\n            return Sheet.findPair(sheet, index,\n                [\n                    (m) => Measure.hasSign('{', m),\n                    (m) => Measure.hasSign('}', m),\n                ]\n                , 1);\n        } else if (Measure.hasSign('}', sheet[index])) {\n            const pair = Sheet.findPair(sheet, index,\n                [\n                    (m, state) => {\n                        // this logic could be infinitely complex, having many side effects and interpretations\n                        // the current behaviour is similar to musescore or ireal handling braces\n                        if (!Measure.hasSign('}', m)) {\n                            return false;\n                        }\n                        if (index === state.index) {\n                            return true;\n                        }\n                        const relatedHouse = Sheet.getRelatedHouse({ sheet, index: state.index });\n                        return relatedHouse === -1;\n                    },\n                    (m) => Measure.hasSign('{', m)\n                ]\n                , -1);\n            if (fallbackToZero) {\n                return pair === -1 ? 0 : pair; // default to zero when searching repeat start (could be forgotten)\n            }\n            return pair;\n        }\n        return -1;\n    }\n\n    // returns true if the house at the given index has not been visited enough times\n    static canVisitHouse({ sheet, index, visits }): boolean {\n        let houses = sheet[index].house;\n        if (houses === undefined) {\n            return false;\n        }\n        if (!Array.isArray(houses)) {\n            houses = [houses];\n        }\n        const visited = visits[index] || 0;\n        return visited < houses.length\n    }\n\n    // returns the next house that can be visited (from the given index)\n    static getNextHouseIndex({ sheet, index, visits }, move = 1): number {\n        return Sheet.findMatch(sheet, index,\n            (m, step) => Measure.hasHouse(m) && Sheet.canVisitHouse({ sheet, index: step.index, visits })\n            , move);\n    }\n\n    static getNextSectionIndex({ sheet, index }, move = 1): number {\n        return Sheet.findMatch(sheet, index + 1,\n            (m) => Measure.from(m).section !== undefined, 1);\n    }\n\n    // wipes all keys in the given range\n    static wipeKeys(numberMap, range): { [key: number]: number } {\n        const wiped = {};\n        Object.keys(numberMap)\n            .map(i => parseInt(i))\n            .filter(i => i < range[0] || i > range[1])\n            .forEach(i => wiped[i] = numberMap[i]);\n        return wiped;\n    }\n\n\n    static getRelatedHouse({ sheet, index }): number {\n        const latestHouse = Sheet.findPair(sheet, index,\n            [\n                (m, state) => index === state.index || Measure.hasSign('}', m),\n                (m) => Measure.hasHouse(m)\n            ], -1);\n        return latestHouse;\n    }\n\n    static isFirstHouse({ sheet, index }): boolean {\n        return Measure.hasHouse(sheet[index], 1);\n    }\n\n    static getAllowedJumps({ sheet, index }) {\n        if (!Measure.hasJumpSign(sheet[index])) {\n            return 0;\n        }\n        const measure = Measure.from(sheet[index]);\n        if (measure.times !== undefined) {\n            return measure.times;\n        }\n        return 1;\n    }\n\n    static readyForFineOrCoda({ sheet, index, jumps, lastTime }: SheetState): boolean {\n        const signs = Object.keys(Sheet.jumpSigns)\n            .filter(s => s.includes('DC') || s.includes('DS'));\n        const backJump = Sheet.findMatch(sheet, index,\n            (m) => signs.reduce((match, sign) => match || Measure.hasSign(sign, m), false)\n        );\n        if (backJump === -1) {\n            return lastTime; // last time\n        }\n        return jumps[backJump] > 0;\n    }\n\n\n    static shouldJump({ sheet, index, jumps }: SheetState) {\n        if (!Measure.hasJumpSign(sheet[index])) {\n            return false;\n        }\n        const sign = Measure.getJumpSign(sheet[index]);\n        if (sign.validator && !sign.validator({ sheet, index, jumps })) {\n            return false;\n        }\n        const allowedJumps = Sheet.getAllowedJumps({ sheet, index });\n        const timesJumped = jumps[index] || 0;\n        return timesJumped < allowedJumps;\n    }\n}\n\n/*\nTODO:\n\nmore typings\nspecial sections:\nIN: only play the first time\nCODA: only play last time\n\ntest standards:\n- Alice in Wonderland (dc al 2nd ending)\n- All or Nothing at All (dc al coda)\n- Are you real (intro + coda)\n- Armageddon (intro)\n- The Bat (coda sign inside repeat): ireal plays coda directly first time..\n- Bennys Tune (intro+coda sign inside repeat): ireal plays coda directly first time..\n- Bess You Is My Woman (coda sign inside repeat): ireal plays coda directly first time..\n- Blessed Relief (nested repeats, with odd behaviour)\n- Blue in Green (coda)\n- Miles Ahead (coda)\n*/\n","import { JumpSign, Sheet } from './Sheet';\n\nexport type MeasureOrString = Measure | string[] | string;\n\nexport interface Measure {\n    chords?: string[],\n    //voices?: string[][],\n    signs?: string[],\n    comments?: string[],\n    house?: number | number[],\n    times?: number,\n    section?: string,\n    idle?: true // bar is repeated\n};\n\nexport class Measure implements Measure {\n    static from(measure: MeasureOrString): Measure {\n        if (typeof measure === 'string') {\n            return {\n                chords: [measure]\n            }\n        }\n        if (Array.isArray(measure)) {\n            return {\n                chords: [].concat(measure)\n            }\n        }\n        return Object.assign({}, measure);\n        // return measure;\n    }\n\n    static hasSign(sign: string, measure: MeasureOrString): boolean {\n        measure = Measure.from(measure);\n        return !!measure.signs && measure.signs.includes(sign);\n    }\n\n    static hasHouse(measure: MeasureOrString, number?: number): boolean {\n        measure = Measure.from(measure);\n        let { house } = measure;\n        if (!house) {\n            return false;\n        } else if (number === undefined) {\n            return true;\n        }\n        if (!Array.isArray(house)) {\n            house = [house];\n        }\n        return house.includes(number);\n    }\n\n    static getJumpSign(measure): JumpSign {\n        const signs = (Measure.from(measure).signs || [])\n            .filter(s => Object.keys(Sheet.jumpSigns).includes(s));\n        if (signs.length > 1) {\n            console.warn('measure cannot contain more than one repeat sign', measure);\n        }\n        return Sheet.jumpSigns[signs[0]];\n    }\n\n    static hasJumpSign(measure: MeasureOrString): boolean {\n        return Object.keys(Sheet.jumpSigns)\n            .reduce((match, current) => match || Measure.hasSign(current, measure), false);\n    }\n}","import { Measure, MeasureOrString } from './Measure';\nimport { Measures } from './Sheet';\n\n// extension of https://github.com/daumling/ireal-renderer/blob/master/src/ireal-renderer.js\n\nexport class RealParser {\n    /**\n     * The RegExp for a complete chord. The match array contains:\n     * 1 - the base note\n     * 2 - the modifiers (+-ohd0123456789 and su for sus)\n     * 3 - any comments (may be e.g. add, sub, or private stuff)\n     * 4 - the \"over\" part starting with a slash\n     * 5 - the top chord as (chord)\n     * @type RegExp\n     */\n\n    static chordRegex = /^([ A-GW][b#]?)((?:sus|[\\+\\-\\^\\dhob#])*)(\\*.+?\\*)*(\\/[A-G][#b]?)?(\\(.*?\\))?/;\n\n    static regExps = [\n        /^\\*[a-zA-Z]/,\t\t\t\t\t\t\t// section\n        /^T\\d\\d/,\t\t\t\t\t\t\t\t// time measurement\n        /^N./,\t\t\t\t\t\t\t\t\t// repeat marker\n        /^<.*?>/,\t\t\t\t\t\t\t\t// comments\n        /^ \\(.*?\\)/,\t\t\t\t\t\t\t// blank and (note)\n        RealParser.chordRegex,\t\t\t\t// chords\n        /^LZ/,\t\t\t\t\t\t\t\t\t// 1 cell + right bar\n        /^XyQ/,\t\t\t\t\t\t\t\t\t// 3 empty cells\n        /^Kcl/\t\t\t\t\t\t\t\t\t// repeat last bar\n    ];\n\n    static replacements = {\n        \"LZ\": [\" \", \"|\"],\n        \"XyQ\": [\" \", \" \", \" \"],\n        \"Kcl\": [\"|\", \"x\", \" \"]\n    };\n\n    static getChord(iRealChord) {\n        return iRealChord.note + iRealChord.modifiers + (iRealChord.over ? '/' + this.getChord(iRealChord.over) : '');\n    }\n\n    static parseSheet(raw): Measures {\n        const tokens = RealParser.parse(raw);\n        console.log('tokensss!', tokens);\n        return RealParser.getSheet(tokens);\n    }\n\n    static getSheet(tokens): Measures {\n        const parsed = tokens\n            .reduce((current, token, index, array) => {\n                const lastBarEnded = ['{', '|', '[', '||' /* 'Z',  *//* , ']' */]\n                    .includes(token.bars || token.token);\n                let signs = token.annots || [];\n                const repeatStart = (token.bars || token.token) === '{';\n                const repeatEnd = (token.bars || token.token) === '}';\n                if (repeatStart) {\n                    signs.push('{');\n                }\n                if (repeatEnd) {\n                    signs.push('}');\n                }\n                // current.measure ends\n                if (lastBarEnded) {\n                    if (current.measure) {\n                        // simplify measure if no signs\n                        /* if (Object.keys(current.measure).find(k=>k)) {\n                            current.measure = current.measure.chords;\n                        } */\n                        current.measures.push(current.measure);\n                    }\n                    current.measure = { chords: [] };\n                }\n\n                const sectionStart = signs.find(a => a.match(/^\\*[a-zA-Z]/));\n                if (sectionStart) {\n                    signs = signs.filter(s => s !== sectionStart);\n                    current.measure.section = sectionStart.replace('*', '');\n                }\n\n                const hasCodaSign = signs.includes('Q');\n                if (hasCodaSign) {\n                    signs = signs.filter(s => s !== 'Q');\n                    let codaSign = 'ToCoda';\n                    if (!!current.measures.find(m => Measure.hasSign('ToCoda', m))) {\n                        codaSign = 'Coda';\n                    }\n                    current.measure.signs = (current.measure.signs || []).concat([codaSign]);\n                }\n\n                const houseStart = signs.find(s => !!s.match(/^N./));\n                if (houseStart) {\n                    signs = signs.filter(s => s !== houseStart);\n                    current.measure.house = parseInt(houseStart.replace('N', ''));\n                }\n\n                const time = signs.find(a => a.match(/^T\\d\\d/));\n                if (time) {\n                    signs = signs.filter(s => s !== time);\n                    current.measure.time = time.replace('T', '');\n                }\n\n                if (token.chord) {\n                    current.measure.chords.push(this.getChord(token.chord));\n                } else if (token.token === 'n') {\n                    current.measure.chords.push(0);\n                }\n\n                const last = current.measures[current.measures.length - 1];\n                if (last && last.chords[0] === 'r') {\n                    last.chords = current.measures[current.measures.length - 3].chords;\n                    current.measure.chords = current.measures[current.measures.length - 2].chords;\n                }\n                if (last && current.measure.chords[0] === 'x') {\n                    current.measure.chords = [].concat(last.chords);\n                    current.measure.idle = true;\n                }\n\n                if (signs.length) {\n                    current.measure.signs = (current.measure.signs || [])\n                        .concat(signs);\n                }\n                if (token.comments.length) {\n                    current.measure.comments = (current.measure.comments || [])\n                        .concat(token.comments.map(c => c.trim()));\n                }\n                return current;\n            }, { measure: null, signs: null, measures: [] });\n        if (parsed.measure.chords.length) {\n            parsed.measures.push(parsed.measure);\n        }\n        return parsed.measures;\n    }\n\n\n    static parse(raw: string): any {\n        var text = raw;\n        var arr = [], headers = [], comments = [];\n        var i;\n        text = text.trim();\n        // text = text.trimRight();\n        while (text) {\n            var found = false;\n            for (i = 0; i < RealParser.regExps.length; i++) {\n                var match = RealParser.regExps[i].exec(text);\n\n                if (match) {\n                    found = true;\n                    if (match.length <= 2) {\n                        const replacement = match[0];\n                        var repl = RealParser.replacements[replacement];\n                        arr = arr.concat(repl ? repl : [replacement]);\n                        text = text.substr(replacement.length);\n                    }\n                    else { // a chord\n                        arr.push(match);\n                        text = text.substr(match[0].length);\n                    }\n                    break;\n                }\n            }\n            if (!found) {\n                // ignore the comma separator\n                if (text[0] !== ',')\n                    arr.push(text[0]);\n                text = text.substr(1);\n            }\n        }\n        //\t\tconsole.log(arr);\n        // pass 2: extract prefixes, suffixes, annotations and comments\n        var out = [];\n        var obj = RealParser.newToken(out);\n        for (i = 0; i < arr.length; i++) {\n            var token = arr[i];\n            if (token instanceof Array) {\n                obj.chord = RealParser.parseChord(token);\n                token = \" \";\n            }\n            switch (token[0]) {\n                case ',': token = null; break; // separator\n                case 'S':\t// segno\n                case 'T':\t// time measurement\n                case 'Q':\t// coda\n                case 'N':\t// repeat\n                case 'U':\t// END\n                case 's':\t// small\n                case 'l':\t// normal\n                case 'f':\t// fermata\n                case '*': obj.annots.push(token); token = null; break;\n                case 'Y': obj.spacer++; token = null; break;\n                case 'r':\n                case 'x':\n                case 'W':\n                    obj.chord = new iRealChord(token, \"\", null, null);\n                    break;\n                case '<':\n                    token = token.substr(1, token.length - 2);\n                    token = token.replace(/XyQ/g, \"   \");\t// weird; needs to be done\n                    obj.comments.push(token);\n                    token = null; break;\n                default:\n            }\n            if (token) {\n                if (\"]}Z\".indexOf(arr[i + 1]) >= 0)\n                    obj.bars += arr[++i];\n                if (\"{[|\".indexOf(token) >= 0) {\n                    obj.bars += token; token = null;\n                }\n            }\n            if (token && i < arr.length - 1) {\n                obj.token = token;\n                obj = RealParser.newToken(out);\n            }\n        }\n        return out;\n    }\n\n\n\n    static parseChord(match) {\n        var note = match[1] || \" \";\n        var modifiers = match[2] || \"\";\n        var comment = match[3] || \"\";\n        if (comment)\n            modifiers += comment.substr(1, comment.length - 2).replace(\"XyQ\", \"   \");\n        var over = match[4] || \"\";\n        if (over[0] === '/')\n            over = over.substr(1);\n        var alternate = match[5] || null;\n        if (alternate) {\n            match = RealParser.chordRegex.exec(alternate.substr(1, alternate.length - 2));\n            if (!match)\n                alternate = null;\n            else\n                alternate = this.parseChord(match);\n        }\n        // empty cell?\n        if (note === \" \" && !alternate && !over)\n            return null;\n        if (over) {\n            var offset = (over[1] === '#' || over[1] === 'b') ? 2 : 1;\n            over = new iRealChord(over.substr(0, offset), over.substr(offset), null, null);\n        }\n        else\n            over = null;\n        return new iRealChord(note, modifiers, over, alternate);\n    }\n\n    static newToken(arr) {\n        var obj = new iRealToken;\n        arr.push(obj);\n        return obj;\n    }\n\n}\n\nclass iRealChord {\n    note: any;\n    modifiers: any;\n    over: any;\n    alternate: any;\n    constructor(note, modifiers, over, alternate) {\n        this.note = note;\n        this.modifiers = modifiers;\n        this.over = over;\n        this.alternate = alternate;\n    }\n}\n\nclass iRealToken {\n    chord: any;\n    spacer: number;\n    bars: string;\n    comments: any[];\n    token: any;\n    annots: any[];\n    constructor() {\n        this.annots = [];\n        this.comments = [];\n        this.bars = \"\";\n        this.spacer = 0;\n        this.chord = null;\n    }\n}","import * as JsDiff from 'diff';\nimport { Measure } from './Measure';\nimport { Sheet } from './Sheet';\nimport { noteArray } from '../util/util';\n\nexport class Snippet {\n\n    static render(snippet, options?) {\n        const parsed = Snippet.parse(snippet);\n        return Sheet.render(parsed, options);\n    }\n\n    static wrapPipes(string) {\n        return `|${string}|`.replace(/\\|+/g, '|');\n    }\n\n    static formatForDiff(snippet) {\n        return Snippet.minify(snippet)\n            .replace(/\\|/g, ' | ').trim();\n    }\n\n    static format(snippet, linebreaks = true) {\n        // replaces url chars back\n        let compact = Snippet.minify(snippet, false);\n        compact = Snippet.wrapPipes(compact);\n\n        if (linebreaks) {\n            compact = Snippet.parseBars(snippet).compact;\n        } else {\n            compact = compact.replace(/\\n/g, '|');\n        }\n        return compact\n            .replace(/\\|+/g, '|')\n            .replace(/\\|( +)\\|( +)/g, ' $1 $2') // remove spacer bar pipes\n            .replace(/\\|( +)\\|([1-9])/g, ' $1|$2')\n            .replace(/^\\s+|\\s+$/g, '') // remove spaces/line breaks from start/end\n    }\n\n    static parseBars(snippet) {\n        let compact = Snippet.minify(snippet, false);\n        compact = Snippet.wrapPipes(compact);\n        // insert spaces before first chord\n        let cells = compact.split('|').slice(1, -1);\n        cells = cells.map((bar, index) => {\n            if (!bar[0].match(/[1-9:]/)) {\n                bar = '  ' + bar;\n            } else if (bar[0] === ':') {\n                bar = ': ' + bar.slice(1);\n            }\n            return bar;\n        });\n        // find out indices of first houses\n        const houses = cells.reduce((offset, bar, index) => {\n            if (bar[0] === '1') {\n                offset.push(index);\n            }\n            return offset;\n        }, []);\n        // insert empty cells before additional houses\n        cells = cells.reduce((cells, bar, index) => {\n            if (bar[0].match(/[2-9]/)) {\n                const offset = houses.filter(h => h < index).reverse()[0];\n                cells = cells.concat(new Array(offset % 4).fill(''));\n            }\n            cells.push(bar);\n            return cells;\n        }, []);\n        // find out the maximal number of chars per column\n        const chars = cells.reduce((max, bar, index) => {\n            max[index % 4] = Math.max(bar.length, max[index % 4] || 0);\n            return max;\n        }, []);\n        // fill up each bar with spaces\n        compact = cells.map((bar, index) => {\n            let diff = chars[index % 4] - bar.length + 2;\n            if (diff > 0) {\n                bar += new Array(diff).fill(' ').join('');\n            }\n            // move double dots to end of bar\n            bar = bar.replace(/:(\\s+)$/, '$1:');\n            return bar;\n        }).join('|');\n\n        compact = Snippet.wrapPipes(compact);\n        // break string all 4 cells\n        let pipeIndex = -1;\n        compact = compact.split('').reduce((string, char, index) => {\n            if (char === '|') {\n                pipeIndex++;\n            }\n            if (char === '|' && pipeIndex % 4 === 0 && index > 0 && index < compact.length - 1) {\n                char = \"|\\n|\";\n                pipeIndex = 0;\n            }\n            return string + char;\n        }, '');\n        return { compact, cells, houses, chars };\n    }\n\n    static columnChars(snippet) {\n        const bars = snippet.split('|');\n        const chars = bars.reduce((max, bar, index) => {\n            max[index % 4] = Math.max(bar.length, max[index % 4] || 0);\n            return max;\n        }, []);\n    }\n\n    static getCellBounds(index, snippet) {\n        const { chars, cells, houses } = Snippet.parseBars(snippet);\n        if (houses.length && index > houses[0]) {\n            const offset = (houses.filter(h => h < index).reverse()[0]) % 4;\n            index += offset;\n        }\n        index = index % cells.length;\n        const col = index % 4;\n        const row = Math.floor(index / 4);\n        const rowlength = chars.reduce((sum, current) => sum + current + 3, 0) + 2;\n        const rowLeft = rowlength * row;\n        const left = rowLeft + chars.slice(0, col).reduce((sum, current, i) => sum + current + 3, 0) + 1;\n        return [left, left + chars[col] + 2];\n    }\n\n    static minify(snippet, urlsafe = false) {\n        let compact = (`|${snippet}|`)\n            .replace(/\\n+/g, '|') // replace line breaks with pipes\n            .replace(/\\s+/g, ' ') // no repeated pipes\n            .replace(/\\s?\\|\\s?/g, '|') // no pipes with spaces\n            .replace(/\\s?\\:\\s?/g, ':') // no repeat with spaces\n            .replace(/\\|+/g, '|') // no repeated pipes\n        if (urlsafe) {\n            // replaces url unfriendly chars\n            compact = compact\n                .replace(/\\|+/g, 'I')\n                .replace(/\\s+/g, '_')\n                .replace(/:/g, 'R')\n                .replace(/\\^/g, 'M')\n                .replace(/\\#/g, 'S')\n                .replace(/\\%/g, 'X')\n        } else {\n            // replaces url unfriendly chars\n            compact = compact\n                .replace(/\\I+/g, '|')\n                .replace(/\\_+/g, ' ')\n                .replace(/R/g, ':')\n                .replace(/M/g, '^')\n                .replace(/X/g, 'x')\n                .replace(/S/g, '#')\n        }\n        return compact.slice(1, -1);\n    }\n\n    static parse(snippet, simplify = true) {\n        const formatted = Snippet.format(snippet, false);\n        return formatted\n            .split('|') // split into measures\n            .map(measure => measure.split(' ')) // split measures by spaces\n            .map(measure => measure.filter(chord => !!chord)) // kill empty chords\n            .filter(measure => !measure || measure.length) // kill empty measures\n            .map(measure => ({ symbols: measure, signs: [] }))\n            // parse symbols to chords and signs\n            .map((measure: { symbols, signs, house, chords }) => {\n                // repeat start\n                if (measure.symbols[0][0] === ':') {\n                    if (measure.symbols[0].length === 1) {\n                        measure.symbols = measure.symbols.slice(1);\n                    }\n                    measure.signs.unshift('{');\n                }\n                const last = measure.symbols[measure.symbols.length - 1];\n                // repeat end\n                if (last[last.length - 1] === ':') {\n                    if (last.length === 1) {\n                        measure.symbols.pop();\n                    }\n                    measure.signs.push('}');\n                }\n                measure.symbols = measure.symbols.map(s => s.replace(/:/g, ''));\n                const house = measure.symbols.find(s => s.match(/^[1-9]$/));\n                if (house) {\n                    measure.house = parseInt(house);\n                }\n                measure.symbols = measure.symbols.filter(s => !s.match(/^[1-9]$/))\n                // houses\n                measure.chords = [].concat(measure.symbols);\n                delete measure.symbols;\n                return measure;\n            })\n            .map(measure => {\n                if (!simplify) {\n                    return measure;\n                }\n                if (measure.signs.length === 0) {\n                    delete measure.signs;\n                }\n                if (measure.chords.length === 0) {\n                    delete measure.chords;\n                }\n                return measure;\n            })\n            // kill empty measures\n            .filter(measure => Object.keys(measure).length > 0)\n            // simplify => measures with only chords will be arrays\n            .map(measure => {\n                if (!simplify) {\n                    return measure;\n                }\n                if (measure.chords && Object.keys(measure).length === 1) {\n                    return measure.chords.length === 1 ?\n                        measure.chords[0] : // simplify one chord measures\n                        measure.chords\n                }\n                return measure;\n            });\n    }\n\n    static nest(string) {\n        let nested = string.split('.')\n            .map(group => group.trim())\n            .map(group => group.split(' '))\n            .map(group => group.filter(chord => !!chord))  // kill empty chords\n            .filter(group => !group || group.length)\n            .map(group => group.length === 1 ? group[0] : group)\n        nested = nested.length === 1 ? nested[0] : nested;\n        return nested;\n    }\n\n    static parse2(snippet, simplify = true) {\n        const formatted = Snippet.format(snippet, false);\n        return formatted\n            .split('|') // split into measures\n            .filter(measure => measure && measure.length) // kill empty measures\n            .map(measure => ({ symbols: measure.trim(), signs: [] }))\n            // parse symbols to chords and signs\n            .map((measure: { symbols, signs, house, chords }) => {\n                // repeat start\n                if (measure.symbols[0] === ':') {\n                    measure.signs.unshift('{');\n                }\n                const last = measure.symbols[measure.symbols.length - 1];\n                // repeat end\n                if (last === ':') {\n                    measure.signs.push('}');\n                }\n                measure.symbols = measure.symbols.replace(/:/g, '');\n\n                /* const house = measure.symbols[0].match(/^[1-9]$/);\n                if (house) {\n                    measure.house = parseInt(house);\n                    measure.symbols = measure.symbols.slice(1);\n                } */\n                measure.chords = [].concat(Snippet.nest(measure.symbols));\n                delete measure.symbols;\n                return measure;\n            })\n            .map(measure => {\n                if (!simplify) {\n                    return measure;\n                }\n                if (measure.signs.length === 0) {\n                    delete measure.signs;\n                }\n                if (measure.chords.length === 0) {\n                    delete measure.chords;\n                }\n                return measure;\n            })\n            // kill empty measures\n            .filter(measure => Object.keys(measure).length > 0)\n            // simplify => measures with only chords will be arrays\n            .map(measure => {\n                if (!simplify) {\n                    return measure;\n                }\n                if (measure.chords && Object.keys(measure).length === 1) {\n                    return measure.chords.length === 1 ?\n                        measure.chords[0] : // simplify one chord measures\n                        measure.chords\n                }\n                return measure;\n            });\n    }\n\n    static testFormat(sheet) {\n        return sheet.map(m => Measure.from(m)).map(m => m.chords).join(' ');\n    }\n\n    static from(sheet, format = true) {\n        const snippet = sheet\n            .map(m => Measure.from(m))\n            .reduce((snippet, { signs, house, chords }) => {\n                const repeatStart = signs && signs.includes('{');\n                const repeatEnd = signs && signs.includes('}');\n                return snippet + `|${repeatStart ? ':' : ''}${house || ''} ${chords ? chords.join(' ') : ''}${repeatEnd ? ':' : ''}`;\n            }, '');\n        if (format) {\n            return Snippet.format(snippet);\n        }\n        return Snippet.minify(snippet);\n    }\n\n    static expand(snippet, options?) {\n        let rendered = Snippet.render(snippet, options);\n        rendered = rendered\n            .map(m => Measure.from(m))\n            .map(m => {\n                delete m.house;\n                delete m.signs;\n                return m;\n            });\n        const expanded = Snippet.from(rendered);\n        return expanded;\n        /* return from(Sheet.render(render(snippet))); */\n    }\n\n    static diff(snippetA, snippetB) {\n        const diffFormat = [Snippet.formatForDiff(snippetA), Snippet.formatForDiff(snippetB)];\n        return JsDiff.diffWords(\n            diffFormat[0], diffFormat[1]\n        );\n    }\n}\n","\nimport k from './drummer/kick.wav';\nimport s from './drummer/snare.wav';\nimport h from './drummer/hihat.wav';\nimport r from './drummer/ride.wav';\nimport c from './drummer/crash.wav';\nimport rs from './drummer/rimshot.wav';\n\nexport const kick = k;\nexport const snare = s;\nexport const hihat = h;\nexport const ride = r;\nexport const crash = c;\nexport const rimshot = rs;\nexport const drumset = [kick, snare, hihat, ride, crash, rimshot];\nexport const drumSamples = { 'C1': kick, 'C2': snare, 'C3': hihat, 'C4': ride, 'C5': crash, 'C6': rimshot };","import C1 from \"./piano/C1.mp3\";\nimport Db1 from \"./piano/Db1.mp3\";\nimport D1 from \"./piano/D1.mp3\";\nimport Eb1 from \"./piano/Eb1.mp3\";\nimport E1 from \"./piano/E1.mp3\";\nimport F1 from \"./piano/F1.mp3\";\nimport Gb1 from \"./piano/Gb1.mp3\";\nimport G1 from \"./piano/G1.mp3\";\nimport Ab1 from \"./piano/Ab1.mp3\";\nimport A1 from \"./piano/A1.mp3\";\nimport Bb1 from \"./piano/Bb1.mp3\";\nimport B1 from \"./piano/B1.mp3\";\nimport C2 from \"./piano/C2.mp3\";\nimport Db2 from \"./piano/Db2.mp3\";\nimport D2 from \"./piano/D2.mp3\";\nimport Eb2 from \"./piano/Eb2.mp3\";\nimport E2 from \"./piano/E2.mp3\";\nimport F2 from \"./piano/F2.mp3\";\nimport Gb2 from \"./piano/Gb2.mp3\";\nimport G2 from \"./piano/G2.mp3\";\nimport Ab2 from \"./piano/Ab2.mp3\";\nimport A2 from \"./piano/A2.mp3\";\nimport Bb2 from \"./piano/Bb2.mp3\";\nimport B2 from \"./piano/B2.mp3\";\nimport C3 from \"./piano/C3.mp3\";\nimport Db3 from \"./piano/Db3.mp3\";\nimport D3 from \"./piano/D3.mp3\";\nimport Eb3 from \"./piano/Eb3.mp3\";\nimport E3 from \"./piano/E3.mp3\";\nimport F3 from \"./piano/F3.mp3\";\nimport Gb3 from \"./piano/Gb3.mp3\";\nimport G3 from \"./piano/G3.mp3\";\nimport Ab3 from \"./piano/Ab3.mp3\";\nimport A3 from \"./piano/A3.mp3\";\nimport Bb3 from \"./piano/Bb3.mp3\";\nimport B3 from \"./piano/B3.mp3\";\nimport C4 from \"./piano/C4.mp3\";\nimport Db4 from \"./piano/Db4.mp3\";\nimport D4 from \"./piano/D4.mp3\";\nimport Eb4 from \"./piano/Eb4.mp3\";\nimport E4 from \"./piano/E4.mp3\";\nimport F4 from \"./piano/F4.mp3\";\nimport Gb4 from \"./piano/Gb4.mp3\";\nimport G4 from \"./piano/G4.mp3\";\nimport Ab4 from \"./piano/Ab4.mp3\";\nimport A4 from \"./piano/A4.mp3\";\nimport Bb4 from \"./piano/Bb4.mp3\";\nimport B4 from \"./piano/B4.mp3\";\nimport C5 from \"./piano/C5.mp3\";\nimport Db5 from \"./piano/Db5.mp3\";\nimport D5 from \"./piano/D5.mp3\";\nimport Eb5 from \"./piano/Eb5.mp3\";\nimport E5 from \"./piano/E5.mp3\";\nimport F5 from \"./piano/F5.mp3\";\nimport Gb5 from \"./piano/Gb5.mp3\";\nimport G5 from \"./piano/G5.mp3\";\nimport Ab5 from \"./piano/Ab5.mp3\";\nimport A5 from \"./piano/A5.mp3\";\nimport Bb5 from \"./piano/Bb5.mp3\";\nimport B5 from \"./piano/B5.mp3\";\nimport C6 from \"./piano/C6.mp3\";\nimport Db6 from \"./piano/Db6.mp3\";\nimport D6 from \"./piano/D6.mp3\";\nimport Eb6 from \"./piano/Eb6.mp3\";\nimport E6 from \"./piano/E6.mp3\";\nimport F6 from \"./piano/F6.mp3\";\nimport Gb6 from \"./piano/Gb6.mp3\";\nimport G6 from \"./piano/G6.mp3\";\nimport Ab6 from \"./piano/Ab6.mp3\";\nimport A6 from \"./piano/A6.mp3\";\nimport Bb6 from \"./piano/Bb6.mp3\";\nimport B6 from \"./piano/B6.mp3\";\nimport C7 from \"./piano/C7.mp3\";\nimport Db7 from \"./piano/Db7.mp3\";\nimport D7 from \"./piano/D7.mp3\";\nimport Eb7 from \"./piano/Eb7.mp3\";\nimport E7 from \"./piano/E7.mp3\";\nimport F7 from \"./piano/F7.mp3\";\nimport Gb7 from \"./piano/Gb7.mp3\";\nimport G7 from \"./piano/G7.mp3\";\nimport Ab7 from \"./piano/Ab7.mp3\";\nimport A7 from \"./piano/A7.mp3\";\nimport Bb7 from \"./piano/Bb7.mp3\";\nimport B7 from \"./piano/B7.mp3\";\n\nexport const piano = [\n    C1,\n    Db1,\n    D1,\n    Eb1,\n    E1,\n    F1,\n    Gb1,\n    G1,\n    Ab1,\n    A1,\n    Bb1,\n    B1,\n    C2,\n    Db2,\n    D2,\n    Eb2,\n    E2,\n    F2,\n    Gb2,\n    G2,\n    Ab2,\n    A2,\n    Bb2,\n    B2,\n    C3,\n    Db3,\n    D3,\n    Eb3,\n    E3,\n    F3,\n    Gb3,\n    G3,\n    Ab3,\n    A3,\n    Bb3,\n    B3,\n    C4,\n    Db4,\n    D4,\n    Eb4,\n    E4,\n    F4,\n    Gb4,\n    G4,\n    Ab4,\n    A4,\n    Bb4,\n    B4,\n    C5,\n    Db5,\n    D5,\n    Eb5,\n    E5,\n    F5,\n    Gb5,\n    G5,\n    Ab5,\n    A5,\n    Bb5,\n    B5,\n    C6,\n    Db6,\n    D6,\n    Eb6,\n    E6,\n    F6,\n    Gb6,\n    G6,\n    Ab6,\n    A6,\n    Bb6,\n    B6,\n    C7,\n    Db7,\n    D7,\n    Eb7,\n    E7,\n    F7,\n    Gb7,\n    G7,\n    Ab7,\n    A7,\n    Bb7,\n    B7,\n];","import iRealReader from 'ireal-reader';\nimport { Trio, Sampler, util } from '../lib';\nimport { bossa } from '../src/grooves/bossa';\n// import { disco } from '../src/grooves/disco';\nimport { funk } from '../src/grooves/funk';\nimport { swing } from '../src/grooves/swing';\nimport { RealParser } from '../src/sheet/RealParser';\nimport { Snippet } from '../src/sheet/Snippet';\nimport link from '../songs/1350.json';\n/* import { harp } from './samples/harp'; */\nimport { drumset } from '../src/samples/drumset';\nimport { piano } from '../src/samples/piano';\nvar AudioContext = window.AudioContext // Default\n    || window.webkitAudioContext // Safari and old versions of Chrome\n    || false;\nif (!AudioContext) {\n    alert(\"Sorry, but the Web Audio API is not supported by your browser. Please, consider upgrading to the latest version or downloading Google Chrome or Mozilla Firefox\");\n}\nconst context = new AudioContext();\nconst playlist = new iRealReader(decodeURI(link));\n\n// bass = new Synthesizer({ duration: 400, gain: gains[w1], type: w1, mix });\nconst keyboard = new Sampler({ samples: piano, midiOffset: 24, gain: 1, context });\n// const keyboard = new WebAudioFont({ context, preset: 50, gain: .8 });\n// const bass = new WebAudioFont({ context, preset: 366 });\nconst bass = keyboard;\n// const harpInstrument = new Sampler({ samples: harp, midiOffset: 24, gain: 1, context });\nconst drums = new Sampler({ samples: drumset, context, gain: 0.5, duration: 6000 });\nconst band = new Trio({ context, piano: keyboard, bass, drums, solo: false });\n\n\nwindow.onload = function () {\n    // buttons\n    const playJazz = document.getElementById('jazz');\n    const playFunk = document.getElementById('funk');\n    const playBossa = document.getElementById('bossa');\n    const stopButton = document.getElementById('stop');\n    const slower = document.getElementById('slower');\n    const faster = document.getElementById('faster');\n    const next = document.getElementById('next');\n    const searchInput = document.getElementById('searchInput');\n    const playChords = document.getElementById('playChords');\n    const format = document.getElementById('format');\n    const minify = document.getElementById('minify');\n    const standardTitle = document.getElementById('standardTitle');\n    const textarea = document.getElementById('chords');\n    const cheapSynths = document.getElementById('cheapsynths');\n    const usePiano = document.getElementById('usePiano');\n    let standard, sheet, groove = swing;\n\n    function getStandard(playlist, query) {\n        let newStandard;\n        if (query) {\n            newStandard = util.randomElement(playlist.songs.filter(s => s.title.toLowerCase().includes(query.toLowerCase())));\n        } else {\n            newStandard = util.randomElement(playlist.songs);\n        }\n        \n        if (newStandard) {\n            newStandard.music.measures = RealParser.parseSheet(newStandard.music.raw); // TODO: add Song that can be passed to comp\n            console.log('m',newStandard.music.measures);\n            \n            return newStandard;\n\n        }\n    }\n\n    loadStandard();\n\n    next.addEventListener('click', () => {\n        loadStandard();\n        searchInput.value = '';\n    });\n\n    searchInput.addEventListener('keyup', () => {\n        const query = searchInput.value;\n        loadStandard(query);\n    });\n\n    function stop() {\n        if (band.pulse) {\n            band.pulse.stop();\n        }\n    }\n\n    function loadStandard(query) {\n        standard = getStandard(playlist, query) || standard;\n        textarea.value = Snippet.from(standard.music.measures);\n        setTitle(standard.composer + ' - ' + standard.title);\n        sheet = {\n            composer: standard.composer,\n            title: standard.title,\n            chords: standard.music.measures\n        };\n        stop();\n    }\n\n    function setTitle(title) {\n        standardTitle.innerHTML = title;\n    }\n\n    function play(leadsheet = sheet, groove = swing) {\n        if (band.pulse) {\n            band.pulse.stop();\n        }\n        const forms = 2;\n        const time = 4;\n        const bpm = groove.tempo || 130;\n        setTitle(sheet.composer + ' - ' + sheet.title);\n        band.comp(sheet, {\n            render: { forms },\n            metronome: false,\n            exact: false,\n            cycle: time,\n            bpm,\n            groove,\n            voicings: {\n                range: ['C3', 'C5'], // allowed voice range\n                maxVoices: 4, // maximum number of voices per chord\n                maxDistance: 7,  // general max distance between single voices\n                minDistance: 1,  // general max distance between single voices\n                minBottomDistance: 3, // min semitones between the two bottom notes\n                minTopDistance: 2, // min semitones between the two top notes\n                noTopDrop: true,\n                noTopAdd: true,\n                noBottomDrop: false,\n                noBottomAdd: true,\n                logging: true\n            },\n            onMeasure: (measure) => {\n                selectCell(measure.index);\n\n            }\n        });\n    }\n    usePiano.addEventListener('click', () => {\n        stop();\n        band.pianist.instrument = keyboard;\n        band.bassist.instrument = bass;\n        /* band.soloist.instrument = util.randomSynth(band.mix, allowed); */\n        console.log('pianist:', band.pianist.instrument.type);\n        console.log('bassist:', band.bassist.instrument.type);\n        play();\n    });\n    cheapSynths.addEventListener('click', () => {\n        stop();\n        const allowed = ['triangle', 'square', 'sawtooth'];\n        band.pianist.instrument = util.randomSynth(band.mix, allowed);\n        band.bassist.instrument = util.randomSynth(band.mix, ['sine']);\n        /* band.soloist.instrument = util.randomSynth(band.mix, allowed); */\n        console.log('pianist:', band.pianist.instrument.type);\n        console.log('bassist:', band.bassist.instrument.type);\n        play()\n    });\n\n    playJazz.addEventListener('click', () => play(sheet, swing));\n    playFunk.addEventListener('click', () => play(sheet, funk));\n    playBossa.addEventListener('click', () => play(sheet, bossa));\n\n\n    stopButton.addEventListener('click', () => {\n        stop();\n    });\n    slower.addEventListener('click', () => {\n        band.pulse.changeTempo(band.pulse.props.bpm - 10);\n        console.log('tempo', band.pulse.props.bpm);\n    });\n    faster.addEventListener('click', () => {\n        band.pulse.changeTempo(band.pulse.props.bpm + 10);\n        console.log('tempo', band.pulse.props.bpm);\n    });\n\n    textarea.addEventListener('click', () => {\n        if (band.pulse) {\n            band.pulse.stop();\n        }\n        sheet = {\n            title: 'Custom Changes',\n            composer: 'You',\n            chords: Snippet.parse(textarea.value),\n        }\n        setTitle(sheet.composer + ' - ' + sheet.title);\n    });\n\n    playChords.addEventListener('click', () => {\n        // the parseChords fn will transform the textarea string to a chord array\n        sheet = {\n            title: sheet.title,\n            composer: sheet.composer,\n            chords: Snippet.parse(textarea.value),\n        }\n        textarea.value = Snippet.format(textarea.value);\n        play();\n    });\n\n    function selectCell(n) {\n        const bounds = Snippet.getCellBounds(n, textarea.value);\n        textarea.focus();\n        textarea.setSelectionRange(bounds[0], bounds[1]);\n    }\n    let n = 0;\n    format.addEventListener('click', () => {\n        textarea.value = Snippet.format(textarea.value);\n        selectCell(n++);\n\n    });\n    minify.addEventListener('click', () => {\n        textarea.value = Snippet.minify(textarea.value, true);\n    });\n}\n"]}