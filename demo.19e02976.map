{"version":3,"sources":["../node_modules/ireal-reader/unscramble.js","../node_modules/ireal-reader/parser.js","../node_modules/ireal-reader/index.js","../../../.nvm/versions/node/v8.11.1/lib/node_modules/parcel/node_modules/process/browser.js","../node_modules/waaclock/lib/WAAClock.js","../node_modules/waaclock/index.js","../lib/Pulse.js","../lib/sheet/Measure.js","../node_modules/tonal-note/build/es6.js","../node_modules/tonal-array/build/es6.js","../node_modules/tonal-interval/build/es6.js","../node_modules/tonal-distance/build/es6.js","0","../node_modules/tonal-pcset/build/es6.js","../node_modules/tonal-dictionary/build/es6.js","../node_modules/tonal-scale/build/es6.js","../node_modules/tonal-chord/build/es6.js","../node_modules/tonal/index.js","../lib/instruments/Instrument.js","../lib/instruments/Synthesizer.js","../lib/symbols.js","../lib/util/util.js","../lib/harmony/Harmony.js","../lib/sheet/Sheet.js","../lib/Metronome.js","../lib/util/Permutation.js","../lib/harmony/Voicing.js","../node_modules/diff/dist/diff.js","../lib/sheet/Snippet.js","../lib/util/Logger.js","../lib/Band.js","../lib/musicians/Musician.js","../lib/grooves/swing.js","../lib/musicians/Pianist.js","../lib/musicians/Drummer.js","../lib/musicians/Bassist.js","../lib/instruments/Sampler.js","../lib/instruments/Kick.js","../lib/instruments/Snare.js","../lib/instruments/PlasticDrums.js","../lib/improvisation/Improvisation.js","../lib/improvisation/methods.js","../lib/musicians/Improvisor.js","../lib/Trio.js","../lib/sheet/RealParser.js","../lib/instruments/MidiOut.js","../lib/musicians/Permutator.js","../lib/index.js","../src/harmony/Harmony.ts","../src/instruments/Instrument.ts","../src/instruments/Synthesizer.ts","../src/symbols.ts","../src/util/util.ts","../src/grooves/bossa.ts","../src/grooves/funk.ts","../src/grooves/swing.ts","../src/sheet/Sheet.ts","../src/sheet/Measure.ts","../src/sheet/RealParser.ts","../src/sheet/Snippet.ts","../src/samples/drumset.js","../src/samples/piano.js","demo.js"],"names":["cachedSetTimeout","cachedClearTimeout","process","module","exports","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","setTimeout","e","call","runClearTimeout","marker","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","Item","array","noop","nextTick","args","Array","arguments","i","push","prototype","apply","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","__importDefault","mod","__esModule","Object","defineProperty","value","waaclock_1","require","Pulse","props","defaults","events","callbackAtTime","assign","context","AudioContext","clock","default","toleranceEarly","toleranceLate","getMeasureLength","bpm","beatsPerMeasure","cycle","arrayPulse","children","path","start","callback","deadline","_this","isArray","item_1","delay","currentTime","event","childLength","map","el","tickArray","l","Promise","resolve","reject","tick","warn","stop","changeTempo","newTempo","factor","filter","timeStretch","Sheet_1","Measure","from","measure","property","_a","_b","hasSign","sign","signs","includes","hasHouse","number","house","undefined","getJumpSign","s","keys","Sheet","jumpSigns","hasJumpSign","reduce","match","current","enharmonic","NAMES","split","names","accTypes","slice","n","acc","indexOf","SHARPS","FLATS","REGEX","tokenize","str","m","exec","toUpperCase","replace","NO_NOTE","freeze","SEMI","properties","tokens","letter","octStr","p","charCodeAt","chroma","step","alt","midi","oct","freq","midiToFreq","memo","fn","cache","pc","isMidiRange","note","tuning","Math","pow","L2","log","L440","freqToMidi","v","round","LETTERS","stepToLetter","fillStr","join","numToStr","num","op","altToAcc","fromProps","baseNote","build","fromMidi","sharps","floor","simplify","sameAcc","alteration","useSharps","range","rotate","sort","unique","ascR","b","a","descR","times","arr","compact","height","src","shuffle","rnd","t","random","permutations","perm","pos","newPerm","splice","fromSemitones","IVL_TNL","IVL_STR","RegExp","SIZES","TYPES","CLASSES","types","NO_IVL","abs","qToAlt","type","q","test","altToQ","numToStep","simple","semitones","ic","ivl","_c","d","intervalProps","invert","IN","IQ","c","o","transpose","trFifths","fifths","transposeBy","addIntervals","add","subtract","interval","FIFTHS","fOcts","f","FIFTH_OCTS","encode","ref","STEPS","unaltered","decode","encoder","encodeNote","noteProps","encodeIvl","iprops","tr","to","isDescending","decodeIvl","ivl1","ivl2","i1","i2","chromatic","lydian","major","mixolydian","dorian","aeolian","phrygian","locrian","melodic minor","melodic minor second mode","lydian augmented","lydian dominant","melodic minor fifth mode","locrian #2","altered","harmonic minor","phrygian dominant","half-whole diminished","diminished","major pentatonic","lydian pentatonic","mixolydian pentatonic","locrian pentatonic","minor pentatonic","minor six pentatonic","minor hexatonic","flat three pentatonic","flat six pentatonic","major flat two pentatonic","whole tone pentatonic","ionian pentatonic","lydian #5P pentatonic","lydian dominant pentatonic","minor #7M pentatonic","super locrian pentatonic","in-sen","iwato","hirajoshi","kumoijoshi","pelog","vietnamese 1","vietnamese 2","prometheus","prometheus neopolitan","ritusen","scriabin","piongio","major blues","minor blues","composite blues","augmented","augmented heptatonic","dorian #4","lydian diminished","whole tone","leading whole tone","lydian minor","locrian major","neopolitan","neopolitan minor","neopolitan major","neopolitan major pentatonic","romanian minor","double harmonic lydian","harmonic major","double harmonic major","egyptian","hungarian minor","hungarian major","oriental","spanish heptatonic","flamenco","balinese","todi raga","malkos raga","kafi raga","purvi raga","persian","bebop","bebop dominant","bebop minor","bebop major","bebop locrian","minor bebop","mystery #1","enigmatic","minor six diminished","ionian augmented","lydian #9","ichikosucho","six tone symmetric","4","64","5","M","M#5","M#5add9","M13","M13#11","M6","M6#11","M69","M69#11","M7#11","M7#5","M7#5sus4","M7#9#11","M7add13","M7b5","M7b6","M7b9","M7sus4","M9","M9#11","M9#5","M9#5sus4","M9b5","M9sus4","Madd9","Maj7","Mb5","Mb6","Msus2","Msus4","Maddb9","7","9","11","13","11b9","13#11","13#9","13#9#11","13b5","13b9","13b9#11","13no5","13sus4","69#11","7#11","7#11b13","7#5","7#5#9","7#5b9","7#5b9#11","7#5sus4","7#9","7#9#11","7#9#11b13","7#9b13","7add6","7b13","7b5","7b6","7b9","7b9#11","7b9#9","7b9b13","7b9b13#11","7no5","7sus4","7sus4b9","7sus4b9b13","9#11","9#11b13","9#5","9#5#11","9b13","9b5","9no5","9sus4","m#5","m11","m11A 5","m11b5","m13","m6","m69","m7","m7#5","m7add11","m7b5","m9","m9#5","m9b5","mMaj7","mMaj7b6","mM9","mM9b6","mb6M7","mb6b9","o7","o7M7","oM7","sus24","+add#9","madd4","madd9","chromas","modes","isChroma","intervals","isEqual","isSubsetOf","isSupersetOf","chr","pcsetNum","set","parseInt","clen","forEach","all","toString","normalize","binary","_","r","IVLS","s1","s2","notes","dictionary","raw","data","index","ivls","key","alias","allKeys","dict","combine","scale","sdata","chord","cdata","pcset","exists","NO_SCALE","setnum","memoize","nameOrTonic","tonic","substring","modeNames","tonics","x","chords","inScale","toScale","supersets","isSuperset","subsets","isSubset","NO_CHORD","NUM_TYPES","Note","Interval","Distance","Dictionary","Scale","Chord","PcSet","Harmony_1","Instrument","gain","mix","onTrigger","midiOffset","activeEvents","init","destination","playNotes","settings","Harmony","getMidi","noteOff","duration","notesOn","pulse","active","notesOff","find","keep","playKeys","__extends","extendStatics","setPrototypeOf","__proto__","hasOwnProperty","__","constructor","create","Instrument_1","tonal_1","util_1","Synthesizer","_super","attack","decay","sustain","release","getVoice","frequency","oscNode","createOscillator","gainNode","createGain","connect","lowestGain","startKeys","time","endless","voice","adsr","stopVoice","setTargetAtTime","stopVoices","voices","__importStar","result","k","groupFilter","group","item","level","max","groups","levels","Set","scaleNames","scales","symbol","chordNames","groupNames","symbolName","long","pool","symbols","short","scaleName","chordName","randomItem","randomScale","randomChord","Synthesizer_1","symbols_1","steps","randomNumber","arraySum","randomElement","weighted","total","w","shuffleArray","j","getPath","measures","traveled","min","getDuration","divisions","noteLength","measureLength","resolveChords","pattern","fraction","NaN","hasOff","division","offbeatReducer","bar","last","randomSynth","allowed","gains","wave","param","linearRampToValueAtTime","randomDelay","maxMs","isInRange","transposeNotes","transposeToRange","getAverageMidi","offset","sum","getDistancesToRangeEnds","rangeMidi","getRangePosition","getRangeDirection","defaultDirection","border","position","direction","force","getStep","getIntervalFromStep","getStepsFromDegree","degree","getStepsInChord","root","getTonalChord","getStepFromInterval","getStepInChord","getChordScales","pickChordScale","findDegree","degreeOrStep","intervalsOrSteps","isInterval","degree_1","minInterval","error","getDegreeFromStep","hasDegree","hasAllDegrees","degrees","res","getScaleDegree","getScalePattern","renderIntervals","renderSteps","permutateIntervals","getDegreeFromInterval","fixed","fixInterval","getDegreeInChord","getPatternInChord","permutation","getDigitalPattern","renderDigitalPattern","getGuideTones","isFirstInPath","isBarStart","isFormStart","isOffbeat","otherDirection","totalDiff","diff","weight","added","count","removed","kept","balance","changes","sortByDegree","diffDegrees","chain","closest","unshift","reverse","renderAbsoluteNotes","octave","absolute","getIntervals","smallestInterval","sortNotes","analyzeVoicing","sortedIntervals","sortMinInterval","semitoneDifference","semitoneMovement","longestChild","isPitchClass","mapTree","tree","modifier","siblings","subtree","flattenTree","flat","expandTree","chordHasIntervals","has","isOptional","isForbidden","isDominantChord","isMajorChord","isMinorChord","isMinorTonic","getChordType","getChordNotes","validate","validateWithoutRoot","getVoicing","omitRoot","previousVoicing","quartal","semitoneDistance","noteA","noteB","noteArray","slots","fill","factorial","__assign","tonal_2","tonal_3","tonal_4","isBlack","hasSamePitch","ignoreOctave","getBassNote","irealToTonal","ignoreSlash","transposeChord","intervalComplement","fix","fixIndex","invertInterval","positive","complement","forceDirection","noUnison","inversion","minIntervals","chordA","chordB","mapMinInterval","preferredDirection","accessor","getNearestNote","getNearestTargets","targets","flip","target","intervalMatrix","pitchRegex","Measure_1","render","sheet","options","clear","state","forms","nested","fallbackToZero","firstTime","newForm","runs","nextMeasure","nextSection","nextIndex","nextForm","jumps","lastTime","shouldJump","braces","getJumpDestination","wipeKeys","visits","section","getNextSectionIndex","readyForFineOrCoda","next","getNextHouseIndex","findPair","pairs","move","stack","findMatch","fine","pair","getBracePair","getRelatedHouse","canVisitHouse","houses","numberMap","wiped","latestHouse","isFirstHouse","getAllowedJumps","backJump","validator","allowedJumps","timesJumped","melody","flatten","withPath","expand","items","lastSiblingIndex","expanded","pathOf","nextItem","nextValue","nextPath","stringify","Metronome","synth","ready","bars","Permutation","permutateElements","isValid","combinations","subcombinations","permutationComplexity","validations","permutateArray","combineValidators","validators","_i","binomial","combs","head","tailcombs","Permutation_1","Logger_1","Voicing","getNextVoicing","rangeBorders","maxVoices","forceBestPick","maxDistance","minBottomDistance","minTopDistance","noTopDrop","noTopAdd","noBottomDrop","noBottomAdd","idleChance","logIdle","logging","sortChoices","filterChoices","getAllVoicePermutations","exit","pick","Logger","logVoicing","firstPick","combination","firstNote","firstNoteInRange","pick_1","choices","getAllChoices","choice","dropped","topNotes","bottomNotes","difference","bestPick","getDesiredDirection","pick_2","movement","voicingOptions","omitNotes","getAllNoteSelections","getVoicePermutations","validatePermutation","voicingValidator","minDistance","notesAtPositionValidator","degreesAtPositionValidator","topDegrees","bottomDegrees","validateInterval","required","getRequiredNotes","withoutPitches","optional","getOptionalNotes","selection","pitches","voicing","getAvailableTensions","getAllTensions","requiredSteps","req","lastPitches","bottomInterval","bottomNote","leads","voiceLeading","origin","analyzeVoiceLeading","more","less","voicingIntervals","oblique","similar","parallel","containsPitch","selected","remaining","hasTonic","thresholds","distances","global","factory","define","amd","self","Diff","buildValues","components","newString","oldString","useLongestToken","componentPos","componentLen","newPos","oldPos","component","tmp","oldValue","lastComponent","equals","pop","done","castInput","removeEmpty","newLen","oldLen","editLength","maxEditLength","bestPath","extractCommon","execEditLength","diagonalPath","basePath","addPath","removePath","_oldPos","canAdd","canRemove","clonePath","pushComponent","ret","commonCount","left","right","comparator","ignoreCase","toLowerCase","chars","characterDiff","generateOptions","extendedWordChars","reWhitespace","wordDiff","ignoreWhitespace","lineDiff","diffLines","oldStr","newStr","retLines","linesAndNewlines","line","newlineIsToken","trim","sentenceDiff","cssDiff","_typeof","obj","Symbol","iterator","_toConsumableArray","_arrayWithoutHoles","arr2","_iterableToArray","iter","_nonIterableSpread","TypeError","objectPrototypeToString","jsonDiff","canonicalize","replacementStack","replacer","canonicalizedObj","toJSON","sortedKeys","_key","_this$options","undefinedReplacement","_this$options$stringi","stringifyReplacer","JSON","arrayDiff","parsePatch","uniDiff","diffstr","delimiters","list","parseIndex","header","hunks","_line","parseHunk","strict","parseFileHeader","fileHeader","keyPrefix","fileName","substr","chunkHeaderIndex","chunkHeader","hunk","addCount","removeCount","operation","lines","linedelimiters","newLines","oldLines","distanceIterator","minLine","maxLine","wantForward","backwardExhausted","forwardExhausted","localOffset","applyPatch","source","removeEOFNL","addEOFNL","compareLine","lineNumber","patchContent","errorCount","fuzzFactor","hunkFits","toPos","content","oldStart","diffOffset","_hunk","_toPos","delimiter","previousOperation","_k","structuredPatch","oldFileName","newFileName","oldHeader","newHeader","contextLines","entry","oldRangeStart","newRangeStart","curRange","oldLine","newLine","_loop","_curRange","prev","_curRange2","_curRange3","contextSize","oldEOFNewline","newEOFNewline","noNlBeforeAdds","createTwoFilesPatch","newStart","arrayStartsWith","calcLineCount","_calcOldNewLineCount","calcOldNewLineCount","myCount","mine","theirCount","theirs","loadPatch","base","fileNameChanged","patch","selectField","conflict","hunkBefore","check","cloneHunk","mergeLines","mineOffset","mineLines","theirOffset","theirLines","their","mineCurrent","theirCurrent","_hunk$lines","collectChange","_hunk$lines2","mutualChange","myChanges","theirChanges","allRemoves","_hunk$lines3","_hunk$lines4","skipRemoveSuperset","_hunk$lines5","removal","swap","_hunk$lines6","collectContext","matchChanges","merged","matchIndex","contextChanges","conflicted","change","insertLeading","insert","insertTrailing","removeChanges","delta","changeContent","diffChars","diffWords","diffWordsWithSpace","diffTrimmedLines","diffSentences","diffCss","diffJson","oldObj","newObj","diffArrays","oldArr","newArr","createPatch","applyPatches","currentIndex","processIndex","complete","loadFile","err","updatedContent","patched","merge","mineIndex","theirsIndex","theirsOffset","Infinity","theirsCurrent","mergedHunk","convertChangesToDMP","convertChangesToXML","escapeHTML","JsDiff","Snippet","snippet","parsed","parse","wrapPipes","string","formatForDiff","minify","format","linebreaks","parseBars","cells","h","pipeIndex","char","columnChars","getCellBounds","cell","col","row","urlsafe","getControlSigns","controlSigns","formatted","nest","parse2","testFormat","end","repeatStart","repeatEnd","snippetA","snippetB","diffFormat","Voicing_1","Snippet_1","logCustom","logFn","console","logLegend","groupCollapsed","table","emoji","groupEnd","logSheet","composer","tempo","style","logLabel","icon","logChoice","contrary","topInterval","logNotes","labels","idle","span","keyboard","isActive","isUsed","isIdle","isAdded","css","konsole","movedUp","movedDown","equilibrium","lucky","wrong","bestMatch","topAdded","topRemoved","bottomRemoved","bottomAdded","rootless","noOblique","noChange","fewChoices","Pulse_1","Metronome_1","Band","musicians","onMeasure","setupMix","metronome","addMember","musician","resume","then","comp","play","exact","Musician","instrument","getGain","eightFour","eightOff","halfTriplet","swing","Musician_1","swing_1","Pianist","playedNotes","playedChords","groove","rollFactor","voicings","playChord","concurrency","arpeggio","ceil","getLastVoicing","scorenotes","Drummer","patterns","Bassist","playBass","Sampler","buffers","samples","sources","loadSources","getBuffer","buffer","fetch","arrayBuffer","decodeAudioData","decodedData","getSource","createBufferSource","getSources","hasLoaded","loadSource","allLoaded","playSounds","sounds","sound","playSource","Kick","setup","osc","trigger","setValueAtTime","exponentialRampToValueAtTime","Snare","noiseBuffer","bufferSize","sampleRate","createBuffer","output","getChannelData","noise","noiseFilter","createBiquadFilter","noiseEnvelope","oscEnvelope","Kick_1","Snare_1","PlasticDrums","Improvisation","rules","get","fromCache","rule","getRuleFactories","enhance","mutate","reducer","originKey","factories","Improvisation_1","permutator","randomNote","firstNoteInPattern","startRandom","material","fixRange","reach","lineBreaks","lastNote","getStraightBar","straightNotes","fixedNotesPerChord","pendulum","softForce","comfort","barNumber","isComfortZone","beatPattern","barStart","notesPerChord","patternPractise","exclude","advancedPermutator","drill","excludeNotes","guideTones","guideTonesFlipped","chordTones","fullScale","scalePendulum","digitalPattern","digitalPendulum","digitalWalker","digitalPractiseUp","digitalPractiseDown","heptatonicPractise","defaultMethod","improvisationMethods","methods_1","Improvisor","method","useMethod","improvise","nextNotes","Band_1","Pianist_1","Bassist_1","Drummer_1","PlasticDrums_1","Improvisor_1","Trio","piano","bass","drums","solo","instruments","setupInstruments","pianist","bassist","drummer","soloist","RealParser","getChord","iRealChord","modifiers","over","parseSheet","getSheet","token","lastBarEnded","annots","sectionStart","hasCodaSign","codaSign","houseStart","comments","text","found","regExps","replacement","repl","replacements","out","newToken","parseChord","spacer","comment","alternate","chordRegex","iRealToken","MidiOut","navigator","midiInit","midiFail","outputs","size","inputs","input","onmidimessage","getMidiMessage","noteOn","message","send","velocity","Permutator","playPermutations","Sampler_1","Trio_1","util","RealParser_1","MidiOut_1","Permutator_1","kick","snare","hihat","ride","crash","rimshot","rs","drumset","drumSamples","C1","Db1","D1","Eb1","E1","F1","Gb1","G1","Ab1","A1","Bb1","B1","C2","Db2","D2","Eb2","E2","F2","Gb2","G2","Ab2","A2","Bb2","B2","C3","Db3","D3","Eb3","E3","F3","Gb3","G3","Ab3","A3","Bb3","B3","C4","Db4","D4","Eb4","E4","F4","Gb4","G4","Ab4","A4","Bb4","B4","C5","Db5","D5","Eb5","E5","F5","Gb5","G5","Ab5","A5","Bb5","B5","C6","Db6","D6","Eb6","E6","F6","Gb6","G6","Ab6","A6","Bb6","B6","C7","Db7","D7","Eb7","E7","F7","Gb7","G7","Ab7","A7","Bb7","B7","window","webkitAudioContext","playlist","iRealReader","decodeURI","link","band","onload","playJazz","document","getElementById","playFunk","playBossa","playExact","stopButton","slower","faster","tempoInput","searchInput","playChords","toggleTraining","nextChord","playChordAgain","playBassOnly","standardTitle","textarea","cheapSynths","usePiano","standard","latestGroove","latestPath","latestChord","trainMode","guess","obfuscateChords","obfuscated","loadStandard","query","getStandard","newStandard","songs","music","setTitle","innerHTML","leadsheet","resetBpm","setTempo","selectCell","bounds","focus","setSelectionRange","addEventListener","funk","bossa","setPath","bassOnly","solution"],"mappings":"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","file":"demo.19e02976.map","sourceRoot":"..","sourcesContent":["'use strict';\n\n//unscrambling hints from https://github.com/ironss/accompaniser/blob/master/irealb_parser.lua\n//strings are broken up in 50 character segments. each segment undergoes character substitution addressed by obfusc50()\nexports.ireal = function(s){\n  let r = '', p;\n\n  while(s.length > 50){\n    p = s.substring(0, 50);\n    s = s.substring(50)\n    if(s.length < 2){\n      r = r + p;\n    }else{\n      r = r + obfusc50(p);\n    }\n  }\n  r = r + s;\n  return r;\n}\n\nfunction obfusc50 (s){\n  //the first 5 characters are switched with the last 5\n  let newString = s.split('');\n  for(let i = 0; i < 5; i++){\n    newString[49 - i] = s[i];\n    newString[i] = s[49 - i];\n  }\n  //characters 10-24 are also switched\n  for(let i = 10; i < 24; i++){\n    newString[49 - i] = s[i];\n    newString[i] = s[49 - i];\n  }\n  return newString.join('');\n}\n","let measures, startRepeatLocation, lastChord, endRepeatLocation, timeSignature, \nthirdEndingImminent, fineLocation, dcAlFineImminent, dcAlCodaImminent, dsAlCodaImminent,\ncodaLocation, segnoLocation;\n\nfunction resetVars() {\n  measures = [];\n  startRepeatLocation = null;\n  endRepeatLocation = null;\n  lastChord = null;\n  codaLocation = null;\n  segnoLocation = null;\n  timeSignature = null;\n  thirdEndingImminent = false;\n  dcAlCodaImminent = false;\n  dsAlCodaImminent = false;\n  fineLocation = null;\n  dcAlFineImminent = false;\n}\n\nconst rules = [\n  { token: 'XyQ', description: 'Empty space' },\n  { token: /\\*\\w/, description: 'Section marker' },\n  { token: /<(.*?)>/, description: 'Comments inside carets', operation: checkForRepeats },\n  { token: /T(\\d+)/, description: 'Time signature', operation: setTimeSignature },\n  { token: 'x', description: 'Repeat previous measure in current measure', operation: repeatLastMeasure },\n  { token: 'Kcl', description: 'Repeat previous measure and create new measure', operation: repeatLastMeasureAndAddNew },\n  { token: 'r|XyQ', description: 'Repeat previous two measures', operation: repeatLastTwoMeasures },\n  { token: /Y+/, description: 'Vertical spacers' },\n  { token: 'n', description: 'No Chord (N.C)', operation: pushNull },\n  { token: 'p', description: 'Pause slash' },\n  { token: 'U', description: 'Ending measure for player' },\n  { token: 'S', description: 'Segno', operation: setSegnoLocation },\n  { token: 'Q', description: 'Coda', operation: setCodaLocation },\n  { token: '{', description: 'Start repeat marker', operation: setStartRepeatLocation },\n  { token: '}', description: 'End repeat marker', operation: repeatEverythingToEndRepeatLocation },\n  { token: 'LZ|', description: 'Bar line', operation: createNewMeasure },\n  { token: '|', description: 'Bar line', operation: createNewMeasure },\n  { token: 'LZ', description: 'Bar line', operation: createNewMeasure },\n  { token: '[', description: 'Double bar start', operation: createNewMeasure },\n  { token: ']', description: 'Double bar end', operation: repeatRemainingEndings },\n  { token: /N(\\d)/, description: 'Numbered endings', operation: setEndRepeatLocation },\n  { token: 'Z', description: 'Final bar line', operation: repeatRemainingEndings },\n  { token: /[A-GW]{1}[\\+\\-\\^\\dhob#suadlt]*(\\/[A-G][#b]?)?/, description: 'Chord', operation: pushChordInMeasures }\n];\n\n//chord regex:\n//  letters A-G and W (W is an invisible slash chord)\n//  {1} only one of the aforementioned letters\n//  followed by zero or more of these: + - ^ h o # b digit\n//  followed by an optional group (to catch slash chords)\n//    that starts with a slash\n//    followed by A-G\n//    followed by optional # or b\n\nfunction checkForRepeats(match) {\n  if (match[1].toLowerCase() === 'd.c. al 3rd ending') {\n    thirdEndingImminent = true;\n  }\n  if (match[1].toLowerCase() === 'd.c. al fine') {\n    dcAlFineImminent = true;\n  }\n  if (match[1].toLowerCase() === 'd.c. al coda') {\n    dcAlCodaImminent = true;\n  }\n  if (match[1].toLowerCase() === 'd.s. al coda') {\n    dsAlCodaImminent = true;\n  }\n  if (match[1].toLowerCase() === 'fine') {\n    fineLocation = measures.length;\n  }\n}\n\nfunction setTimeSignature(match) {\n  timeSignature = match[1];\n}\n\nfunction pushNull() {\n  if (measures.length === 0) measures.push([]);\n  measures[measures.length - 1].push(null);\n}\n\nfunction repeatLastMeasure() {\n  measures[measures.length - 1] = measures[measures.length - 2];\n}\n\nfunction repeatLastMeasureAndAddNew() {\n  measures[measures.length] = measures[measures.length - 1];\n}\n\nfunction repeatLastTwoMeasures() {\n  measures[measures.length - 1] = measures[measures.length - 3];\n  measures[measures.length] = measures[measures.length - 2];\n}\n\nfunction setStartRepeatLocation() {\n  createNewMeasure();\n  startRepeatLocation = measures.length - 1;\n  endRepeatLocation = null;\n}\n\nfunction setEndRepeatLocation(match) {\n  //if the ending is N1, set that as the end of the repeat, because next time around we go to N2\n  const ending = parseInt(match[1]);\n  if (ending === 1) {\n    endRepeatLocation = measures.length - 1;\n  }\n}\n\nfunction setSegnoLocation() {\n  segnoLocation = measures.length - 1;\n}\n\nfunction setCodaLocation() {\n  codaLocation = measures.length;\n}\n\nfunction createNewMeasure() {\n  //unless the last measure is a blank, insert a new blank measure\n  if (measures.length === 0 || measures[measures.length - 1].length !== 0) {\n    measures.push([]);\n  }\n}\n\nfunction repeatEverythingToEndRepeatLocation() {\n  if (!endRepeatLocation) {\n    endRepeatLocation = measures.length;\n  } \n  measures.push(...measures.slice(startRepeatLocation, endRepeatLocation));\n  createNewMeasure();\n}\n\nfunction repeatRemainingEndings() {\n  if (thirdEndingImminent) {\n    repeatEverythingToEndRepeatLocation();\n    thirdEndingImminent = false; \n  }\n  if (dcAlFineImminent) {\n    measures.push(...measures.slice(0, fineLocation));\n    dcAlFineImminent = false; \n  }\n  if (dcAlCodaImminent) {\n    measures.push(...measures.slice(0, codaLocation));\n    dcAlCodaImminent = false; \n  }\n  if (dsAlCodaImminent) {\n    measures.push(...measures.slice(segnoLocation, codaLocation));\n    dsAlCodaImminent = false; \n  }\n}\n\nfunction pushChordInMeasures(match) {\n  if (measures.length === 0) measures.push([]);\n\n  let chord = match[0];\n  if (chord.startsWith('W') && lastChord) {\n    chord = chord.replace('W', lastChord)\n  } else {\n    lastChord = chord.split('/')[0];\n  }\n  measures[measures.length - 1].push(chord)\n}\n\nfunction parse(inputString) {\n  // loop through the rules until one of them applies to the beginning of the string\n  // chop off the match and parse again \n\n  for (let i = 0; i < rules.length; i++) {\n    const rule = rules[i];\n\n    if (typeof rule.token === 'string' && inputString.startsWith(rule.token)) {\n      if (rule.operation) rule.operation();\n      parse(inputString.substring(rule.token.length).trim());\n      break;\n    } else if (rule.token instanceof RegExp) {\n      const match = inputString.match(rule.token);\n      if (match && match.index === 0) {\n        if (rule.operation) rule.operation(match);\n        parse(inputString.substring(match[0].length).trim());\n        break;\n      }\n    }\n    if (i === rules.length - 1 && inputString.length > 1) {\n      // we got to the last rule and no rule applied\n      // trim off one character and parse again\n      parse(inputString.substring(1));\n    }\n  }\n}\nfunction removeEmptyMeasures(measures){\n  return measures.filter(x => x.length !== 0)\n}\n\nmodule.exports = function (raw) {\n  resetVars();\n  parse(raw);\n  return { measures: removeEmptyMeasures(measures), timeSignature, raw };\n}\n\n\n//updates\n//-handles NC as null chords\n//-repeats 1.2.3 \n//-segno, coda\n// -time signature\n//- removed the Song constructor, and Playlist constructor. now returning pure JSON\n","'use strict';\n\nconst protocolRegex = /.*?irealb:\\/\\/([^\"]*)/;\nconst musicPrefix = \"1r34LbKcu7\";\nconst unscramble = require('./unscramble');\nconst parser = require('./parser');\n\nfunction parseMusic(data) {\n  const parts = data.split(musicPrefix);\n  return parser(unscramble.ireal(parts[1]));\n}\n\nfunction makeSong(data) {\n  const parts = data.split(/=+/).filter(x => x != \"\"); //split on one or more equal signs, remove the blanks\n  let title, composer, style, key, transpose, music, compStyle, bpm, repeats = null;\n\n  if (parts.length === 7) {\n    [title, composer, style, key, music, bpm, repeats] = parts;\n  }\n  if (parts.length === 8 && parts[4].startsWith(musicPrefix)) {\n    [title, composer, style, key, music, compStyle, bpm, repeats] = parts;\n  }\n  if (parts.length === 8 && parts[5].startsWith(musicPrefix)) {\n    [title, composer, style, key, transpose, music, bpm, repeats] = parts;\n  }\n  if (parts.length === 9) {\n    [title, composer, style, key, transpose, music, compStyle, bpm, repeats] = parts;\n  }\n\n  return {\n    title,\n    composer,\n    style,\n    key,\n    transpose: transpose ? parseInt(transpose) : null,\n    music: parseMusic(music),\n    compStyle,\n    bpm: bpm ? parseInt(bpm) : null,\n    repeats: repeats ? parseInt(repeats) : null\n  }\n}\n\nmodule.exports = function (data) {\n  const percentEncoded = protocolRegex.exec(data);\n  const percentDecoded = decodeURIComponent(percentEncoded[1]);\n  const parts = percentDecoded.split(\"===\");  //songs are separated by ===\n\n  return {\n    name: (parts.length > 1) ? parts.pop() : undefined,\n    songs: parts.map(x => makeSong(x))\n  }\n};","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","var isBrowser = (typeof window !== 'undefined')\n\nvar CLOCK_DEFAULTS = {\n  toleranceLate: 0.10,\n  toleranceEarly: 0.001\n}\n\n// ==================== Event ==================== //\nvar Event = function(clock, deadline, func) {\n  this.clock = clock\n  this.func = func\n  this._cleared = false // Flag used to clear an event inside callback\n\n  this.toleranceLate = clock.toleranceLate\n  this.toleranceEarly = clock.toleranceEarly\n  this._latestTime = null\n  this._earliestTime = null\n  this.deadline = null\n  this.repeatTime = null\n\n  this.schedule(deadline)\n}\n\n// Unschedules the event\nEvent.prototype.clear = function() {\n  this.clock._removeEvent(this)\n  this._cleared = true\n  return this\n}\n\n// Sets the event to repeat every `time` seconds.\nEvent.prototype.repeat = function(time) {\n  if (time === 0)\n    throw new Error('delay cannot be 0')\n  this.repeatTime = time\n  if (!this.clock._hasEvent(this))\n    this.schedule(this.deadline + this.repeatTime)\n  return this\n}\n\n// Sets the time tolerance of the event.\n// The event will be executed in the interval `[deadline - early, deadline + late]`\n// If the clock fails to execute the event in time, the event will be dropped.\nEvent.prototype.tolerance = function(values) {\n  if (typeof values.late === 'number')\n    this.toleranceLate = values.late\n  if (typeof values.early === 'number')\n    this.toleranceEarly = values.early\n  this._refreshEarlyLateDates()\n  if (this.clock._hasEvent(this)) {\n    this.clock._removeEvent(this)\n    this.clock._insertEvent(this)\n  }\n  return this\n}\n\n// Returns true if the event is repeated, false otherwise\nEvent.prototype.isRepeated = function() { return this.repeatTime !== null }\n\n// Schedules the event to be ran before `deadline`.\n// If the time is within the event tolerance, we handle the event immediately.\n// If the event was already scheduled at a different time, it is rescheduled.\nEvent.prototype.schedule = function(deadline) {\n  this._cleared = false\n  this.deadline = deadline\n  this._refreshEarlyLateDates()\n\n  if (this.clock.context.currentTime >= this._earliestTime) {\n    this._execute()\n  \n  } else if (this.clock._hasEvent(this)) {\n    this.clock._removeEvent(this)\n    this.clock._insertEvent(this)\n  \n  } else this.clock._insertEvent(this)\n}\n\nEvent.prototype.timeStretch = function(tRef, ratio) {\n  if (this.isRepeated())\n    this.repeatTime = this.repeatTime * ratio\n\n  var deadline = tRef + ratio * (this.deadline - tRef)\n  // If the deadline is too close or past, and the event has a repeat,\n  // we calculate the next repeat possible in the stretched space.\n  if (this.isRepeated()) {\n    while (this.clock.context.currentTime >= deadline - this.toleranceEarly)\n      deadline += this.repeatTime\n  }\n  this.schedule(deadline)\n}\n\n// Executes the event\nEvent.prototype._execute = function() {\n  if (this.clock._started === false) return\n  this.clock._removeEvent(this)\n\n  if (this.clock.context.currentTime < this._latestTime)\n    this.func(this)\n  else {\n    if (this.onexpired) this.onexpired(this)\n    console.warn('event expired')\n  }\n  // In the case `schedule` is called inside `func`, we need to avoid\n  // overrwriting with yet another `schedule`.\n  if (!this.clock._hasEvent(this) && this.isRepeated() && !this._cleared)\n    this.schedule(this.deadline + this.repeatTime) \n}\n\n// Updates cached times\nEvent.prototype._refreshEarlyLateDates = function() {\n  this._latestTime = this.deadline + this.toleranceLate\n  this._earliestTime = this.deadline - this.toleranceEarly\n}\n\n// ==================== WAAClock ==================== //\nvar WAAClock = module.exports = function(context, opts) {\n  var self = this\n  opts = opts || {}\n  this.tickMethod = opts.tickMethod || 'ScriptProcessorNode'\n  this.toleranceEarly = opts.toleranceEarly || CLOCK_DEFAULTS.toleranceEarly\n  this.toleranceLate = opts.toleranceLate || CLOCK_DEFAULTS.toleranceLate\n  this.context = context\n  this._events = []\n  this._started = false\n}\n\n// ---------- Public API ---------- //\n// Schedules `func` to run after `delay` seconds.\nWAAClock.prototype.setTimeout = function(func, delay) {\n  return this._createEvent(func, this._absTime(delay))\n}\n\n// Schedules `func` to run before `deadline`.\nWAAClock.prototype.callbackAtTime = function(func, deadline) {\n  return this._createEvent(func, deadline)\n}\n\n// Stretches `deadline` and `repeat` of all scheduled `events` by `ratio`, keeping\n// their relative distance to `tRef`. In fact this is equivalent to changing the tempo.\nWAAClock.prototype.timeStretch = function(tRef, events, ratio) {\n  events.forEach(function(event) { event.timeStretch(tRef, ratio) })\n  return events\n}\n\n// Removes all scheduled events and starts the clock \nWAAClock.prototype.start = function() {\n  if (this._started === false) {\n    var self = this\n    this._started = true\n    this._events = []\n\n    if (this.tickMethod === 'ScriptProcessorNode') {\n      var bufferSize = 256\n      // We have to keep a reference to the node to avoid garbage collection\n      this._clockNode = this.context.createScriptProcessor(bufferSize, 1, 1)\n      this._clockNode.connect(this.context.destination)\n      this._clockNode.onaudioprocess = function () {\n        process.nextTick(function() { self._tick() })\n      }\n    } else if (this.tickMethod === 'manual') null // _tick is called manually\n\n    else throw new Error('invalid tickMethod ' + this.tickMethod)\n  }\n}\n\n// Stops the clock\nWAAClock.prototype.stop = function() {\n  if (this._started === true) {\n    this._started = false\n    this._clockNode.disconnect()\n  }  \n}\n\n// ---------- Private ---------- //\n\n// This function is ran periodically, and at each tick it executes\n// events for which `currentTime` is included in their tolerance interval.\nWAAClock.prototype._tick = function() {\n  var event = this._events.shift()\n\n  while(event && event._earliestTime <= this.context.currentTime) {\n    event._execute()\n    event = this._events.shift()\n  }\n\n  // Put back the last event\n  if(event) this._events.unshift(event)\n}\n\n// Creates an event and insert it to the list\nWAAClock.prototype._createEvent = function(func, deadline) {\n  return new Event(this, deadline, func)\n}\n\n// Inserts an event to the list\nWAAClock.prototype._insertEvent = function(event) {\n  this._events.splice(this._indexByTime(event._earliestTime), 0, event)\n}\n\n// Removes an event from the list\nWAAClock.prototype._removeEvent = function(event) {\n  var ind = this._events.indexOf(event)\n  if (ind !== -1) this._events.splice(ind, 1)\n}\n\n// Returns true if `event` is in queue, false otherwise\nWAAClock.prototype._hasEvent = function(event) {\n return this._events.indexOf(event) !== -1\n}\n\n// Returns the index of the first event whose deadline is >= to `deadline`\nWAAClock.prototype._indexByTime = function(deadline) {\n  // performs a binary search\n  var low = 0\n    , high = this._events.length\n    , mid\n  while (low < high) {\n    mid = Math.floor((low + high) / 2)\n    if (this._events[mid]._earliestTime < deadline)\n      low = mid + 1\n    else high = mid\n  }\n  return low\n}\n\n// Converts from relative time to absolute time\nWAAClock.prototype._absTime = function(relTime) {\n  return relTime + this.context.currentTime\n}\n\n// Converts from absolute time to relative time \nWAAClock.prototype._relTime = function(absTime) {\n  return absTime - this.context.currentTime\n}","var WAAClock = require('./lib/WAAClock')\n\nmodule.exports = WAAClock\nif (typeof window !== 'undefined') window.WAAClock = WAAClock\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar waaclock_1 = __importDefault(require(\"waaclock\"));\nvar Pulse = /** @class */ (function () {\n    function Pulse(props) {\n        if (props === void 0) { props = {}; }\n        this.defaults = {\n            bpm: 120,\n            cycle: 4,\n            delay: 0\n        };\n        this.events = [];\n        this.callbackAtTime = false;\n        this.props = Object.assign({}, this.defaults, props);\n        this.context = this.props.context || new AudioContext();\n        this.clock = this.props.clock || new waaclock_1.default(this.context, { toleranceEarly: 0.1, toleranceLate: 0.1 });\n    }\n    Pulse.prototype.getMeasureLength = function (bpm, beatsPerMeasure) {\n        if (bpm === void 0) { bpm = this.props.bpm; }\n        if (beatsPerMeasure === void 0) { beatsPerMeasure = this.props.cycle; }\n        return 60 / bpm * beatsPerMeasure;\n    };\n    Pulse.prototype.arrayPulse = function (children, length, path, start, callback, deadline) {\n        var _this = this;\n        if (length === void 0) { length = 1; }\n        if (path === void 0) { path = []; }\n        if (start === void 0) { start = 0; }\n        //TODO: return promise on next one (for chaining)\n        if (!Array.isArray(children)) {\n            if (children === 0) {\n                return 0;\n            }\n            var item_1 = {\n                value: children,\n                length: length,\n                path: path,\n                start: start,\n                pulse: this,\n                cycle: this.props.cycle,\n                timeout: null\n            };\n            start += this.props.delay; // TODO: be able to add delay from arrayPulse fn directly\n            if (this.callbackAtTime) {\n                start += deadline ? deadline : this.context.currentTime;\n                item_1.timeout = this.clock.callbackAtTime(function (event) {\n                    return callback(Object.assign(item_1, { event: event, deadline: event.deadline }));\n                }, start);\n            }\n            else {\n                start += (deadline || this.context.currentTime) - this.context.currentTime;\n                item_1.timeout = this.clock.setTimeout(function (event) {\n                    return callback(Object.assign(item_1, { event: event, deadline: event.deadline }));\n                }, start);\n            }\n            this.events.push(item_1.timeout);\n            return item_1;\n        }\n        var childLength = length / children.length;\n        return {\n            length: length,\n            children: children.map(function (el, i) {\n                return _this.arrayPulse(el, childLength, path.concat([i]), start + i * childLength, callback, deadline);\n            })\n        };\n    };\n    Pulse.prototype.tickArray = function (array, callback, deadline, length) {\n        var _this = this;\n        array.push(1);\n        var l = length || this.getMeasureLength() * array.length;\n        this.start();\n        return new Promise(function (resolve, reject) {\n            _this.arrayPulse(array, l, [], 0, function (tick, start) {\n                if (tick.path[0] === array.length - 1) {\n                    resolve(tick);\n                }\n                else {\n                    callback(tick, start);\n                }\n            }, deadline);\n        });\n    };\n    Pulse.prototype.start = function () {\n        // console.log('start with', this.events.length, 'events');\n        var criticalEvents = 6000;\n        if (this.events.length > criticalEvents) {\n            console.warn('more than ', criticalEvents, 'events received. Consider using less \"times\" to keep the timing precies');\n        }\n        this.clock.start();\n    };\n    Pulse.prototype.stop = function () {\n        this.clock.stop();\n    };\n    Pulse.prototype.changeTempo = function (newTempo, timeout) {\n        var _this = this;\n        if (timeout === void 0) { timeout = 0.2; }\n        var factor = this.props.bpm / newTempo;\n        this.props.bpm = newTempo;\n        var events = this.events.filter(function (e) {\n            return e.deadline - _this.context.currentTime > timeout;\n        });\n        // TODO: stretch durations?!\n        this.clock.timeStretch(this.context.currentTime, events, factor);\n    };\n    return Pulse;\n}());\nexports.Pulse = Pulse;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Sheet_1 = require(\"./Sheet\");\n;\nvar Measure = /** @class */ (function () {\n    function Measure() {\n    }\n    Measure.from = function (measure, property) {\n        if (property === void 0) { property = 'chords'; }\n        var _a, _b;\n        if (typeof measure === 'string') {\n            return _a = {},\n                _a[property] = [measure],\n                _a;\n        }\n        if (Array.isArray(measure)) {\n            return _b = {},\n                _b[property] = [].concat(measure),\n                _b;\n        }\n        return Object.assign({}, measure);\n        // return measure;\n    };\n    Measure.hasSign = function (sign, measure) {\n        measure = Measure.from(measure);\n        return !!measure.signs && measure.signs.includes(sign);\n    };\n    Measure.hasHouse = function (measure, number) {\n        measure = Measure.from(measure);\n        var house = measure.house;\n        if (!house) {\n            return false;\n        }\n        else if (number === undefined) {\n            return true;\n        }\n        if (!Array.isArray(house)) {\n            house = [house];\n        }\n        return house.includes(number);\n    };\n    Measure.getJumpSign = function (measure) {\n        var signs = (Measure.from(measure).signs || [])\n            .filter(function (s) { return Object.keys(Sheet_1.Sheet.jumpSigns).includes(s); });\n        if (signs.length > 1) {\n            console.warn('measure cannot contain more than one repeat sign', measure);\n        }\n        return Sheet_1.Sheet.jumpSigns[signs[0]];\n    };\n    Measure.hasJumpSign = function (measure) {\n        return Object.keys(Sheet_1.Sheet.jumpSigns)\n            .reduce(function (match, current) { return match || Measure.hasSign(current, measure); }, false);\n    };\n    return Measure;\n}());\nexports.Measure = Measure;\n","var NAMES = \"C C# Db D D# Eb E F F# Gb G G# Ab A A# Bb B\".split(\" \");\r\nvar names = function (accTypes) {\r\n    return typeof accTypes !== \"string\"\r\n        ? NAMES.slice()\r\n        : NAMES.filter(function (n) {\r\n            var acc = n[1] || \" \";\r\n            return accTypes.indexOf(acc) !== -1;\r\n        });\r\n};\r\nvar SHARPS = names(\" #\");\r\nvar FLATS = names(\" b\");\r\nvar REGEX = /^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\\d*)\\s*(.*)$/;\r\nfunction tokenize(str) {\r\n    if (typeof str !== \"string\")\r\n        str = \"\";\r\n    var m = REGEX.exec(str);\r\n    return [m[1].toUpperCase(), m[2].replace(/x/g, \"##\"), m[3], m[4]];\r\n}\r\nvar NO_NOTE = Object.freeze({\r\n    pc: null,\r\n    name: null,\r\n    step: null,\r\n    alt: null,\r\n    oct: null,\r\n    octStr: null,\r\n    chroma: null,\r\n    midi: null,\r\n    freq: null\r\n});\r\nvar SEMI = [0, 2, 4, 5, 7, 9, 11];\r\nvar properties = function (str) {\r\n    var tokens = tokenize(str);\r\n    if (tokens[0] === \"\" || tokens[3] !== \"\")\r\n        return NO_NOTE;\r\n    var letter = tokens[0], acc = tokens[1], octStr = tokens[2];\r\n    var p = {\r\n        letter: letter,\r\n        acc: acc,\r\n        octStr: octStr,\r\n        pc: letter + acc,\r\n        name: letter + acc + octStr,\r\n        step: (letter.charCodeAt(0) + 3) % 7,\r\n        alt: acc[0] === \"b\" ? -acc.length : acc.length,\r\n        oct: octStr.length ? +octStr : null,\r\n        chroma: 0,\r\n        midi: null,\r\n        freq: null\r\n    };\r\n    p.chroma = (SEMI[p.step] + p.alt + 120) % 12;\r\n    p.midi = p.oct !== null ? SEMI[p.step] + p.alt + 12 * (p.oct + 1) : null;\r\n    p.freq = midiToFreq(p.midi);\r\n    return Object.freeze(p);\r\n};\r\nvar memo = function (fn, cache) {\r\n    if (cache === void 0) { cache = {}; }\r\n    return function (str) { return cache[str] || (cache[str] = fn(str)); };\r\n};\r\nvar props = memo(properties);\r\nvar name = function (str) { return props(str).name; };\r\nvar pc = function (str) { return props(str).pc; };\r\nvar isMidiRange = function (m) { return m >= 0 && m <= 127; };\r\nvar midi = function (note) {\r\n    if (typeof note !== \"number\" && typeof note !== \"string\") {\r\n        return null;\r\n    }\r\n    var midi = props(note).midi;\r\n    var value = midi || midi === 0 ? midi : +note;\r\n    return isMidiRange(value) ? value : null;\r\n};\r\nvar midiToFreq = function (midi, tuning) {\r\n    if (tuning === void 0) { tuning = 440; }\r\n    return typeof midi === \"number\" ? Math.pow(2, (midi - 69) / 12) * tuning : null;\r\n};\r\nvar freq = function (note) { return props(note).freq || midiToFreq(note); };\r\nvar L2 = Math.log(2);\r\nvar L440 = Math.log(440);\r\nvar freqToMidi = function (freq) {\r\n    var v = (12 * (Math.log(freq) - L440)) / L2 + 69;\r\n    return Math.round(v * 100) / 100;\r\n};\r\nvar chroma = function (str) { return props(str).chroma; };\r\nvar oct = function (str) { return props(str).oct; };\r\nvar LETTERS = \"CDEFGAB\";\r\nvar stepToLetter = function (step) { return LETTERS[step]; };\r\nvar fillStr = function (s, n) { return Array(n + 1).join(s); };\r\nvar numToStr = function (num, op) {\r\n    return typeof num !== \"number\" ? \"\" : op(num);\r\n};\r\nvar altToAcc = function (alt) {\r\n    return numToStr(alt, function (alt) { return (alt < 0 ? fillStr(\"b\", -alt) : fillStr(\"#\", alt)); });\r\n};\r\nvar from = function (fromProps, baseNote) {\r\n    if (fromProps === void 0) { fromProps = {}; }\r\n    if (baseNote === void 0) { baseNote = null; }\r\n    var _a = baseNote\r\n        ? Object.assign({}, props(baseNote), fromProps)\r\n        : fromProps, step = _a.step, alt = _a.alt, oct = _a.oct;\r\n    if (typeof step !== \"number\")\r\n        return null;\r\n    var letter = stepToLetter(step);\r\n    if (!letter)\r\n        return null;\r\n    var pc = letter + altToAcc(alt);\r\n    return oct || oct === 0 ? pc + oct : pc;\r\n};\r\nvar build = from;\r\nfunction fromMidi(num, sharps) {\r\n    if (sharps === void 0) { sharps = false; }\r\n    num = Math.round(num);\r\n    var pcs = sharps === true ? SHARPS : FLATS;\r\n    var pc = pcs[num % 12];\r\n    var o = Math.floor(num / 12) - 1;\r\n    return pc + o;\r\n}\r\nvar simplify = function (note, sameAcc) {\r\n    if (sameAcc === void 0) { sameAcc = true; }\r\n    var _a = props(note), alt = _a.alt, chroma = _a.chroma, midi = _a.midi;\r\n    if (chroma === null)\r\n        return null;\r\n    var alteration = alt;\r\n    var useSharps = sameAcc === false ? alteration < 0 : alteration > 0;\r\n    return midi === null\r\n        ? pc(fromMidi(chroma, useSharps))\r\n        : fromMidi(midi, useSharps);\r\n};\r\nvar enharmonic = function (note) { return simplify(note, false); };\n\nexport { names, tokenize, props, name, pc, midi, midiToFreq, freq, freqToMidi, chroma, oct, stepToLetter, altToAcc, from, build, fromMidi, simplify, enharmonic };\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-array.svg?style=flat-square)](https://www.npmjs.com/package/tonal-array)\n *\n * Tonal array utilities. Create ranges, sort notes, ...\n *\n * @example\n * import * as Array;\n * Array.sort([\"f\", \"a\", \"c\"]) // => [\"C\", \"F\", \"A\"]\n *\n * @example\n * const Array = require(\"tonal-array\")\n * Array.range(1, 4) // => [1, 2, 3, 4]\n *\n * @module Array\n */\nimport { props, name } from \"tonal-note\";\n\n// ascending range\nfunction ascR(b, n) {\n  for (var a = []; n--; a[n] = n + b){ ; }\n  return a;\n}\n// descending range\nfunction descR(b, n) {\n  for (var a = []; n--; a[n] = b - n){ ; }\n  return a;\n}\n\n/**\n * Create a numeric range\n *\n * @param {Number} from\n * @param {Number} to\n * @return {Array}\n *\n * @example\n * Array.range(-2, 2) // => [-2, -1, 0, 1, 2]\n * Array.range(2, -2) // => [2, 1, 0, -1, -2]\n */\nexport function range(a, b) {\n  return a === null || b === null\n    ? []\n    : a < b\n      ? ascR(a, b - a + 1)\n      : descR(a, a - b + 1);\n}\n/**\n *\n * Rotates a list a number of times. It\"s completly agnostic about the\n * contents of the list.\n *\n * @param {Integer} times - the number of rotations\n * @param {Array} array\n * @return {Array} the rotated array\n * @example\n * Array.rotate(1, [1, 2, 3]) // => [2, 3, 1]\n */\nexport function rotate(times, arr) {\n  var len = arr.length;\n  var n = ((times % len) + len) % len;\n  return arr.slice(n, len).concat(arr.slice(0, n));\n}\n\n/**\n * Return a copy of the array with the null values removed\n * @function\n * @param {Array} array\n * @return {Array}\n *\n * @example\n * Array.compact([\"a\", \"b\", null, \"c\"]) // => [\"a\", \"b\", \"c\"]\n */\nexport var compact = function (arr) { return arr.filter(function (n) { return n === 0 || n; }); };\n\n// a function that get note heights (with negative number for pitch classes)\nvar height = function (name) {\n  var m = props(name).midi;\n  return m !== null ? m : props(name + \"-100\").midi;\n};\n\n/**\n * Sort an array of notes in ascending order\n *\n * @param {String|Array} notes\n * @return {Array} sorted array of notes\n */\nexport function sort(src) {\n  return compact(src.map(name)).sort(function (a, b) { return height(a) > height(b); });\n}\n\n/**\n * Get sorted notes with duplicates removed\n *\n * @function\n * @param {Array} notes\n */\nexport function unique(arr) {\n  return sort(arr).filter(function (n, i, a) { return i === 0 || n !== a[i - 1]; });\n}\n\n/**\n * Randomizes the order of the specified array in-place, using the FisherYates shuffle.\n *\n * @private\n * @function\n * @param {Array|String} arr - the array\n * @return {Array} the shuffled array\n *\n * @example\n * Array.shuffle([\"C\", \"D\", \"E\", \"F\"])\n */\nexport var shuffle = function (arr, rnd) {\n  if ( rnd === void 0 ) rnd = Math.random;\n\n  var i, t;\n  var m = arr.length;\n  while (m) {\n    i = (rnd() * m--) | 0;\n    t = arr[m];\n    arr[m] = arr[i];\n    arr[i] = t;\n  }\n  return arr;\n};\n\n/**\n * Get all permutations of an array\n * http://stackoverflow.com/questions/9960908/permutations-in-javascript\n *\n * @param {Array} array - the array\n * @return {Array<Array>} an array with all the permutations\n */\nexport var permutations = function (arr) {\n  if (arr.length === 0) { return [[]]; }\n  return permutations(arr.slice(1)).reduce(function(acc, perm) {\n    return acc.concat(\n      arr.map(function(e, pos) {\n        var newPerm = perm.slice();\n        newPerm.splice(pos, 0, arr[0]);\n        return newPerm;\n      })\n    );\n  }, []);\n};\n","var IVL_TNL = \"([-+]?\\\\d+)(d{1,4}|m|M|P|A{1,4})\";\r\nvar IVL_STR = \"(AA|A|P|M|m|d|dd)([-+]?\\\\d+)\";\r\nvar REGEX = new RegExp(\"^\" + IVL_TNL + \"|\" + IVL_STR + \"$\");\r\nvar SIZES = [0, 2, 4, 5, 7, 9, 11];\r\nvar TYPES = \"PMMPPMM\";\r\nvar CLASSES = [0, 1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1];\r\nvar NAMES = \"1P 2m 2M 3m 3M 4P 5P 6m 6M 7m 7M 8P\".split(\" \");\r\nvar names = function (types) {\r\n    return typeof types !== \"string\"\r\n        ? NAMES.slice()\r\n        : NAMES.filter(function (n) { return types.indexOf(n[1]) !== -1; });\r\n};\r\nvar tokenize = function (str) {\r\n    var m = REGEX.exec(\"\" + str);\r\n    if (m === null)\r\n        return null;\r\n    return (m[1] ? [m[1], m[2]] : [m[4], m[3]]);\r\n};\r\nvar NO_IVL = Object.freeze({\r\n    name: null,\r\n    num: null,\r\n    q: null,\r\n    step: null,\r\n    alt: null,\r\n    dir: null,\r\n    type: null,\r\n    simple: null,\r\n    semitones: null,\r\n    chroma: null,\r\n    oct: null\r\n});\r\nvar fillStr = function (s, n) { return Array(Math.abs(n) + 1).join(s); };\r\nvar qToAlt = function (type, q) {\r\n    if (q === \"M\" && type === \"M\")\r\n        return 0;\r\n    if (q === \"P\" && type === \"P\")\r\n        return 0;\r\n    if (q === \"m\" && type === \"M\")\r\n        return -1;\r\n    if (/^A+$/.test(q))\r\n        return q.length;\r\n    if (/^d+$/.test(q))\r\n        return type === \"P\" ? -q.length : -q.length - 1;\r\n    return null;\r\n};\r\nvar altToQ = function (type, alt) {\r\n    if (alt === 0)\r\n        return type === \"M\" ? \"M\" : \"P\";\r\n    else if (alt === -1 && type === \"M\")\r\n        return \"m\";\r\n    else if (alt > 0)\r\n        return fillStr(\"A\", alt);\r\n    else if (alt < 0)\r\n        return fillStr(\"d\", type === \"P\" ? alt : alt + 1);\r\n    else\r\n        return null;\r\n};\r\nvar numToStep = function (num) { return (Math.abs(num) - 1) % 7; };\r\nvar properties = function (str) {\r\n    var t = tokenize(str);\r\n    if (t === null)\r\n        return NO_IVL;\r\n    var p = {\r\n        num: 0,\r\n        q: \"d\",\r\n        name: \"\",\r\n        type: \"M\",\r\n        step: 0,\r\n        dir: -1,\r\n        simple: 1,\r\n        alt: 0,\r\n        oct: 0,\r\n        semitones: 0,\r\n        chroma: 0,\r\n        ic: 0\r\n    };\r\n    p.num = +t[0];\r\n    p.q = t[1];\r\n    p.step = numToStep(p.num);\r\n    p.type = TYPES[p.step];\r\n    if (p.type === \"M\" && p.q === \"P\")\r\n        return NO_IVL;\r\n    p.name = \"\" + p.num + p.q;\r\n    p.dir = p.num < 0 ? -1 : 1;\r\n    p.simple = (p.num === 8 || p.num === -8\r\n        ? p.num\r\n        : p.dir * (p.step + 1));\r\n    p.alt = qToAlt(p.type, p.q);\r\n    p.oct = Math.floor((Math.abs(p.num) - 1) / 7);\r\n    p.semitones = p.dir * (SIZES[p.step] + p.alt + 12 * p.oct);\r\n    p.chroma = ((((p.dir * (SIZES[p.step] + p.alt)) % 12) + 12) %\r\n        12);\r\n    return Object.freeze(p);\r\n};\r\nvar cache = {};\r\nfunction props(str) {\r\n    if (typeof str !== \"string\")\r\n        return NO_IVL;\r\n    return cache[str] || (cache[str] = properties(str));\r\n}\r\nvar num = function (str) { return props(str).num; };\r\nvar name = function (str) { return props(str).name; };\r\nvar semitones = function (str) { return props(str).semitones; };\r\nvar chroma = function (str) { return props(str).chroma; };\r\nvar ic = function (ivl) {\r\n    if (typeof ivl === \"string\")\r\n        ivl = props(ivl).chroma;\r\n    return typeof ivl === \"number\" ? CLASSES[ivl % 12] : null;\r\n};\r\nvar build = function (_a) {\r\n    var _b = _a === void 0 ? {} : _a, num = _b.num, step = _b.step, alt = _b.alt, _c = _b.oct, oct = _c === void 0 ? 1 : _c, dir = _b.dir;\r\n    if (step !== undefined)\r\n        num = step + 1 + 7 * oct;\r\n    if (num === undefined)\r\n        return null;\r\n    if (typeof alt !== \"number\")\r\n        return null;\r\n    var d = typeof dir !== \"number\" ? \"\" : dir < 0 ? \"-\" : \"\";\r\n    var type = TYPES[numToStep(num)];\r\n    return (d + num + altToQ(type, alt));\r\n};\r\nvar simplify = function (str) {\r\n    var p = props(str);\r\n    if (p === NO_IVL)\r\n        return null;\r\n    var intervalProps = p;\r\n    return intervalProps.simple + intervalProps.q;\r\n};\r\nvar invert = function (str) {\r\n    var p = props(str);\r\n    if (p === NO_IVL)\r\n        return null;\r\n    var intervalProps = p;\r\n    var step = (7 - intervalProps.step) % 7;\r\n    var alt = intervalProps.type === \"P\" ? -intervalProps.alt : -(intervalProps.alt + 1);\r\n    return build({ step: step, alt: alt, oct: intervalProps.oct, dir: intervalProps.dir });\r\n};\r\nvar IN = [1, 2, 2, 3, 3, 4, 5, 5, 6, 6, 7, 7];\r\nvar IQ = \"P m M m M P d P m M m M\".split(\" \");\r\nvar fromSemitones = function (num) {\r\n    var d = num < 0 ? -1 : 1;\r\n    var n = Math.abs(num);\r\n    var c = n % 12;\r\n    var o = Math.floor(n / 12);\r\n    return d * (IN[c] + 7 * o) + IQ[c];\r\n};\n\nexport { names, tokenize, qToAlt, altToQ, props, num, name, semitones, chroma, ic, build, simplify, invert, fromSemitones };\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-distance.svg)](https://www.npmjs.com/package/tonal-distance)\n * [![tonal](https://img.shields.io/badge/tonal-distance-yellow.svg)](https://github.com/danigb/tonal/tree/master/packages/tonal/distance)\n *\n * Transpose notes by intervals and find distances between notes\n *\n * @example\n * // es6\n * import * as Distance from \"tonal-distance\"\n * Distance.interval(\"C3\", \"C4\") // => \"1P\"\n *\n * @example\n * // es6 import selected functions\n * import { interval, semitones, transpose } from \"tonal-distance\"\n *\n * semitones(\"C\" ,\"D\") // => 2\n * interval(\"C4\", \"G4\") // => \"5P\"\n * transpose(\"C4\", \"P5\") // => \"G4\"\n *\n * @example\n * // included in tonal facade\n * const Tonal = require(\"tonal\");\n * Tonal.Distance.transpose(\"C4\", \"P5\")\n * Tonal.Distance.transposeBy(\"P5\", \"C4\")\n *\n * @module Distance\n */\nimport { props as noteProps, build as fromNote } from \"tonal-note\";\nimport { props as iprops, build as ibuild } from \"tonal-interval\";\n\n// Map from letter step to number of fifths starting from \"C\":\n// { C: 0, D: 2, E: 4, F: -1, G: 1, A: 3, B: 5 }\nvar FIFTHS = [0, 2, 4, -1, 1, 3, 5];\n\n// Given a number of fifths, return the octaves they span\nvar fOcts = function (f) { return Math.floor((f * 7) / 12); };\n\n// Get the number of octaves it span each step\nvar FIFTH_OCTS = FIFTHS.map(fOcts);\n\nvar encode = function (ref) {\n  var step = ref.step;\n  var alt = ref.alt;\n  var oct = ref.oct;\n  var dir = ref.dir; if ( dir === void 0 ) dir = 1;\n\n  var f = FIFTHS[step] + 7 * alt;\n  if (oct === null) { return [dir * f]; }\n  var o = oct - FIFTH_OCTS[step] - 4 * alt;\n  return [dir * f, dir * o];\n};\n\n// We need to get the steps from fifths\n// Fifths for CDEFGAB are [ 0, 2, 4, -1, 1, 3, 5 ]\n// We add 1 to fifths to avoid negative numbers, so:\n// for [\"F\", \"C\", \"G\", \"D\", \"A\", \"E\", \"B\"] we have:\nvar STEPS = [3, 0, 4, 1, 5, 2, 6];\n\n// Return the number of fifths as if it were unaltered\nfunction unaltered(f) {\n  var i = (f + 1) % 7;\n  return i < 0 ? 7 + i : i;\n}\n\nvar decode = function (f, o, dir) {\n  var step = STEPS[unaltered(f)];\n  var alt = Math.floor((f + 1) / 7);\n  if (o === undefined) { return { step: step, alt: alt, dir: dir }; }\n  var oct = o + 4 * alt + FIFTH_OCTS[step];\n  return { step: step, alt: alt, oct: oct, dir: dir };\n};\n\nvar memo = function (fn, cache) {\n  if ( cache === void 0 ) cache = {};\n\n  return function (str) { return cache[str] || (cache[str] = fn(str)); };\n};\n\nvar encoder = function (props) { return memo(function (str) {\n    var p = props(str);\n    return p.name === null ? null : encode(p);\n  }); };\n\nvar encodeNote = encoder(noteProps);\nvar encodeIvl = encoder(iprops);\n\n/**\n * Transpose a note by an interval. The note can be a pitch class.\n *\n * This function can be partially applied.\n *\n * @param {String} note\n * @param {String} interval\n * @return {String} the transposed note\n * @example\n * import { tranpose } from \"tonal-distance\"\n * transpose(\"d3\", \"3M\") // => \"F#3\"\n * // it works with pitch classes\n * transpose(\"D\", \"3M\") // => \"F#\"\n * // can be partially applied\n * [\"C\", \"D\", \"E\", \"F\", \"G\"].map(transpose(\"M3)) // => [\"E\", \"F#\", \"G#\", \"A\", \"B\"]\n */\nexport function transpose(note, interval) {\n  if (arguments.length === 1) { return function (i) { return transpose(note, i); }; }\n  var n = encodeNote(note);\n  var i = encodeIvl(interval);\n  if (n === null || i === null) { return null; }\n  var tr = n.length === 1 ? [n[0] + i[0]] : [n[0] + i[0], n[1] + i[1]];\n  return fromNote(decode(tr[0], tr[1]));\n}\n\n/**\n * Transpose a pitch class by a number of perfect fifths.\n *\n * It can be partially applied.\n *\n * @function\n * @param {String} pitchClass - the pitch class\n * @param {Integer} fifhts - the number of fifths\n * @return {String} the transposed pitch class\n *\n * @example\n * import { trFifths } from \"tonal-transpose\"\n * [0, 1, 2, 3, 4].map(trFifths(\"C\")) // => [\"C\", \"G\", \"D\", \"A\", \"E\"]\n * // or using tonal\n * Distance.trFifths(\"G4\", 1) // => \"D\"\n */\n\nexport function trFifths(note, fifths) {\n  if (arguments.length === 1) { return function (f) { return trFifths(note, f); }; }\n  var n = encodeNote(note);\n  if (n === null) { return null; }\n  return fromNote(decode(n[0] + fifths));\n}\n\n/**\n * Get the distance in fifths between pitch classes\n *\n * Can be partially applied.\n *\n * @param {String} to - note or pitch class\n * @param {String} from - note or pitch class\n */\nexport function fifths(from, to) {\n  if (arguments.length === 1) { return function (to) { return fifths(from, to); }; }\n  var f = encodeNote(from);\n  var t = encodeNote(to);\n  if (t === null || f === null) { return null; }\n  return t[0] - f[0];\n}\n\n/**\n * The same as transpose with the arguments inverted.\n *\n * Can be partially applied.\n *\n * @param {String} note\n * @param {String} interval\n * @return {String} the transposed note\n * @example\n * import { tranposeBy } from \"tonal-distance\"\n * transposeBy(\"3m\", \"5P\") // => \"7m\"\n */\nexport function transposeBy(interval, note) {\n  if (arguments.length === 1) { return function (n) { return transpose(n, interval); }; }\n  return transpose(note, interval);\n}\n\nvar isDescending = function (e) { return e[0] * 7 + e[1] * 12 < 0; };\nvar decodeIvl = function (i) { return isDescending(i) ? decode(-i[0], -i[1], -1) : decode(i[0], i[1], 1); };\n\nexport function addIntervals(ivl1, ivl2, dir) {\n  var i1 = encodeIvl(ivl1);\n  var i2 = encodeIvl(ivl2);\n  if (i1 === null || i2 === null) { return null; }\n  var i = [i1[0] + dir * i2[0], i1[1] + dir * i2[1]];\n  return ibuild(decodeIvl(i));\n}\n\n/**\n * Add two intervals\n *\n * Can be partially applied.\n *\n * @param {String} interval1\n * @param {String} interval2\n * @return {String} the resulting interval\n * @example\n * import { add } from \"tonal-distance\"\n * add(\"3m\", \"5P\") // => \"7m\"\n */\nexport function add(ivl1, ivl2) {\n  if (arguments.length === 1) { return function (i2) { return add(ivl1, i2); }; }\n  return addIntervals(ivl1, ivl2, 1);\n}\n\n/**\n * Subtract two intervals\n *\n * Can be partially applied\n *\n * @param {String} minuend\n * @param {String} subtrahend\n * @return {String} interval diference\n */\nexport function subtract(ivl1, ivl2) {\n  if (arguments.length === 1) { return function (i2) { return add(ivl1, i2); }; }\n  return addIntervals(ivl1, ivl2, -1);\n}\n\n/**\n * Find the interval between two pitches. It works with pitch classes\n * (both must be pitch classes and the interval is always ascending)\n *\n * Can be partially applied\n *\n * @param {String} from - distance from\n * @param {String} to - distance to\n * @return {String} the interval distance\n *\n * @example\n * import { interval } from \"tonal-distance\"\n * interval(\"C2\", \"C3\") // => \"P8\"\n * interval(\"G\", \"B\") // => \"M3\"\n *\n * @example\n * import * as Distance from \"tonal-distance\"\n * Distance.interval(\"M2\", \"P5\") // => \"P4\"\n */\nexport function interval(from, to) {\n  if (arguments.length === 1) { return function (t) { return interval(from, t); }; }\n  var f = encodeNote(from);\n  var t = encodeNote(to);\n  if (f === null || t === null || f.length !== t.length) { return null; }\n  var d =\n    f.length === 1\n      ? [t[0] - f[0], -Math.floor(((t[0] - f[0]) * 7) / 12)]\n      : [t[0] - f[0], t[1] - f[1]];\n  return ibuild(decodeIvl(d));\n}\n\n/**\n * Get the distance between two notes in semitones\n *\n * @param {String|Pitch} from - first note\n * @param {String|Pitch} to - last note\n * @return {Integer} the distance in semitones or null if not valid notes\n * @example\n * import { semitones } from \"tonal-distance\"\n * semitones(\"C3\", \"A2\") // => -3\n * // or use tonal\n * Tonal.Distance.semitones(\"C3\", \"G3\") // => 7\n */\nexport function semitones(from, to) {\n  if (arguments.length === 1) { return function (t) { return semitones(from, t); }; }\n  var f = noteProps(from);\n  var t = noteProps(to);\n  return f.midi !== null && t.midi !== null\n    ? t.midi - f.midi\n    : f.chroma !== null && t.chroma !== null\n      ? (t.chroma - f.chroma + 12) % 12\n      : null;\n}\n",null,"/**\n * [![npm version](https://img.shields.io/npm/v/tonal-pcset.svg?style=flat-square)](https://www.npmjs.com/package/tonal-pcset)\n * [![tonal](https://img.shields.io/badge/tonal-pcset-yellow.svg?style=flat-square)](https://www.npmjs.com/browse/keyword/tonal)\n *\n * `tonal-pcset` is a collection of functions to work with pitch class sets, oriented\n * to make comparations (isEqual, isSubset, isSuperset)\n *\n * This is part of [tonal](https://www.npmjs.com/package/tonal) music theory library.\n *\n * You can install via npm: `npm i --save tonal-pcset`\n *\n * ```js\n * // es6\n * import PcSet from \"tonal-pcset\"\n * var PcSet = require(\"tonal-pcset\")\n *\n * PcSet.isEqual(\"c2 d5 e6\", \"c6 e3 d1\") // => true\n * ```\n *\n * ## API documentation\n *\n * @module PcSet\n */\nimport { chroma as notechr } from \"tonal-note\";\nimport { chroma as ivlchr } from \"tonal-interval\";\nimport { rotate, range, compact } from \"tonal-array\";\n\nvar chr = function (str) { return notechr(str) || ivlchr(str) || 0; };\nvar pcsetNum = function (set) { return parseInt(chroma(set), 2); };\nvar clen = function (chroma) { return chroma.replace(/0/g, \"\").length; };\n\n/**\n * Get chroma of a pitch class set. A chroma identifies each set uniquely.\n * It\"s a 12-digit binary each presenting one semitone of the octave.\n *\n * Note that this function accepts a chroma as parameter and return it\n * without modification.\n *\n * @param {Array|String} set - the pitch class set\n * @return {String} a binary representation of the pitch class set\n * @example\n * PcSet.chroma([\"C\", \"D\", \"E\"]) // => \"1010100000000\"\n */\nexport function chroma(set) {\n  if (isChroma(set)) { return set; }\n  if (!Array.isArray(set)) { return \"\"; }\n  var b = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n  set.map(chr).forEach(function (i) {\n    b[i] = 1;\n  });\n  return b.join(\"\");\n}\n\nvar all = null;\n/**\n * Get a list of all possible chromas (all possible scales)\n * More information: http://allthescales.org/\n * @return {Array} an array of possible chromas from '10000000000' to '11111111111'\n *\n */\nexport function chromas(n) {\n  all = all || range(2048, 4095).map(function (n) { return n.toString(2); });\n  return typeof n === \"number\"\n    ? all.filter(function (chroma) { return clen(chroma) === n; })\n    : all.slice();\n}\n\n/**\n * Given a a list of notes or a pcset chroma, produce the rotations\n * of the chroma discarding the ones that starts with \"0\"\n *\n * This is used, for example, to get all the modes of a scale.\n *\n * @param {Array|String} set - the list of notes or pitchChr of the set\n * @param {Boolean} normalize - (Optional, true by default) remove all\n * the rotations that starts with \"0\"\n * @return {Array<String>} an array with all the modes of the chroma\n *\n * @example\n * PcSet.modes([\"C\", \"D\", \"E\"]).map(PcSet.intervals)\n */\nexport function modes(set, normalize) {\n  normalize = normalize !== false;\n  var binary = chroma(set).split(\"\");\n  return compact(\n    binary.map(function(_, i) {\n      var r = rotate(i, binary);\n      return normalize && r[0] === \"0\" ? null : r.join(\"\");\n    })\n  );\n}\n\nvar REGEX = /^[01]{12}$/;\n/**\n * Test if the given string is a pitch class set chroma.\n * @param {String} chroma - the pitch class set chroma\n * @return {Boolean} true if its a valid pcset chroma\n * @example\n * PcSet.isChroma(\"101010101010\") // => true\n * PcSet.isChroma(\"101001\") // => false\n */\nexport function isChroma(set) {\n  return REGEX.test(set);\n}\n\nvar IVLS = \"1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M\".split(\" \");\n/**\n * Given a pcset (notes or chroma) return it\"s intervals\n * @param {String|Array} pcset - the pitch class set (notes or chroma)\n * @return {Array} intervals or empty array if not valid pcset\n * @example\n * PcSet.intervals(\"1010100000000\") => [\"1P\", \"2M\", \"3M\"]\n */\nexport function intervals(set) {\n  if (!isChroma(set)) { return []; }\n  return compact(\n    set.split(\"\").map(function(d, i) {\n      return d === \"1\" ? IVLS[i] : null;\n    })\n  );\n}\n\n/**\n * Test if two pitch class sets are identical\n *\n * @param {Array|String} set1 - one of the pitch class sets\n * @param {Array|String} set2 - the other pitch class set\n * @return {Boolean} true if they are equal\n * @example\n * PcSet.isEqual([\"c2\", \"d3\"], [\"c5\", \"d2\"]) // => true\n */\nexport function isEqual(s1, s2) {\n  if (arguments.length === 1) { return function (s) { return isEqual(s1, s); }; }\n  return chroma(s1) === chroma(s2);\n}\n\n/**\n * Create a function that test if a collection of notes is a\n * subset of a given set\n *\n * The function can be partially applied\n *\n * @param {Array|String} set - an array of notes or a chroma set string to test against\n * @param {Array|String} notes - an array of notes or a chroma set\n * @return {boolean} true if notes is a subset of set, false otherwise\n * @example\n * const inCMajor = PcSet.isSubsetOf([\"C\", \"E\", \"G\"])\n * inCMajor([\"e6\", \"c4\"]) // => true\n * inCMajor([\"e6\", \"c4\", \"d3\"]) // => false\n */\nexport function isSubsetOf(set, notes) {\n  if (arguments.length > 1) { return isSubsetOf(set)(notes); }\n  set = pcsetNum(set);\n  return function(notes) {\n    notes = pcsetNum(notes);\n    return notes !== set && (notes & set) === notes;\n  };\n}\n\n/**\n * Create a function that test if a collectio of notes is a\n * superset of a given set (it contains all notes and at least one more)\n *\n * @param {Array|String} set - an array of notes or a chroma set string to test against\n * @param {Array|String} notes - an array of notes or a chroma set\n * @return {boolean} true if notes is a superset of set, false otherwise\n * @example\n * const extendsCMajor = PcSet.isSupersetOf([\"C\", \"E\", \"G\"])\n * extendsCMajor([\"e6\", \"a\", \"c4\", \"g2\"]) // => true\n * extendsCMajor([\"c6\", \"e4\", \"g3\"]) // => false\n */\nexport function isSupersetOf(set, notes) {\n  if (arguments.length > 1) { return isSupersetOf(set)(notes); }\n  set = pcsetNum(set);\n  return function(notes) {\n    notes = pcsetNum(notes);\n    return notes !== set && (notes | set) === notes;\n  };\n}\n\n/**\n * Test if a given pitch class set includes a note\n * @param {Array|String} set - the base set to test against\n * @param {String|Pitch} note - the note to test\n * @return {Boolean} true if the note is included in the pcset\n * @example\n * PcSet.includes([\"C\", \"D\", \"E\"], \"C4\") // => true\n * PcSet.includes([\"C\", \"D\", \"E\"], \"C#4\") // => false\n */\nexport function includes(set, note) {\n  if (arguments.length > 1) { return includes(set)(note); }\n  set = chroma(set);\n  return function(note) {\n    return set[chr(note)] === \"1\";\n  };\n}\n\n/**\n * Filter a list with a pitch class set\n *\n * @param {Array|String} set - the pitch class set notes\n * @param {Array|String} notes - the note list to be filtered\n * @return {Array} the filtered notes\n *\n * @example\n * PcSet.filter([\"C\", \"D\", \"E\"], [\"c2\", \"c#2\", \"d2\", \"c3\", \"c#3\", \"d3\"]) // => [ \"c2\", \"d2\", \"c3\", \"d3\" ])\n * PcSet.filter([\"C2\"], [\"c2\", \"c#2\", \"d2\", \"c3\", \"c#3\", \"d3\"]) // => [ \"c2\", \"c3\" ])\n */\nexport function filter(set, notes) {\n  if (arguments.length === 1) { return function (n) { return filter(set, n); }; }\n  return notes.filter(includes(set));\n}\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-dictionary.svg)](https://www.npmjs.com/package/tonal-dictionary)\n *\n * `tonal-dictionary` contains a dictionary of musical scales and chords\n *\n * This is part of [tonal](https://www.npmjs.com/package/tonal) music theory library.\n *\n * @example\n * // es6\n * import * as Dictionary from \"tonal-dictionary\"\n * // es5\n * const Dictionary = require(\"tonal-dictionary\")\n *\n * @example\n * Dictionary.chord(\"Maj7\") // => [\"1P\", \"3M\", \"5P\", \"7M\"]\n *\n * @module Dictionary\n */\nimport sdata from \"./data/scales.json\";\nimport cdata from \"./data/chords.json\";\nimport { chroma } from \"tonal-pcset\";\n\nexport var dictionary = function (raw) {\n  var keys = Object.keys(raw).sort();\n  var data = [];\n  var index = [];\n\n  var add = function (name, ivls, chroma) {\n    data[name] = ivls;\n    index[chroma] = index[chroma] || [];\n    index[chroma].push(name);\n  };\n\n  keys.forEach(function (key) {\n    var ivls = raw[key][0].split(\" \");\n    var alias = raw[key][1];\n    var chr = chroma(ivls);\n\n    add(key, ivls, chr);\n    if (alias) { alias.forEach(function (a) { return add(a, ivls, chr); }); }\n  });\n  var allKeys = Object.keys(data).sort();\n\n  var dict = function (name) { return data[name]; };\n  dict.names = function (p) {\n    if (typeof p === \"string\") { return (index[p] || []).slice(); }\n    else { return (p === true ? allKeys : keys).slice(); }\n  };\n  return dict;\n};\n\nexport var combine = function (a, b) {\n  var dict = function (name) { return a(name) || b(name); };\n  dict.names = function (p) { return a.names(p).concat(b.names(p)); };\n  return dict;\n};\n\n/**\n * A dictionary of scales: a function that given a scale name (without tonic)\n * returns an array of intervals\n *\n * @function\n * @param {String} name\n * @return {Array} intervals\n * @example\n * import { scale } from \"tonal-dictionary\"\n * scale(\"major\") // => [\"1P\", \"2M\", ...]\n * scale.names(); // => [\"major\", ...]\n */\nexport var scale = dictionary(sdata);\n\n/**\n * A dictionary of chords: a function that given a chord type\n * returns an array of intervals\n *\n * @function\n * @param {String} type\n * @return {Array} intervals\n * @example\n * import { chord } from \"tonal-dictionary\"\n * chord(\"Maj7\") // => [\"1P\", \"3M\", ...]\n * chord.names(); // => [\"Maj3\", ...]\n */\nexport var chord = dictionary(cdata);\nexport var pcset = combine(scale, chord);\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-scale.svg?style=flat-square)](https://www.npmjs.com/package/tonal-scale)\n *\n * A scale is a collection of pitches in ascending or descending order.\n *\n * This module provides functions to get and manipulate scales.\n *\n * @example\n * // es6\n * import * as Scale from \"tonal-scale\"\n * // es5\n * const Scale = require(\"tonal-scale\");\n *\n * @example\n * Scale.notes(\"Ab bebop\") // => [ \"Ab\", \"Bb\", \"C\", \"Db\", \"Eb\", \"F\", \"Gb\", \"G\" ]\n * Scale.names() => [\"major\", \"minor\", ...]\n * @module Scale\n */\nimport { name as noteName, pc } from \"tonal-note\";\nimport {\n  modes as pcsetModes,\n  chroma,\n  isSubsetOf,\n  isSupersetOf\n} from \"tonal-pcset\";\nimport { transpose } from \"tonal-distance\";\nimport { scale, chord } from \"tonal-dictionary\";\nimport { compact, unique, rotate } from \"tonal-array\";\n\nvar NO_SCALE = Object.freeze({\n  name: null,\n  intervals: [],\n  names: [],\n  chroma: null,\n  setnum: null\n});\n\nvar properties = function (name) {\n  var intervals = scale(name);\n  if (!intervals) { return NO_SCALE; }\n  var s = { intervals: intervals, name: name };\n  s.chroma = chroma(intervals);\n  s.setnum = parseInt(s.chroma, 2);\n  s.names = scale.names(s.chroma);\n  return Object.freeze(s);\n};\n\nvar memoize = function (fn, cache) { return function (str) { return cache[str] || (cache[str] = fn(str)); }; };\n\n/**\n * Get scale properties. It returns an object with:\n * - name: the scale name\n * - names: a list with all possible names (includes the current)\n * - intervals: an array with the scale intervals\n * - chroma:  scale croma (see pcset)\n * - setnum: scale chroma number\n *\n * @function\n * @param {string} name - the scale name (without tonic)\n * @return {Object}\n */\nexport var props = memoize(properties, {});\n\n/**\n * Return the available scale names\n *\n * @function\n * @param {boolean} [aliases=false] - true to include aliases\n * @return {Array} the scale names\n *\n * @example\n * Scale.names() // => [\"maj7\", ...]\n */\nexport var names = scale.names;\n\n/**\n * Given a scale name, return its intervals. The name can be the type and\n * optionally the tonic (which is ignored)\n *\n * It retruns an empty array when no scale found\n *\n * @function\n * @param {string} name - the scale name (tonic and type, tonic is optional)\n * @return {Array<string>} the scale intervals if is a known scale or an empty\n * array if no scale found\n * @example\n * Scale.intervals(\"major\") // => [ \"1P\", \"2M\", \"3M\", \"4P\", \"5P\", \"6M\", \"7M\" ]\n */\nexport var intervals = function (name) {\n  var p = tokenize(name);\n  return props(p[1]).intervals;\n};\n\n/**\n * Get the notes (pitch classes) of a scale.\n *\n * Note that it always returns an array, and the values are only pitch classes.\n *\n * @function\n * @param {string} tonic\n * @param {string} nameOrTonic - the scale name or tonic (if 2nd param)\n * @param {string} [name] - the scale name without tonic\n * @return {Array} a pitch classes array\n *\n * @example\n * Scale.notes(\"C\", \"major\") // => [ \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\" ]\n * Scale.notes(\"C major\") // => [ \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\" ]\n * Scale.notes(\"C4\", \"major\") // => [ \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\" ]\n * Scale.notes(\"A4\", \"no-scale\") // => []\n * Scale.notes(\"blah\", \"major\") // => []\n */\nexport function notes(nameOrTonic, name) {\n  var p = tokenize(nameOrTonic);\n  name = name || p[1];\n  return intervals(name).map(transpose(p[0]));\n}\n\n/**\n * Check if the given name is a known scale from the scales dictionary\n *\n * @function\n * @param {string} name - the scale name\n * @return {Boolean}\n */\nexport function exists(name) {\n  var p = tokenize(name);\n  return scale(p[1]) !== undefined;\n}\n\n/**\n * Given a string with a scale name and (optionally) a tonic, split\n * that components.\n *\n * It retuns an array with the form [ name, tonic ] where tonic can be a\n * note name or null and name can be any arbitrary string\n * (this function doesn\"t check if that scale name exists)\n *\n * @function\n * @param {string} name - the scale name\n * @return {Array} an array [tonic, name]\n * @example\n * Scale.tokenize(\"C mixolydean\") // => [\"C\", \"mixolydean\"]\n * Scale.tokenize(\"anything is valid\") // => [\"\", \"anything is valid\"]\n * Scale.tokenize() // => [\"\", \"\"]\n */\nexport function tokenize(str) {\n  if (typeof str !== \"string\") { return [\"\", \"\"]; }\n  var i = str.indexOf(\" \");\n  var tonic = noteName(str.substring(0, i)) || noteName(str) || \"\";\n  var name = tonic !== \"\" ? str.substring(tonic.length + 1) : str;\n  return [tonic, name.length ? name : \"\"];\n}\n\n/**\n * Find mode names of a scale\n *\n * @function\n * @param {string} name - scale name\n * @example\n * Scale.modeNames(\"C pentatonic\") // => [\n *   [\"C\", \"major pentatonic\"],\n *   [\"D\", \"egyptian\"],\n *   [\"E\", \"malkos raga\"],\n *   [\"G\", \"ritusen\"],\n *   [\"A\", \"minor pentatonic\"]\n * ]\n */\nexport var modeNames = function (name) {\n  var ivls = intervals(name);\n  var tonics = notes(name);\n\n  return pcsetModes(ivls)\n    .map(function (chroma, i) {\n      var name = scale.names(chroma)[0];\n      if (name) { return [tonics[i] || ivls[i], name]; }\n    })\n    .filter(function (x) { return x; });\n};\n\n/**\n * Get all chords that fits a given scale\n *\n * @function\n * @param {string} name - the scale name\n * @return {Array<string>} - the chord names\n *\n * @example\n * Scale.chords(\"pentatonic\") // => [\"5\", \"64\", \"M\", \"M6\", \"Madd9\", \"Msus2\"]\n */\nexport var chords = function (name) {\n  var inScale = isSubsetOf(intervals(name));\n  return chord.names().filter(function (name) { return inScale(chord(name)); });\n};\n\n/**\n * Given an array of notes, return the scale: a pitch class set starting from\n * the first note of the array\n *\n * @function\n * @param {Array} notes\n * @return {Array}\n * @example\n * Scale.toScale(['C4', 'c3', 'C5', 'C4', 'c4']) // => [\"C\"]\n * Scale.toScale(['D4', 'c#5', 'A5', 'F#6']) // => [\"D\", \"F#\", \"A\", \"C#\"]\n */\nexport var toScale = function (notes) {\n  var pcset = compact(notes.map(pc));\n  if (!pcset.length) { return pcset; }\n  var tonic = pcset[0];\n  var scale = unique(pcset);\n  return rotate(scale.indexOf(tonic), scale);\n};\n\n/**\n * Get all scales names that are a superset of the given one\n * (has the same notes and at least one more)\n *\n * @function\n * @param {string} name\n * @return {Array} a list of scale names\n * @example\n * Scale.supersets(\"major\") // => [\"bebop\", \"bebop dominant\", \"bebop major\", \"chromatic\", \"ichikosucho\"]\n */\nexport var supersets = function (name) {\n  if (!intervals(name).length) { return []; }\n  var isSuperset = isSupersetOf(intervals(name));\n  return scale.names().filter(function (name) { return isSuperset(scale(name)); });\n};\n\n/**\n * Find all scales names that are a subset of the given one\n * (has less notes but all from the given scale)\n *\n * @function\n * @param {string} name\n * @return {Array} a list of scale names\n *\n * @example\n * Scale.subsets(\"major\") // => [\"ionian pentatonic\", \"major pentatonic\", \"ritusen\"]\n */\nexport var subsets = function (name) {\n  var isSubset = isSubsetOf(intervals(name));\n  return scale.names().filter(function (name) { return isSubset(scale(name)); });\n};\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-chord.svg)](https://www.npmjs.com/package/tonal-chord)\n * [![tonal](https://img.shields.io/badge/tonal-chord-yellow.svg)](https://www.npmjs.com/browse/keyword/tonal)\n *\n * `tonal-chord` is a collection of functions to manipulate musical chords\n *\n * This is part of [tonal](https://www.npmjs.com/package/tonal) music theory library.\n *\n * @example\n * // es6\n * import * as Chord from \"tonal-chord\"\n * // es5\n * const Chord = require(\"tonal-chord\")\n *\n * @example\n * Chord.notes(\"CMaj7\") // => [\"C\", \"E\", \"G\", \"B\"]\n *\n * @module Chord\n */\nimport { tokenize as split } from \"tonal-note\";\nimport { transpose } from \"tonal-distance\";\nimport { chord } from \"tonal-dictionary\";\nimport { chroma, isSubsetOf, isSupersetOf } from \"tonal-pcset\";\n\n/**\n * Return the available chord names\n *\n * @function\n * @param {boolean} aliases - true to include aliases\n * @return {Array} the chord names\n *\n * @example\n * Chord.names() // => [\"maj7\", ...]\n */\nexport var names = chord.names;\n\nvar NO_CHORD = Object.freeze({\n  name: null,\n  names: [],\n  intervals: [],\n  chroma: null,\n  setnum: null\n});\n\nvar properties = function (name) {\n  var intervals = chord(name);\n  if (!intervals) { return NO_CHORD; }\n  var s = { intervals: intervals, name: name };\n  s.chroma = chroma(intervals);\n  s.setnum = parseInt(s.chroma, 2);\n  s.names = chord.names(s.chroma);\n  return s;\n};\n\nvar memo = function (fn, cache) {\n  if ( cache === void 0 ) cache = {};\n\n  return function (str) { return cache[str] || (cache[str] = fn(str)); };\n};\n\n/**\n * Get chord properties. It returns an object with:\n *\n * - name: the chord name\n * - names: a list with all possible names (includes the current)\n * - intervals: an array with the chord intervals\n * - chroma:  chord croma (see pcset)\n * - setnum: chord chroma number\n *\n * @function\n * @param {String} name - the chord name (without tonic)\n * @return {Object} an object with the properties or a object with all properties\n * set to null if not valid chord name\n */\nexport var props = memo(properties);\n\n/**\n * Get chord intervals. It always returns an array\n *\n * @function\n * @param {String} name - the chord name (optionally a tonic and type)\n * @return {Array<String>} a list of intervals or null if the type is not known\n */\nexport var intervals = function (name) { return props(tokenize(name)[1]).intervals; };\n\n/**\n * Get the chord notes of a chord. This function accepts either a chord name\n * (for example: \"Cmaj7\") or a list of notes.\n *\n * It always returns an array, even if the chord is not found.\n *\n * @function\n * @param {String} nameOrTonic - name of the chord or the tonic (if the second parameter is present)\n * @param {String} [name] - (Optional) name if the first parameter is the tonic\n * @return {Array} an array of notes or an empty array\n *\n * @example\n * Chord.notes(\"Cmaj7\") // => [\"C\", \"E\", \"G\", \"B\"]\n * Chord.notes(\"C\", \"maj7\") // => [\"C\", \"E\", \"G\", \"B\"]\n */\nexport function notes(nameOrTonic, name) {\n  if (name) { return props(name).intervals.map(transpose(nameOrTonic)); }\n  var ref = tokenize(nameOrTonic);\n  var tonic = ref[0];\n  var type = ref[1];\n  return props(type).intervals.map(transpose(tonic));\n}\n\n/**\n * Check if a given name correspond to a chord in the dictionary\n *\n * @function\n * @param {String} name\n * @return {Boolean}\n * @example\n * Chord.exists(\"CMaj7\") // => true\n * Chord.exists(\"Maj7\") // => true\n * Chord.exists(\"Ablah\") // => false\n */\nexport var exists = function (name) { return chord(tokenize(name)[1]) !== undefined; };\n\n/**\n * Get all chords names that are a superset of the given one\n * (has the same notes and at least one more)\n *\n * @function\n * @param {String} name\n * @return {Array} a list of chord names\n */\nexport var supersets = function (name) {\n  if (!intervals(name).length) { return []; }\n  var isSuperset = isSupersetOf(intervals(name));\n  return chord.names().filter(function (name) { return isSuperset(chord(name)); });\n};\n\n/**\n * Find all chords names that are a subset of the given one\n * (has less notes but all from the given chord)\n *\n * @function\n * @param {String} name\n * @return {Array} a list of chord names\n */\nexport var subsets = function (name) {\n  var isSubset = isSubsetOf(intervals(name));\n  return chord.names().filter(function (name) { return isSubset(chord(name)); });\n};\n\n// 6, 64, 7, 9, 11 and 13 are consider part of the chord\n// (see https://github.com/danigb/tonal/issues/55)\nvar NUM_TYPES = /^(6|64|7|9|11|13)$/;\n/**\n * Tokenize a chord name. It returns an array with the tonic and chord type\n * If not tonic is found, all the name is considered the chord name.\n *\n * This function does NOT check if the chord type exists or not. It only tries\n * to split the tonic and chord type.\n *\n * @function\n * @param {String} name - the chord name\n * @return {Array} an array with [tonic, type]\n * @example\n * Chord.tokenize(\"Cmaj7\") // => [ \"C\", \"maj7\" ]\n * Chord.tokenize(\"C7\") // => [ \"C\", \"7\" ]\n * Chord.tokenize(\"mMaj7\") // => [ \"\", \"mMaj7\" ]\n * Chord.tokenize(\"Cnonsense\") // => [ \"C\", \"nonsense\" ]\n */\nexport function tokenize(name) {\n  var p = split(name);\n  if (p[0] === \"\") { return [\"\", name]; }\n  // aug is augmented (see https://github.com/danigb/tonal/issues/55)\n  if (p[0] === \"A\" && p[3] === \"ug\") { return [\"\", \"aug\"]; }\n\n  if (NUM_TYPES.test(p[2])) {\n    return [p[0] + p[1], p[2] + p[3]];\n  } else {\n    return [p[0] + p[1] + p[2], p[3]];\n  }\n}\n","/**\n * [![npm version](https://img.shields.io/npm/v/tonal-key.svg?style=flat-square)](https://www.npmjs.com/package/tonal-key)\n *\n * The `Tonal` module is a facade to the rest of the modules. They are namespaced,\n * so for example to use `pc` function from `tonal-note` you have to write:\n * `Tonal.Note.pc`\n *\n * It exports the following modules:\n * - Note\n * - Interval\n * - Distance\n * - Scale\n * - Chord\n * - PcSet\n *\n * Additionally this facade exports some functions without namespace (see \"Methods\" below)\n *\n * @example\n * // es6 modules\n * import * as Tonal from \"tonal\"\n * Tonal.Note.name(\"cx\") // => \"C##\"\n *\n * @example\n * import { Note } from \"tonal\"\n * Note.name(\"bb\") // => \"Bb\"\n *\n * @example\n * // es5 node modules\n * var Tonal = require(\"tonal\");\n * Tonal.Distance.transpose(Tonal.Note.pc(\"C#2\"), \"M3\") // => \"E#\"\n * Tonal.Chord.notes(\"Dmaj7\") // => [\"D\", \"F#\", \"A\", \"C#\"]\n *\n * @module Tonal\n */\nimport * as Array from \"tonal-array\";\nimport * as Note from \"tonal-note\";\nimport * as Interval from \"tonal-interval\";\nimport * as Distance from \"tonal-distance\";\nimport * as Dictionary from \"tonal-dictionary\";\nimport * as Scale from \"tonal-scale\";\nimport * as Chord from \"tonal-chord\";\nimport * as PcSet from \"tonal-pcset\";\n\nexport { Array, Note, Interval, Distance, Scale, Chord, PcSet, Dictionary };\n\n/**\n * Transpose a note by an interval\n * @function\n * @param {string} note\n * @param {string} interval\n * @return {string} the transported note\n * @see Distance.transpose\n */\nexport const transpose = Distance.transpose;\n\n/**\n * Get the interval from two notes\n * @function\n * @param {string} from\n * @param {string} to\n * @return {string} the interval in reverse shorthand notation\n * @see Distance.interval\n */\nexport const interval = Distance.interval;\n\n/**\n * Get note properties\n * @function\n * @param {string} note - the note name\n * @return {Object}\n * @see Note.props\n * @example\n * Tonal.note(\"A4\").chroma // => 9\n */\nexport const note = Note.props;\n\n/**\n * Get midi note number\n * @function\n * @param {string} note\n * @return {Number}\n * @see Note.midi\n * @example\n * Tonal.midi(\"A4\") // => 49\n */\nexport const midi = Note.midi;\n\n/**\n * Get note frequency using equal tempered tuning at 440\n * @function\n * @param {string} note\n * @return {Number}\n * @see Note.freq\n * @example\n * Tonal.freq(\"A4\") // => 440\n */\nexport const freq = Note.freq;\n\n/**\n * Get intervals from a chord type\n * @function\n * @param {string} type - the chord type (no tonic)\n * @return {Array} an array of intervals or undefined if the chord type is not known\n * @see Dictionary.chord\n * @example\n * Tonal.chord(\"m7b5\") // => [\"1P\", \"3m\", \"5d\", \"7m\"]\n */\nexport const chord = Dictionary.chord;\n\n/**\n * Get intervals from scale name\n * @function\n * @param {string} name - the scale name (without tonic)\n * @return {Array} an array of intervals or undefiend if the scale is not kown\n * @example\n * Tonal.scale(\"major\") // => [\"1P\", \"2M\", \"3M\"...]\n */\nexport const scale = Dictionary.scale;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar Instrument = /** @class */ (function () {\n    function Instrument(_a) {\n        var _b = _a === void 0 ? {} : _a, context = _b.context, gain = _b.gain, mix = _b.mix, onTrigger = _b.onTrigger, midiOffset = _b.midiOffset;\n        this.midiOffset = 0;\n        this.gain = 1;\n        this.activeEvents = [];\n        this.onTrigger = onTrigger;\n        this.midiOffset = midiOffset || this.midiOffset;\n        this.gain = gain || this.gain;\n        this.init({ context: context, mix: mix });\n    }\n    Instrument.prototype.init = function (_a) {\n        var context = _a.context, mix = _a.mix;\n        if (!context && (!mix || !mix.context)) {\n            console.warn(\"you should pass a context or a mix (gainNode) to a new Instrument. \\n            You can also Call init with {context,mix} to setup the Instrument later\");\n            return;\n        }\n        this.context = context || mix.context;\n        this.mix = mix || this.context.destination;\n    };\n    Instrument.prototype.playNotes = function (notes, settings) {\n        var _this = this;\n        if (settings === void 0) { settings = {}; }\n        var deadline = (settings.deadline || this.context.currentTime);\n        settings = Object.assign({\n            duration: 2000,\n            gain: 1,\n        }, settings, { deadline: deadline });\n        if (settings.interval) {\n            // call recursively with single notes at interval\n            return notes.map(function (note, index) {\n                _this.playNotes([note], Object.assign({}, settings, {\n                    interval: 0,\n                    deadline: deadline + index * settings.interval\n                }));\n            });\n        }\n        var midi = notes.map(function (note) { return Harmony_1.Harmony.getMidi(note, _this.midiOffset); });\n        var noteOff = settings.deadline + settings.duration / 1000;\n        var notesOn = notes.map(function (note, index) { return ({\n            note: note,\n            midi: midi[index],\n            gain: settings.gain,\n            noteOff: noteOff,\n            deadline: settings.deadline\n        }); });\n        if (settings.pulse && this.onTrigger) {\n            settings.pulse.clock.callbackAtTime(function (deadline) {\n                _this.activeEvents = _this.activeEvents.concat(notesOn);\n                _this.onTrigger({ on: notesOn, off: [], active: _this.activeEvents });\n            }, settings.deadline);\n        }\n        if (settings.duration && settings.pulse) {\n            settings.pulse.clock.callbackAtTime(function (deadline) {\n                // find out which notes need to be deactivated\n                var notesOff = notes\n                    .filter(function (note) { return !_this.activeEvents\n                    .find(function (event) {\n                    var keep = note === event.note && event.noteOff > deadline;\n                    if (keep) {\n                        console.log('keep', note);\n                    }\n                    return keep;\n                }); }).map(function (note) { return _this.activeEvents.find(function (e) { return e.note === note; }); });\n                _this.activeEvents = _this.activeEvents\n                    .filter(function (e) { return !notesOff.includes(e); });\n                if (_this.onTrigger) {\n                    _this.onTrigger({ on: [], off: notesOff, active: _this.activeEvents });\n                }\n            }, noteOff);\n        }\n        return this.playKeys(midi, settings);\n    };\n    Instrument.prototype.playKeys = function (keys, settings) {\n        // TODO: fire callbacks after keys.map((key,i)=>i*settings.interval)?\n    };\n    return Instrument;\n}());\nexports.Instrument = Instrument;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Instrument_1 = require(\"./Instrument\");\nvar tonal_1 = require(\"tonal\");\nvar util_1 = require(\"../util/util\");\nvar Synthesizer = /** @class */ (function (_super) {\n    __extends(Synthesizer, _super);\n    function Synthesizer(props) {\n        var _this = _super.call(this, props) || this;\n        _this.duration = 200;\n        _this.type = 'sine';\n        _this.gain = 0.9;\n        _this.attack = .05;\n        _this.decay = .05;\n        _this.sustain = .4;\n        _this.release = .1;\n        _this.duration = props.duration || _this.duration;\n        _this.type = props.type || _this.type;\n        _this.gain = props.gain || _this.gain;\n        return _this;\n    }\n    Synthesizer.prototype.getVoice = function (type, gain, key) {\n        if (type === void 0) { type = 'sine'; }\n        if (gain === void 0) { gain = 0; }\n        var frequency = tonal_1.Note.freq(key);\n        var oscNode = this.context.createOscillator();\n        oscNode.type = type;\n        var gainNode = this.context.createGain();\n        oscNode.connect(gainNode);\n        gainNode.gain.value = typeof gain === 'number' ? gain : 0.8;\n        gainNode.connect(this.mix);\n        oscNode.frequency.value = frequency;\n        return { oscNode: oscNode, gainNode: gainNode, key: key, frequency: frequency };\n    };\n    Synthesizer.prototype.lowestGain = function (a, b) {\n        return a.gain.gain.value < b.gain.gain.value ? -1 : 0;\n    };\n    Synthesizer.prototype.startKeys = function (keys, settings) {\n        if (settings === void 0) { settings = {}; }\n    };\n    Synthesizer.prototype.playKeys = function (keys, settings) {\n        var _this = this;\n        if (settings === void 0) { settings = {}; }\n        _super.prototype.playKeys.call(this, keys, settings); // fires callback   \n        //const time = this.context.currentTime + settings.deadline / 1000;\n        var time = settings.deadline || this.context.currentTime;\n        var interval = settings.interval || 0;\n        return keys.map(function (key, i) {\n            var delay = i * interval;\n            var _a = [\n                settings.endless,\n                settings.attack || _this.attack,\n                settings.decay || _this.decay,\n                settings.sustain || _this.sustain,\n                settings.release || _this.release,\n                (settings.duration || _this.duration) / 1000,\n                (settings.gain || 1) * _this.gain\n            ], endless = _a[0], attack = _a[1], decay = _a[2], sustain = _a[3], release = _a[4], duration = _a[5], gain = _a[6];\n            var voice = _this.getVoice(_this.type, 0, key);\n            util_1.adsr({ attack: attack, decay: decay, sustain: sustain, release: release, gain: gain, duration: duration, endless: endless }, time + delay, voice.gainNode.gain);\n            voice.oscNode.start(settings.deadline + delay);\n            return voice;\n        });\n    };\n    Synthesizer.prototype.stopVoice = function (voice, settings) {\n        if (settings === void 0) { settings = {}; }\n        if (!voice) {\n            return;\n        }\n        var time = settings.deadline || this.context.currentTime;\n        voice.gainNode.gain.setTargetAtTime(0, time, settings.release || this.release);\n        //voice.oscNode.stop()\n    };\n    Synthesizer.prototype.stopVoices = function (voices, settings) {\n        var _this = this;\n        voices.forEach(function (voice) {\n            _this.stopVoice(voice, settings);\n        });\n    };\n    return Synthesizer;\n}(Instrument_1.Instrument));\nexports.Synthesizer = Synthesizer;\n","\"use strict\";\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Chord = __importStar(require(\"tonal-chord\"));\nvar Scale = __importStar(require(\"tonal-scale\"));\nexports.chords = [\n    {\n        symbol: 'm',\n        long: 'minor',\n        short: '-',\n        groups: ['Basic', 'Triads']\n    },\n    {\n        symbol: 'M',\n        long: 'major',\n        short: '',\n        groups: ['Basic', 'Triads']\n    },\n    {\n        symbol: 'o',\n        groups: ['Basic', 'Symmetric', 'Triads'],\n        long: 'Vermindert'\n        /* short: 'o' */\n    },\n    {\n        symbol: 'M#5',\n        groups: ['Advanced', 'Symmetric', 'Triads'],\n        short: '#5'\n    },\n    {\n        symbol: 'Msus4',\n        groups: ['Advanced', 'Symmetric'],\n        short: 'sus4'\n    },\n    {\n        symbol: 'Msus2',\n        groups: ['Advanced', 'Symmetric'],\n        short: 'sus2'\n    },\n    // 5 4 64 m#5 Mb5  7no5  \n    {\n        symbol: '7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Dominantsept'\n    },\n    {\n        symbol: '7#11',\n        groups: ['Advanced', 'Diatonic', 'Modes'],\n        long: 'Dominant #11'\n    },\n    {\n        symbol: 'M6',\n        groups: ['Advanced'],\n        long: 'major 6',\n        short: '6'\n    },\n    {\n        symbol: 'o7',\n        groups: ['Advanced', 'Symmetric', 'Diatonic'],\n        long: 'Vermindert 7',\n    },\n    {\n        symbol: 'm7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'minor 7',\n        short: '-7'\n    },\n    {\n        symbol: 'oM7',\n        groups: ['Expert'],\n        long: 'diminished major 7',\n        short: 'o7'\n    },\n    {\n        symbol: 'm7b5',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Halbvermindert',\n        short: '-7b5'\n    },\n    {\n        symbol: '7#5',\n        groups: ['Advanced', 'Symmetric'],\n        long: 'Dominantsept #5'\n    },\n    {\n        symbol: 'Maj7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Major 7',\n        short: '7'\n    },\n    {\n        symbol: 'mMaj7',\n        short: '-7',\n        groups: ['Advanced', 'Diatonic']\n    },\n    {\n        symbol: 'M7#5',\n        groups: ['Advanced', 'Diatonic'],\n        short: '7#5'\n    },\n    {\n        symbol: '7sus4',\n        groups: ['Advanced'],\n    },\n    {\n        symbol: '9',\n        groups: ['Advanced'],\n    },\n    {\n        symbol: 'M9',\n        groups: ['Advanced'],\n        short: '9'\n    },\n    {\n        symbol: 'M69',\n        groups: ['Advanced'],\n        short: '69'\n    }\n    /*\n7b13 M7b5 m7#5 9no5  M7b6 7b5 Madd9 mb6b9 mb6M7 madd4 sus24 madd9 Maddb9 +add#9 M7sus4 7#5sus4 M#5add9 M7#5sus4\n11 m9 m6 9#5 7b9 7#9 M69 9b5 m69 mM9 7b6 m9b5 m9#5 7#11 M7b9 9b13 o7M7 M9b5 11b9 M9#5 7add6 M6#11 M7#11 7#5#9 13no5 9sus4 7#5b9 M9sus4 7sus4b9 m7add11 mMaj7b6 M9#5sus4\n13 m11 M13 9#11 13#9 13b5 13b9 m11b5 7b9#9 mM9b6 M9#11 9#5#11 7#9b13 7b9b13 13sus4 m11A 5 7#9#11 7b9#11 M69#11 7#11b13 M7#9#11 M7add13 7#5b9#11 7sus4b9b13\nm13 13#11 M13#11 13b9#11 9#11b13 13#9#11 7b9b13#11 7#9#11b13\n    */\n];\nexports.scales = [\n    {\n        symbol: 'major pentatonic',\n        groups: ['Basic', 'Pentatonic'],\n    },\n    {\n        symbol: 'minor pentatonic',\n        groups: ['Basic', 'Pentatonic'],\n    },\n    {\n        symbol: 'minor blues',\n        groups: ['Basic'],\n    },\n    // gregorian modes\n    {\n        symbol: 'major',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'dorian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'phrygian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'lydian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'mixolydian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'aeolian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'locrian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'whole tone',\n        groups: ['Advanced', 'Symmetric']\n    },\n    {\n        symbol: 'diminished',\n        groups: ['Advanced', 'Symmetric']\n    },\n    //HTGT ?\n    {\n        symbol: 'augmented',\n        groups: ['Advanced', 'Symmetric']\n    },\n    {\n        symbol: 'chromatic',\n        groups: ['Expert', 'Symmetric']\n    },\n    // harmonic minor modes\n    {\n        symbol: 'harmonic minor',\n        groups: ['Advanced', 'Diatonic']\n    },\n    // HM 2 locrian #6 !\n    {\n        symbol: 'ionian augmented',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'dorian #4',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'spanish',\n        groups: ['Advanced', 'Diatonic']\n    },\n    // HM 6 lydian #9\n    // HM 7 ???\n    // melodic minor modes\n    {\n        symbol: 'melodic minor',\n        groups: ['Advanced', 'Diatonic']\n    },\n    {\n        symbol: 'melodic minor second mode',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'lydian augmented',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'lydian dominant',\n        groups: ['Advanced', 'Diatonic'],\n        long: 'mixolydian #11'\n    },\n    {\n        symbol: 'melodic minor fifth mode',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'locrian #2',\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'altered',\n        groups: ['Advanced', 'Diatonic']\n    },\n    //non european\n    {\n        symbol: 'kumoijoshi',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'iwato',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'pelog',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    // hyojo?\n    {\n        symbol: 'egyptian',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'in-sen',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'scriabin',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'ritusen',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'hirajoshi',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'malkos raga',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'vietnamese 1',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    /* {\n        symbol: 'vietnamese 2',\n        groups: ['Exotic', 'Pentatonic'] // = minor pentatonic\n    }, */\n    {\n        symbol: 'lydian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'mixolydian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'ionian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'locrian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'flat six pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'minor six pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'minor #7M pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'lydian #5P pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'whole tone pentatonic',\n        groups: ['Pentatonic', 'Symmetric']\n    },\n    {\n        symbol: 'flat three pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'super locrian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'major flat two pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'lydian dominant pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'neopolitan major pentatonic',\n        groups: ['Pentatonic']\n    }\n    /*\n    mystery #1 piongio    prometheus major blues minor hexatonic six tone symmetric prometheus neopolitan\n     persian  spanish  oriental flamenco balinese   todi raga enigmatic lydian #9 neopolitan locrian #2  lydian minor  locrian major  romanian minor harmonic major hungarian major hungarian minor lydian dominant   neopolitan minor neopolitan major lydian diminished leading whole tone augmented heptatonic double harmonic major double harmonic lydian melodic minor fifth mode melodic minor second mode\n    bebop kafi raga  purvi raga ichikosucho bebop minor minor bebop bebop major bebop locrian bebop dominant spanish heptatonic minor six diminished\n    composite blues\n    */\n];\nexports.symbols = { chords: exports.chords, scales: exports.scales };\nexports.levels = ['Basic', 'Advanced', 'Expert'];\nfunction groupFilter(group) {\n    return function (item) {\n        var level = Math.max(item.groups.filter(function (group) { return exports.levels.indexOf(group) !== -1; })\n            .map(function (group) { return exports.levels.indexOf(group) + 1; }));\n        var groups = level > 0 ? Array.from(new Set(exports.levels.slice(level).concat(item.groups))) : item.groups;\n        return groups.indexOf(group) !== -1;\n    };\n}\nexports.groupFilter = groupFilter;\nfunction scaleNames(group) {\n    if (group === void 0) { group = 'Basic'; }\n    if (!group || group === 'All') {\n        return Scale.names();\n    }\n    return exports.scales.filter(groupFilter(group))\n        .map(function (scale) { return scale.symbol; });\n}\nexports.scaleNames = scaleNames;\nfunction chordNames(group) {\n    if (group === void 0) { group = 'Basic'; }\n    if (!group || group === 'All') {\n        return Chord.names();\n    }\n    return exports.chords.filter(groupFilter(group))\n        .map(function (scale) { return scale.symbol; });\n}\nexports.chordNames = chordNames;\nfunction groupNames() {\n    return Array.from(new Set(exports.levels.concat(exports.scales.concat(exports.chords)\n        .map(function (item) { return item.groups; })\n        .reduce(function (groups, current) { return groups.concat(current); })))).concat(['All']);\n}\nexports.groupNames = groupNames;\nfunction symbolName(type, symbol, long) {\n    var pool = exports.symbols[type + 's'];\n    var match = pool.find(function (item) { return item.symbol === symbol; });\n    if (!match) {\n        return symbol;\n    }\n    /* return symbol; */\n    return (long ? match.long : match.short) || symbol;\n}\nexports.symbolName = symbolName;\nfunction scaleName(symbol, long) {\n    if (long === void 0) { long = false; }\n    return symbolName('scale', symbol, long);\n}\nexports.scaleName = scaleName;\nfunction chordName(symbol, long) {\n    if (long === void 0) { long = false; }\n    return symbolName('chord', symbol, long);\n}\nexports.chordName = chordName;\nfunction randomItem(array) {\n    return array[Math.floor(Math.random() * array.length)];\n}\nexports.randomItem = randomItem;\nfunction randomScale(group) {\n    return randomItem(scaleNames(group));\n}\nexports.randomScale = randomScale;\nfunction randomChord(group) {\n    return randomItem(chordNames(group));\n}\nexports.randomChord = randomChord;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tonal_1 = require(\"tonal\");\nvar Synthesizer_1 = require(\"../instruments/Synthesizer\");\nvar symbols_1 = require(\"../symbols\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar steps = {\n    '1P': ['1', '8'],\n    '2m': ['b9', 'b2'],\n    '2M': ['9', '2',],\n    '2A': ['#9', '#2'],\n    '3m': ['b3'],\n    '3M': ['3'],\n    '4P': ['11', '4'],\n    '4A': ['#11', '#4'],\n    '5d': ['b5'],\n    '5P': ['5'],\n    '5A': ['#5'],\n    '6m': ['b13', 'b6'],\n    '6M': ['13', '6'],\n    '7m': ['b7'],\n    '7M': ['7', '^7', 'maj7']\n};\n/*\nLower Interval Limits (just guidelines):\n2m: E3-F3\n2M: Eb3-F3\n3m: C3-Eb3\n3M: Bb2-D3\n4P: Bb2-Eb3\n5D: B2-F3\n5P: Bb1-F2\n6m: F2-Db3\n6M: F2-D3\n7m: F2-Eb3\n7m: F2-E3\n8P: -\n\nmore rough: top note should be D3 or higher.\ntaken from https://www.youtube.com/watch?v=iW6YeDJklhQ\n*/\nfunction randomNumber(n) {\n    return Math.floor(Math.random() * n);\n}\nexports.randomNumber = randomNumber;\nfunction arraySum(array) {\n    return array.reduce(function (s, i) { return s + i; }, 0);\n}\nexports.arraySum = arraySum;\nfunction randomElement(array, weighted) {\n    if (!weighted) {\n        return array[randomNumber(array.length)];\n    }\n    var r = randomNumber(arraySum(weighted)) + 1;\n    var total = weighted\n        .reduce(function (abs, w, i) { return abs.concat(w + (abs.length ? abs[i - 1] : 0)); }, []);\n    return array[total.indexOf(total.find(function (s, i) { return s >= r; }))];\n}\nexports.randomElement = randomElement;\nfunction shuffleArray(a) {\n    var _a;\n    for (var i = a.length - 1; i > 0; i--) {\n        var j = Math.floor(Math.random() * (i + 1));\n        _a = [a[j], a[i]], a[i] = _a[0], a[j] = _a[1];\n    }\n    return a;\n}\nexports.shuffleArray = shuffleArray;\n/** OLD SHEET / RHYTHM STUFF */\n/** Travels path along measures */\nfunction getPath(path, measures, traveled) {\n    if (traveled === void 0) { traveled = []; }\n    if (!Array.isArray(measures[path[0]]) || path.length === 1) {\n        return measures[Math.min(path[0], measures.length - 1)];\n    }\n    return this.getPath(path.slice(1), measures[path[0]], traveled.concat(path[0]));\n}\nexports.getPath = getPath;\nfunction getDuration(divisions, noteLength, measureLength) {\n    if (noteLength === void 0) { noteLength = 1; }\n    if (measureLength === void 0) { measureLength = 1; }\n    return noteLength * divisions.reduce(function (f, d) { return f / d; }, 1000) * measureLength; // fraction of one\n}\nexports.getDuration = getDuration;\nfunction resolveChords(pattern, measures, path, divisions) {\n    var _this = this;\n    if (divisions === void 0) { divisions = []; }\n    if (Array.isArray(pattern)) {\n        // division: array of children lengths down the path (to calculate fraction)\n        divisions = [].concat(divisions, [pattern.length]);\n        return pattern.map(function (p, i) { return _this.resolveChords(p, measures, path.concat([i]), divisions); });\n    }\n    if (pattern === 0) {\n        return 0;\n    }\n    var fraction = getDuration(divisions, pattern);\n    if (fraction === 0) {\n        console.warn('fraction is 0', pattern);\n    }\n    if (fraction === NaN) {\n        console.warn('fraction NaN', divisions, pattern);\n    }\n    return { chord: this.getPath(path, measures), pattern: pattern, path: path, divisions: divisions, fraction: fraction };\n}\nexports.resolveChords = resolveChords;\nfunction hasOff(pattern, division) {\n    if (division === void 0) { division = 3; }\n    return Array.isArray(pattern) && pattern.length === division && pattern[division - 1] !== 0;\n}\nexports.hasOff = hasOff;\n// replaces offs on last beat with next chord + erases next one\nfunction offbeatReducer(settings) {\n    var _this = this;\n    // TODO: find out why some offbeats sound sketchy\n    return function (measures, bar, index) {\n        var last = index > 0 ? measures[index - 1] : null;\n        if (last && _this.hasOff(last[settings.cycle - 1], settings.division)) {\n            last[settings.cycle - 1][settings.division - 1] = bar[0];\n            bar[0] = 0;\n        }\n        return measures.concat([bar]);\n    };\n}\nexports.offbeatReducer = offbeatReducer;\nfunction randomSynth(mix, allowed, settings) {\n    if (allowed === void 0) { allowed = ['sine', 'triangle', 'square', 'sawtooth']; }\n    if (settings === void 0) { settings = {}; }\n    var gains = {\n        sine: 0.9,\n        triangle: 0.8,\n        square: 0.2,\n        sawtooth: 0.3\n    };\n    var wave = randomElement(allowed);\n    return new Synthesizer_1.Synthesizer(Object.assign({ gain: gains[wave], type: wave, mix: mix }, settings));\n}\nexports.randomSynth = randomSynth;\nfunction adsr(_a, time, param) {\n    var attack = _a.attack, decay = _a.decay, sustain = _a.sustain, release = _a.release, gain = _a.gain, duration = _a.duration, endless = _a.endless;\n    // console.log('adsr', attack, decay, sustain, release, gain, duration, time);\n    param.linearRampToValueAtTime(gain, time + attack);\n    param.setTargetAtTime(sustain * gain, time + Math.min(attack + decay, duration), decay);\n    if (!endless) {\n        param.setTargetAtTime(0, time + Math.max(duration - attack - decay, attack + decay, duration), release);\n    }\n}\nexports.adsr = adsr;\nfunction randomDelay(maxMs) {\n    return Math.random() * maxMs * 2 / 1000;\n}\nexports.randomDelay = randomDelay;\nfunction isInRange(note, range) {\n    return tonal_1.Distance.semitones(note, range[0]) <= 0 && tonal_1.Distance.semitones(note, range[1]) >= 0;\n}\nexports.isInRange = isInRange;\nfunction transposeNotes(notes, interval) {\n    return notes.map(function (note) { return tonal_1.Distance.transpose(note, interval); });\n}\nexports.transposeNotes = transposeNotes;\nfunction transposeToRange(notes, range, times) {\n    if (times === void 0) { times = 0; }\n    if (times > 10) {\n        return notes;\n    }\n    if (notes.find(function (note) { return tonal_1.Distance.semitones(note, range[0]) > 0; })) {\n        notes = notes.map(function (note) { return tonal_1.Distance.transpose(note, '8P'); });\n        console.log('tp up');\n        return transposeToRange(notes, range, ++times);\n    }\n    if (notes.find(function (note) { return tonal_1.Distance.semitones(note, range[1]) < 0; })) {\n        console.log('tp down');\n        notes = notes.map(function (note) { return tonal_1.Distance.transpose(note, '-8P'); });\n        return transposeToRange(notes, range, ++times);\n    }\n    return notes;\n}\nexports.transposeToRange = transposeToRange;\nfunction getAverageMidi(notes, offset) {\n    return notes.reduce(function (sum, note) { return sum + Harmony_1.Harmony.getMidi(note, offset); }, 0) / notes.length;\n}\nexports.getAverageMidi = getAverageMidi;\nfunction getDistancesToRangeEnds(notes, range) {\n    if (notes.length > 2) {\n        notes = [notes[0], notes[notes.length - 1]];\n    }\n    var midi = notes.map(function (n) { return Harmony_1.Harmony.getMidi(n); });\n    var rangeMidi = range.map(function (n) { return Harmony_1.Harmony.getMidi(n); });\n    return [midi[0] - rangeMidi[0], rangeMidi[1] - midi[1]];\n}\nexports.getDistancesToRangeEnds = getDistancesToRangeEnds;\nfunction getRangePosition(note, range) {\n    note = Harmony_1.Harmony.getMidi(note);\n    range = range.map(function (n) { return Harmony_1.Harmony.getMidi(n); });\n    var semitones = [note - range[0], range[1] - range[0]];\n    return semitones[0] / semitones[1];\n}\nexports.getRangePosition = getRangePosition;\nfunction getRangeDirection(note, range, defaultDirection, border) {\n    if (defaultDirection === void 0) { defaultDirection = 'down'; }\n    if (border === void 0) { border = 0; }\n    var position = getRangePosition(note, range);\n    if (position <= border) {\n        return { direction: 'up', force: true };\n    }\n    if (position >= (1 - border)) {\n        return { direction: 'down', force: true };\n    }\n    return {\n        direction: defaultDirection, force: false\n    };\n}\nexports.getRangeDirection = getRangeDirection;\n// accepts both strings or numbers where negative means minor, \n// returns unified step string that can be turned into an interval\nfunction getStep(step) {\n    if (typeof step === 'number' && step < 0) {\n        step = 'b' + (step * -1);\n    }\n    return step + ''; // to string\n}\nexports.getStep = getStep;\nfunction getIntervalFromStep(step) {\n    step = getStep(step);\n    var interval = Object.keys(steps)\n        .find(function (i) { return steps[i].includes(step); });\n    if (!interval) {\n        // console.warn(`step ${step} has no defined inteval`);\n    }\n    return interval;\n}\nexports.getIntervalFromStep = getIntervalFromStep;\nfunction getStepsFromDegree(degree) {\n    return;\n}\nexports.getStepsFromDegree = getStepsFromDegree;\nfunction getStepsInChord(notes, chord, min) {\n    if (min === void 0) { min = false; }\n    var root = tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord))[0];\n    return notes.map(function (note) {\n        var interval = tonal_1.Distance.interval(root, tonal_1.Note.pc(note));\n        return getStepFromInterval(interval, min);\n    });\n}\nexports.getStepsInChord = getStepsInChord;\nfunction getStepInChord(note, chord, min) {\n    if (min === void 0) { min = false; }\n    return getStepFromInterval(tonal_1.Distance.interval(tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord))[0], tonal_1.Note.pc(note), min));\n}\nexports.getStepInChord = getStepInChord;\nfunction getChordScales(chord, group) {\n    if (group === void 0) { group = 'Diatonic'; }\n    var tokens = tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord));\n    /* const isSuperset = PcSet.isSupersetOf(Chord.intervals(tokens[1])); */\n    return symbols_1.scaleNames(group).filter(function (name) {\n        /* isSuperset(Scale.intervals(name)) */\n        return tonal_1.PcSet.isSupersetOf(tonal_1.Chord.intervals(tokens[1]), tonal_1.Scale.intervals(name));\n    });\n}\nexports.getChordScales = getChordScales;\nfunction pickChordScale(chord, group) {\n    if (group === void 0) { group = 'Diatonic'; }\n    var scales = getChordScales(chord);\n    if (!scales.length) {\n        console.warn(\"cannot pick chord scale: no scales found for chord \" + chord + \" in group \" + group);\n        return;\n    }\n    return scales[0];\n}\nexports.pickChordScale = pickChordScale;\nfunction findDegree(degreeOrStep, intervalsOrSteps) {\n    var intervals = intervalsOrSteps.map(function (i) { return isInterval(i) ? i : getIntervalFromStep(i); });\n    if (typeof degreeOrStep === 'number') { // is degree\n        var degree_1 = Math.abs(degreeOrStep);\n        return intervals.find(function (i) {\n            i = Harmony_1.Harmony.minInterval(i, 'up');\n            if (!steps[i]) {\n                console.error('interval', i, 'is not valid', intervals);\n            }\n            return !!(steps[i].find(function (step) { return getDegreeFromStep(step) === degree_1; }));\n        });\n    }\n    // is step\n    var step = getStep(degreeOrStep);\n    return intervals.find(function (i) { return i.includes(step) ||\n        i === getIntervalFromStep(step); });\n}\nexports.findDegree = findDegree;\nfunction hasDegree(degree, intervals) {\n    return !!findDegree(degree, intervals);\n}\nexports.hasDegree = hasDegree;\nfunction hasAllDegrees(degrees, intervals) {\n    return degrees.reduce(function (res, d) { return res && hasDegree(d, intervals); }, true);\n}\nexports.hasAllDegrees = hasAllDegrees;\nfunction getScaleDegree(degree, scale) {\n    return findDegree(degree, tonal_1.Scale.intervals(scale));\n}\nexports.getScaleDegree = getScaleDegree;\nfunction getScalePattern(pattern, scale) {\n    return pattern.map(function (degree) { return getScaleDegree(degree, scale); });\n}\nexports.getScalePattern = getScalePattern;\nfunction renderIntervals(intervals, root) {\n    return intervals.map(function (i) { return tonal_1.Distance.transpose(root, i); });\n}\nexports.renderIntervals = renderIntervals;\nfunction renderSteps(steps, root) {\n    return renderIntervals(steps.map(function (step) { return getIntervalFromStep(step); }), root);\n}\nexports.renderSteps = renderSteps;\nfunction permutateIntervals(intervals, pattern) {\n    return pattern.map(function (d) { return findDegree(d, intervals); });\n}\nexports.permutateIntervals = permutateIntervals;\nfunction getStepFromInterval(interval, min) {\n    if (min === void 0) { min = false; }\n    var step = steps[interval] || [];\n    if (min) {\n        return step[1] || step[0] || 0;\n    }\n    return step[0] || 0;\n}\nexports.getStepFromInterval = getStepFromInterval;\nfunction getDegreeFromInterval(interval, simplify) {\n    if (interval === void 0) { interval = '-1'; }\n    if (simplify === void 0) { simplify = false; }\n    var fixed = Harmony_1.Harmony.fixInterval(interval + '', simplify) || '';\n    var match = fixed.match(/[-]?([1-9])+/);\n    if (!match) {\n        return 0;\n    }\n    return Math.abs(parseInt(match[0], 10));\n}\nexports.getDegreeFromInterval = getDegreeFromInterval;\nfunction getDegreeFromStep(step) {\n    step = getStep(step);\n    var match = step.match(/([1-9])+/);\n    if (!match || !match.length) {\n        console.log('no valid step', step);\n        return 0;\n    }\n    return parseInt(match[0], 10);\n}\nexports.getDegreeFromStep = getDegreeFromStep;\nfunction getDegreeInChord(degree, chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var intervals = tonal_1.Chord.intervals(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    return tonal_1.Distance.transpose(tokens[0], findDegree(degree, intervals));\n}\nexports.getDegreeInChord = getDegreeInChord;\nfunction getPatternInChord(pattern, chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var intervals = tonal_1.Chord.intervals(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    var permutation;\n    if (hasAllDegrees(pattern, intervals)) {\n        permutation = permutateIntervals(intervals, pattern);\n    }\n    else {\n        // not all degrees of the pattern are in the chord > get scale\n        var scale = pickChordScale(chord);\n        permutation = permutateIntervals(tonal_1.Scale.intervals(scale), pattern);\n    }\n    if (tokens[0]) {\n        return renderIntervals(permutation, tokens[0]);\n    }\n    return permutation;\n}\nexports.getPatternInChord = getPatternInChord;\n// TODO: other way around: find fixed interval pattern in a scale\n// TODO: motives aka start pattern from same note in different scale\n// TODO: motives aka start pattern from different note in same scale\n// TODO: motives aka start pattern from different note in different scale\nfunction getDigitalPattern(chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var intervals = tonal_1.Chord.intervals(chord);\n    if (intervals.includes('3m')) {\n        return [1, 3, 4, 5];\n    }\n    else if (intervals.includes('3M')) {\n        return [1, 2, 3, 5];\n    }\n    else {\n        return [1, 1, 1, 1];\n    }\n}\nexports.getDigitalPattern = getDigitalPattern;\nfunction renderDigitalPattern(chord) {\n    return getPatternInChord(getDigitalPattern(chord), chord);\n}\nexports.renderDigitalPattern = renderDigitalPattern;\nfunction getGuideTones(chord) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    return getPatternInChord([3, 7], chord);\n}\nexports.getGuideTones = getGuideTones;\nfunction isFirstInPath(path, index) {\n    return path.slice(index)\n        .reduce(function (sum, value) { return sum + value; }, 0) === 0;\n}\nexports.isFirstInPath = isFirstInPath;\nfunction isBarStart(path) {\n    return isFirstInPath(path, 1);\n}\nexports.isBarStart = isBarStart;\nfunction isFormStart(path) {\n    return isFirstInPath(path, 0);\n}\nexports.isFormStart = isFormStart;\nfunction isOffbeat(path) {\n    return path[2] !== 0;\n}\nexports.isOffbeat = isOffbeat;\nfunction otherDirection(direction, defaultDirection) {\n    if (direction === 'up') {\n        return 'down';\n    }\n    else if (direction === 'down') {\n        return 'up';\n    }\n    return defaultDirection;\n}\nexports.otherDirection = otherDirection;\nfunction totalDiff(diff) {\n    var total = diff.reduce(function (weight, diff) {\n        weight.added += diff.added ? diff.count : 0;\n        weight.removed += diff.added ? diff.count : 0;\n        weight.kept += (!diff.added && !diff.removed) ? diff.count : 0;\n        return weight;\n    }, { added: 0, removed: 0, kept: 0, balance: 0 });\n    total.balance = total.added - total.removed;\n    total.changes = total.added + total.removed;\n    return total;\n}\nexports.totalDiff = totalDiff;\n/** Reorders the given notes to contain the given step as close as possible */\nfunction sortByDegree(notes, degree) {\n    degree = Math.max(degree, (degree + 8) % 8);\n    /* const semitones = Interval.semitones(interval); */\n    var diffDegrees = function (a, b) { return Math.abs(getDegreeFromInterval(tonal_1.Distance.interval(a, b) + '') - degree); };\n    /* const diffTones = (a, b) => Math.abs(Distance.interval(a, b) - semitones); */\n    notes = notes.slice(1).reduce(function (chain, note) {\n        var closest = notes\n            .filter(function (n) { return !chain.includes(n); })\n            .sort(function (a, b) { return diffDegrees(chain[0], a) < diffDegrees(chain[0], b) ? -1 : 1; });\n        chain.unshift(closest[0]);\n        return chain;\n    }, [notes[0]]).reverse();\n    return notes;\n}\nexports.sortByDegree = sortByDegree;\n/** Returns the given notes with octaves either moving bottom up or top down */\nfunction renderAbsoluteNotes(notes, octave, direction) {\n    if (octave === void 0) { octave = 3; }\n    if (direction === void 0) { direction = 'up'; }\n    return notes.reduce(function (absolute, current, index, notes) {\n        if (index === 0) {\n            return [current + octave];\n        }\n        var interval = tonal_1.Distance.interval(notes[index - 1], current);\n        interval = Harmony_1.Harmony.minInterval(interval, direction);\n        if (interval === '1P') {\n            interval = direction === 'down' ? '-8P' : '8P';\n        }\n        absolute.push(tonal_1.Distance.transpose(absolute[index - 1], interval + ''));\n        return absolute;\n    }, []);\n}\nexports.renderAbsoluteNotes = renderAbsoluteNotes;\nfunction getIntervals(notes) {\n    return notes.reduce(function (intervals, note, index, notes) {\n        if (index === 0) {\n            return [];\n        }\n        intervals.push(tonal_1.Distance.interval(notes[index - 1], note));\n        return intervals;\n    }, []);\n}\nexports.getIntervals = getIntervals;\nfunction isInterval(interval) {\n    return typeof tonal_1.Interval.semitones(interval) === 'number';\n}\nexports.isInterval = isInterval;\nfunction smallestInterval(intervals) {\n    return intervals.reduce(function (min, current) {\n        if (!min || tonal_1.Interval.semitones(current) < tonal_1.Interval.semitones(min)) {\n            return current;\n        }\n        return min;\n    });\n}\nexports.smallestInterval = smallestInterval;\nfunction sortNotes(notes, direction) {\n    if (direction === void 0) { direction = 'up'; }\n    return notes.sort(function (a, b) { return Harmony_1.Harmony.getMidi(a) - Harmony_1.Harmony.getMidi(b); });\n}\nexports.sortNotes = sortNotes;\nfunction analyzeVoicing(notes, root) {\n    if (!notes || notes.length < 2) {\n        throw new Error('Can only analyze Voicing with at least two notes');\n    }\n    notes = sortNotes(notes);\n    root = root || notes[0]; // TODO: get degrees\n    var intervals = getIntervals(notes);\n    var sortedIntervals = intervals.sort(Harmony_1.Harmony.sortMinInterval());\n    return {\n        notes: notes,\n        minInterval: sortedIntervals[0],\n        maxInterval: sortedIntervals[sortedIntervals.length - 1],\n        intervals: intervals,\n        spread: tonal_1.Distance.interval(notes[0], notes[notes.length - 1])\n    };\n}\nexports.analyzeVoicing = analyzeVoicing;\nfunction semitoneDifference(intervals) {\n    return intervals.reduce(function (semitones, interval) {\n        return semitones + Math.abs(tonal_1.Interval.semitones(interval));\n    }, 0);\n}\nexports.semitoneDifference = semitoneDifference;\nfunction semitoneMovement(intervals) {\n    return intervals.reduce(function (semitones, interval) {\n        return semitones + tonal_1.Interval.semitones(interval);\n    }, 0);\n}\nexports.semitoneMovement = semitoneMovement;\nfunction longestChild(array) {\n    return array.reduce(function (max, current) { return (current.length > max.length ? current : max); }, array[0]);\n}\nexports.longestChild = longestChild;\nfunction isPitchClass(note) {\n    return tonal_1.Note.pc(note) === note;\n}\nexports.isPitchClass = isPitchClass;\nfunction mapTree(tree, modifier, simplify, path, siblings, position) {\n    if (simplify === void 0) { simplify = false; }\n    if (path === void 0) { path = []; }\n    if (siblings === void 0) { siblings = []; }\n    if (position === void 0) { position = 0; }\n    // skip current tree if only one child\n    if (simplify && Array.isArray(tree) && tree.length === 1) {\n        return mapTree(tree[0], modifier, simplify, path, siblings, position);\n    }\n    var fraction = siblings.reduce(function (f, d) { return f / d; }, 1);\n    if (!Array.isArray(tree)) {\n        return modifier ? modifier(tree, { path: path, siblings: siblings, fraction: fraction, position: position }) : tree;\n    }\n    if (Array.isArray(tree)) {\n        siblings = siblings.concat([tree.length]);\n        fraction = fraction / tree.length;\n        return tree.map(function (subtree, index) {\n            return mapTree(subtree, modifier, simplify, path.concat([index]), siblings, position + index * fraction);\n        });\n    }\n}\nexports.mapTree = mapTree;\nfunction flattenTree(tree) {\n    var flat = [];\n    mapTree(tree, function (value, props) { return flat.push(Object.assign(props, { value: value })); });\n    return flat;\n}\nexports.flattenTree = flattenTree;\nfunction expandTree(tree) {\n    // TODO\n}\nexports.expandTree = expandTree;\n/* Returns true if the given intervals are all present in the chords interval structure\nIntervals can be appendend with \"?\" to indicate that those degrees could also be omitted\n(but when present they should match)\n*/\nfunction chordHasIntervals(chord, intervals) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var has = tonal_1.Chord.intervals(chord);\n    return intervals.reduce(function (match, current) {\n        var isOptional = current.includes('?');\n        var isForbidden = current.includes('!');\n        if (isOptional) {\n            current = current.replace('?', '');\n            return (!hasDegree(getDegreeFromInterval(current), has) ||\n                has.includes(current)) && match;\n        }\n        if (isForbidden) {\n            current = current.replace('!', '');\n            return !hasDegree(getDegreeFromInterval(current), has);\n        }\n        return has.includes(current) && match;\n    }, true);\n}\nexports.chordHasIntervals = chordHasIntervals;\nfunction isDominantChord(chord) {\n    return chordHasIntervals(chord, ['3M', '7m']) || chordHasIntervals(chord, ['!3', '4P', '7m']);\n}\nexports.isDominantChord = isDominantChord;\nfunction isMajorChord(chord) {\n    return chordHasIntervals(chord, ['3M', '7M?']);\n}\nexports.isMajorChord = isMajorChord;\nfunction isMinorChord(chord) {\n    return chordHasIntervals(chord, ['3m']);\n}\nexports.isMinorChord = isMinorChord;\nfunction isMinorTonic(chord) {\n    return chordHasIntervals(chord, ['3m', '5P', '13M?', '7M?']);\n}\nexports.isMinorTonic = isMinorTonic;\nfunction getChordType(chord) {\n    if (isDominantChord(chord)) {\n        return 'dominant';\n    }\n    if (isMajorChord(chord)) {\n        return 'major';\n    }\n    if (isMinorTonic(chord)) {\n        return 'minor-tonic';\n    }\n    if (isMinorChord(chord)) {\n        return 'minor';\n    }\n}\nexports.getChordType = getChordType;\nfunction getChordNotes(chord, validate) {\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    var notes = tonal_1.Chord.notes(chord);\n    return notes.filter(function (note) {\n        var interval = tonal_1.Distance.interval(tokens[0], note);\n        return !validate || validate(note, {\n            root: tokens[0],\n            symbol: tokens[1],\n            interval: interval,\n            step: getStepFromInterval(interval),\n            degree: getDegreeFromInterval(interval + '')\n        });\n    });\n}\nexports.getChordNotes = getChordNotes;\nfunction validateWithoutRoot(note, _a) {\n    var degree = _a.degree;\n    return degree !== 1;\n}\nexports.validateWithoutRoot = validateWithoutRoot;\n// OLD...\nfunction getVoicing(chord, _a) {\n    var _b = _a === void 0 ? {} : _a, voices = _b.voices, previousVoicing = _b.previousVoicing, omitRoot = _b.omitRoot, quartal = _b.quartal;\n    chord = Harmony_1.Harmony.getTonalChord(chord);\n    var tokens = tonal_1.Chord.tokenize(chord);\n    var notes = tonal_1.Chord.notes(chord);\n    if (omitRoot) {\n        notes = notes.filter(function (n) { return n !== tokens[0]; });\n    }\n    if (quartal) {\n    }\n    if (previousVoicing) {\n    }\n    return notes;\n}\nexports.getVoicing = getVoicing;\nfunction semitoneDistance(noteA, noteB) {\n    return tonal_1.Interval.semitones(tonal_1.Distance.interval(noteA, noteB) + '');\n}\nexports.semitoneDistance = semitoneDistance;\nfunction noteArray(range) {\n    var slots = tonal_1.Interval.semitones(tonal_1.Distance.interval(range[0], range[1]) + '');\n    return new Array(slots + 1)\n        .fill('')\n        .map(function (v, i) { return tonal_1.Distance.transpose(range[0], tonal_1.Interval.fromSemitones(i)) + ''; })\n        .map(function (n) { return tonal_1.Note.simplify(n); });\n}\nexports.noteArray = noteArray;\nfunction factorial(n) {\n    var value = 1;\n    for (var i = 2; i <= n; ++i) {\n        value *= i;\n    }\n    return value;\n}\nexports.factorial = factorial;\n// finds best combination following the given notes, based on minimal movement\n/* export function bestCombination(notes, combinations = []) {\n    return combinations.reduce((best, current) => {\n        const currentMovement = voicingDifference(notes, current);\n        const bestMovement = voicingDifference(notes, best);\n        if (Math.abs(currentMovement) < Math.abs(bestMovement)) {\n            return current;\n        }\n        return best;\n    });\n} */\n/* export function sortCombinationsByMovement(notes, combinations, direction: intervalDirection = 'up', min = true) {\n    const movements = combinations.map((combination) => ({\n        movement: voicingMovement(notes, combination, min),\n        combination\n    }));\n    let right = movements.filter(move => direction === 'up' ? move >= 0 : move <= 0);\n    if (!right.length) {\n        right = movements;\n    }\n    let sorted = right.sort((a, b) => a.movement - b.movement);\n    if (direction === 'down') {\n        sorted = sorted.reverse();\n    }\n    return sorted.map(movement => movement.combination);\n}\n */ \n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tonal_1 = require(\"tonal\");\nvar tonal_2 = require(\"tonal\");\nvar tonal_3 = require(\"tonal\");\nvar tonal_4 = require(\"tonal\");\nvar util_1 = require(\"../util/util\");\nvar Harmony = /** @class */ (function () {\n    function Harmony() {\n    }\n    Harmony.isBlack = function (note) {\n        return tonal_1.Note.props(note)['acc'] !== '';\n    };\n    Harmony.hasSamePitch = function (noteA, noteB, ignoreOctave) {\n        if (ignoreOctave === void 0) { ignoreOctave = false; }\n        if (ignoreOctave || util_1.isPitchClass(noteA) || util_1.isPitchClass(noteB)) {\n            return tonal_1.Note.props(noteA).chroma === tonal_1.Note.props(noteB).chroma;\n        }\n        return tonal_1.Note.midi(noteA) === tonal_1.Note.midi(noteB);\n    };\n    Harmony.getTonalChord = function (chord) {\n        if (!chord) {\n            return null;\n        }\n        var root = Harmony.getBassNote(chord, true) || '';\n        var symbol = chord.replace(root, '');\n        symbol = symbol.split('/')[0]; // ignore slash\n        // check if already a proper tonal chord\n        if (!!Object.keys(Harmony.irealToTonal).find(function (i) { return Harmony.irealToTonal[i] === symbol; })) {\n            return root + symbol;\n        }\n        symbol = Harmony.irealToTonal[symbol];\n        if (symbol === undefined) {\n            return null;\n        }\n        return root + symbol;\n    };\n    Harmony.getBassNote = function (chord, ignoreSlash) {\n        if (ignoreSlash === void 0) { ignoreSlash = false; }\n        if (!chord) {\n            return null;\n        }\n        if (!ignoreSlash && chord.includes('/')) {\n            return chord.split('/')[1];\n        }\n        var match = chord.match(/^([A-G][b|#]?)/);\n        if (!match || !match.length) {\n            return '';\n        }\n        return match[0];\n    };\n    Harmony.transposeChord = function (chord, interval) {\n        if (!chord) {\n            return chord;\n        }\n        var tokens = tonal_2.Chord.tokenize(Harmony.getTonalChord(chord));\n        var root = tonal_4.Distance.transpose(tokens[0], interval);\n        root = tonal_1.Note.simplify(root);\n        return root + tokens[1];\n    };\n    Harmony.getMidi = function (note, offset) {\n        if (offset === void 0) { offset = 0; }\n        return tonal_1.Note.midi(note) - offset;\n    };\n    Harmony.intervalComplement = function (interval) {\n        var fix = {\n            '8P': '1P',\n            '8d': '1A',\n            '8A': '1d',\n            '1A': '8d',\n            '1d': '8A',\n        };\n        var fixIndex = Object.keys(fix).find(function (key) { return interval.match(key); });\n        if (fixIndex) {\n            return fix[fixIndex];\n        }\n        return tonal_3.Interval.invert(interval);\n    };\n    Harmony.invertInterval = function (interval) {\n        if (!interval) {\n            return null;\n        }\n        var positive = interval.replace('-', '');\n        var complement = Harmony.intervalComplement(positive);\n        var isNegative = interval.length > positive.length;\n        return (isNegative ? '' : '-') + complement;\n    };\n    /** Transforms interval into one octave (octave+ get octaved down) */\n    Harmony.fixInterval = function (interval, simplify) {\n        if (interval === void 0) { interval = ''; }\n        if (simplify === void 0) { simplify = false; }\n        var fix = {\n            '0A': '1P',\n            '-0A': '1P',\n        };\n        if (simplify) {\n            fix = __assign({}, fix, { '8P': '1P', '-8P': '1P' });\n            interval = tonal_3.Interval.simplify(interval);\n        }\n        if (Object.keys(fix).includes(interval)) {\n            return fix[interval];\n        }\n        return interval;\n    };\n    /** inverts the interval if it does not go to the desired direction */\n    Harmony.forceDirection = function (interval, direction, noUnison) {\n        if (noUnison === void 0) { noUnison = false; }\n        var semitones = tonal_3.Interval.semitones(interval);\n        if ((direction === 'up' && semitones < 0) ||\n            (direction === 'down' && semitones > 0)) {\n            return Harmony.invertInterval(interval);\n        }\n        if (interval === '1P' && noUnison) {\n            return (direction === 'down' ? '-' : '') + '8P';\n        }\n        return interval;\n    };\n    // use Interval.ic?\n    Harmony.minInterval = function (interval, direction, noUnison) {\n        interval = Harmony.fixInterval(interval, true);\n        if (direction) {\n            return Harmony.forceDirection(interval, direction, noUnison);\n        }\n        var inversion = Harmony.invertInterval(interval);\n        if (Math.abs(tonal_3.Interval.semitones(inversion)) < Math.abs(tonal_3.Interval.semitones(interval))) {\n            interval = inversion;\n        }\n        return interval;\n    };\n    // returns array of intervals that lead the voices of chord A to chordB\n    Harmony.minIntervals = function (chordA, chordB) {\n        return chordA.map(function (n, i) { return Harmony.minInterval(tonal_4.Distance.interval(n, chordB[i])); });\n    };\n    Harmony.mapMinInterval = function (direction) {\n        return function (interval) { return Harmony.minInterval(interval, direction); };\n    };\n    // sort function\n    Harmony.sortMinInterval = function (preferredDirection, accessor) {\n        if (preferredDirection === void 0) { preferredDirection = 'up'; }\n        if (accessor === void 0) { accessor = (function (i) { return i; }); }\n        return function (a, b) {\n            var diff = Math.abs(tonal_3.Interval.semitones(accessor(a))) - Math.abs(tonal_3.Interval.semitones(accessor(b)));\n            if (diff === 0) {\n                return preferredDirection === 'up' ? -1 : 1;\n            }\n            return diff;\n        };\n    };\n    /** Returns the note with the least distance to \"from\" */\n    Harmony.getNearestNote = function (from, to, direction) {\n        var interval = Harmony.minInterval(tonal_4.Distance.interval(tonal_1.Note.pc(from), tonal_1.Note.pc(to)), direction);\n        return tonal_4.Distance.transpose(from, interval) + '';\n    };\n    /** Returns the note with the least distance to \"from\". TODO: add range */\n    Harmony.getNearestTargets = function (from, targets, preferredDirection, flip) {\n        if (preferredDirection === void 0) { preferredDirection = 'down'; }\n        if (flip === void 0) { flip = false; }\n        var intervals = targets\n            .map(function (target) { return tonal_4.Distance.interval(tonal_1.Note.pc(from), target); })\n            .map(Harmony.mapMinInterval(preferredDirection))\n            .sort(Harmony.sortMinInterval(preferredDirection));\n        /* if (flip) {\n            intervals = intervals.reverse();\n        } */\n        return intervals.map(function (i) { return tonal_4.Distance.transpose(from, i); });\n    };\n    Harmony.intervalMatrix = function (from, to) {\n        return to.map(function (note) { return from\n            .map(function (n) {\n            return tonal_4.Distance.interval(n, note);\n        })\n            .map(function (d) { return Harmony.minInterval(d); }); }\n        /* .map(i => i.slice(0, 2) === '--' ? i.slice(1) : i) */\n        );\n    };\n    // mapping for ireal chords to tonal symbols, see getTonalChord\n    Harmony.irealToTonal = {\n        \"^7\": \"M7\",\n        \"7\": \"7\",\n        \"-7\": \"m7\",\n        \"h7\": \"m7b5\",\n        \"7#9\": \"7#9\",\n        \"7b9\": \"7b9\",\n        \"^7#5\": \"M7#5\",\n        \"\": \"\",\n        \"6\": \"6\",\n        \"9\": \"9\",\n        \"-6\": \"m6\",\n        \"o7\": \"o7\",\n        \"h\": \"m7b5\",\n        \"-^7\": \"mM7\",\n        \"o\": \"o\",\n        \"^9\": \"M9\",\n        \"7#11\": \"7#11\",\n        \"7#5\": \"7#5\",\n        \"-\": \"m\",\n        \"7sus\": \"7sus\",\n        \"69\": \"M69\",\n        \"7b13\": \"7b13\",\n        \"^\": \"M\",\n        \"+\": \"+\",\n        \"7b9b5\": \"7b5b9\",\n        \"-9\": \"m9\",\n        \"9sus\": \"9sus\",\n        \"7b9sus\": \"7b9sus\",\n        \"7b9#5\": \"7#5b9\",\n        \"13\": \"13\",\n        \"^7#11\": \"M7#11\",\n        \"-7b5\": \"m7b5\",\n        \"^13\": \"M13\",\n        \"7#9b5\": \"7b5#9\",\n        \"-11\": \"m11\",\n        \"11\": \"11\",\n        \"7b5\": \"7b5\",\n        \"9#5\": \"9#5\",\n        \"13b9\": \"13b9\",\n        \"9#11\": \"9#11\",\n        \"13#11\": \"13#11\",\n        \"-b6\": \"mb6\",\n        \"7#9#5\": \"7#5#9\",\n        \"-69\": \"m69\",\n        \"13sus\": \"13sus\",\n        \"^9#11\": \"M9#11\",\n        \"7b9#9\": \"7b9#9\",\n        \"sus\": \"sus\",\n        \"7#9#11\": \"7#9#11\",\n        \"7b9b13\": \"7b9b13\",\n        \"7b9#11\": \"7b9#11\",\n        \"13#9\": \"13#9\",\n        \"9b5\": \"9b5\",\n        \"-^9\": \"mM9\",\n        \"2\": \"Madd9\",\n        \"-#5\": \"m#5\",\n        \"7+\": \"7#5\",\n        \"7sus4\": \"7sus\",\n        \"M69\": \"M69\",\n    };\n    Harmony.pitchRegex = /^([A-G^][b|#]?)/;\n    return Harmony;\n}());\nexports.Harmony = Harmony;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Measure_1 = require(\"./Measure\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar util_1 = require(\"../util/util\");\nvar Sheet = /** @class */ (function () {\n    function Sheet() {\n    }\n    Sheet.render = function (sheet, options, clear) {\n        if (options === void 0) { options = {}; }\n        if (clear === void 0) { clear = true; }\n        var state = __assign({ sheet: sheet, measures: [], forms: 1, nested: true, fallbackToZero: true, firstTime: true }, options);\n        state = __assign({}, state, Sheet.newForm(state));\n        var runs = 0;\n        while (runs < 1000 && state.index < sheet.length) {\n            runs++;\n            state = Sheet.nextMeasure(state);\n        }\n        if (clear) {\n            return state.measures\n                .map(function (m) { return Measure_1.Measure.from(m); })\n                .map(function (m) {\n                delete m.house;\n                delete m.signs;\n                return m;\n            });\n        }\n        return state.measures;\n    };\n    Sheet.nextMeasure = function (state) {\n        state = __assign({}, state, Sheet.nextSection(state)); // moves to the right house (if any)\n        var sheet = state.sheet, index = state.index, measures = state.measures;\n        state = __assign({}, state, { measures: measures.concat([__assign({}, Measure_1.Measure.from(sheet[index]), { index: index // add index for mapping\n                 })]) }, Sheet.nextIndex(state));\n        return Sheet.nextForm(state);\n    };\n    Sheet.nextIndex = function (state) {\n        var _a;\n        var sheet = state.sheet, index = state.index, jumps = state.jumps, nested = state.nested, fallbackToZero = state.fallbackToZero, lastTime = state.lastTime;\n        if (!Sheet.shouldJump({ sheet: sheet, index: index, jumps: jumps, lastTime: lastTime })) {\n            return {\n                index: index + 1\n            };\n        }\n        var braces = [Sheet.getJumpDestination({ sheet: sheet, index: index, fallbackToZero: fallbackToZero, nested: nested }), index];\n        jumps = Sheet.wipeKeys(jumps, [braces[0], braces[1] - 1]); // wipes indices inside braces\n        return {\n            index: braces[0],\n            jumps: __assign({}, jumps, (_a = {}, _a[braces[1]] = (jumps[braces[1]] || 0) + 1, _a))\n        };\n    };\n    Sheet.newForm = function (state) {\n        return __assign({}, state, { index: 0, jumps: {}, visits: {}, lastTime: state.forms === 1 });\n    };\n    Sheet.nextForm = function (state, force) {\n        if (force === void 0) { force = false; }\n        var sheet = state.sheet, index = state.index, forms = state.forms;\n        if (force || (index >= sheet.length && forms > 1)) {\n            return Sheet.newForm(__assign({}, state, { firstTime: false, forms: forms - 1 }));\n        }\n        return state;\n    };\n    // moves the index to the current house (if any)\n    Sheet.nextSection = function (state) {\n        var _a;\n        var sheet = state.sheet, index = state.index, visits = state.visits, firstTime = state.firstTime, lastTime = state.lastTime;\n        // skip intro when not firstTime\n        if (!firstTime && Measure_1.Measure.from(sheet[index]).section === 'IN') {\n            return {\n                index: Sheet.getNextSectionIndex({ sheet: sheet, index: index }),\n            };\n        }\n        // skip coda when not last time\n        if (Measure_1.Measure.hasSign('Coda', sheet[index]) && !Sheet.readyForFineOrCoda(state, -1)) {\n            return Sheet.nextForm(state, true);\n        }\n        if (!Measure_1.Measure.hasHouse(sheet[index], 1)) {\n            return {};\n        }\n        var next = Sheet.getNextHouseIndex({ sheet: sheet, index: index, visits: visits });\n        if (next === -1) {\n            next = index;\n            visits = {}; // reset visits\n        }\n        return {\n            visits: __assign({}, visits, (_a = {}, _a[next] = (visits[next] || 0) + 1, _a)),\n            index: next\n        };\n    };\n    /** Starts at a given index, stops when the pair functions returned equally often */\n    Sheet.findPair = function (sheet, index, pairs, move, stack) {\n        if (move === void 0) { move = 1; }\n        if (stack === void 0) { stack = 0; }\n        var match = -1; // start with no match\n        while (match === -1 && index >= 0 && index < sheet.length) {\n            if (pairs[0](sheet[index], { sheet: sheet, index: index })) { // same sign\n                stack++;\n            }\n            if (pairs[1](sheet[index], { sheet: sheet, index: index })) { // pair sign\n                stack--;\n            }\n            if (stack === 0) { // all pairs resolved > match!\n                match = index;\n            }\n            else {\n                index += move;\n            }\n        }\n        return match;\n    };\n    Sheet.findMatch = function (sheet, index, find, move) {\n        if (move === void 0) { move = 1; }\n        var match = -1; // start with no match\n        while (match === -1 && index >= 0 && index < sheet.length) {\n            if (find(sheet[index], { sheet: sheet, index: index })) {\n                match = index;\n            }\n            else {\n                index += move;\n            }\n        }\n        return match;\n    };\n    // simple matching for brace start, ignores nested repeats\n    Sheet.getJumpDestination = function (state) {\n        var sheet = state.sheet, index = state.index, fallbackToZero = state.fallbackToZero, nested = state.nested;\n        var sign = Measure_1.Measure.getJumpSign(sheet[index]);\n        // if fine > jump till end\n        if (sign.fine) {\n            return sheet.length;\n        }\n        // if no pair given => da capo\n        if (!sign.pair) {\n            return 0;\n        }\n        // if nested mode on and opening brace is searched, use getBracePair..\n        if (nested !== false && sign.pair === '{') {\n            return Sheet.getBracePair({ sheet: sheet, index: index, fallbackToZero: fallbackToZero });\n        }\n        var destination = Sheet.findMatch(sheet, index, function (m) { return Measure_1.Measure.hasSign(sign.pair, m); }, sign.move || -1); // default move back\n        if (fallbackToZero) {\n            // default to zero when searching repeat start (could be forgotten)\n            return destination === -1 ? 0 : destination;\n        }\n        return destination;\n    };\n    // returns the index of the repeat sign that pairs with the given index\n    Sheet.getBracePair = function (_a) {\n        var sheet = _a.sheet, index = _a.index, fallbackToZero = _a.fallbackToZero;\n        if (fallbackToZero === undefined) {\n            fallbackToZero = true;\n        }\n        if (Measure_1.Measure.hasSign('{', sheet[index])) {\n            return Sheet.findPair(sheet, index, [\n                function (m) { return Measure_1.Measure.hasSign('{', m); },\n                function (m) { return Measure_1.Measure.hasSign('}', m); },\n            ], 1);\n        }\n        else if (Measure_1.Measure.hasSign('}', sheet[index])) {\n            var pair = Sheet.findPair(sheet, index, [\n                function (m, state) {\n                    // this logic could be infinitely complex, having many side effects and interpretations\n                    // the current behaviour is similar to musescore or ireal handling braces\n                    if (!Measure_1.Measure.hasSign('}', m)) {\n                        return false;\n                    }\n                    if (index === state.index) {\n                        return true;\n                    }\n                    var relatedHouse = Sheet.getRelatedHouse({ sheet: sheet, index: state.index });\n                    return relatedHouse === -1;\n                },\n                function (m) { return Measure_1.Measure.hasSign('{', m); }\n            ], -1);\n            if (fallbackToZero) {\n                return pair === -1 ? 0 : pair; // default to zero when searching repeat start (could be forgotten)\n            }\n            return pair;\n        }\n        return -1;\n    };\n    // returns true if the house at the given index has not been visited enough times\n    Sheet.canVisitHouse = function (_a) {\n        var sheet = _a.sheet, index = _a.index, visits = _a.visits;\n        var houses = sheet[index].house;\n        if (houses === undefined) {\n            return false;\n        }\n        if (!Array.isArray(houses)) {\n            houses = [houses];\n        }\n        var visited = visits[index] || 0;\n        return visited < houses.length;\n    };\n    // returns the next house that can be visited (from the given index)\n    Sheet.getNextHouseIndex = function (_a, move) {\n        var sheet = _a.sheet, index = _a.index, visits = _a.visits;\n        if (move === void 0) { move = 1; }\n        return Sheet.findMatch(sheet, index, function (m, step) { return Measure_1.Measure.hasHouse(m) && Sheet.canVisitHouse({ sheet: sheet, index: step.index, visits: visits }); }, move);\n    };\n    Sheet.getNextSectionIndex = function (_a, move) {\n        var sheet = _a.sheet, index = _a.index;\n        if (move === void 0) { move = 1; }\n        return Sheet.findMatch(sheet, index + 1, function (m) { return Measure_1.Measure.from(m).section !== undefined; }, 1);\n    };\n    // wipes all keys in the given range\n    Sheet.wipeKeys = function (numberMap, range) {\n        var wiped = {};\n        Object.keys(numberMap)\n            .map(function (i) { return parseInt(i); })\n            .filter(function (i) { return i < range[0] || i > range[1]; })\n            .forEach(function (i) { return wiped[i] = numberMap[i]; });\n        return wiped;\n    };\n    Sheet.getRelatedHouse = function (_a) {\n        var sheet = _a.sheet, index = _a.index;\n        var latestHouse = Sheet.findPair(sheet, index, [\n            function (m, state) { return index === state.index || Measure_1.Measure.hasSign('}', m); },\n            function (m) { return Measure_1.Measure.hasHouse(m); }\n        ], -1);\n        return latestHouse;\n    };\n    Sheet.isFirstHouse = function (_a) {\n        var sheet = _a.sheet, index = _a.index;\n        return Measure_1.Measure.hasHouse(sheet[index], 1);\n    };\n    Sheet.getAllowedJumps = function (_a) {\n        var sheet = _a.sheet, index = _a.index;\n        if (!Measure_1.Measure.hasJumpSign(sheet[index])) {\n            return 0;\n        }\n        var measure = Measure_1.Measure.from(sheet[index]);\n        if (measure.times !== undefined) {\n            return measure.times;\n        }\n        return 1;\n    };\n    Sheet.readyForFineOrCoda = function (_a, move) {\n        var sheet = _a.sheet, index = _a.index, jumps = _a.jumps, lastTime = _a.lastTime;\n        if (move === void 0) { move = 1; }\n        var signs = Object.keys(Sheet.jumpSigns)\n            .filter(function (s) { return s.includes('DC') || s.includes('DS'); });\n        var backJump = Sheet.findMatch(sheet, index, function (m) { return signs.reduce(function (match, sign) { return match || Measure_1.Measure.hasSign(sign, m); }, false); }, move);\n        if (backJump === -1) {\n            return lastTime; // last time\n        }\n        return jumps[backJump] > 0;\n    };\n    Sheet.shouldJump = function (_a) {\n        var sheet = _a.sheet, index = _a.index, jumps = _a.jumps, lastTime = _a.lastTime;\n        if (!Measure_1.Measure.hasJumpSign(sheet[index])) {\n            return false;\n        }\n        var sign = Measure_1.Measure.getJumpSign(sheet[index]);\n        if (sign.validator && !sign.validator({ sheet: sheet, index: index, jumps: jumps, lastTime: lastTime })) {\n            return false;\n        }\n        var allowedJumps = Sheet.getAllowedJumps({ sheet: sheet, index: index });\n        var timesJumped = jumps[index] || 0;\n        return timesJumped < allowedJumps;\n    };\n    Sheet.transpose = function (sheet, interval) {\n        if (sheet.chords) {\n            sheet = __assign({}, sheet, { chords: sheet.chords\n                    .map(function (measure) { return Measure_1.Measure.from(measure).chords\n                    .map(function (chord) { return Harmony_1.Harmony.transposeChord(chord, interval); }); }) });\n        }\n        if (sheet.melody) {\n            console.log('TODO: tranpose melody');\n        }\n        return sheet;\n    };\n    /** Flattens the given possibly nested tree array to an array containing all values in sequential order.\n     * If withPath is set to true, the values are turned to objects containing the nested path (ItemWithPath).\n     * You can then turn ItemWithPath[] back to the original nested array with Measure.expand. */\n    Sheet.flatten = function (tree, withPath, path) {\n        if (withPath === void 0) { withPath = false; }\n        if (path === void 0) { path = []; }\n        if (!Array.isArray(tree)) { // is primitive value\n            if (withPath) {\n                return [{\n                        path: path,\n                        value: tree\n                    }];\n            }\n            return [tree];\n        }\n        return tree.reduce(function (flat, item, index) {\n            return flat.concat(Sheet.flatten(item, withPath, path.concat([index])));\n        }, []);\n    };\n    /** Turns a flat ItemWithPath array to a (possibly) nested Array of its values. Reverts Measure.flatten (using withPath=true). */\n    Sheet.expand = function (items) {\n        var lastSiblingIndex = -1;\n        return items.reduce(function (expanded, item, index) {\n            if (item.path.length === 1) {\n                expanded[item.path[0]] = item.value;\n            }\n            else if (item.path[0] > lastSiblingIndex) {\n                lastSiblingIndex = item.path[0];\n                var siblings = items\n                    .filter(function (i, j) { return j >= index && i.path.length >= item.path.length; })\n                    .map(function (i) { return (__assign({}, i, { path: i.path.slice(1) })); });\n                expanded[item.path[0]] = Sheet.expand(siblings);\n                /* expanded.push(Measure.expand(siblings)); */\n            }\n            return expanded;\n        }, []);\n    };\n    Sheet.pathOf = function (value, tree) {\n        var flat = Sheet.flatten(tree, true);\n        var match = flat.find(function (v) { return v.value === value; });\n        if (match) {\n            return match.path;\n        }\n    };\n    Sheet.getPath = function (tree, path, withPath, flat) {\n        if (withPath === void 0) { withPath = false; }\n        if (typeof path === 'number') {\n            path = [path];\n        }\n        flat = flat || Sheet.flatten(tree, true);\n        var match = flat.find(function (v) {\n            var min = Math.min(path.length, v.path.length);\n            return v.path.slice(0, min).join(',') === path.slice(0, min).join(',');\n        });\n        if (withPath) {\n            return match;\n        }\n        return match ? match.value : undefined;\n    };\n    Sheet.nextItem = function (tree, path, move, withPath, flat) {\n        if (move === void 0) { move = 1; }\n        if (withPath === void 0) { withPath = false; }\n        flat = Sheet.flatten(tree, true);\n        var match = Sheet.getPath(tree, path, true, flat);\n        if (match) {\n            var index = (flat.indexOf(match) + move) % flat.length;\n            if (withPath) {\n                return flat[index];\n            }\n            return flat[index] ? flat[index].value : undefined;\n        }\n    };\n    Sheet.nextValue = function (tree, value, move) {\n        if (move === void 0) { move = 1; }\n        var flat = Sheet.flatten(tree, true);\n        var match = flat.find(function (v) { return v.value === value; });\n        if (match) {\n            return Sheet.nextItem(tree, match.path, move, false, flat);\n        }\n    };\n    Sheet.nextPath = function (tree, path, move) {\n        if (move === void 0) { move = 1; }\n        var flat = Sheet.flatten(tree, true);\n        if (!path) {\n            return flat[0] ? flat[0].path : undefined;\n        }\n        var match = Sheet.getPath(tree, path, true, flat);\n        if (match) {\n            var next = Sheet.nextItem(tree, match.path, move, true, flat);\n            return next ? next.path : undefined;\n        }\n    };\n    Sheet.randomItem = function (tree) {\n        var flat = Sheet.flatten(tree, true);\n        return util_1.randomElement(flat);\n    };\n    Sheet.stringify = function (measures, property) {\n        if (property === void 0) { property = 'chords'; }\n        return measures.map(function (measure) { return (Measure_1.Measure.from(measure)[property]); });\n    };\n    Sheet.jumpSigns = {\n        '}': { pair: '{', move: -1 },\n        'DC': {},\n        'DS': { pair: 'Segno', move: -1 },\n        'DS.Fine': { pair: 'Segno', move: -1 },\n        'DS.Coda': { pair: 'Segno', move: -1 },\n        'DC.Fine': {},\n        'DC.Coda': {},\n        'Fine': {\n            fine: true,\n            validator: function (state) { return Sheet.readyForFineOrCoda(state); }\n        },\n        'ToCoda': {\n            pair: 'Coda', move: 1,\n            validator: function (state) { return Sheet.readyForFineOrCoda(state); }\n        }\n    };\n    return Sheet;\n}());\nexports.Sheet = Sheet;\n/*\nTODO:\n\nmore typings\nspecial sections:\nIN: only play the first time\nCODA: only play last time\n\ntest standards:\n- Alice in Wonderland (dc al 2nd ending)\n- All or Nothing at All (dc al coda)\n- Are you real (intro + coda)\n- Armageddon (intro)\n- The Bat (coda sign inside repeat): ireal plays coda directly first time..\n- Bennys Tune (intro+coda sign inside repeat): ireal plays coda directly first time..\n- Bess You Is My Woman (coda sign inside repeat): ireal plays coda directly first time..\n- Blessed Relief (nested repeats, with odd behaviour)\n- Blue in Green (coda)\n- Miles Ahead (coda)\n*/\n/*\n\n\n\n    static getPath(measures: Measures, path: number[] | number = 0, tickleDown = false, traveled = []) {\n        if (typeof path === 'number') {\n            path = [path]; // fix syntax sugar\n        }\n        if (!path.length && !tickleDown) {\n            return measures; // path end\n        } else if (!path.length) {\n            path = [0];\n        }\n        const next = measures[path[0]];\n        if (Array.isArray(next)) {\n            traveled.push[path[0]];\n            path.shift();\n            return Sheet.getPath(next, path, tickleDown, traveled)\n        }\n        if (typeof next === 'string') {\n            if (path.length > 1) {\n                console.warn('path ended too early');\n            }\n            return next;\n        }\n        if (!next) {\n\n        }\n        return next;\n    }\n\n    */ \n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Synthesizer_1 = require(\"./instruments/Synthesizer\");\nvar Metronome = /** @class */ (function () {\n    function Metronome(mix) {\n        this.synth = new Synthesizer_1.Synthesizer({ type: 'sine', gain: 1, mix: mix });\n        this.ready = this.synth.ready;\n    }\n    Metronome.prototype.count = function (pulse, bars) {\n        var _this = this;\n        if (bars === void 0) { bars = 1; }\n        var count = new Array(bars).fill([new Array(pulse.props.cycle).fill(1)]);\n        return pulse.tickArray(count, function (_a) {\n            var path = _a.path, deadline = _a.deadline;\n            _this.synth.playKeys([path[2] === 0 ? 90 : 78], { deadline: deadline, duration: 0.01, attack: .01, release: .01, decay: .01, sustain: 1 });\n        });\n    };\n    return Metronome;\n}());\nexports.Metronome = Metronome;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Permutation = /** @class */ (function () {\n    function Permutation() {\n    }\n    Permutation.permutateElements = function (array, validate, path) {\n        if (path === void 0) { path = []; }\n        var isValid = function (next) { return !validate || validate(path, next, array); };\n        if (array.length === 1) {\n            return isValid(array[0]) ? array : [];\n        }\n        return array.filter(isValid).reduce(function (combinations, el) { return combinations.concat(Permutation.permutateElements(array.filter(function (e) { return e !== el; }), validate, path.concat([el])).map(function (subcombinations) { return [\n            el\n        ].concat(subcombinations); })); }, []);\n    };\n    Permutation.permutationComplexity = function (array, validate, path) {\n        if (path === void 0) { path = []; }\n        var validations = 0;\n        Permutation.permutateElements(array, function (path, next, array) {\n            ++validations;\n            return !validate || validate(path, next, array);\n        }, path);\n        return validations;\n    };\n    Permutation.permutateArray = function (array) {\n        if (array.length === 1) {\n            return array;\n        }\n        return array.reduce(function (combinations, el) { return combinations.concat(Permutation.permutateArray(array.filter(function (e) { return e !== el; }))\n            .map(function (subcombinations) { return ([el].concat(subcombinations)); })); }, []);\n    };\n    // combine multiple validators\n    Permutation.combineValidators = function () {\n        var validators = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            validators[_i] = arguments[_i];\n        }\n        return function (path, next, array) { return validators\n            .reduce(function (result, validator) { return result && validator(path, next, array); }, true); };\n    };\n    //https://stackoverflow.com/questions/9960908/permutations-in-javascript\n    Permutation.combinations = function (array) {\n        var length = array.length, result = [array.slice()], c = new Array(length).fill(0), i = 1, k, p;\n        while (i < length) {\n            if (c[i] < i) {\n                k = i % 2 && c[i];\n                p = array[i];\n                array[i] = array[k];\n                array[k] = p;\n                ++c[i];\n                i = 1;\n                result.push(array.slice());\n            }\n            else {\n                c[i] = 0;\n                ++i;\n            }\n        }\n        return result;\n    };\n    // https://gist.github.com/axelpale/3118596\n    Permutation.binomial = function (set, k) {\n        var i, j, combs, head, tailcombs;\n        // There is no way to take e.g. sets of 5 elements from\n        // a set of 4.\n        if (k > set.length || k <= 0) {\n            return [];\n        }\n        // K-sized set has only one K-sized subset.\n        if (k == set.length) {\n            return [set];\n        }\n        // There is N 1-sized subsets in a N-sized set.\n        if (k == 1) {\n            combs = [];\n            for (i = 0; i < set.length; i++) {\n                combs.push([set[i]]);\n            }\n            return combs;\n        }\n        // Assert {1 < k < set.length}\n        // Algorithm description:\n        // To get k-combinations of a set, we want to join each element\n        // with all (k-1)-combinations of the other elements. The set of\n        // these k-sized sets would be the desired result. However, as we\n        // represent sets with lists, we need to take duplicates into\n        // account. To avoid producing duplicates and also unnecessary\n        // computing, we use the following approach: each element i\n        // divides the list into three: the preceding elements, the\n        // current element i, and the subsequent elements. For the first\n        // element, the list of preceding elements is empty. For element i,\n        // we compute the (k-1)-computations of the subsequent elements,\n        // join each with the element i, and store the joined to the set of\n        // computed k-combinations. We do not need to take the preceding\n        // elements into account, because they have already been the i:th\n        // element so they are already computed and stored. When the length\n        // of the subsequent list drops below (k-1), we cannot find any\n        // (k-1)-combs, hence the upper limit for the iteration:\n        combs = [];\n        for (i = 0; i < set.length - k + 1; i++) {\n            // head is a list that includes only our current element.\n            head = set.slice(i, i + 1);\n            // We take smaller combinations from the subsequent elements\n            tailcombs = Permutation.binomial(set.slice(i + 1), k - 1);\n            // For each (k-1)-combination we join it with the current\n            // and store it to the set of k-combinations.\n            for (j = 0; j < tailcombs.length; j++) {\n                combs.push(head.concat(tailcombs[j]));\n            }\n        }\n        return combs;\n    };\n    return Permutation;\n}());\nexports.Permutation = Permutation;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Permutation_1 = require(\"../util/Permutation\");\nvar Logger_1 = require(\"../util/Logger\");\nvar tonal_1 = require(\"tonal\");\nvar tonal_2 = require(\"tonal\");\nvar tonal_3 = require(\"tonal\");\nvar tonal_4 = require(\"tonal\");\nvar util_1 = require(\"../util/util\");\nvar Harmony_1 = require(\"./Harmony\");\nvar Voicing = /** @class */ (function () {\n    function Voicing() {\n    }\n    /** Returns the next voicing that should follow the previously played voicing.\n    */\n    Voicing.getNextVoicing = function (chord, previousVoicing, options) {\n        if (options === void 0) { options = {}; }\n        var _a = __assign({ range: ['C3', 'C5'], rangeBorders: [3, 3], maxVoices: 4, forceDirection: null, forceBestPick: false, maxDistance: 7, minBottomDistance: 3, minTopDistance: 2, noTopDrop: true, noTopAdd: true, noBottomDrop: false, noBottomAdd: false, idleChance: 1, logIdle: false, logging: true }, options), maxVoices = _a.maxVoices, range = _a.range, forceDirection = _a.forceDirection, forceBestPick = _a.forceBestPick, rangeBorders = _a.rangeBorders, sortChoices = _a.sortChoices, filterChoices = _a.filterChoices, noTopDrop = _a.noTopDrop, noTopAdd = _a.noTopAdd, noBottomDrop = _a.noBottomDrop, noBottomAdd = _a.noBottomAdd, idleChance = _a.idleChance, logIdle = _a.logIdle, logging = _a.logging;\n        // make sure tonal can read the chord\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        if (chord === 'r') {\n            return null;\n        }\n        var combinations = Voicing.getAllVoicePermutations(chord, maxVoices, options);\n        var exit = function () {\n            var pick = [];\n            if (logging) {\n                Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick, logIdle: logIdle });\n            }\n            return pick;\n        };\n        if (!combinations.length) {\n            return exit();\n        }\n        if (!previousVoicing || !previousVoicing.length) { // no previous chord\n            // filter out combinations that are out of range\n            combinations = combinations.filter(function (combination) {\n                var firstNote = Harmony_1.Harmony.getNearestNote(range[0], combination[0], 'up');\n                var pick = util_1.renderAbsoluteNotes(combination, tonal_2.Note.oct(firstNote));\n                return util_1.isInRange(pick[0], range) && util_1.isInRange(pick[pick.length - 1], range);\n            });\n            var firstPick = combinations[0];\n            var firstNoteInRange = Harmony_1.Harmony.getNearestNote(range[0], firstPick[0], 'up');\n            var pick_1 = util_1.renderAbsoluteNotes(firstPick, tonal_2.Note.oct(firstNoteInRange));\n            if (logging) {\n                Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick_1, logIdle: logIdle });\n            }\n            return pick_1;\n        }\n        var choices = Voicing.getAllChoices(combinations, previousVoicing, range)\n            .filter(function (choice) {\n            return (!noTopDrop || !choice.dropped.includes(choice.topNotes[0])) &&\n                (!noTopAdd || !choice.added.includes(choice.topNotes[1])) &&\n                (!noBottomDrop || !choice.dropped.includes(choice.bottomNotes[0])) &&\n                (!noBottomAdd || !choice.added.includes(choice.bottomNotes[1])) &&\n                (!filterChoices || filterChoices(choice)) &&\n                (choice.difference > 0 || Math.random() < idleChance);\n        })\n            .sort(sortChoices ?\n            function (a, b) { return sortChoices(a, b); } :\n            function (a, b) { return a.difference - b.difference; });\n        if (!choices.length) {\n            return exit();\n        }\n        var bestPick = choices[0].targets, choice;\n        var direction = Voicing.getDesiredDirection(previousVoicing, range, rangeBorders) || forceDirection;\n        if (direction && forceBestPick && (!util_1.isInRange(bestPick[0], range) || util_1.isInRange(bestPick[bestPick.length - 1], range))) {\n            var octave = direction === 'up' ? '8P' : '-8P';\n            bestPick = util_1.transposeNotes(bestPick, octave);\n        }\n        if (!direction || forceBestPick) {\n            var pick_2 = bestPick;\n            choice = choices[0];\n            if (logging) {\n                Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick_2, direction: direction, bestPick: bestPick, choice: choice, choices: choices, logIdle: logIdle });\n            }\n            return pick_2;\n        }\n        // sort after movement instead of difference\n        choice = choices.sort(function (a, b) {\n            return Math.abs(a.movement) - Math.abs(b.movement);\n        }).find(function (choice) {\n            if (direction === 'up') {\n                return choice.movement >= 0;\n            }\n            return choice.movement <= 0;\n        });\n        if (!choice) { // keep hanging in the corner of the range..\n            choice = choices[0];\n        }\n        var pick = choice.targets;\n        if (logging) {\n            Logger_1.Logger.logVoicing({ chord: chord, previousVoicing: previousVoicing, range: range, combinations: combinations, pick: pick, direction: direction, bestPick: bestPick, choice: choice, choices: choices, logIdle: logIdle });\n        }\n        return pick;\n    };\n    /** Computes all valid voice permutations for a given chord and voice number.\n     * Runs getVoicePermutations for each possible selection of notes.\n     */\n    Voicing.getAllVoicePermutations = function (chord, length, voicingOptions) {\n        if (voicingOptions === void 0) { voicingOptions = {}; }\n        var root = Harmony_1.Harmony.getBassNote(chord, true);\n        var omitNotes = voicingOptions.omitNotes;\n        return Voicing.getAllNoteSelections(chord, length, omitNotes)\n            .reduce(function (combinations, combination) {\n            return combinations.concat(Voicing.getVoicePermutations(combination, __assign({}, voicingOptions, { root: root })));\n        }, []);\n    };\n    /** Get all permutations of the given notes that would make a good voicing. */\n    Voicing.getVoicePermutations = function (notes, options) {\n        if (options === void 0) { options = {}; }\n        if (notes.length === 1) {\n            return [notes];\n        }\n        var validator = options.validatePermutation || (function (path, next, array) { return true; });\n        return Permutation_1.Permutation.permutateElements(notes, Permutation_1.Permutation.combineValidators(validator, Voicing.voicingValidator(options)));\n    };\n    /** Configurable Validator that sorts out note combinations with untasty intervals.  */\n    Voicing.voicingValidator = function (options) {\n        options = __assign({ maxDistance: 6, minDistance: 1, minBottomDistance: 3, minTopDistance: 2 }, options);\n        return function (path, next, array) {\n            return Permutation_1.Permutation.combineValidators(Voicing.notesAtPositionValidator(options.topNotes, path.length + array.length - 1), Voicing.notesAtPositionValidator(options.bottomNotes, 0), Voicing.degreesAtPositionValidator(options.topDegrees, path.length + array.length - 1, options.root), Voicing.degreesAtPositionValidator(options.bottomDegrees, 0, options.root), Voicing.validateInterval(function (interval) { return tonal_4.Interval.semitones(interval) <= options.maxDistance; }), Voicing.validateInterval(function (interval, _a) {\n                var path = _a.path, array = _a.array;\n                return array.length === 1 || path.length === 1 || tonal_4.Interval.semitones(interval) >= options.minDistance;\n            }), Voicing.validateInterval(function (interval, _a) {\n                var array = _a.array;\n                return array.length !== 1 || tonal_4.Interval.semitones(interval) >= options.minTopDistance;\n            }), Voicing.validateInterval(function (interval, _a) {\n                var path = _a.path;\n                return path.length !== 1 || tonal_4.Interval.semitones(interval) >= options.minBottomDistance;\n            }))(path, next, array);\n        };\n    };\n    /** Validates the interval to the next note. You can write your own logic inside the validate fn. */\n    Voicing.validateInterval = function (validate) {\n        return function (path, next, array) {\n            if (!path.length) {\n                return true;\n            }\n            var interval = tonal_3.Distance.interval(path[path.length - 1], next) + '';\n            return validate(interval, { path: path, next: next, array: array });\n        };\n    };\n    /** Returns all possible combinations of required and optional notes for a given chord and desired length.\n     * If the voices number is higher than the required notes of the chord, the rest number will be permutated from the optional notes */\n    Voicing.getAllNoteSelections = function (chord, voices, omitNotes) {\n        if (voices === void 0) { voices = 2; }\n        if (omitNotes === void 0) { omitNotes = []; }\n        var required = Voicing.getRequiredNotes(chord, voices);\n        required = Voicing.withoutPitches(omitNotes, required);\n        if (voices === 1) {\n            return required.map(function (note) { return [note]; });\n        }\n        var fill = voices - required.length;\n        if (fill === 0) {\n            return [required];\n        }\n        if (fill < 0) { // required notes are enough\n            return Permutation_1.Permutation.binomial(required, voices);\n        }\n        var optional = Voicing.getOptionalNotes(chord, voices, required);\n        optional = Voicing.withoutPitches(omitNotes, optional);\n        if (fill >= optional.length) {\n            return [required.concat(optional)];\n        }\n        return Permutation_1.Permutation.binomial(optional, fill)\n            .map(function (selection) { return required.concat(selection); });\n    };\n    Voicing.withoutPitches = function (pitches, voicing) {\n        if (pitches === void 0) { pitches = []; }\n        return voicing.filter(function (r) { return !pitches.find(function (o) { return Harmony_1.Harmony.hasSamePitch(r, o); }); });\n    };\n    /** Get available tensions for a given chord. Omits tensions that kill the chord quality */\n    Voicing.getAvailableTensions = function (chord) {\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        var notes = tonal_1.Chord.notes(chord);\n        if (util_1.isDominantChord(chord)) {\n            return Voicing.getAllTensions(notes[0])\n                // filter out tensions that are part of the chord\n                .filter(function (note) { return !notes.find(function (n) { return util_1.semitoneDistance(notes[0], note) === util_1.semitoneDistance(notes[0], n); }); })\n                // filter out tensions that are a semitone above the 3 (if exists)\n                .filter(function (note) { return util_1.chordHasIntervals(chord, ['3!']) || util_1.semitoneDistance(util_1.getDegreeInChord(3, chord), note) > 1; })\n                // filter out tensions that are a semitone above the 4 (if exists => sus)\n                .filter(function (note) { return !util_1.chordHasIntervals(chord, ['4P']) || util_1.semitoneDistance(util_1.getDegreeInChord(4, chord), note) > 1; })\n                // filter out tensions that are a semitone above the 7\n                .filter(function (note) { return util_1.semitoneDistance(util_1.getDegreeInChord(7, chord), note) > 1; });\n        }\n        return notes.slice(0, 4)\n            // notes less than 3 semitones away from root are omitted (tensions 2M above would be in next octave)\n            .filter(function (note) { return note === notes[0] || util_1.semitoneDistance(note, notes[0]) > 2; })\n            // all tensions are a major second above a chord note\n            .map(function (note) { return tonal_3.Distance.transpose(note, '2M'); })\n            // tensions 2 semiontes below root are flat 7 => changes chord quality\n            .filter(function (note) { return util_1.semitoneDistance(note, notes[0]) !== 2; });\n        // omit tensions that end up on a chord note again?\n    };\n    /** Returns all Tensions that could be in any chord */\n    Voicing.getAllTensions = function (root) {\n        return ['b9', '9', '#9', '3', '11', '#11', 'b13', '13', '7']\n            .map(function (step) { return util_1.getIntervalFromStep(step); })\n            .map(function (interval) { return tonal_3.Distance.transpose(root, interval); });\n    };\n    /** Returns all notes that are required to outline a chord */\n    Voicing.getRequiredNotes = function (chord, voices) {\n        if (voices === void 0) { voices = 2; }\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        var notes = tonal_1.Chord.notes(chord);\n        var intervals = tonal_1.Chord.intervals(chord);\n        var requiredSteps = [3, 7, 'b5', 6].slice(0, Math.max(voices, 2)); // order is important\n        if (!util_1.hasDegree(3, intervals)) {\n            requiredSteps.push(4); // fixes m6 chords\n        }\n        var required = requiredSteps.reduce(function (req, degree) {\n            if (util_1.hasDegree(degree, intervals)) {\n                req.push(util_1.getDegreeInChord(degree, chord));\n            }\n            return req;\n        }, []);\n        if (voices > 3 && !required.includes(notes[notes.length - 1])) {\n            required.push(notes[notes.length - 1]);\n        }\n        return required;\n    };\n    /** Returns all notes that are not required */\n    Voicing.getOptionalNotes = function (chord, voices, required) {\n        chord = Harmony_1.Harmony.getTonalChord(chord);\n        var notes = tonal_1.Chord.notes(chord);\n        required = required || Voicing.getRequiredNotes(chord, voices);\n        return notes.filter(function (note) { return !required.includes(note); });\n    };\n    /** Returns all possible note choices for the given combinations.\n     * Takes the bottom note of the previous voicing and computes the minimal intervals up and down to the next bottom note.\n     */\n    Voicing.getAllChoices = function (combinations, previousVoicing, range) {\n        var lastPitches = previousVoicing.map(function (note) { return tonal_2.Note.pc(note); });\n        return combinations\n            .map(function (combination) {\n            var bottomInterval = tonal_3.Distance.interval(lastPitches[0], combination[0]);\n            var bottomNotes = [\n                tonal_3.Distance.transpose(previousVoicing[0], Harmony_1.Harmony.minInterval(bottomInterval, 'down')),\n                tonal_3.Distance.transpose(previousVoicing[0], Harmony_1.Harmony.minInterval(bottomInterval, 'up')),\n            ];\n            if (bottomNotes[0] === bottomNotes[1]) {\n                bottomNotes = [bottomNotes[0]];\n            }\n            return { combination: combination, bottomNotes: bottomNotes };\n        })\n            .reduce(function (all, _a) {\n            var combination = _a.combination, bottomNotes = _a.bottomNotes;\n            return all.concat(bottomNotes.map(function (bottomNote) { return util_1.renderAbsoluteNotes(combination, tonal_2.Note.oct(bottomNote)); }));\n        }, [])\n            .filter(function (targets) {\n            return !range ||\n                util_1.isInRange(targets[0], range) &&\n                    util_1.isInRange(targets[targets.length - 1], range);\n        })\n            .reduce(function (all, targets) {\n            var leads = Voicing.voiceLeading(previousVoicing, targets);\n            return all.concat(leads);\n        }, []);\n    };\n    /** Analyzes all possible voice movements for all possible transitions. Handles inequal lengths */\n    Voicing.voiceLeading = function (origin, targets) {\n        // if same length > dont permutate\n        if (origin.length === targets.length) {\n            return Voicing.analyzeVoiceLeading(origin, targets);\n        }\n        var _a = [origin, targets].sort(function (a, b) { return b.length - a.length; }), more = _a[0], less = _a[1];\n        return Permutation_1.Permutation.binomial(more, less.length)\n            .map(function (selection) {\n            var _a, _b;\n            var from, to;\n            if (origin.length < targets.length) {\n                _a = [origin, selection], from = _a[0], to = _a[1];\n            }\n            else {\n                _b = [selection, targets], from = _b[0], to = _b[1];\n            }\n            return Voicing.analyzeVoiceLeading(from, to, origin, targets);\n        });\n    };\n    /** Analyzed the voice leading for the movement from > to.\n     * Origin and targets needs to be passed if the voice transition over unequal lengths\n     */\n    Voicing.analyzeVoiceLeading = function (from, to, origin, targets) {\n        var _a;\n        _a = [origin || from, targets || to], origin = _a[0], targets = _a[1];\n        var intervals = Voicing.voicingIntervals(from, to, false)\n            .map(function (interval) { return Harmony_1.Harmony.fixInterval(interval, false); });\n        /** Interval qualities */\n        var degrees = intervals.map(function (i) { return util_1.getDegreeFromInterval(i); });\n        /** Voices that did not move */\n        var oblique = from.filter(function (n, i) { return to.find(function (note) { return Harmony_1.Harmony.hasSamePitch(n, note); }); });\n        /** abs sum of semitones movements of voices */\n        var difference = util_1.semitoneDifference(intervals);\n        /** relative sum of semitone movements */\n        var movement = util_1.semitoneMovement(intervals);\n        /** voice differences did not cancel each other out > moved in same direction */\n        var similar = Math.abs(movement) === Math.abs(difference);\n        /** moves parallel if all interval qualities the same and in the same direction */\n        var parallel = difference > 0 && similar && degrees.reduce(function (match, degree, index) {\n            return match && (index === 0 || degrees[index - 1] === degree);\n        }, true);\n        // find out which notes have been dropped / added\n        var dropped = [], added = [];\n        if (origin.length < targets.length) {\n            added = targets.filter(function (n) { return !to.includes(n); });\n        }\n        else {\n            dropped = origin.filter(function (n) { return !from.includes(n); });\n        }\n        return {\n            from: from,\n            to: to,\n            origin: origin,\n            targets: targets,\n            intervals: intervals,\n            difference: difference,\n            movement: movement,\n            bottomInterval: intervals[0],\n            topInterval: intervals[intervals.length - 1],\n            topNotes: [origin[origin.length - 1], targets[targets.length - 1]],\n            bottomNotes: [origin[0], targets[0]],\n            similar: similar,\n            contrary: !similar,\n            parallel: parallel,\n            oblique: oblique,\n            degrees: degrees,\n            added: added,\n            dropped: dropped,\n        };\n    };\n    /** Returns true if the given note is contained in the given voicing. */\n    Voicing.containsPitch = function (note, voicing, enharmonic) {\n        if (enharmonic === void 0) { enharmonic = true; }\n        if (!enharmonic) {\n            return voicing.includes(note);\n        }\n        return !!voicing.find(function (n) { return Harmony_1.Harmony.hasSamePitch(note, n); });\n    };\n    /** Returns the intervals between the given chord voicings.\n     * Can be passed pitch classes or absolute notes.\n     * The two voicings should have the same length. */\n    Voicing.voicingIntervals = function (chordA, chordB, min, direction) {\n        if (min === void 0) { min = true; }\n        if (chordA.length !== chordB.length) {\n            // console.log('voicingIntervals: not the same length..');\n        }\n        var intervals = chordA.map(function (n, i) {\n            var interval = tonal_3.Distance.interval(n, chordB[i]);\n            if (min === false) {\n                return interval;\n            }\n            if (util_1.isPitchClass(n) && util_1.isPitchClass(chordB[i])) {\n                return Harmony_1.Harmony.minInterval(interval, direction);\n            }\n            return interval;\n        });\n        return intervals;\n    };\n    /** Validates the current permutation to have a note at a certain position (array index) */\n    Voicing.notesAtPositionValidator = function (notes, position) {\n        if (notes === void 0) { notes = []; }\n        return function (selected, note, remaining) {\n            return !notes.length || selected.length !== position || Voicing.containsPitch(note, notes) /*  notes.includes(note) */;\n        };\n    };\n    /** Validates the current permutation to have a note at a certain position (array index) */\n    Voicing.degreesAtPositionValidator = function (degrees, position, root) {\n        if (degrees === void 0) { degrees = []; }\n        return function (selected, note, remaining) {\n            if (!degrees.length || !root || selected.length !== position) {\n                return true;\n            }\n            var degree = util_1.getDegreeFromInterval(tonal_3.Distance.interval(root, note));\n            return degrees.includes(degree);\n        };\n    };\n    /** Returns true if the given voicing contains its root */\n    Voicing.hasTonic = function (voicing, chord) {\n        var tokens = tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord));\n        return voicing.map(function (n) { return tonal_2.Note.pc(n); }).includes(tokens[0]);\n    };\n    /** Returns the best direction to move for a given voicing in a range.\n     * Outputs a direction as soon as the semitone distance of one of the outer notes is below the given threshold\n     */\n    Voicing.getDesiredDirection = function (voicing, range, thresholds) {\n        if (thresholds === void 0) { thresholds = [3, 3]; }\n        var distances = util_1.getDistancesToRangeEnds([voicing[0], voicing[voicing.length - 1]], range);\n        if (distances[0] < thresholds[0] && distances[1] < thresholds[1]) {\n            console.error('range is too small to fit the comfy zone');\n            return;\n        }\n        if (distances[0] < thresholds[0]) {\n            return 'up';\n        }\n        if (distances[1] < thresholds[1]) {\n            return 'down';\n        }\n    };\n    return Voicing;\n}());\nexports.Voicing = Voicing;\n/**\n *\n\n\n\n    static getPossibleVoicings(chord, voices = 4) {\n        const required = getRequiredNotes(chord);\n        const optional = getOptionalNotes(chord);\n        const tensions = getAvailableTensions(chord);\n        return { required, optional, tensions };\n    }\n    static voicingDifference(chordA, chordB, min = true) {\n        return semitoneDifference(Voicing.voicingIntervals(chordA, chordB, min));\n    }\n\n    static voicingMovement(chordA, chordB, min = true, direction?: intervalDirection) {\n        return semitoneMovement(Voicing.voicingIntervals(chordA, chordB, min, direction));\n    }\n\n    static bestVoiceLeading(chordA, chordB, sortFn?) {\n        sortFn = sortFn || ((a, b) => a.difference - b.difference);\n        const voices = Voicing.voiceLeading(chordA, chordB)\n            .sort((best, current) => {\n                return sortFn(best, current);\n            }, null);\n        return voices[0];\n    }\n\n    static minVoiceMovement(chordA, chordB) {\n        [chordA, chordB] = [chordA, chordB].sort((a, b) => b.length - a.length);\n        const picks = Permutation.binomial(chordA, chordB.length);\n        return picks.reduce((min, current) => {\n            const diff = Voicing.voicingMovement(current, chordB, false);\n            if (Math.abs(diff) < Math.abs(min)) {\n                return diff;\n            }\n            return min;\n        }, 100);\n    }\n\n    static getVoices(chord, voices = 4, rootless = false, tension = 1) {\n        // THE PROBLEM: TENSION MUST BE CHOSEN WHEN SELECTING THE OPTIMAL VOICING!\n        chord = Harmony.getTonalChord(chord);\n        const tokens = Chord.tokenize(chord);\n        const required = Voicing.getRequiredNotes(chord);\n        let optional = Voicing.getOptionalNotes(chord, required);\n        let choices = [].concat(required);\n        const remaining = () => voices - choices.length;\n        if (tension > 0) {\n            choices = choices.concat(Voicing.getAvailableTensions(chord).slice(0, tension));\n        }\n        if (remaining() > 0) {\n            choices = choices.concat(optional);\n        }\n        if (remaining() < 0 && rootless) {\n            choices = choices.filter(n => n !== tokens[0]);\n        }\n        if (remaining() > 0) {\n            // console.warn(`${remaining} notes must be doubled!!!`);\n            choices = choices.concat(required, optional).slice(0, voices);\n        }\n        return choices.slice(0, voices);\n    }\n */ \n","/*!\n\n diff v4.0.1\n\nSoftware License Agreement (BSD License)\n\nCopyright (c) 2009-2015, Kevin Decker <kpdecker@gmail.com>\n\nAll rights reserved.\n\nRedistribution and use of this software in source and binary forms, with or without modification,\nare permitted provided that the following conditions are met:\n\n* Redistributions of source code must retain the above\n  copyright notice, this list of conditions and the\n  following disclaimer.\n\n* Redistributions in binary form must reproduce the above\n  copyright notice, this list of conditions and the\n  following disclaimer in the documentation and/or other\n  materials provided with the distribution.\n\n* Neither the name of Kevin Decker nor the names of its\n  contributors may be used to endorse or promote products\n  derived from this software without specific prior\n  written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\nIMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\nFITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR\nCONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER\nIN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\nOF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n@license\n*/\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n  (global = global || self, factory(global.Diff = {}));\n}(this, function (exports) { 'use strict';\n\n  function Diff() {}\n  Diff.prototype = {\n    diff: function diff(oldString, newString) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var callback = options.callback;\n\n      if (typeof options === 'function') {\n        callback = options;\n        options = {};\n      }\n\n      this.options = options;\n      var self = this;\n\n      function done(value) {\n        if (callback) {\n          setTimeout(function () {\n            callback(undefined, value);\n          }, 0);\n          return true;\n        } else {\n          return value;\n        }\n      } // Allow subclasses to massage the input prior to running\n\n\n      oldString = this.castInput(oldString);\n      newString = this.castInput(newString);\n      oldString = this.removeEmpty(this.tokenize(oldString));\n      newString = this.removeEmpty(this.tokenize(newString));\n      var newLen = newString.length,\n          oldLen = oldString.length;\n      var editLength = 1;\n      var maxEditLength = newLen + oldLen;\n      var bestPath = [{\n        newPos: -1,\n        components: []\n      }]; // Seed editLength = 0, i.e. the content starts with the same values\n\n      var oldPos = this.extractCommon(bestPath[0], newString, oldString, 0);\n\n      if (bestPath[0].newPos + 1 >= newLen && oldPos + 1 >= oldLen) {\n        // Identity per the equality and tokenizer\n        return done([{\n          value: this.join(newString),\n          count: newString.length\n        }]);\n      } // Main worker method. checks all permutations of a given edit length for acceptance.\n\n\n      function execEditLength() {\n        for (var diagonalPath = -1 * editLength; diagonalPath <= editLength; diagonalPath += 2) {\n          var basePath = void 0;\n\n          var addPath = bestPath[diagonalPath - 1],\n              removePath = bestPath[diagonalPath + 1],\n              _oldPos = (removePath ? removePath.newPos : 0) - diagonalPath;\n\n          if (addPath) {\n            // No one else is going to attempt to use this value, clear it\n            bestPath[diagonalPath - 1] = undefined;\n          }\n\n          var canAdd = addPath && addPath.newPos + 1 < newLen,\n              canRemove = removePath && 0 <= _oldPos && _oldPos < oldLen;\n\n          if (!canAdd && !canRemove) {\n            // If this path is a terminal then prune\n            bestPath[diagonalPath] = undefined;\n            continue;\n          } // Select the diagonal that we want to branch from. We select the prior\n          // path whose position in the new string is the farthest from the origin\n          // and does not pass the bounds of the diff graph\n\n\n          if (!canAdd || canRemove && addPath.newPos < removePath.newPos) {\n            basePath = clonePath(removePath);\n            self.pushComponent(basePath.components, undefined, true);\n          } else {\n            basePath = addPath; // No need to clone, we've pulled it from the list\n\n            basePath.newPos++;\n            self.pushComponent(basePath.components, true, undefined);\n          }\n\n          _oldPos = self.extractCommon(basePath, newString, oldString, diagonalPath); // If we have hit the end of both strings, then we are done\n\n          if (basePath.newPos + 1 >= newLen && _oldPos + 1 >= oldLen) {\n            return done(buildValues(self, basePath.components, newString, oldString, self.useLongestToken));\n          } else {\n            // Otherwise track this path as a potential candidate and continue.\n            bestPath[diagonalPath] = basePath;\n          }\n        }\n\n        editLength++;\n      } // Performs the length of edit iteration. Is a bit fugly as this has to support the\n      // sync and async mode which is never fun. Loops over execEditLength until a value\n      // is produced.\n\n\n      if (callback) {\n        (function exec() {\n          setTimeout(function () {\n            // This should not happen, but we want to be safe.\n\n            /* istanbul ignore next */\n            if (editLength > maxEditLength) {\n              return callback();\n            }\n\n            if (!execEditLength()) {\n              exec();\n            }\n          }, 0);\n        })();\n      } else {\n        while (editLength <= maxEditLength) {\n          var ret = execEditLength();\n\n          if (ret) {\n            return ret;\n          }\n        }\n      }\n    },\n    pushComponent: function pushComponent(components, added, removed) {\n      var last = components[components.length - 1];\n\n      if (last && last.added === added && last.removed === removed) {\n        // We need to clone here as the component clone operation is just\n        // as shallow array clone\n        components[components.length - 1] = {\n          count: last.count + 1,\n          added: added,\n          removed: removed\n        };\n      } else {\n        components.push({\n          count: 1,\n          added: added,\n          removed: removed\n        });\n      }\n    },\n    extractCommon: function extractCommon(basePath, newString, oldString, diagonalPath) {\n      var newLen = newString.length,\n          oldLen = oldString.length,\n          newPos = basePath.newPos,\n          oldPos = newPos - diagonalPath,\n          commonCount = 0;\n\n      while (newPos + 1 < newLen && oldPos + 1 < oldLen && this.equals(newString[newPos + 1], oldString[oldPos + 1])) {\n        newPos++;\n        oldPos++;\n        commonCount++;\n      }\n\n      if (commonCount) {\n        basePath.components.push({\n          count: commonCount\n        });\n      }\n\n      basePath.newPos = newPos;\n      return oldPos;\n    },\n    equals: function equals(left, right) {\n      if (this.options.comparator) {\n        return this.options.comparator(left, right);\n      } else {\n        return left === right || this.options.ignoreCase && left.toLowerCase() === right.toLowerCase();\n      }\n    },\n    removeEmpty: function removeEmpty(array) {\n      var ret = [];\n\n      for (var i = 0; i < array.length; i++) {\n        if (array[i]) {\n          ret.push(array[i]);\n        }\n      }\n\n      return ret;\n    },\n    castInput: function castInput(value) {\n      return value;\n    },\n    tokenize: function tokenize(value) {\n      return value.split('');\n    },\n    join: function join(chars) {\n      return chars.join('');\n    }\n  };\n\n  function buildValues(diff, components, newString, oldString, useLongestToken) {\n    var componentPos = 0,\n        componentLen = components.length,\n        newPos = 0,\n        oldPos = 0;\n\n    for (; componentPos < componentLen; componentPos++) {\n      var component = components[componentPos];\n\n      if (!component.removed) {\n        if (!component.added && useLongestToken) {\n          var value = newString.slice(newPos, newPos + component.count);\n          value = value.map(function (value, i) {\n            var oldValue = oldString[oldPos + i];\n            return oldValue.length > value.length ? oldValue : value;\n          });\n          component.value = diff.join(value);\n        } else {\n          component.value = diff.join(newString.slice(newPos, newPos + component.count));\n        }\n\n        newPos += component.count; // Common case\n\n        if (!component.added) {\n          oldPos += component.count;\n        }\n      } else {\n        component.value = diff.join(oldString.slice(oldPos, oldPos + component.count));\n        oldPos += component.count; // Reverse add and remove so removes are output first to match common convention\n        // The diffing algorithm is tied to add then remove output and this is the simplest\n        // route to get the desired output with minimal overhead.\n\n        if (componentPos && components[componentPos - 1].added) {\n          var tmp = components[componentPos - 1];\n          components[componentPos - 1] = components[componentPos];\n          components[componentPos] = tmp;\n        }\n      }\n    } // Special case handle for when one terminal is ignored (i.e. whitespace).\n    // For this case we merge the terminal into the prior string and drop the change.\n    // This is only available for string mode.\n\n\n    var lastComponent = components[componentLen - 1];\n\n    if (componentLen > 1 && typeof lastComponent.value === 'string' && (lastComponent.added || lastComponent.removed) && diff.equals('', lastComponent.value)) {\n      components[componentLen - 2].value += lastComponent.value;\n      components.pop();\n    }\n\n    return components;\n  }\n\n  function clonePath(path) {\n    return {\n      newPos: path.newPos,\n      components: path.components.slice(0)\n    };\n  }\n\n  var characterDiff = new Diff();\n  function diffChars(oldStr, newStr, options) {\n    return characterDiff.diff(oldStr, newStr, options);\n  }\n\n  function generateOptions(options, defaults) {\n    if (typeof options === 'function') {\n      defaults.callback = options;\n    } else if (options) {\n      for (var name in options) {\n        /* istanbul ignore else */\n        if (options.hasOwnProperty(name)) {\n          defaults[name] = options[name];\n        }\n      }\n    }\n\n    return defaults;\n  }\n\n  //\n  // Ranges and exceptions:\n  // Latin-1 Supplement, 008000FF\n  //  - U+00D7   Multiplication sign\n  //  - U+00F7   Division sign\n  // Latin Extended-A, 0100017F\n  // Latin Extended-B, 0180024F\n  // IPA Extensions, 025002AF\n  // Spacing Modifier Letters, 02B002FF\n  //  - U+02C7   &#711;  Caron\n  //  - U+02D8   &#728;  Breve\n  //  - U+02D9   &#729;  Dot Above\n  //  - U+02DA   &#730;  Ring Above\n  //  - U+02DB   &#731;  Ogonek\n  //  - U+02DC   &#732;  Small Tilde\n  //  - U+02DD   &#733;  Double Acute Accent\n  // Latin Extended Additional, 1E001EFF\n\n  var extendedWordChars = /^[A-Za-z\\xC0-\\u02C6\\u02C8-\\u02D7\\u02DE-\\u02FF\\u1E00-\\u1EFF]+$/;\n  var reWhitespace = /\\S/;\n  var wordDiff = new Diff();\n\n  wordDiff.equals = function (left, right) {\n    if (this.options.ignoreCase) {\n      left = left.toLowerCase();\n      right = right.toLowerCase();\n    }\n\n    return left === right || this.options.ignoreWhitespace && !reWhitespace.test(left) && !reWhitespace.test(right);\n  };\n\n  wordDiff.tokenize = function (value) {\n    var tokens = value.split(/(\\s+|[()[\\]{}'\"]|\\b)/); // Join the boundary splits that we do not consider to be boundaries. This is primarily the extended Latin character set.\n\n    for (var i = 0; i < tokens.length - 1; i++) {\n      // If we have an empty string in the next field and we have only word chars before and after, merge\n      if (!tokens[i + 1] && tokens[i + 2] && extendedWordChars.test(tokens[i]) && extendedWordChars.test(tokens[i + 2])) {\n        tokens[i] += tokens[i + 2];\n        tokens.splice(i + 1, 2);\n        i--;\n      }\n    }\n\n    return tokens;\n  };\n\n  function diffWords(oldStr, newStr, options) {\n    options = generateOptions(options, {\n      ignoreWhitespace: true\n    });\n    return wordDiff.diff(oldStr, newStr, options);\n  }\n  function diffWordsWithSpace(oldStr, newStr, options) {\n    return wordDiff.diff(oldStr, newStr, options);\n  }\n\n  var lineDiff = new Diff();\n\n  lineDiff.tokenize = function (value) {\n    var retLines = [],\n        linesAndNewlines = value.split(/(\\n|\\r\\n)/); // Ignore the final empty token that occurs if the string ends with a new line\n\n    if (!linesAndNewlines[linesAndNewlines.length - 1]) {\n      linesAndNewlines.pop();\n    } // Merge the content and line separators into single tokens\n\n\n    for (var i = 0; i < linesAndNewlines.length; i++) {\n      var line = linesAndNewlines[i];\n\n      if (i % 2 && !this.options.newlineIsToken) {\n        retLines[retLines.length - 1] += line;\n      } else {\n        if (this.options.ignoreWhitespace) {\n          line = line.trim();\n        }\n\n        retLines.push(line);\n      }\n    }\n\n    return retLines;\n  };\n\n  function diffLines(oldStr, newStr, callback) {\n    return lineDiff.diff(oldStr, newStr, callback);\n  }\n  function diffTrimmedLines(oldStr, newStr, callback) {\n    var options = generateOptions(callback, {\n      ignoreWhitespace: true\n    });\n    return lineDiff.diff(oldStr, newStr, options);\n  }\n\n  var sentenceDiff = new Diff();\n\n  sentenceDiff.tokenize = function (value) {\n    return value.split(/(\\S.+?[.!?])(?=\\s+|$)/);\n  };\n\n  function diffSentences(oldStr, newStr, callback) {\n    return sentenceDiff.diff(oldStr, newStr, callback);\n  }\n\n  var cssDiff = new Diff();\n\n  cssDiff.tokenize = function (value) {\n    return value.split(/([{}:;,]|\\s+)/);\n  };\n\n  function diffCss(oldStr, newStr, callback) {\n    return cssDiff.diff(oldStr, newStr, callback);\n  }\n\n  function _typeof(obj) {\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _iterableToArray(iter) {\n    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n  }\n\n  var objectPrototypeToString = Object.prototype.toString;\n  var jsonDiff = new Diff(); // Discriminate between two lines of pretty-printed, serialized JSON where one of them has a\n  // dangling comma and the other doesn't. Turns out including the dangling comma yields the nicest output:\n\n  jsonDiff.useLongestToken = true;\n  jsonDiff.tokenize = lineDiff.tokenize;\n\n  jsonDiff.castInput = function (value) {\n    var _this$options = this.options,\n        undefinedReplacement = _this$options.undefinedReplacement,\n        _this$options$stringi = _this$options.stringifyReplacer,\n        stringifyReplacer = _this$options$stringi === void 0 ? function (k, v) {\n      return typeof v === 'undefined' ? undefinedReplacement : v;\n    } : _this$options$stringi;\n    return typeof value === 'string' ? value : JSON.stringify(canonicalize(value, null, null, stringifyReplacer), stringifyReplacer, '  ');\n  };\n\n  jsonDiff.equals = function (left, right) {\n    return Diff.prototype.equals.call(jsonDiff, left.replace(/,([\\r\\n])/g, '$1'), right.replace(/,([\\r\\n])/g, '$1'));\n  };\n\n  function diffJson(oldObj, newObj, options) {\n    return jsonDiff.diff(oldObj, newObj, options);\n  } // This function handles the presence of circular references by bailing out when encountering an\n  // object that is already on the \"stack\" of items being processed. Accepts an optional replacer\n\n  function canonicalize(obj, stack, replacementStack, replacer, key) {\n    stack = stack || [];\n    replacementStack = replacementStack || [];\n\n    if (replacer) {\n      obj = replacer(key, obj);\n    }\n\n    var i;\n\n    for (i = 0; i < stack.length; i += 1) {\n      if (stack[i] === obj) {\n        return replacementStack[i];\n      }\n    }\n\n    var canonicalizedObj;\n\n    if ('[object Array]' === objectPrototypeToString.call(obj)) {\n      stack.push(obj);\n      canonicalizedObj = new Array(obj.length);\n      replacementStack.push(canonicalizedObj);\n\n      for (i = 0; i < obj.length; i += 1) {\n        canonicalizedObj[i] = canonicalize(obj[i], stack, replacementStack, replacer, key);\n      }\n\n      stack.pop();\n      replacementStack.pop();\n      return canonicalizedObj;\n    }\n\n    if (obj && obj.toJSON) {\n      obj = obj.toJSON();\n    }\n\n    if (_typeof(obj) === 'object' && obj !== null) {\n      stack.push(obj);\n      canonicalizedObj = {};\n      replacementStack.push(canonicalizedObj);\n\n      var sortedKeys = [],\n          _key;\n\n      for (_key in obj) {\n        /* istanbul ignore else */\n        if (obj.hasOwnProperty(_key)) {\n          sortedKeys.push(_key);\n        }\n      }\n\n      sortedKeys.sort();\n\n      for (i = 0; i < sortedKeys.length; i += 1) {\n        _key = sortedKeys[i];\n        canonicalizedObj[_key] = canonicalize(obj[_key], stack, replacementStack, replacer, _key);\n      }\n\n      stack.pop();\n      replacementStack.pop();\n    } else {\n      canonicalizedObj = obj;\n    }\n\n    return canonicalizedObj;\n  }\n\n  var arrayDiff = new Diff();\n\n  arrayDiff.tokenize = function (value) {\n    return value.slice();\n  };\n\n  arrayDiff.join = arrayDiff.removeEmpty = function (value) {\n    return value;\n  };\n\n  function diffArrays(oldArr, newArr, callback) {\n    return arrayDiff.diff(oldArr, newArr, callback);\n  }\n\n  function parsePatch(uniDiff) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var diffstr = uniDiff.split(/\\r\\n|[\\n\\v\\f\\r\\x85]/),\n        delimiters = uniDiff.match(/\\r\\n|[\\n\\v\\f\\r\\x85]/g) || [],\n        list = [],\n        i = 0;\n\n    function parseIndex() {\n      var index = {};\n      list.push(index); // Parse diff metadata\n\n      while (i < diffstr.length) {\n        var line = diffstr[i]; // File header found, end parsing diff metadata\n\n        if (/^(\\-\\-\\-|\\+\\+\\+|@@)\\s/.test(line)) {\n          break;\n        } // Diff index\n\n\n        var header = /^(?:Index:|diff(?: -r \\w+)+)\\s+(.+?)\\s*$/.exec(line);\n\n        if (header) {\n          index.index = header[1];\n        }\n\n        i++;\n      } // Parse file headers if they are defined. Unified diff requires them, but\n      // there's no technical issues to have an isolated hunk without file header\n\n\n      parseFileHeader(index);\n      parseFileHeader(index); // Parse hunks\n\n      index.hunks = [];\n\n      while (i < diffstr.length) {\n        var _line = diffstr[i];\n\n        if (/^(Index:|diff|\\-\\-\\-|\\+\\+\\+)\\s/.test(_line)) {\n          break;\n        } else if (/^@@/.test(_line)) {\n          index.hunks.push(parseHunk());\n        } else if (_line && options.strict) {\n          // Ignore unexpected content unless in strict mode\n          throw new Error('Unknown line ' + (i + 1) + ' ' + JSON.stringify(_line));\n        } else {\n          i++;\n        }\n      }\n    } // Parses the --- and +++ headers, if none are found, no lines\n    // are consumed.\n\n\n    function parseFileHeader(index) {\n      var fileHeader = /^(---|\\+\\+\\+)\\s+(.*)$/.exec(diffstr[i]);\n\n      if (fileHeader) {\n        var keyPrefix = fileHeader[1] === '---' ? 'old' : 'new';\n        var data = fileHeader[2].split('\\t', 2);\n        var fileName = data[0].replace(/\\\\\\\\/g, '\\\\');\n\n        if (/^\".*\"$/.test(fileName)) {\n          fileName = fileName.substr(1, fileName.length - 2);\n        }\n\n        index[keyPrefix + 'FileName'] = fileName;\n        index[keyPrefix + 'Header'] = (data[1] || '').trim();\n        i++;\n      }\n    } // Parses a hunk\n    // This assumes that we are at the start of a hunk.\n\n\n    function parseHunk() {\n      var chunkHeaderIndex = i,\n          chunkHeaderLine = diffstr[i++],\n          chunkHeader = chunkHeaderLine.split(/@@ -(\\d+)(?:,(\\d+))? \\+(\\d+)(?:,(\\d+))? @@/);\n      var hunk = {\n        oldStart: +chunkHeader[1],\n        oldLines: +chunkHeader[2] || 1,\n        newStart: +chunkHeader[3],\n        newLines: +chunkHeader[4] || 1,\n        lines: [],\n        linedelimiters: []\n      };\n      var addCount = 0,\n          removeCount = 0;\n\n      for (; i < diffstr.length; i++) {\n        // Lines starting with '---' could be mistaken for the \"remove line\" operation\n        // But they could be the header for the next file. Therefore prune such cases out.\n        if (diffstr[i].indexOf('--- ') === 0 && i + 2 < diffstr.length && diffstr[i + 1].indexOf('+++ ') === 0 && diffstr[i + 2].indexOf('@@') === 0) {\n          break;\n        }\n\n        var operation = diffstr[i].length == 0 && i != diffstr.length - 1 ? ' ' : diffstr[i][0];\n\n        if (operation === '+' || operation === '-' || operation === ' ' || operation === '\\\\') {\n          hunk.lines.push(diffstr[i]);\n          hunk.linedelimiters.push(delimiters[i] || '\\n');\n\n          if (operation === '+') {\n            addCount++;\n          } else if (operation === '-') {\n            removeCount++;\n          } else if (operation === ' ') {\n            addCount++;\n            removeCount++;\n          }\n        } else {\n          break;\n        }\n      } // Handle the empty block count case\n\n\n      if (!addCount && hunk.newLines === 1) {\n        hunk.newLines = 0;\n      }\n\n      if (!removeCount && hunk.oldLines === 1) {\n        hunk.oldLines = 0;\n      } // Perform optional sanity checking\n\n\n      if (options.strict) {\n        if (addCount !== hunk.newLines) {\n          throw new Error('Added line count did not match for hunk at line ' + (chunkHeaderIndex + 1));\n        }\n\n        if (removeCount !== hunk.oldLines) {\n          throw new Error('Removed line count did not match for hunk at line ' + (chunkHeaderIndex + 1));\n        }\n      }\n\n      return hunk;\n    }\n\n    while (i < diffstr.length) {\n      parseIndex();\n    }\n\n    return list;\n  }\n\n  // Iterator that traverses in the range of [min, max], stepping\n  // by distance from a given start position. I.e. for [0, 4], with\n  // start of 2, this will iterate 2, 3, 1, 4, 0.\n  function distanceIterator (start, minLine, maxLine) {\n    var wantForward = true,\n        backwardExhausted = false,\n        forwardExhausted = false,\n        localOffset = 1;\n    return function iterator() {\n      if (wantForward && !forwardExhausted) {\n        if (backwardExhausted) {\n          localOffset++;\n        } else {\n          wantForward = false;\n        } // Check if trying to fit beyond text length, and if not, check it fits\n        // after offset location (or desired location on first iteration)\n\n\n        if (start + localOffset <= maxLine) {\n          return localOffset;\n        }\n\n        forwardExhausted = true;\n      }\n\n      if (!backwardExhausted) {\n        if (!forwardExhausted) {\n          wantForward = true;\n        } // Check if trying to fit before text beginning, and if not, check it fits\n        // before offset location\n\n\n        if (minLine <= start - localOffset) {\n          return -localOffset++;\n        }\n\n        backwardExhausted = true;\n        return iterator();\n      } // We tried to fit hunk before text beginning and beyond text length, then\n      // hunk can't fit on the text. Return undefined\n\n    };\n  }\n\n  function applyPatch(source, uniDiff) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (typeof uniDiff === 'string') {\n      uniDiff = parsePatch(uniDiff);\n    }\n\n    if (Array.isArray(uniDiff)) {\n      if (uniDiff.length > 1) {\n        throw new Error('applyPatch only works with a single input.');\n      }\n\n      uniDiff = uniDiff[0];\n    } // Apply the diff to the input\n\n\n    var lines = source.split(/\\r\\n|[\\n\\v\\f\\r\\x85]/),\n        delimiters = source.match(/\\r\\n|[\\n\\v\\f\\r\\x85]/g) || [],\n        hunks = uniDiff.hunks,\n        compareLine = options.compareLine || function (lineNumber, line, operation, patchContent) {\n      return line === patchContent;\n    },\n        errorCount = 0,\n        fuzzFactor = options.fuzzFactor || 0,\n        minLine = 0,\n        offset = 0,\n        removeEOFNL,\n        addEOFNL;\n    /**\n     * Checks if the hunk exactly fits on the provided location\n     */\n\n\n    function hunkFits(hunk, toPos) {\n      for (var j = 0; j < hunk.lines.length; j++) {\n        var line = hunk.lines[j],\n            operation = line.length > 0 ? line[0] : ' ',\n            content = line.length > 0 ? line.substr(1) : line;\n\n        if (operation === ' ' || operation === '-') {\n          // Context sanity check\n          if (!compareLine(toPos + 1, lines[toPos], operation, content)) {\n            errorCount++;\n\n            if (errorCount > fuzzFactor) {\n              return false;\n            }\n          }\n\n          toPos++;\n        }\n      }\n\n      return true;\n    } // Search best fit offsets for each hunk based on the previous ones\n\n\n    for (var i = 0; i < hunks.length; i++) {\n      var hunk = hunks[i],\n          maxLine = lines.length - hunk.oldLines,\n          localOffset = 0,\n          toPos = offset + hunk.oldStart - 1;\n      var iterator = distanceIterator(toPos, minLine, maxLine);\n\n      for (; localOffset !== undefined; localOffset = iterator()) {\n        if (hunkFits(hunk, toPos + localOffset)) {\n          hunk.offset = offset += localOffset;\n          break;\n        }\n      }\n\n      if (localOffset === undefined) {\n        return false;\n      } // Set lower text limit to end of the current hunk, so next ones don't try\n      // to fit over already patched text\n\n\n      minLine = hunk.offset + hunk.oldStart + hunk.oldLines;\n    } // Apply patch hunks\n\n\n    var diffOffset = 0;\n\n    for (var _i = 0; _i < hunks.length; _i++) {\n      var _hunk = hunks[_i],\n          _toPos = _hunk.oldStart + _hunk.offset + diffOffset - 1;\n\n      diffOffset += _hunk.newLines - _hunk.oldLines;\n\n      if (_toPos < 0) {\n        // Creating a new file\n        _toPos = 0;\n      }\n\n      for (var j = 0; j < _hunk.lines.length; j++) {\n        var line = _hunk.lines[j],\n            operation = line.length > 0 ? line[0] : ' ',\n            content = line.length > 0 ? line.substr(1) : line,\n            delimiter = _hunk.linedelimiters[j];\n\n        if (operation === ' ') {\n          _toPos++;\n        } else if (operation === '-') {\n          lines.splice(_toPos, 1);\n          delimiters.splice(_toPos, 1);\n          /* istanbul ignore else */\n        } else if (operation === '+') {\n          lines.splice(_toPos, 0, content);\n          delimiters.splice(_toPos, 0, delimiter);\n          _toPos++;\n        } else if (operation === '\\\\') {\n          var previousOperation = _hunk.lines[j - 1] ? _hunk.lines[j - 1][0] : null;\n\n          if (previousOperation === '+') {\n            removeEOFNL = true;\n          } else if (previousOperation === '-') {\n            addEOFNL = true;\n          }\n        }\n      }\n    } // Handle EOFNL insertion/removal\n\n\n    if (removeEOFNL) {\n      while (!lines[lines.length - 1]) {\n        lines.pop();\n        delimiters.pop();\n      }\n    } else if (addEOFNL) {\n      lines.push('');\n      delimiters.push('\\n');\n    }\n\n    for (var _k = 0; _k < lines.length - 1; _k++) {\n      lines[_k] = lines[_k] + delimiters[_k];\n    }\n\n    return lines.join('');\n  } // Wrapper that supports multiple file patches via callbacks.\n\n  function applyPatches(uniDiff, options) {\n    if (typeof uniDiff === 'string') {\n      uniDiff = parsePatch(uniDiff);\n    }\n\n    var currentIndex = 0;\n\n    function processIndex() {\n      var index = uniDiff[currentIndex++];\n\n      if (!index) {\n        return options.complete();\n      }\n\n      options.loadFile(index, function (err, data) {\n        if (err) {\n          return options.complete(err);\n        }\n\n        var updatedContent = applyPatch(data, index, options);\n        options.patched(index, updatedContent, function (err) {\n          if (err) {\n            return options.complete(err);\n          }\n\n          processIndex();\n        });\n      });\n    }\n\n    processIndex();\n  }\n\n  function structuredPatch(oldFileName, newFileName, oldStr, newStr, oldHeader, newHeader, options) {\n    if (!options) {\n      options = {};\n    }\n\n    if (typeof options.context === 'undefined') {\n      options.context = 4;\n    }\n\n    var diff = diffLines(oldStr, newStr, options);\n    diff.push({\n      value: '',\n      lines: []\n    }); // Append an empty value to make cleanup easier\n\n    function contextLines(lines) {\n      return lines.map(function (entry) {\n        return ' ' + entry;\n      });\n    }\n\n    var hunks = [];\n    var oldRangeStart = 0,\n        newRangeStart = 0,\n        curRange = [],\n        oldLine = 1,\n        newLine = 1;\n\n    var _loop = function _loop(i) {\n      var current = diff[i],\n          lines = current.lines || current.value.replace(/\\n$/, '').split('\\n');\n      current.lines = lines;\n\n      if (current.added || current.removed) {\n        var _curRange;\n\n        // If we have previous context, start with that\n        if (!oldRangeStart) {\n          var prev = diff[i - 1];\n          oldRangeStart = oldLine;\n          newRangeStart = newLine;\n\n          if (prev) {\n            curRange = options.context > 0 ? contextLines(prev.lines.slice(-options.context)) : [];\n            oldRangeStart -= curRange.length;\n            newRangeStart -= curRange.length;\n          }\n        } // Output our changes\n\n\n        (_curRange = curRange).push.apply(_curRange, _toConsumableArray(lines.map(function (entry) {\n          return (current.added ? '+' : '-') + entry;\n        }))); // Track the updated file position\n\n\n        if (current.added) {\n          newLine += lines.length;\n        } else {\n          oldLine += lines.length;\n        }\n      } else {\n        // Identical context lines. Track line changes\n        if (oldRangeStart) {\n          // Close out any changes that have been output (or join overlapping)\n          if (lines.length <= options.context * 2 && i < diff.length - 2) {\n            var _curRange2;\n\n            // Overlapping\n            (_curRange2 = curRange).push.apply(_curRange2, _toConsumableArray(contextLines(lines)));\n          } else {\n            var _curRange3;\n\n            // end the range and output\n            var contextSize = Math.min(lines.length, options.context);\n\n            (_curRange3 = curRange).push.apply(_curRange3, _toConsumableArray(contextLines(lines.slice(0, contextSize))));\n\n            var hunk = {\n              oldStart: oldRangeStart,\n              oldLines: oldLine - oldRangeStart + contextSize,\n              newStart: newRangeStart,\n              newLines: newLine - newRangeStart + contextSize,\n              lines: curRange\n            };\n\n            if (i >= diff.length - 2 && lines.length <= options.context) {\n              // EOF is inside this hunk\n              var oldEOFNewline = /\\n$/.test(oldStr);\n              var newEOFNewline = /\\n$/.test(newStr);\n              var noNlBeforeAdds = lines.length == 0 && curRange.length > hunk.oldLines;\n\n              if (!oldEOFNewline && noNlBeforeAdds) {\n                // special case: old has no eol and no trailing context; no-nl can end up before adds\n                curRange.splice(hunk.oldLines, 0, '\\\\ No newline at end of file');\n              }\n\n              if (!oldEOFNewline && !noNlBeforeAdds || !newEOFNewline) {\n                curRange.push('\\\\ No newline at end of file');\n              }\n            }\n\n            hunks.push(hunk);\n            oldRangeStart = 0;\n            newRangeStart = 0;\n            curRange = [];\n          }\n        }\n\n        oldLine += lines.length;\n        newLine += lines.length;\n      }\n    };\n\n    for (var i = 0; i < diff.length; i++) {\n      _loop(i);\n    }\n\n    return {\n      oldFileName: oldFileName,\n      newFileName: newFileName,\n      oldHeader: oldHeader,\n      newHeader: newHeader,\n      hunks: hunks\n    };\n  }\n  function createTwoFilesPatch(oldFileName, newFileName, oldStr, newStr, oldHeader, newHeader, options) {\n    var diff = structuredPatch(oldFileName, newFileName, oldStr, newStr, oldHeader, newHeader, options);\n    var ret = [];\n\n    if (oldFileName == newFileName) {\n      ret.push('Index: ' + oldFileName);\n    }\n\n    ret.push('===================================================================');\n    ret.push('--- ' + diff.oldFileName + (typeof diff.oldHeader === 'undefined' ? '' : '\\t' + diff.oldHeader));\n    ret.push('+++ ' + diff.newFileName + (typeof diff.newHeader === 'undefined' ? '' : '\\t' + diff.newHeader));\n\n    for (var i = 0; i < diff.hunks.length; i++) {\n      var hunk = diff.hunks[i];\n      ret.push('@@ -' + hunk.oldStart + ',' + hunk.oldLines + ' +' + hunk.newStart + ',' + hunk.newLines + ' @@');\n      ret.push.apply(ret, hunk.lines);\n    }\n\n    return ret.join('\\n') + '\\n';\n  }\n  function createPatch(fileName, oldStr, newStr, oldHeader, newHeader, options) {\n    return createTwoFilesPatch(fileName, fileName, oldStr, newStr, oldHeader, newHeader, options);\n  }\n\n  function arrayEqual(a, b) {\n    if (a.length !== b.length) {\n      return false;\n    }\n\n    return arrayStartsWith(a, b);\n  }\n  function arrayStartsWith(array, start) {\n    if (start.length > array.length) {\n      return false;\n    }\n\n    for (var i = 0; i < start.length; i++) {\n      if (start[i] !== array[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  function calcLineCount(hunk) {\n    var _calcOldNewLineCount = calcOldNewLineCount(hunk.lines),\n        oldLines = _calcOldNewLineCount.oldLines,\n        newLines = _calcOldNewLineCount.newLines;\n\n    if (oldLines !== undefined) {\n      hunk.oldLines = oldLines;\n    } else {\n      delete hunk.oldLines;\n    }\n\n    if (newLines !== undefined) {\n      hunk.newLines = newLines;\n    } else {\n      delete hunk.newLines;\n    }\n  }\n  function merge(mine, theirs, base) {\n    mine = loadPatch(mine, base);\n    theirs = loadPatch(theirs, base);\n    var ret = {}; // For index we just let it pass through as it doesn't have any necessary meaning.\n    // Leaving sanity checks on this to the API consumer that may know more about the\n    // meaning in their own context.\n\n    if (mine.index || theirs.index) {\n      ret.index = mine.index || theirs.index;\n    }\n\n    if (mine.newFileName || theirs.newFileName) {\n      if (!fileNameChanged(mine)) {\n        // No header or no change in ours, use theirs (and ours if theirs does not exist)\n        ret.oldFileName = theirs.oldFileName || mine.oldFileName;\n        ret.newFileName = theirs.newFileName || mine.newFileName;\n        ret.oldHeader = theirs.oldHeader || mine.oldHeader;\n        ret.newHeader = theirs.newHeader || mine.newHeader;\n      } else if (!fileNameChanged(theirs)) {\n        // No header or no change in theirs, use ours\n        ret.oldFileName = mine.oldFileName;\n        ret.newFileName = mine.newFileName;\n        ret.oldHeader = mine.oldHeader;\n        ret.newHeader = mine.newHeader;\n      } else {\n        // Both changed... figure it out\n        ret.oldFileName = selectField(ret, mine.oldFileName, theirs.oldFileName);\n        ret.newFileName = selectField(ret, mine.newFileName, theirs.newFileName);\n        ret.oldHeader = selectField(ret, mine.oldHeader, theirs.oldHeader);\n        ret.newHeader = selectField(ret, mine.newHeader, theirs.newHeader);\n      }\n    }\n\n    ret.hunks = [];\n    var mineIndex = 0,\n        theirsIndex = 0,\n        mineOffset = 0,\n        theirsOffset = 0;\n\n    while (mineIndex < mine.hunks.length || theirsIndex < theirs.hunks.length) {\n      var mineCurrent = mine.hunks[mineIndex] || {\n        oldStart: Infinity\n      },\n          theirsCurrent = theirs.hunks[theirsIndex] || {\n        oldStart: Infinity\n      };\n\n      if (hunkBefore(mineCurrent, theirsCurrent)) {\n        // This patch does not overlap with any of the others, yay.\n        ret.hunks.push(cloneHunk(mineCurrent, mineOffset));\n        mineIndex++;\n        theirsOffset += mineCurrent.newLines - mineCurrent.oldLines;\n      } else if (hunkBefore(theirsCurrent, mineCurrent)) {\n        // This patch does not overlap with any of the others, yay.\n        ret.hunks.push(cloneHunk(theirsCurrent, theirsOffset));\n        theirsIndex++;\n        mineOffset += theirsCurrent.newLines - theirsCurrent.oldLines;\n      } else {\n        // Overlap, merge as best we can\n        var mergedHunk = {\n          oldStart: Math.min(mineCurrent.oldStart, theirsCurrent.oldStart),\n          oldLines: 0,\n          newStart: Math.min(mineCurrent.newStart + mineOffset, theirsCurrent.oldStart + theirsOffset),\n          newLines: 0,\n          lines: []\n        };\n        mergeLines(mergedHunk, mineCurrent.oldStart, mineCurrent.lines, theirsCurrent.oldStart, theirsCurrent.lines);\n        theirsIndex++;\n        mineIndex++;\n        ret.hunks.push(mergedHunk);\n      }\n    }\n\n    return ret;\n  }\n\n  function loadPatch(param, base) {\n    if (typeof param === 'string') {\n      if (/^@@/m.test(param) || /^Index:/m.test(param)) {\n        return parsePatch(param)[0];\n      }\n\n      if (!base) {\n        throw new Error('Must provide a base reference or pass in a patch');\n      }\n\n      return structuredPatch(undefined, undefined, base, param);\n    }\n\n    return param;\n  }\n\n  function fileNameChanged(patch) {\n    return patch.newFileName && patch.newFileName !== patch.oldFileName;\n  }\n\n  function selectField(index, mine, theirs) {\n    if (mine === theirs) {\n      return mine;\n    } else {\n      index.conflict = true;\n      return {\n        mine: mine,\n        theirs: theirs\n      };\n    }\n  }\n\n  function hunkBefore(test, check) {\n    return test.oldStart < check.oldStart && test.oldStart + test.oldLines < check.oldStart;\n  }\n\n  function cloneHunk(hunk, offset) {\n    return {\n      oldStart: hunk.oldStart,\n      oldLines: hunk.oldLines,\n      newStart: hunk.newStart + offset,\n      newLines: hunk.newLines,\n      lines: hunk.lines\n    };\n  }\n\n  function mergeLines(hunk, mineOffset, mineLines, theirOffset, theirLines) {\n    // This will generally result in a conflicted hunk, but there are cases where the context\n    // is the only overlap where we can successfully merge the content here.\n    var mine = {\n      offset: mineOffset,\n      lines: mineLines,\n      index: 0\n    },\n        their = {\n      offset: theirOffset,\n      lines: theirLines,\n      index: 0\n    }; // Handle any leading content\n\n    insertLeading(hunk, mine, their);\n    insertLeading(hunk, their, mine); // Now in the overlap content. Scan through and select the best changes from each.\n\n    while (mine.index < mine.lines.length && their.index < their.lines.length) {\n      var mineCurrent = mine.lines[mine.index],\n          theirCurrent = their.lines[their.index];\n\n      if ((mineCurrent[0] === '-' || mineCurrent[0] === '+') && (theirCurrent[0] === '-' || theirCurrent[0] === '+')) {\n        // Both modified ...\n        mutualChange(hunk, mine, their);\n      } else if (mineCurrent[0] === '+' && theirCurrent[0] === ' ') {\n        var _hunk$lines;\n\n        // Mine inserted\n        (_hunk$lines = hunk.lines).push.apply(_hunk$lines, _toConsumableArray(collectChange(mine)));\n      } else if (theirCurrent[0] === '+' && mineCurrent[0] === ' ') {\n        var _hunk$lines2;\n\n        // Theirs inserted\n        (_hunk$lines2 = hunk.lines).push.apply(_hunk$lines2, _toConsumableArray(collectChange(their)));\n      } else if (mineCurrent[0] === '-' && theirCurrent[0] === ' ') {\n        // Mine removed or edited\n        removal(hunk, mine, their);\n      } else if (theirCurrent[0] === '-' && mineCurrent[0] === ' ') {\n        // Their removed or edited\n        removal(hunk, their, mine, true);\n      } else if (mineCurrent === theirCurrent) {\n        // Context identity\n        hunk.lines.push(mineCurrent);\n        mine.index++;\n        their.index++;\n      } else {\n        // Context mismatch\n        conflict(hunk, collectChange(mine), collectChange(their));\n      }\n    } // Now push anything that may be remaining\n\n\n    insertTrailing(hunk, mine);\n    insertTrailing(hunk, their);\n    calcLineCount(hunk);\n  }\n\n  function mutualChange(hunk, mine, their) {\n    var myChanges = collectChange(mine),\n        theirChanges = collectChange(their);\n\n    if (allRemoves(myChanges) && allRemoves(theirChanges)) {\n      // Special case for remove changes that are supersets of one another\n      if (arrayStartsWith(myChanges, theirChanges) && skipRemoveSuperset(their, myChanges, myChanges.length - theirChanges.length)) {\n        var _hunk$lines3;\n\n        (_hunk$lines3 = hunk.lines).push.apply(_hunk$lines3, _toConsumableArray(myChanges));\n\n        return;\n      } else if (arrayStartsWith(theirChanges, myChanges) && skipRemoveSuperset(mine, theirChanges, theirChanges.length - myChanges.length)) {\n        var _hunk$lines4;\n\n        (_hunk$lines4 = hunk.lines).push.apply(_hunk$lines4, _toConsumableArray(theirChanges));\n\n        return;\n      }\n    } else if (arrayEqual(myChanges, theirChanges)) {\n      var _hunk$lines5;\n\n      (_hunk$lines5 = hunk.lines).push.apply(_hunk$lines5, _toConsumableArray(myChanges));\n\n      return;\n    }\n\n    conflict(hunk, myChanges, theirChanges);\n  }\n\n  function removal(hunk, mine, their, swap) {\n    var myChanges = collectChange(mine),\n        theirChanges = collectContext(their, myChanges);\n\n    if (theirChanges.merged) {\n      var _hunk$lines6;\n\n      (_hunk$lines6 = hunk.lines).push.apply(_hunk$lines6, _toConsumableArray(theirChanges.merged));\n    } else {\n      conflict(hunk, swap ? theirChanges : myChanges, swap ? myChanges : theirChanges);\n    }\n  }\n\n  function conflict(hunk, mine, their) {\n    hunk.conflict = true;\n    hunk.lines.push({\n      conflict: true,\n      mine: mine,\n      theirs: their\n    });\n  }\n\n  function insertLeading(hunk, insert, their) {\n    while (insert.offset < their.offset && insert.index < insert.lines.length) {\n      var line = insert.lines[insert.index++];\n      hunk.lines.push(line);\n      insert.offset++;\n    }\n  }\n\n  function insertTrailing(hunk, insert) {\n    while (insert.index < insert.lines.length) {\n      var line = insert.lines[insert.index++];\n      hunk.lines.push(line);\n    }\n  }\n\n  function collectChange(state) {\n    var ret = [],\n        operation = state.lines[state.index][0];\n\n    while (state.index < state.lines.length) {\n      var line = state.lines[state.index]; // Group additions that are immediately after subtractions and treat them as one \"atomic\" modify change.\n\n      if (operation === '-' && line[0] === '+') {\n        operation = '+';\n      }\n\n      if (operation === line[0]) {\n        ret.push(line);\n        state.index++;\n      } else {\n        break;\n      }\n    }\n\n    return ret;\n  }\n\n  function collectContext(state, matchChanges) {\n    var changes = [],\n        merged = [],\n        matchIndex = 0,\n        contextChanges = false,\n        conflicted = false;\n\n    while (matchIndex < matchChanges.length && state.index < state.lines.length) {\n      var change = state.lines[state.index],\n          match = matchChanges[matchIndex]; // Once we've hit our add, then we are done\n\n      if (match[0] === '+') {\n        break;\n      }\n\n      contextChanges = contextChanges || change[0] !== ' ';\n      merged.push(match);\n      matchIndex++; // Consume any additions in the other block as a conflict to attempt\n      // to pull in the remaining context after this\n\n      if (change[0] === '+') {\n        conflicted = true;\n\n        while (change[0] === '+') {\n          changes.push(change);\n          change = state.lines[++state.index];\n        }\n      }\n\n      if (match.substr(1) === change.substr(1)) {\n        changes.push(change);\n        state.index++;\n      } else {\n        conflicted = true;\n      }\n    }\n\n    if ((matchChanges[matchIndex] || '')[0] === '+' && contextChanges) {\n      conflicted = true;\n    }\n\n    if (conflicted) {\n      return changes;\n    }\n\n    while (matchIndex < matchChanges.length) {\n      merged.push(matchChanges[matchIndex++]);\n    }\n\n    return {\n      merged: merged,\n      changes: changes\n    };\n  }\n\n  function allRemoves(changes) {\n    return changes.reduce(function (prev, change) {\n      return prev && change[0] === '-';\n    }, true);\n  }\n\n  function skipRemoveSuperset(state, removeChanges, delta) {\n    for (var i = 0; i < delta; i++) {\n      var changeContent = removeChanges[removeChanges.length - delta + i].substr(1);\n\n      if (state.lines[state.index + i] !== ' ' + changeContent) {\n        return false;\n      }\n    }\n\n    state.index += delta;\n    return true;\n  }\n\n  function calcOldNewLineCount(lines) {\n    var oldLines = 0;\n    var newLines = 0;\n    lines.forEach(function (line) {\n      if (typeof line !== 'string') {\n        var myCount = calcOldNewLineCount(line.mine);\n        var theirCount = calcOldNewLineCount(line.theirs);\n\n        if (oldLines !== undefined) {\n          if (myCount.oldLines === theirCount.oldLines) {\n            oldLines += myCount.oldLines;\n          } else {\n            oldLines = undefined;\n          }\n        }\n\n        if (newLines !== undefined) {\n          if (myCount.newLines === theirCount.newLines) {\n            newLines += myCount.newLines;\n          } else {\n            newLines = undefined;\n          }\n        }\n      } else {\n        if (newLines !== undefined && (line[0] === '+' || line[0] === ' ')) {\n          newLines++;\n        }\n\n        if (oldLines !== undefined && (line[0] === '-' || line[0] === ' ')) {\n          oldLines++;\n        }\n      }\n    });\n    return {\n      oldLines: oldLines,\n      newLines: newLines\n    };\n  }\n\n  // See: http://code.google.com/p/google-diff-match-patch/wiki/API\n  function convertChangesToDMP(changes) {\n    var ret = [],\n        change,\n        operation;\n\n    for (var i = 0; i < changes.length; i++) {\n      change = changes[i];\n\n      if (change.added) {\n        operation = 1;\n      } else if (change.removed) {\n        operation = -1;\n      } else {\n        operation = 0;\n      }\n\n      ret.push([operation, change.value]);\n    }\n\n    return ret;\n  }\n\n  function convertChangesToXML(changes) {\n    var ret = [];\n\n    for (var i = 0; i < changes.length; i++) {\n      var change = changes[i];\n\n      if (change.added) {\n        ret.push('<ins>');\n      } else if (change.removed) {\n        ret.push('<del>');\n      }\n\n      ret.push(escapeHTML(change.value));\n\n      if (change.added) {\n        ret.push('</ins>');\n      } else if (change.removed) {\n        ret.push('</del>');\n      }\n    }\n\n    return ret.join('');\n  }\n\n  function escapeHTML(s) {\n    var n = s;\n    n = n.replace(/&/g, '&amp;');\n    n = n.replace(/</g, '&lt;');\n    n = n.replace(/>/g, '&gt;');\n    n = n.replace(/\"/g, '&quot;');\n    return n;\n  }\n\n  /* See LICENSE file for terms of use */\n\n  exports.Diff = Diff;\n  exports.diffChars = diffChars;\n  exports.diffWords = diffWords;\n  exports.diffWordsWithSpace = diffWordsWithSpace;\n  exports.diffLines = diffLines;\n  exports.diffTrimmedLines = diffTrimmedLines;\n  exports.diffSentences = diffSentences;\n  exports.diffCss = diffCss;\n  exports.diffJson = diffJson;\n  exports.diffArrays = diffArrays;\n  exports.structuredPatch = structuredPatch;\n  exports.createTwoFilesPatch = createTwoFilesPatch;\n  exports.createPatch = createPatch;\n  exports.applyPatch = applyPatch;\n  exports.applyPatches = applyPatches;\n  exports.parsePatch = parsePatch;\n  exports.merge = merge;\n  exports.convertChangesToDMP = convertChangesToDMP;\n  exports.convertChangesToXML = convertChangesToXML;\n  exports.canonicalize = canonicalize;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n","\"use strict\";\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar JsDiff = __importStar(require(\"diff\"));\nvar Measure_1 = require(\"./Measure\");\nvar Sheet_1 = require(\"./Sheet\");\nvar Snippet = /** @class */ (function () {\n    function Snippet() {\n    }\n    Snippet.render = function (snippet, options) {\n        var parsed = Snippet.parse(snippet);\n        return Sheet_1.Sheet.render(parsed, options, true);\n    };\n    Snippet.wrapPipes = function (string) {\n        return (\"|\" + string + \"|\").replace(/\\|+/g, '|');\n    };\n    Snippet.formatForDiff = function (snippet) {\n        return Snippet.minify(snippet)\n            .replace(/\\|/g, ' | ').trim();\n    };\n    Snippet.format = function (snippet, linebreaks) {\n        if (linebreaks === void 0) { linebreaks = true; }\n        // replaces url chars back\n        var compact = Snippet.minify(snippet, false);\n        compact = Snippet.wrapPipes(compact);\n        if (linebreaks) {\n            compact = Snippet.parseBars(snippet).compact;\n        }\n        else {\n            compact = compact.replace(/\\n/g, '|');\n        }\n        return compact\n            .replace(/\\|+/g, '|')\n            .replace(/\\|( +)\\|( +)/g, ' $1 $2') // remove spacer bar pipes\n            .replace(/\\|( +)\\|([1-9])/g, ' $1|$2')\n            .replace(/^\\s+|\\s+$/g, ''); // remove spaces/line breaks from start/end\n    };\n    Snippet.parseBars = function (snippet) {\n        var compact = Snippet.minify(snippet, false);\n        compact = Snippet.wrapPipes(compact);\n        // insert spaces before first chord\n        var cells = compact.split('|').slice(1, -1);\n        cells = cells.map(function (bar, index) {\n            if (!bar[0].match(/[1-9:]/)) {\n                bar = '  ' + bar;\n            }\n            else if (bar[0] === ':') {\n                bar = ': ' + bar.slice(1);\n            }\n            return bar;\n        });\n        // find out indices of first houses\n        var houses = cells.reduce(function (offset, bar, index) {\n            if (bar[0] === '1') {\n                offset.push(index);\n            }\n            return offset;\n        }, []);\n        // insert empty cells before additional houses\n        cells = cells.reduce(function (cells, bar, index) {\n            if (bar[0].match(/[2-9]/)) {\n                var offset = houses.filter(function (h) { return h < index; }).reverse()[0];\n                cells = cells.concat(new Array(offset % 4).fill(''));\n            }\n            cells.push(bar);\n            return cells;\n        }, []);\n        // find out the maximal number of chars per column\n        var chars = cells.reduce(function (max, bar, index) {\n            max[index % 4] = Math.max(bar.length, max[index % 4] || 0);\n            return max;\n        }, []);\n        // fill up each bar with spaces\n        compact = cells.map(function (bar, index) {\n            var diff = chars[index % 4] - bar.length + 2;\n            if (diff > 0) {\n                bar += new Array(diff).fill(' ').join('');\n            }\n            // move double dots to end of bar\n            bar = bar.replace(/:(\\s+)$/, '$1:');\n            return bar;\n        }).join('|');\n        compact = Snippet.wrapPipes(compact);\n        // break string all 4 cells\n        var pipeIndex = -1;\n        compact = compact.split('').reduce(function (string, char, index) {\n            if (char === '|') {\n                pipeIndex++;\n            }\n            if (char === '|' && pipeIndex % 4 === 0 && index > 0 && index < compact.length - 1) {\n                char = \"|\\n|\";\n                pipeIndex = 0;\n            }\n            return string + char;\n        }, '');\n        return { compact: compact, cells: cells, houses: houses, chars: chars };\n    };\n    Snippet.columnChars = function (snippet) {\n        var bars = snippet.split('|');\n        var chars = bars.reduce(function (max, bar, index) {\n            max[index % 4] = Math.max(bar.length, max[index % 4] || 0);\n            return max;\n        }, []);\n    };\n    Snippet.getCellBounds = function (index, snippet) {\n        var _a = Snippet.parseBars(snippet), chars = _a.chars, cells = _a.cells;\n        // get correct index with offset (dont count empty cells)\n        index = cells.map((function (cell, index) { return ({ cell: cell, index: index }); }))\n            .filter(function (_a) {\n            var cell = _a.cell;\n            return cell !== '';\n        })[index].index;\n        index = index % cells.length;\n        var col = index % 4;\n        var row = Math.floor(index / 4);\n        var rowlength = chars.reduce(function (sum, current) { return sum + current + 3; }, 0) + 2;\n        var rowLeft = rowlength * row;\n        var left = rowLeft + chars.slice(0, col).reduce(function (sum, current, i) { return sum + current + 3; }, 0) + 1;\n        return [left, left + chars[col] + 2];\n    };\n    Snippet.minify = function (snippet, urlsafe) {\n        if (urlsafe === void 0) { urlsafe = false; }\n        var compact = (\"|\" + snippet + \"|\")\n            .replace(/\\n+/g, '|') // replace line breaks with pipes\n            .replace(/\\s+/g, ' ') // no repeated pipes\n            .replace(/\\s?\\|\\s?/g, '|') // no pipes with spaces\n            .replace(/\\s?\\:\\s?/g, ':') // no repeat with spaces\n            .replace(/\\|+/g, '|'); // no repeated pipes\n        if (urlsafe) {\n            // replaces url unfriendly chars\n            compact = compact\n                .replace(/\\|+/g, 'I')\n                .replace(/\\s+/g, '_')\n                .replace(/:/g, 'R')\n                .replace(/\\^/g, 'M')\n                .replace(/\\#/g, 'Y')\n                .replace(/\\%/g, 'X');\n        }\n        else {\n            // replaces url unfriendly chars\n            compact = compact\n                .replace(/\\I+/g, '|')\n                .replace(/\\_+/g, ' ')\n                .replace(/R/g, ':')\n                .replace(/M/g, '^')\n                .replace(/X/g, 'x')\n                .replace(/Y/g, '#');\n        }\n        return compact.slice(1, -1);\n    };\n    Snippet.getControlSigns = function (symbols) {\n        if (symbols === void 0) { symbols = []; }\n        return symbols\n            .filter(function (s) { return typeof s === 'string'; }) // control should not be nested!\n            .map(function (s) { return Snippet.controlSigns.find(function (c) { return [c.name, c.short]\n            .includes(s.replace('(', '').replace(')', '')); }); })\n            .filter(function (s) { return !!s; });\n    };\n    Snippet.parse = function (snippet, simplify) {\n        if (simplify === void 0) { simplify = true; }\n        var formatted = Snippet.format(snippet, false);\n        return formatted\n            .split('|') // split into measures\n            .map(function (measure) { return measure.split(' '); }) // split measures by spaces\n            .map(function (measure) { return measure.filter(function (chord) { return !!chord; }); }) // kill empty chords\n            .filter(function (measure) { return !measure || measure.length; }) // kill empty measures\n            .map(function (measure) { return ({ symbols: measure, signs: [] }); })\n            // parse symbols to chords and signs\n            .map(function (measure) {\n            // repeat start\n            if (measure.symbols[0][0] === ':') {\n                if (measure.symbols[0].length === 1) {\n                    measure.symbols = measure.symbols.slice(1);\n                }\n                measure.signs.unshift('{');\n            }\n            var last = measure.symbols[measure.symbols.length - 1];\n            // repeat end\n            if (last[last.length - 1] === ':') {\n                if (last.length === 1) {\n                    measure.symbols.pop();\n                }\n                measure.signs.push('}');\n            }\n            measure.symbols = measure.symbols.map(function (s) { return s.replace(/:/g, ''); });\n            var house = measure.symbols.find(function (s) { return s.match(/^[1-9]$/); });\n            if (house) {\n                measure.house = parseInt(house);\n            }\n            measure.symbols = measure.symbols.filter(function (s) { return !s.match(/^[1-9]$/); });\n            var controlSigns = Snippet.getControlSigns(measure.symbols);\n            if (controlSigns.length) {\n                measure.signs = measure.signs.concat(controlSigns.map(function (sign) { return sign.name; }));\n                measure.symbols = measure.symbols\n                    .filter(function (s) { return !controlSigns\n                    .find(function (c) { return [c.name, c.short].includes(s.replace(')', '').replace('(', '')); }); });\n            }\n            measure.chords = [].concat(measure.symbols);\n            delete measure.symbols;\n            return measure;\n        })\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.signs.length === 0) {\n                delete measure.signs;\n            }\n            if (measure.chords.length === 0) {\n                delete measure.chords;\n            }\n            return measure;\n        })\n            // kill empty measures\n            .filter(function (measure) { return Object.keys(measure).length > 0; })\n            // simplify => measures with only chords will be arrays\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.chords && Object.keys(measure).length === 1) {\n                return measure.chords.length === 1 ?\n                    measure.chords[0] : // simplify one chord measures\n                    measure.chords;\n            }\n            return measure;\n        });\n    };\n    Snippet.nest = function (string) {\n        var nested = string.split('.')\n            .map(function (group) { return group.trim(); })\n            .map(function (group) { return group.split(' '); })\n            .map(function (group) { return group.filter(function (chord) { return !!chord; }); }) // kill empty chords\n            .filter(function (group) { return !group || group.length; })\n            .map(function (group) { return group.length === 1 ? group[0] : group; });\n        nested = nested.length === 1 ? nested[0] : nested;\n        return nested;\n    };\n    Snippet.parse2 = function (snippet, simplify) {\n        if (simplify === void 0) { simplify = true; }\n        var formatted = Snippet.format(snippet, false);\n        return formatted\n            .split('|') // split into measures\n            .filter(function (measure) { return measure && measure.length; }) // kill empty measures\n            .map(function (measure) { return ({ symbols: measure.trim(), signs: [] }); })\n            // parse symbols to chords and signs\n            .map(function (measure) {\n            // repeat start\n            if (measure.symbols[0] === ':') {\n                measure.signs.unshift('{');\n            }\n            var last = measure.symbols[measure.symbols.length - 1];\n            // repeat end\n            if (last === ':') {\n                measure.signs.push('}');\n            }\n            measure.symbols = measure.symbols.replace(/:/g, '');\n            var house = measure.symbols[0].match(/^[1-9]$/);\n            if (house) {\n                measure.house = parseInt(house);\n                measure.symbols = measure.symbols.slice(1);\n            }\n            measure.symbols = [].concat(Snippet.nest(measure.symbols));\n            var controlSigns = Snippet.getControlSigns(measure.symbols);\n            if (controlSigns.length) {\n                measure.signs = measure.signs.concat(controlSigns.map(function (sign) { return sign.name; }));\n                measure.symbols = measure.symbols\n                    .filter(function (s) { return !controlSigns\n                    .find(function (c) { return [c.name, c.short].includes(s.replace(')', '').replace('(', '')); }); });\n            }\n            measure.chords = measure.symbols;\n            delete measure.symbols;\n            return measure;\n        })\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.signs.length === 0) {\n                delete measure.signs;\n            }\n            if (measure.chords.length === 0) {\n                delete measure.chords;\n            }\n            return measure;\n        })\n            // kill empty measures\n            .filter(function (measure) { return Object.keys(measure).length > 0; })\n            // simplify => measures with only chords will be arrays\n            .map(function (measure) {\n            if (!simplify) {\n                return measure;\n            }\n            if (measure.chords && Object.keys(measure).length === 1) {\n                return measure.chords.length === 1 ?\n                    measure.chords[0] : // simplify one chord measures\n                    measure.chords;\n            }\n            return measure;\n        });\n    };\n    Snippet.testFormat = function (sheet) {\n        return sheet.map(function (m) { return Measure_1.Measure.from(m); }).map(function (m) { return m.chords; }).join(' ');\n    };\n    Snippet.from = function (sheet, format) {\n        if (format === void 0) { format = true; }\n        var snippet = sheet\n            .map(function (m) { return Measure_1.Measure.from(m); })\n            .reduce(function (snippet, _a) {\n            var signs = _a.signs, house = _a.house, chords = _a.chords;\n            var controlSigns = Snippet.getControlSigns(signs || []);\n            var start = controlSigns.filter(function (c) { return !c.end; }).map(function (c) { return '(' + c.short + ')'; }).join(' ');\n            var end = controlSigns.filter(function (c) { return !!c.end; }).map(function (c) { return '(' + c.short + ')'; }).join(' ');\n            var repeatStart = signs && signs.includes('{');\n            var repeatEnd = signs && signs.includes('}');\n            return snippet + (\"|\" + (repeatStart ? ':' : '') + (house || '') + \" \" + (start ? start + ' ' : '') + (chords ? chords.join(' ') : '') + (end ? ' ' + end : '') + (repeatEnd ? ':' : ''));\n        }, '');\n        if (format) {\n            return Snippet.format(snippet);\n        }\n        return Snippet.minify(snippet);\n    };\n    Snippet.expand = function (snippet, options) {\n        return Snippet.from(Snippet.render(snippet, options));\n    };\n    Snippet.diff = function (snippetA, snippetB) {\n        var diffFormat = [Snippet.formatForDiff(snippetA), Snippet.formatForDiff(snippetB)];\n        return JsDiff.diffWords(diffFormat[0], diffFormat[1]);\n    };\n    Snippet.controlSigns = [\n        {\n            name: 'DC',\n            short: 'DC',\n            end: true\n        },\n        {\n            name: 'DS',\n            short: 'DS',\n            end: true\n        },\n        {\n            name: 'Segno',\n            short: 'S',\n        },\n        {\n            name: 'DS.Fine',\n            short: 'DS',\n            end: true\n        },\n        {\n            name: 'DS.Coda',\n            short: 'DS',\n            end: true\n        },\n        {\n            name: 'DC.Fine',\n            short: 'DC',\n            end: true\n        },\n        {\n            name: 'DC.Coda',\n            short: 'DC',\n            end: true\n        },\n        {\n            name: 'Fine',\n            short: 'Fi',\n            end: true\n        },\n        {\n            name: 'ToCoda',\n            short: '2Q',\n            end: true\n        },\n        {\n            name: 'Coda',\n            short: 'Q'\n        },\n    ];\n    return Snippet;\n}());\nexports.Snippet = Snippet;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tonal_1 = require(\"tonal\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar Voicing_1 = require(\"../harmony/Voicing\");\nvar Snippet_1 = require(\"../sheet/Snippet\");\nvar util_1 = require(\"./util\");\nvar Logger = /** @class */ (function () {\n    function Logger() {\n    }\n    Logger.logCustom = function (args, logFn) {\n        if (logFn === void 0) { logFn = console.log; }\n        /* console.clear(); */\n        logFn.apply(console, args);\n    };\n    Logger.logLegend = function () {\n        if (console.groupCollapsed) {\n            console.groupCollapsed('Show Emoji Legend');\n            console.table(Logger.emoji);\n            console.groupEnd();\n        }\n        else {\n            console.log('Emoji Legend:', Logger.emoji);\n        }\n    };\n    Logger.logSheet = function (sheet) {\n        sheet = __assign({ title: 'Untitled', composer: 'Unkown', chords: [], forms: 3, tempo: 130, style: 'Swing' }, sheet);\n        var snippet = Snippet_1.Snippet.from(sheet.chords);\n        console.log(sheet.composer + \" - \" + sheet.title);\n        console.log(sheet.tempo + \"bpm, Style: \" + sheet.style);\n        console.log(snippet);\n        if (console.groupCollapsed) {\n            console.log('Sheet', sheet);\n            /* console.log('Groove', sheet.groove); */\n            console.groupCollapsed(\"show \" + sheet.forms + \" rendered forms\");\n            console.log(\"expanded view\\n\\n\" + Snippet_1.Snippet.expand(snippet, { forms: sheet.forms || 1 }));\n            console.groupEnd();\n        }\n    };\n    Logger.logLabel = function (key) {\n        if (!Logger.emoji[key]) {\n            return key;\n        }\n        return Logger.emoji[key].icon + ' ' + key;\n    };\n    Logger.logChoice = function (choice) {\n        var _a;\n        if (!choice) {\n            return;\n        }\n        var difference = choice.difference, origin = choice.origin, targets = choice.targets, from = choice.from, to = choice.to, movement = choice.movement, similar = choice.similar, added = choice.added, dropped = choice.dropped, contrary = choice.contrary, parallel = choice.parallel, topInterval = choice.topInterval, bottomInterval = choice.bottomInterval, topNotes = choice.topNotes, bottomNotes = choice.bottomNotes, intervals = choice.intervals, degrees = choice.degrees;\n        console.table((_a = {\n                difference: difference,\n                movement: movement,\n                origin: origin.join(' '),\n                dropped: dropped.join(' '),\n                added: added.join(' '),\n                targets: targets.join(' '),\n                /* from: from.join(' '),\n                to: to.join(' '), */\n                intervals: intervals.join(' '),\n                degrees: degrees.join(' ')\n            },\n            _a[Logger.logLabel('similar')] = similar,\n            _a[Logger.logLabel('contrary')] = contrary,\n            _a[Logger.logLabel('parallel')] = parallel,\n            _a.topNotes = topNotes.join(' '),\n            _a.topInterval = topInterval,\n            _a.bottomNotes = bottomNotes.join(' '),\n            _a.bottomInterval = bottomInterval,\n            _a));\n    };\n    Logger.logNotes = function (options) {\n        var _a = __assign({ labels: [] }, options), notes = _a.notes, active = _a.active, idle = _a.idle, added = _a.added, range = _a.range, labels = _a.labels;\n        var span = [\n            tonal_1.Distance.transpose(range[0], tonal_1.Interval.fromSemitones(-7)),\n            tonal_1.Distance.transpose(range[1], tonal_1.Interval.fromSemitones(12))\n        ];\n        var allNotes = util_1.noteArray(span);\n        var keyboard = allNotes.map(function (note, index) {\n            var isActive = active.find(function (n) { return Harmony_1.Harmony.hasSamePitch(note, n); });\n            var isUsed = notes.find(function (n) { return Harmony_1.Harmony.hasSamePitch(note, n); });\n            var i = notes.indexOf(isUsed);\n            var isIdle = idle.find(function (n) { return Harmony_1.Harmony.hasSamePitch(note, n); });\n            var isAdded = added.find(function (n) { return Harmony_1.Harmony.hasSamePitch(note, n); });\n            var isBlack = Harmony_1.Harmony.isBlack(note);\n            var css = '', sign = '_';\n            if (isAdded && !isBlack) {\n                css = 'background:green;color:white;';\n                sign = labels[i] || '';\n            }\n            else if (isAdded && isBlack) {\n                css = 'background:darkgreen;color:white;';\n                sign = labels[i] || '';\n            }\n            else if (isActive && isBlack) {\n                css = 'background:#a50909;color:white;';\n                sign = labels[i] || '';\n            }\n            else if (isActive && !isBlack) {\n                css = 'background:#e52929;color:white;';\n                sign = labels[i] || '';\n            }\n            else if (isIdle && !isBlack) {\n                css = 'background:gray;color:white;';\n                sign = labels[i] || '';\n            }\n            else if (isIdle && isBlack) {\n                css = 'background:darkgray;color:white;';\n                sign = labels[i] || '';\n            }\n            else {\n                css = isBlack ? 'color:black;' : 'color:#eee;';\n            }\n            var position = util_1.getRangePosition(note, range);\n            if (position < 0 || position > 1) {\n                if (active || idle || added) {\n                    css += 'color:red;';\n                    sign = ' ';\n                }\n                else {\n                    sign = ' ';\n                }\n            }\n            return {\n                sign: sign,\n                css: css\n            };\n        });\n        var args = [\n            keyboard.map(function (key) { return \"%c\" + key.sign; }).join('')\n        ].concat((keyboard.map(function (key) { return key.css + \";\"; })));\n        /* Snippet.logCustom(args); */\n        return args;\n    };\n    Logger.logVoicing = function (_a) {\n        var chord = _a.chord, previousVoicing = _a.previousVoicing, logIdle = _a.logIdle, combinations = _a.combinations, bestPick = _a.bestPick, pick = _a.pick, range = _a.range, choice = _a.choice, direction = _a.direction, choices = _a.choices;\n        /* pick = pick.map(n => Note.simplify(n)); */\n        pick = pick || [];\n        previousVoicing = previousVoicing || [];\n        var idle = previousVoicing.filter(function (n) { return pick.find(function (p) { return Harmony_1.Harmony.hasSamePitch(n, p); }); });\n        var isIdle = choice && choice.oblique.length === choice.targets.length;\n        if (isIdle && !logIdle) {\n            return;\n        }\n        var active = pick.filter(function (n) { return !previousVoicing.find(function (p) { return Harmony_1.Harmony.hasSamePitch(n, p); }); });\n        var added = choice ? choice.added : [];\n        var degrees = util_1.getStepsInChord(pick, chord, true)\n            .map(function (step) { return util_1.getDegreeFromStep(step); })\n            .map(function (step) { return step === 8 ? 1 : step; });\n        var konsole = Logger.logNotes({ notes: pick, active: active, idle: idle, added: added, range: range, labels: degrees });\n        var movement = choice ? choice.movement : 0;\n        var difference = choice ? choice.difference : 0;\n        choices = choices || [];\n        if (movement > 0) {\n            konsole.push(Logger.emoji.movedUp.icon);\n        }\n        else if (movement < 0) {\n            konsole.push(Logger.emoji.movedDown.icon);\n        }\n        else {\n            konsole.push(Logger.emoji.equilibrium.icon);\n        }\n        if (!pick.length) {\n            konsole.push(Logger.emoji.error.icon);\n        }\n        // TODO replace force with filter of choices after isInRange\n        //      isInRange: checks if top and bottom note are inside the range\n        if (!direction) {\n            konsole.push(Logger.emoji.bestMatch.icon);\n        }\n        else {\n            if (bestPick !== pick) {\n                konsole.push(Logger.emoji.force.icon);\n            }\n            else {\n                konsole.push(Logger.emoji.lucky.icon);\n            }\n            // wrong direction?\n            if ((direction === 'up' && movement < 0) || (direction === 'down' && movement > 0)) {\n                konsole.push(Logger.emoji.wrong.icon);\n            }\n        }\n        if (choice) {\n            if (choice.similar) {\n                konsole.push(Logger.emoji.similar.icon);\n            }\n            if (choice.contrary) {\n                konsole.push(Logger.emoji.contrary.icon);\n            }\n            if (choice.parallel) {\n                konsole.push(Logger.emoji.parallel.icon);\n            }\n            if (choice.added.length && choice.added[choice.added.length - 1] === choice.topNotes[1]) {\n                konsole.push(Logger.emoji.topAdded.icon);\n            }\n            if (choice.dropped.length && choice.dropped[choice.dropped.length - 1] === choice.topNotes[0]) {\n                konsole.push(Logger.emoji.topRemoved.icon);\n            }\n            if (choice.dropped.length && choice.dropped[0] === choice.origin[0]) {\n                konsole.push(Logger.emoji.bottomRemoved.icon);\n            }\n            if (choice.added.length && choice.added[0] === choice.targets[0]) {\n                konsole.push(Logger.emoji.bottomAdded.icon);\n            }\n            if (!Voicing_1.Voicing.hasTonic(pick, chord)) {\n                konsole.push(Logger.emoji.rootless.icon);\n            }\n            if (!choice.parallel && choice.oblique.length === 0) {\n                konsole.push(Logger.emoji.noOblique.icon);\n            }\n            if (isIdle) {\n                konsole.push(Logger.emoji.noChange.icon);\n            }\n        }\n        if (choices.length) {\n            if (choices.length < pick.length) {\n                konsole.push(Logger.emoji.fewChoices.icon);\n            }\n        }\n        konsole.push(\"\" + chord);\n        if (console && console.table) {\n            Logger.logCustom(konsole, console.groupCollapsed);\n            console.log(previousVoicing.join(' ') + \" > \" + pick.join(' ') + \" (\" + (choices.indexOf(choice) + 1) + \". choice of \" + choices.length + \")\");\n            previousVoicing = previousVoicing || [];\n            if (choice) {\n                console.group('Choice:');\n                Logger.logChoice(choice);\n                console.groupEnd();\n                console.groupCollapsed('All Choices:');\n                choices.forEach(function (c) { return Logger.logChoice(c); });\n                console.groupEnd();\n                console.groupCollapsed('Combinations:');\n                console.log(combinations);\n                console.groupEnd();\n            }\n            console.groupEnd();\n        }\n        //console.log(`${ Snippet.voicing(voicing, ['G2', 'C5']) } ${ chord }: ${ voicing.join(' ') } `);\n        //console.log(`#${ event.path[1] + 1 }: ${ chord }: ${ latest } > ${ voicing }.moved ${ moves } (avg | ${ avgDiff } | total ${ totalMoves })`);\n        // console.log(chord, voicing);\n        // G#o7 2 (5.25) (4)[\"G3\", \"D4\", \"F4\", \"Bb4\"] > (4)[\"B2\", \"D3\", \"E#3\", \"G#3\"]\n        /* } */\n        return pick;\n    };\n    Logger.emoji = {\n        bestMatch: {\n            icon: '',\n            description: 'The selected voicing had the best possible voice leading from the previous voicing'\n        },\n        force: {\n            icon: '',\n            description: 'Voicing had to be forced in the desired direction. The best pick would have gone in the wrong direction.'\n        },\n        lucky: {\n            icon: '',\n            description: 'The best pick moved in the direction that would have been forced.'\n        },\n        wrong: {\n            icon: '',\n            description: 'Continued moving in the wrong direction'\n        },\n        similar: {\n            icon: '',\n            description: 'All voices are moving in the same direction'\n        },\n        parallel: {\n            icon: '',\n            description: 'All voices are moving by parallel intervals'\n        },\n        contrary: {\n            icon: '',\n            description: 'Some voices were moving in opposite directions'\n        },\n        noOblique: {\n            icon: '',\n            description: 'All voices changed position. (Not shown when parallel)'\n        },\n        noChange: {\n            icon: '',\n            description: 'All voices remained in position.'\n        },\n        topAdded: {\n            icon: '',\n            description: 'A top voice was added',\n        },\n        topRemoved: {\n            icon: '',\n            description: 'A top voice was dropped'\n        },\n        bottomRemoved: {\n            icon: '',\n            description: 'A bottom voice was dropped'\n        },\n        bottomAdded: {\n            icon: '',\n            description: 'A bottom note was added'\n        },\n        movedUp: {\n            icon: '',\n            description: 'The Voices generally moved up'\n        },\n        movedDown: {\n            icon: '',\n            description: 'The Voices generally moved down'\n        },\n        equilibrium: {\n            icon: '',\n            description: 'The Voices generally did not move anywhere'\n        },\n        fewChoices: {\n            icon: '',\n            description: 'There were very few valid combinations to choose from'\n        },\n        error: {\n            icon: '',\n            description: 'No notes could be selected. Some error happened.'\n        },\n        rootless: {\n            icon: '',\n            description: 'The voicing does not contain its root note (tonic).'\n        }\n        // \n    };\n    return Logger;\n}());\nexports.Logger = Logger;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Pulse_1 = require(\"./Pulse\");\nvar Sheet_1 = require(\"./sheet/Sheet\");\nvar Metronome_1 = require(\"./Metronome\");\nvar Logger_1 = require(\"./util/Logger\");\nvar Snippet_1 = require(\"./sheet/Snippet\");\n/** Band */\nvar Band = /** @class */ (function () {\n    function Band(_a) {\n        var _b = _a === void 0 ? {} : _a, context = _b.context, musicians = _b.musicians, onMeasure = _b.onMeasure;\n        this.defaults = {\n            cycle: 4,\n            division: 3,\n            transpose: 0,\n            style: 'Medium Swing',\n        };\n        this.context = context || new AudioContext();\n        this.onMeasure = onMeasure;\n        this.musicians = musicians || [];\n        this.mix = this.setupMix(this.context);\n        this.metronome = new Metronome_1.Metronome(this.mix);\n    }\n    Band.prototype.setupMix = function (context) {\n        var mix = context.createGain();\n        mix.gain.value = 0.9;\n        mix.connect(context.destination);\n        return mix;\n    };\n    Band.prototype.addMember = function (musician) {\n        this.musicians = this.musicians.concat(musician);\n    };\n    Band.prototype.ready = function () {\n        return Promise.all([this.resume()].concat(this.musicians.map(function (m) { return m.ready; })));\n    };\n    Band.prototype.resume = function () {\n        var _this = this;\n        return this.context.resume ? this.context.resume().then(function () { return _this.context; }) : Promise.resolve(this.context);\n    };\n    Band.prototype.comp = function (sheet, settings) {\n        if (this.pulse) {\n            this.pulse.stop();\n        }\n        Logger_1.Logger.logLegend();\n        Logger_1.Logger.logSheet(sheet);\n        if (settings.onMeasure) {\n            this.onMeasure = settings.onMeasure;\n        }\n        console.log('sheet', sheet);\n        var measures = Sheet_1.Sheet.render(sheet.chords, settings.render);\n        console.log(Snippet_1.Snippet.from(measures));\n        settings = Object.assign(this.defaults, settings, { context: this.context });\n        this.play(measures, settings);\n    };\n    Band.prototype.play = function (measures, settings) {\n        var _this = this;\n        this.ready().then(function () {\n            _this.pulse = settings.pulse || new Pulse_1.Pulse(settings);\n            return _this.count(_this.pulse, settings.metronome ? null : 0);\n        }).then(function (tick) {\n            /* settings.deadline = tick.deadline; */\n            if (_this.onMeasure) {\n                // TODO: add onChord for setting tonics + circle chroma etc\n                _this.pulse.tickArray(measures.map(function (measure) { return ({ measure: measure }); }), function (tick) { return _this.onMeasure(tick.value.measure, tick); });\n            }\n            measures = measures.map(function (m) { return m.chords ? m.chords : m; });\n            console.log('Band#play', settings);\n            var musicians = (settings.musicians || _this.musicians);\n            if (settings.exact) {\n                musicians = _this.musicians.slice(0, 2);\n            }\n            musicians.forEach(function (musician) { return musician.play({ pulse: _this.pulse, measures: measures, settings: settings }); });\n            _this.pulse.start();\n        });\n    };\n    Band.prototype.count = function (pulse, bars) {\n        if (bars === void 0) { bars = 1; }\n        if (pulse.getMeasureLength() < 1.5) {\n            bars *= 2; //double countin bars when countin would be shorter than 1.5s\n        }\n        return this.metronome.count(pulse, bars);\n    };\n    return Band;\n}());\nexports.default = Band;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Musician = /** @class */ (function () {\n    function Musician(instrument) {\n        this.name = 'Musician';\n        this.gain = 1;\n        if (!instrument) {\n            console.warn('musician has no instrument', this);\n        }\n        this.instrument = instrument;\n        this.ready = this.instrument ? this.instrument.ready : Promise.resolve();\n    }\n    Musician.prototype.play = function (_a) {\n        var pulse = _a.pulse, measures = _a.measures, settings = _a.settings;\n        console.log('play..', pulse, measures, settings);\n    };\n    Musician.prototype.getGain = function (value) {\n        if (value === void 0) { value = 1; }\n        return value * this.gain * this.instrument.gain;\n    };\n    return Musician;\n}());\nexports.Musician = Musician;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nvar off = function () { return util_1.randomElement([0, [0, 0, 2]], [6, 1]); };\nvar eightFour = function () { return util_1.randomElement([[1, 0, 1], 1, [0, 0, 1, 1]], [4, 2, 1]); };\nvar eightOff = function () { return util_1.randomElement([[1, 0, 1], [0, 0, 1]], [4, 1]); };\nvar halfTriplet = function () { return util_1.randomElement([\n    [2, 0],\n    [[2, 0, 2], [0, 2, 0]],\n    [1, 1, 1, 1]\n], [2, 1, 1]); };\nexports.swing = {\n    name: 'Swing',\n    tempo: 130,\n    chords: function (_a) {\n        var measure = _a.measure, settings = _a.settings;\n        var r = Math.random() > 0.5 ? .6 : 0;\n        var t = settings.cycle + \"/\" + measure.length;\n        if (t === '4/1') {\n            return util_1.randomElement([\n                [[1, 0], [0, 0, 7], 0, 0],\n                [1, [0, 0, 2], 0, off()],\n                [[0, 0, 1], 0, 2, 0],\n                [[0, 0, 4], 0, 1, 0],\n                [2, 0, 0, 0],\n                [3, 0, 0, 0],\n                [1, 0, r, off()],\n                [[0, 0, 2], 0, r, 0],\n                [1.5, [0, 0, 2], 0, off()],\n            ]); //, [2, 1, 1]\n        }\n        if (t === '4/2') {\n            return util_1.randomElement([\n                [[1, 0], [0, 0, 7], 0, 0],\n                [1, [0, 0, 3], 0, 0],\n                [1, 0, 2, 0],\n                [2, 0, 1, 0],\n                [1, 0, .7, off()],\n                [[1, 0, 0], 0, .7, off()],\n                [[4, 0, 0], [0, 0, 2.8], 0, off()],\n            ]);\n        }\n        if (t === '4/3') {\n            return util_1.randomElement([\n                [1, [0, 0, 2], [0, 0, 4], 0],\n                [1, [2, 0, 0], 2, 0],\n                [1, 1, 2, 0],\n                [[2, 0, 0], 1, 2, 0],\n                [2, 0, 1, 1]\n            ]);\n        }\n        if ('4/4') {\n            return util_1.randomElement([\n                [1, 1, 1, 1],\n            ]);\n        }\n    },\n    bass: function () { return util_1.randomElement([\n        [1, 1, 1, 1],\n        /* [2, 0, 2, 0] */ \n    ]); },\n    crash: function (_a) {\n        var measures = _a.measures, index = _a.index;\n        var fill = index !== 0 && index % measures.length === 0;\n        if (fill) {\n            return [4, 0, 0, 0];\n        }\n        return [0, 0, 0, 0];\n    },\n    ride: function (_a) {\n        var measures = _a.measures, index = _a.index;\n        return util_1.randomElement([\n            [.6, [.9, 0, 1], .6, [.9, 0, 1]],\n            [.6, [.4, 0, 1], .8, [0, 0, 1],],\n            [.6, .9, [.6, 0, 1], 1],\n            [.6, .9, .6, [.9, 0, 1]],\n        ], [3, 2, 1, 2]);\n    },\n    hihat: function () { return [0, .8, 0, 1]; },\n    solo: function () { return util_1.randomElement([\n        [eightFour(), eightFour(), eightFour(), eightFour()],\n        [eightFour(), 2, 0, eightFour()],\n        [0, 0, eightFour(), eightFour()],\n        [[1, 0, 4], 0, eightFour(), eightFour()],\n        [3, 0, 0, eightFour()],\n        halfTriplet().concat(halfTriplet()),\n        [eightOff(), eightOff(), eightOff(), eightOff()],\n    ]); }\n    /* solo: () => [1, 1, 0, 1] */\n};\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nvar Musician_1 = require(\"./Musician\");\nvar swing_1 = require(\"../grooves/swing\");\nvar Voicing_1 = require(\"../harmony/Voicing\");\nvar tonal_1 = require(\"tonal\");\nvar Pianist = /** @class */ (function (_super) {\n    __extends(Pianist, _super);\n    function Pianist(instrument, props) {\n        if (props === void 0) { props = {}; }\n        var _this = _super.call(this, instrument) || this;\n        _this.name = 'Pianist';\n        _this.playedNotes = [];\n        _this.playedChords = [];\n        _this.defaults = { groove: swing_1.swing };\n        _this.min = Math.min;\n        _this.rollFactor = 1; // how much keyroll effect? controls interval between notes\n        _this.voicingOptions = {};\n        _this.props = Object.assign({}, _this.defaults, props || {});\n        return _this;\n    }\n    Pianist.prototype.play = function (_a) {\n        var _this = this;\n        var pulse = _a.pulse, measures = _a.measures, settings = _a.settings;\n        var groove = settings.groove || this.defaults.groove;\n        var grooveKey = 'chords';\n        this.voicingOptions = __assign({}, this.voicingOptions, settings.voicings || {});\n        // if no groove or groove without chords, or exact, play whats there\n        // TODO: exact timing is false with metronome\n        if (settings.exact || !groove || !groove[grooveKey]) {\n            if (!groove[grooveKey]) {\n                console.warn('Groove has no chords, Pianist will play exact.', groove);\n            }\n            measures = measures\n                .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); });\n            return pulse.tickArray(measures, function (_a) {\n                var value = _a.value, deadline = _a.deadline;\n                var fraction = util_1.getDuration(value.divisions, 1);\n                // TODO: find out why value fraction is NaN\n                var duration = fraction * pulse.getMeasureLength();\n                _this.playChord(value.chord || value, { deadline: deadline, duration: duration, pulse: pulse });\n            });\n        }\n        // else, play groovy\n        var pattern = groove[grooveKey];\n        measures = measures\n            // generate random patterns\n            .map(function (measure) { return pattern({ measures: measures, pulse: pulse, measure: measure, settings: settings })\n            .slice(0, Math.floor(settings.cycle)); })\n            // fill in chords\n            .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); })\n            // fix chords at last offbeat\n            .reduce(util_1.offbeatReducer(settings), []);\n        pulse.tickArray(measures, function (_a) {\n            var path = _a.path, value = _a.value, deadline = _a.deadline;\n            var measureLength = pulse.getMeasureLength();\n            var concurrency = settings.bpm / (_this.rollFactor || 1);\n            var interval = settings.arpeggio ? measureLength / settings.cycle : Math.random() / (concurrency * 20);\n            if (path[0] % 2 === 0 && !path[1] && !path[2]) {\n                interval = Math.random() / concurrency;\n            }\n            var duration = settings.arpeggio ? interval : value.fraction * measureLength;\n            var slice = settings.arpeggio ? Math.ceil(value.fraction / 1000 * 4) : null;\n            var gain = _this.getGain(value.gain);\n            _this.playChord(value.chord, { deadline: deadline, gain: gain, duration: duration, interval: interval, slice: slice, pulse: pulse });\n        }, settings.deadline);\n    };\n    Pianist.prototype.getLastVoicing = function () {\n        return this.playedNotes.length ? this.playedNotes[this.playedNotes.length - 1] : null;\n    };\n    // plays the given notes at the given interval\n    Pianist.prototype.playNotes = function (scorenotes, _a) {\n        var deadline = _a.deadline, interval = _a.interval, gain = _a.gain, duration = _a.duration, pulse = _a.pulse;\n        this.playedNotes.push([].concat(scorenotes));\n        this.instrument.playNotes(scorenotes, { deadline: deadline, interval: interval, gain: gain, duration: duration, pulse: pulse });\n    };\n    Pianist.prototype.playChord = function (chord, settings) {\n        if (chord === 'x') { // repeat\n            chord = this.playedChords[this.playedChords.length - 1];\n        }\n        if (!chord || chord === '0') {\n            this.playedChords.push('');\n            return;\n        }\n        this.playedChords.push(chord);\n        var notes = Voicing_1.Voicing.getNextVoicing(chord, this.getLastVoicing(), settings.voicingOptions || this.voicingOptions);\n        notes = notes.map(function (note) { return tonal_1.Note.simplify(note); });\n        settings.deadline += 0.02 + util_1.randomDelay(5);\n        this.playNotes(notes, settings);\n    };\n    return Pianist;\n}(Musician_1.Musician));\nexports.default = Pianist;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Musician_1 = require(\"./Musician\");\nvar swing_1 = require(\"../grooves/swing\");\nvar util_1 = require(\"../util/util\");\nvar Drummer = /** @class */ (function (_super) {\n    __extends(Drummer, _super);\n    function Drummer(instrument) {\n        var _this = _super.call(this, instrument) || this;\n        _this.name = 'Drummer';\n        _this.set = {\n            kick: 0,\n            snare: 1,\n            hihat: 2,\n            ride: 3,\n            crash: 4,\n            rimshot: 5\n        };\n        _this.defaults = { groove: swing_1.swing };\n        return _this;\n    }\n    Drummer.prototype.play = function (_a) {\n        var _this = this;\n        var measures = _a.measures, pulse = _a.pulse, settings = _a.settings;\n        var groove = settings.groove || this.defaults.groove;\n        Object.keys(groove)\n            .filter(function (t) { return Object.keys(_this.set).includes(t); }) // only use drum set patterns\n            .forEach(function (key) {\n            var patterns = measures\n                .map(function (measure, index) { return groove[key]({ measures: measures, index: index, measure: measure, settings: settings, pulse: pulse })\n                .slice(0, Math.floor(settings.cycle)); });\n            pulse.tickArray(patterns, function (_a) {\n                var deadline = _a.deadline, value = _a.value;\n                deadline += util_1.randomDelay(5);\n                _this.instrument.playKeys([_this.set[key]], { deadline: deadline, gain: _this.getGain(value) });\n            }, settings.deadline);\n        });\n    };\n    return Drummer;\n}(Musician_1.Musician));\nexports.default = Drummer;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nvar Musician_1 = require(\"./Musician\");\nvar tonal_1 = require(\"tonal\");\nvar swing_1 = require(\"../grooves/swing\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nvar Bassist = /** @class */ (function (_super) {\n    __extends(Bassist, _super);\n    function Bassist(instrument) {\n        var _this = _super.call(this, instrument) || this;\n        _this.name = 'Bassist';\n        _this.defaults = { groove: swing_1.swing };\n        _this.playedChords = [];\n        return _this;\n    }\n    Bassist.prototype.play = function (_a) {\n        var _this = this;\n        var measures = _a.measures, pulse = _a.pulse, settings = _a.settings;\n        var groove = settings.groove || this.defaults.groove;\n        var pattern = groove['bass'];\n        if (!pattern) {\n            console.warn('no bass pattern found in groove', groove);\n            return;\n        }\n        measures = measures\n            .map(function (measure) {\n            /* if (Array.isArray(measure)) {\n                return measure;\n            } */\n            return pattern({ measures: measures, measure: measure, settings: settings, pulse: pulse }).slice(0, Math.floor(settings.cycle));\n        })\n            .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); });\n        pulse.tickArray(measures, function (tick) {\n            _this.playBass(tick, measures, pulse);\n        }, settings.deadline);\n    };\n    Bassist.prototype.getStep = function (step, chord, octave) {\n        if (octave === void 0) { octave = 2; }\n        var tokens = tonal_1.Chord.tokenize(Harmony_1.Harmony.getTonalChord(chord));\n        var interval = tonal_1.Chord.intervals(tokens[1]).find(function (i) { return parseInt(i[0]) === step; });\n        return tonal_1.Distance.transpose(tokens[0] + octave, interval);\n    };\n    Bassist.prototype.playBass = function (_a, measures, pulse) {\n        var value = _a.value, cycle = _a.cycle, path = _a.path, deadline = _a.deadline, interval = _a.interval, duration = _a.duration;\n        var chord = value.chord;\n        if (chord === 'N.C.') {\n            return;\n        }\n        if (chord === 'x') {\n            chord = this.playedChords[this.playedChords.length - 1];\n        }\n        if (!chord || chord === '0') {\n            this.playedChords.push('');\n            return;\n        }\n        this.playedChords.push(chord);\n        var note;\n        /* const steps = [1, randomElement([3, 5]), 1, randomElement([3, 5])]; */\n        var steps = [1, 5, 1, util_1.randomElement([3, 5])];\n        var octave = 2;\n        if (steps[path[1]] === 1) {\n            note = Harmony_1.Harmony.getBassNote(chord) + octave;\n        }\n        else {\n            note = this.getStep(steps[path[1]], Harmony_1.Harmony.getTonalChord(chord), octave);\n        }\n        duration = duration || value.fraction * pulse.getMeasureLength();\n        deadline += util_1.randomDelay(10);\n        this.instrument.playNotes([note], { deadline: deadline, interval: interval, gain: this.getGain() * .7, duration: duration, pulse: pulse });\n    };\n    return Bassist;\n}(Musician_1.Musician));\nexports.default = Bassist;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Instrument_1 = require(\"./Instrument\");\nvar util_1 = require(\"../util/util\");\nvar Sampler = /** @class */ (function (_super) {\n    __extends(Sampler, _super);\n    function Sampler(options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, options) || this;\n        _this.buffers = {};\n        _this.duration = 10000;\n        _this.type = 'sine';\n        _this.gain = 1;\n        _this.attack = 0;\n        _this.decay = 0;\n        _this.sustain = 1;\n        _this.release = .2;\n        _this.gain = options.gain || _this.gain;\n        _this.gainNode = _this.context.createGain();\n        _this.gainNode.connect(_this.context.destination);\n        _this.duration = options.duration || _this.duration;\n        // this.overlap = options.overlap;\n        if (options.samples) {\n            _this.sources = options.samples;\n            _this.ready = _this.loadSources(options.samples);\n        }\n        return _this;\n    }\n    // returns buffer from buffer cache or loads buffer data from source\n    Sampler.prototype.getBuffer = function (src, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        if (this.buffers[src] && this.buffers[src].context === context) {\n            // console.log('buffer already present');\n            return Promise.resolve(this.buffers[src].buffer);\n        }\n        return fetch(src)\n            .then(function (res) { return res.arrayBuffer(); })\n            .then(function (buffer) {\n            return new Promise(function (resolve, reject) {\n                context.decodeAudioData(buffer, function (decodedData) {\n                    _this.buffers[src] = { buffer: decodedData, context: context };\n                    resolve(decodedData);\n                });\n            });\n        });\n    };\n    Sampler.prototype.getSource = function (buffer, connect) {\n        var source = this.context.createBufferSource();\n        connect = connect || this.gainNode;\n        source.buffer = buffer;\n        source.connect(connect);\n        return source;\n    };\n    Sampler.prototype.getSources = function (sources, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        if (!this.hasLoaded(sources)) {\n            console.error('not all sources loaded!!!');\n            return [];\n        }\n        return sources.map(function (source) { return _this.getSource(_this.buffers[source].buffer); });\n    };\n    // loads a sound file into the context\n    Sampler.prototype.loadSource = function (src, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        return this.getBuffer(src, context)\n            .then(function (decodedData) { return _this.getSource(decodedData); });\n    };\n    // loads multiple sources into the context\n    Sampler.prototype.loadSources = function (sources, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        sources.forEach(function (source, i) {\n            if (!source) {\n                console.warn(\"note at index \" + i + \" cannot be played!\");\n            }\n        });\n        return Promise.all(sources.filter(function (source) { return !!source; }).map(function (source) { return _this.loadSource(source, context); }));\n    };\n    Sampler.prototype.hasLoaded = function (sources, context) {\n        var _this = this;\n        if (context === void 0) { context = this.context; }\n        return sources.reduce(function (allLoaded, src) {\n            return allLoaded && _this.buffers[src] && _this.buffers[src].context === context;\n        }, true);\n    };\n    Sampler.prototype.playSounds = function (sounds, deadline, interval) {\n        if (deadline === void 0) { deadline = this.context.currentTime; }\n        if (interval === void 0) { interval = 0; }\n        sounds.forEach(function (sound, i) { return sound.start(deadline + interval * i); });\n    };\n    Sampler.prototype.playSource = function (source, settings) {\n        var gainNode = this.context.createGain();\n        if (!this.buffers[source]) {\n            console.warn('no buffer found for source', source);\n            return;\n        }\n        var sound = this.getSource(this.buffers[source].buffer, gainNode);\n        var _a = [\n            settings.attack || this.attack,\n            settings.decay || this.decay,\n            settings.sustain || this.sustain,\n            settings.release || this.release,\n            (settings.duration || this.duration) / 1000,\n            (settings.gain || 1) * this.gain\n        ], attack = _a[0], decay = _a[1], sustain = _a[2], release = _a[3], duration = _a[4], gain = _a[5];\n        var time = settings.deadline || this.context.currentTime;\n        //gainNode.gain.value = typeof settings.gain === 'number' ? settings.gain : this.gain;\n        gainNode.connect(this.mix);\n        util_1.adsr({ attack: attack, decay: decay, sustain: sustain, release: release, gain: gain, duration: duration }, time, gainNode.gain);\n        this.playSounds([sound], time); //, settings.interval\n    };\n    /* playSources(sources, deadline = 0, interval = 0) {\n        if (this.hasLoaded(sources, this.context)) {\n            this.playSounds(this.getSources(sources, this.context), deadline, interval)\n        } else {\n            console.warn('need to load');\n            this.loadSources(sources, this.context)\n                .then(sounds => this.playSounds(sounds, deadline, interval));\n        }\n    } */\n    Sampler.prototype.playKeys = function (keys, settings) {\n        var _this = this;\n        _super.prototype.playKeys.call(this, keys, settings);\n        keys.forEach(function (key, index) {\n            if (settings.delay) {\n                settings.deadline += settings.delay;\n            }\n            _this.playSource(_this.sources[key], settings);\n        });\n    };\n    return Sampler;\n}(Instrument_1.Instrument));\nexports.Sampler = Sampler;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Kick = /** @class */ (function () {\n    function Kick(context) {\n        this.context = context;\n    }\n    Kick.prototype.setup = function () {\n        this.osc = this.context.createOscillator();\n        this.gain = this.context.createGain();\n        this.osc.connect(this.gain);\n        this.gain.connect(this.context.destination);\n    };\n    Kick.prototype.trigger = function (time) {\n        this.setup();\n        this.osc.frequency.setValueAtTime(150, time);\n        this.gain.gain.setValueAtTime(1, time);\n        this.osc.frequency.exponentialRampToValueAtTime(0.01, time + 0.5);\n        this.gain.gain.exponentialRampToValueAtTime(0.01, time + 0.5);\n        this.osc.start(time);\n        this.osc.stop(time + 0.5);\n    };\n    return Kick;\n}());\nexports.Kick = Kick;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Snare = /** @class */ (function () {\n    function Snare(context) {\n        this.context = context;\n    }\n    Snare.prototype.noiseBuffer = function () {\n        var bufferSize = this.context.sampleRate;\n        var buffer = this.context.createBuffer(1, bufferSize, this.context.sampleRate);\n        var output = buffer.getChannelData(0);\n        for (var i = 0; i < bufferSize; i++) {\n            output[i] = Math.random() * 2 - 1;\n        }\n        return buffer;\n    };\n    Snare.prototype.setup = function () {\n        this.noise = this.context.createBufferSource();\n        this.noise.buffer = this.noiseBuffer();\n        var noiseFilter = this.context.createBiquadFilter();\n        noiseFilter.type = 'highpass';\n        noiseFilter.frequency.value = 1000;\n        this.noise.connect(noiseFilter);\n        this.noiseEnvelope = this.context.createGain();\n        noiseFilter.connect(this.noiseEnvelope);\n        this.noiseEnvelope.connect(this.context.destination);\n        this.osc = this.context.createOscillator();\n        this.osc.type = 'triangle';\n        this.oscEnvelope = this.context.createGain();\n        this.osc.connect(this.oscEnvelope);\n        this.oscEnvelope.connect(this.context.destination);\n    };\n    ;\n    Snare.prototype.trigger = function (time) {\n        this.setup();\n        this.noiseEnvelope.gain.setValueAtTime(1, time);\n        this.noiseEnvelope.gain.exponentialRampToValueAtTime(0.01, time + 0.2);\n        this.noise.start(time);\n        this.osc.frequency.setValueAtTime(100, time);\n        this.oscEnvelope.gain.setValueAtTime(0.7, time);\n        this.oscEnvelope.gain.exponentialRampToValueAtTime(0.01, time + 0.1);\n        this.osc.start(time);\n        this.osc.stop(time + 0.2);\n        this.noise.stop(time + 0.2);\n    };\n    ;\n    return Snare;\n}());\nexports.Snare = Snare;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Instrument_1 = require(\"./Instrument\");\nvar Kick_1 = require(\"./Kick\");\nvar Snare_1 = require(\"./Snare\");\nvar PlasticDrums = /** @class */ (function (_super) {\n    __extends(PlasticDrums, _super);\n    function PlasticDrums(options) {\n        var _this = _super.call(this, options) || this;\n        _this.keys = [\n            new Kick_1.Kick(_this.context),\n            new Snare_1.Snare(_this.context)\n        ];\n        return _this;\n    }\n    PlasticDrums.prototype.playKeys = function (keys, _a) {\n        var _this = this;\n        var deadline = _a.deadline, gain = _a.gain, value = _a.value;\n        var sounds = keys.filter(function (key) { return !!_this.keys[key]; }).map(function (key) { return _this.keys[key]; });\n        if (sounds.length < keys.length) {\n            var missing = keys.filter(function (key) { return !_this.keys[key]; });\n            // console.warn('PlasticDrums missing keys:', missing);\n        }\n        sounds.forEach(function (sound) { return sound.trigger(deadline); });\n    };\n    return PlasticDrums;\n}(Instrument_1.Instrument));\nexports.PlasticDrums = PlasticDrums;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Improvisation = /** @class */ (function () {\n    function Improvisation(rules) {\n        this.rules = rules;\n        this.cache = {};\n    }\n    Improvisation.prototype.get = function (key, fromCache) {\n        if (fromCache === void 0) { fromCache = false; }\n        if (fromCache) {\n            return this.cache[key];\n        }\n        var rule = this.rules[key];\n        if (rule === undefined) {\n            console.error('could not resolve key', key, '!');\n        }\n        if (typeof rule === 'function') {\n            rule = rule(this.getRuleFactories(key));\n        }\n        this.cache[key] = rule;\n        return rule;\n    };\n    Improvisation.prototype.enhance = function (rules) {\n        return new Improvisation(Object.assign({}, this.rules, rules));\n    };\n    Improvisation.prototype.mutate = function (reducer) {\n        this.rules = Object.assign({}, this.rules, reducer(this.getRuleFactories()));\n        return this;\n    };\n    Improvisation.prototype.getRuleFactories = function (originKey) {\n        var _this = this;\n        return Object.keys(this.rules)\n            .map(function (key) { return ({ key: key, factory: function () { return _this.get(key); } }); })\n            .reduce(function (factories, _a) {\n            var key = _a.key, factory = _a.factory;\n            var _b, _c;\n            return (Object.assign({}, factories, (_b = {}, _b[key] = factory, _b), (originKey ? (_c = {}, _c[originKey] = function () { return _this.cache[originKey]; }, _c) : {})));\n        }, {});\n    };\n    return Improvisation;\n}());\nexports.Improvisation = Improvisation;\n/**\n *\n * methods: { [method: string]: ImprovisationRules } = {\n        guideTones: {\n            pattern: [3, 7]\n        },\n        flippedGuideTones: {\n            pattern: [3, 7],\n            flip: true,\n        },\n        chordTones: {\n            pattern: [1, 3, 7],\n            variance: .5,\n            variety: .5,\n            drill: .5,\n            flip: ({ drill }) => Math.random() * Math.abs(drill()) > .5,\n        }\n    }\n */ \n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar swing_1 = require(\"../grooves/swing\");\nvar tonal_1 = require(\"tonal\");\nvar util_1 = require(\"../util/util\");\nvar Improvisation_1 = require(\"./Improvisation\");\nvar Harmony_1 = require(\"../harmony/Harmony\");\nexports.permutator = new Improvisation_1.Improvisation({\n    groove: swing_1.swing,\n    groovePattern: function (_a) {\n        var groove = _a.groove;\n        return groove()['solo'] || (function (m) {\n            return m.measure.map(function () { return [1]; });\n        });\n    },\n    octave: 4,\n    reach: 1,\n    lineBreaks: false,\n    direction: null,\n    force: false,\n    flip: false,\n    playedNotes: [],\n    fixRange: true,\n    startRandom: false,\n    range: ['Bb3', 'Bb5'],\n    /* chanceCurve: () => (distance, length) => (length - distance) * 10, */\n    firstNoteInPattern: function (_a) {\n        var pattern = _a.pattern, chord = _a.chord;\n        return util_1.getPatternInChord([pattern()[0]], chord());\n    },\n    firstNote: function (_a) {\n        var randomNote = _a.randomNote, firstNoteInPattern = _a.firstNoteInPattern, startRandom = _a.startRandom, octave = _a.octave;\n        return startRandom() ? randomNote() : firstNoteInPattern() + octave();\n    },\n    lastNote: function (_a) {\n        var playedNotes = _a.playedNotes;\n        return playedNotes().length ? playedNotes()[0] : null;\n    },\n    material: function (_a) {\n        var pattern = _a.pattern, chord = _a.chord;\n        return util_1.getPatternInChord(pattern(), chord());\n    },\n    randomNote: function (_a) {\n        var material = _a.material, octave = _a.octave;\n        return util_1.randomElement(material()) + octave();\n    },\n    nextNotes: function (_a) {\n        var fixRange = _a.fixRange, firstNote = _a.firstNote, chord = _a.chord, reach = _a.reach, lineBreaks = _a.lineBreaks, lastNote = _a.lastNote, range = _a.range, material = _a.material, direction = _a.direction, force = _a.force, flip = _a.flip;\n        var note;\n        if (!lastNote() || lineBreaks()) {\n            note = firstNote();\n        }\n        else {\n            var choices = material();\n            if (!choices.length) {\n                console.warn('no choice..');\n                return;\n            }\n            var targets = Harmony_1.Harmony.getNearestTargets(lastNote(), material(), direction(), flip());\n            targets = targets.slice(0, reach());\n            note = util_1.randomElement(targets);\n            note = tonal_1.Note.simplify(note, true);\n        }\n        if (fixRange()) {\n            note = util_1.transposeToRange([note], range())[0];\n        }\n        var step = util_1.getStepInChord(note, chord());\n        /* console.log(`${step} in ${chord()} = ${note}`); */\n        return [note];\n    }\n});\n/** MODIFIERS */\nvar getStraightBar = function (notes, cycle) {\n    if (cycle === void 0) { cycle = 4; }\n    return new Array(cycle).fill(new Array(Math.ceil(notes / cycle)).fill(1));\n};\nvar straightNotes = function (n, cycle) {\n    if (cycle === void 0) { cycle = 4; }\n    return ({\n        groove: null,\n        groovePattern: function () { return (function (m) {\n            return getStraightBar(n, cycle);\n        }); },\n    });\n};\nvar fixedNotesPerChord = function (n, cycle) {\n    if (cycle === void 0) { cycle = 4; }\n    return ({\n        groove: null,\n        groovePattern: function () { return (function (m) { return m.measure.map(function () {\n            return getStraightBar(n, cycle);\n        }); }); },\n    });\n};\nvar pendulum = function (defaultDirection, softForce, comfort) {\n    if (defaultDirection === void 0) { defaultDirection = 'up'; }\n    if (softForce === void 0) { softForce = false; }\n    if (comfort === void 0) { comfort = .4; }\n    return ({\n        exclude: 1,\n        force: !softForce ? true : function (_a) {\n            var lastNote = _a.lastNote, range = _a.range;\n            var position = util_1.getRangePosition(lastNote(), range());\n            return position < 0 || position > 1; // only force if out of range..    \n        },\n        fixRange: false,\n        direction: function (_a) {\n            var lastNote = _a.lastNote, range = _a.range, direction = _a.direction, barNumber = _a.barNumber, isBarStart = _a.isBarStart;\n            var position = util_1.getRangePosition(lastNote(), range());\n            var comfortSwitchBars = 1; // switch direction each x bars when in comfort zone\n            var isComfortZone = (position > comfort && position < 1 - comfort);\n            if ((position <= 0 && direction() === 'down') ||\n                (position >= 1 && direction() === 'up') ||\n                (isComfortZone && isBarStart() && barNumber() % comfortSwitchBars === 0)) {\n                /* console.log('change direction', otherDirection(direction(), defaultDirection)); */\n                return util_1.otherDirection(direction(), defaultDirection);\n            }\n            return direction() || defaultDirection;\n        }\n    });\n};\nvar beatPattern = function (_a) {\n    var pattern = _a.pattern, on = _a.on, off = _a.off, barStart = _a.barStart;\n    return ({\n        beatPattern: function (_a) {\n            var isBarStart = _a.isBarStart, isOffbeat = _a.isOffbeat;\n            if (isBarStart()) {\n                return barStart || on || pattern;\n            }\n            else if (!isOffbeat()) {\n                return on || pattern;\n            }\n            return off || pattern;\n        },\n        pattern: function (_a) {\n            var beatPattern = _a.beatPattern;\n            return beatPattern();\n        },\n    });\n};\nvar notesPerChord = function (n) { return (__assign({}, fixedNotesPerChord(1, n))); };\nvar patternPractise = function (direction, notes, lineBreaks) {\n    if (direction === void 0) { direction = 'up'; }\n    if (notes === void 0) { notes = 4; }\n    if (lineBreaks === void 0) { lineBreaks = false; }\n    return (__assign({}, straightNotes(notes), { firstNoteInPattern: function (_a) {\n            var pattern = _a.pattern, chord = _a.chord;\n            return util_1.getPatternInChord(direction === 'up' ? [pattern()[0]] : pattern().slice(-1), chord());\n        }, direction: direction, force: true, fixRange: false, lineBreaks: function (_a) {\n            var isBarStart = _a.isBarStart;\n            return lineBreaks ? isBarStart() : false;\n        }, exclude: 1, reach: 1 }));\n};\n/** FORMULAS */\nexports.advancedPermutator = exports.permutator.enhance({\n    drill: .5,\n    direction: function (_a) {\n        var drill = _a.drill;\n        return drill() > 0 ? 'up' : 'down';\n    },\n    force: function (_a) {\n        var drill = _a.drill;\n        return Math.random() * Math.abs(drill()) > .5;\n    },\n    exclude: 1,\n    reach: 1,\n    material: function (_a) {\n        var pattern = _a.pattern, chord = _a.chord, playedNotes = _a.playedNotes, exclude = _a.exclude;\n        var all = util_1.getPatternInChord(pattern(), chord());\n        if (!playedNotes().length) {\n            return all;\n        }\n        var excludeNotes = playedNotes()\n            .slice(0, exclude())\n            .map(function (n) { return tonal_1.Note.pc(n); });\n        return all.filter(function (n) { return !excludeNotes.includes(n); });\n    }\n});\nexports.guideTones = exports.advancedPermutator.enhance(__assign({ name: 'Guide Lines' }, notesPerChord(1), pendulum('down', true), { pattern: [3, 7], exclude: 0 }));\nexports.guideTonesFlipped = exports.guideTones.enhance({\n    name: 'Distant Guide Tones',\n    flip: true\n});\nexports.chordTones = exports.advancedPermutator.enhance({\n    name: 'Only Chord Tones',\n    pattern: [1, 3, 5, 7],\n    drill: .75,\n    direction: function (_a) {\n        var drill = _a.drill;\n        return drill() > 0 ? 'up' : 'down';\n    },\n});\n/* export const digitalPattern = advancedPermutator.enhance({\n    pattern: ({ chord }) => getDigitalPattern(chord()),\n    ...pendulum(),\n    ...straightNotes(4)\n}); */\nexports.fullScale = exports.advancedPermutator.enhance(__assign({ name: 'Heptatonic' }, beatPattern({ on: [1, 3, 5, 7], off: [1, 2, 3, 4, 5, 6, 7] }), pendulum()));\nexports.scalePendulum = exports.advancedPermutator.enhance(__assign({ name: 'Heptatonic Pendulum' }, beatPattern({ pattern: [1, 2, 3, 4, 5, 6, 7] }), pendulum(), straightNotes(8)));\nexports.digitalPattern = exports.advancedPermutator.enhance(__assign({ name: 'Digital Patterns', pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }, pendulum('up', true, .2), { exclude: 2, reach: 3 }));\nexports.digitalPendulum = exports.advancedPermutator.enhance(__assign({ name: 'Digital Pendulum', pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }, pendulum('up', false, 1), straightNotes(8), { \n    /* lineBreaks: ({ isBarStart }) => isBarStart(), */\n    exclude: 1, reach: 1 }));\nexports.digitalWalker = exports.advancedPermutator.enhance(__assign({ name: 'Digital Fourths', pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }, pendulum('up', true, .4), straightNotes(4), { lineBreaks: false, \n    /* lineBreaks: ({ isBarStart }) => isBarStart(), */\n    exclude: 2, reach: 2 }));\nexports.digitalPractiseUp = exports.advancedPermutator.enhance(__assign({ name: 'Digital Practise Up' }, patternPractise('up', 4, true), { pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }));\nexports.digitalPractiseDown = exports.advancedPermutator.enhance(__assign({ name: 'Digital Practise Down' }, patternPractise('down', 4, true), { pattern: function (_a) {\n        var chord = _a.chord;\n        return util_1.getDigitalPattern(chord());\n    } }));\nexports.heptatonicPractise = exports.advancedPermutator.enhance(__assign({ name: 'Heptatonic Practise' }, patternPractise('up', 8, false), beatPattern({ barStart: [1], on: [3, 5, 7], off: [1, 2, 3, 4, 5, 6, 7] })));\nexports.defaultMethod = exports.guideTones;\nexports.improvisationMethods = {\n    guideTones: exports.guideTones,\n    guideTonesFlipped: exports.guideTonesFlipped,\n    chordTones: exports.chordTones,\n    digitalPattern: exports.digitalPattern,\n    digitalPendulum: exports.digitalPendulum,\n    digitalWalker: exports.digitalWalker,\n    fullScale: exports.fullScale,\n    scalePendulum: exports.scalePendulum,\n    digitalPractiseUp: exports.digitalPractiseUp,\n    digitalPractiseDown: exports.digitalPractiseDown,\n};\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar swing_1 = require(\"../grooves/swing\");\nvar methods_1 = require(\"../improvisation/methods\");\nvar util_1 = require(\"../util/util\");\nvar Musician_1 = require(\"./Musician\");\nvar Improvisor = /** @class */ (function (_super) {\n    __extends(Improvisor, _super);\n    function Improvisor(instrument, method) {\n        var _this = _super.call(this, instrument) || this;\n        _this.name = 'Improvisor';\n        _this.defaultMethod = methods_1.defaultMethod;\n        method = method || _this.defaultMethod;\n        _this.method = method /* .enhance({\n            range: ['F3', 'F5']\n        }) */;\n        return _this;\n    }\n    Improvisor.prototype.useMethod = function (method) {\n        this.method = method;\n    };\n    Improvisor.prototype.play = function (_a) {\n        var _this = this;\n        var measures = _a.measures, pulse = _a.pulse, settings = _a.settings;\n        if (settings.method) {\n            this.useMethod(settings.method);\n        }\n        var groove = settings.groove || swing_1.swing;\n        this.method.mutate(function () { return ({ groove: groove, playedNotes: [] }); });\n        var pattern = this.method.get('groovePattern');\n        measures = measures\n            .map(function (measure) { return pattern({ measures: measures, measure: measure, settings: settings, pulse: pulse }); }\n        /*     .slice(0, Math.floor(settings.cycle)) */\n        )\n            .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); });\n        pulse.tickArray(measures, function (tick) {\n            _this.improvise(tick, measures, pulse);\n        }, settings.deadline);\n    };\n    Improvisor.prototype.improvise = function (_a, measures, pulse) {\n        var _this = this;\n        var value = _a.value, deadline = _a.deadline, interval = _a.interval;\n        var chord = value.chord;\n        if (chord === 'N.C.') {\n            return;\n        }\n        this.method.mutate(function () { return ({\n            chord: chord,\n            isFormStart: util_1.isFormStart(value.path),\n            isBarStart: util_1.isBarStart(value.path),\n            isOffbeat: util_1.isOffbeat(value.path),\n            // TODO: is ChordStart\n            barNumber: value.path[0]\n        }); })\n            .mutate(function (_a) {\n            var nextNotes = _a.nextNotes, playedNotes = _a.playedNotes;\n            var pick = nextNotes();\n            var duration = value.fraction * pulse.getMeasureLength();\n            _this.instrument.playNotes(pick, { deadline: deadline, interval: interval, gain: _this.getGain(), duration: duration, pulse: pulse });\n            return {\n                playedNotes: [].concat(pick, playedNotes())\n            };\n        });\n    };\n    return Improvisor;\n}(Musician_1.Musician));\nexports.default = Improvisor;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"./util/util\");\nvar Band_1 = __importDefault(require(\"./Band\"));\nvar Pianist_1 = __importDefault(require(\"./musicians/Pianist\"));\nvar Bassist_1 = __importDefault(require(\"./musicians/Bassist\"));\nvar Drummer_1 = __importDefault(require(\"./musicians/Drummer\"));\nvar PlasticDrums_1 = require(\"./instruments/PlasticDrums\");\nvar Improvisor_1 = __importDefault(require(\"./musicians/Improvisor\"));\nvar Trio = /** @class */ (function (_super) {\n    __extends(Trio, _super);\n    function Trio(_a) {\n        var context = _a.context, piano = _a.piano, bass = _a.bass, drums = _a.drums, onMeasure = _a.onMeasure, solo = _a.solo;\n        var _this = _super.call(this, { context: context, onMeasure: onMeasure }) || this;\n        var instruments = _this.setupInstruments({ piano: piano, bass: bass, drums: drums });\n        _this.pianist = new Pianist_1.default(instruments.piano);\n        _this.bassist = new Bassist_1.default(instruments.bass);\n        _this.drummer = new Drummer_1.default(instruments.drums);\n        _this.musicians = [_this.pianist, _this.bassist, _this.drummer];\n        if (solo) {\n            // this.soloist = new Permutator(instruments.piano);\n            _this.soloist = new Improvisor_1.default(instruments.piano);\n            _this.musicians.push(_this.soloist);\n        }\n        return _this;\n    }\n    Trio.prototype.setupInstruments = function (_a) {\n        var piano = _a.piano, bass = _a.bass, drums = _a.drums;\n        bass = bass || util_1.randomSynth(this.mix);\n        piano = piano || util_1.randomSynth(this.mix);\n        drums = drums || new PlasticDrums_1.PlasticDrums({ mix: this.mix });\n        return { piano: piano, bass: bass, drums: drums };\n    };\n    return Trio;\n}(Band_1.default));\nexports.Trio = Trio;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Measure_1 = require(\"./Measure\");\n// extension of https://github.com/daumling/ireal-renderer/blob/master/src/ireal-renderer.js\nvar RealParser = /** @class */ (function () {\n    function RealParser() {\n    }\n    RealParser.getChord = function (iRealChord) {\n        return iRealChord.note + iRealChord.modifiers + (iRealChord.over ? '/' + this.getChord(iRealChord.over) : '');\n    };\n    RealParser.parseSheet = function (raw) {\n        var tokens = RealParser.parse(raw);\n        return RealParser.getSheet(tokens);\n    };\n    RealParser.getSheet = function (tokens) {\n        var _this = this;\n        var parsed = tokens\n            .reduce(function (current, token, index, array) {\n            var lastBarEnded = ['{', '|', '[', '||' /* 'Z',  */ /* , ']' */]\n                .includes(token.bars || token.token);\n            var signs = token.annots || [];\n            var repeatStart = (token.bars || token.token) === '{';\n            var repeatEnd = (token.bars || token.token) === '}';\n            if (repeatStart) {\n                signs.push('{');\n            }\n            if (repeatEnd) {\n                signs.push('}');\n            }\n            // current.measure ends\n            if (lastBarEnded) {\n                if (current.measure) {\n                    // simplify measure if no signs\n                    /* if (Object.keys(current.measure).find(k=>k)) {\n                        current.measure = current.measure.chords;\n                    } */\n                    current.measures.push(current.measure);\n                }\n                current.measure = { chords: [] };\n            }\n            var sectionStart = signs.find(function (a) { return a.match(/^\\*[a-zA-Z]/); });\n            if (sectionStart) {\n                signs = signs.filter(function (s) { return s !== sectionStart; });\n                current.measure.section = sectionStart.replace('*', '');\n            }\n            var hasCodaSign = signs.includes('Q');\n            if (hasCodaSign) {\n                signs = signs.filter(function (s) { return s !== 'Q'; });\n                var codaSign = 'ToCoda';\n                if (!!current.measures.find(function (m) { return Measure_1.Measure.hasSign('ToCoda', m); })) {\n                    codaSign = 'Coda';\n                }\n                current.measure.signs = (current.measure.signs || []).concat([codaSign]);\n            }\n            var houseStart = signs.find(function (s) { return !!s.match(/^N./); });\n            if (houseStart) {\n                signs = signs.filter(function (s) { return s !== houseStart; });\n                current.measure.house = parseInt(houseStart.replace('N', ''));\n            }\n            var time = signs.find(function (a) { return a.match(/^T\\d\\d/); });\n            if (time) {\n                signs = signs.filter(function (s) { return s !== time; });\n                current.measure.time = time.replace('T', '');\n            }\n            if (token.chord) {\n                current.measure.chords.push(_this.getChord(token.chord));\n            }\n            else if (token.token === 'n') {\n                current.measure.chords.push(0);\n            }\n            var last = current.measures[current.measures.length - 1];\n            if (last && last.chords[0] === 'r') {\n                last.chords = current.measures[current.measures.length - 3].chords;\n                current.measure.chords = current.measures[current.measures.length - 2].chords;\n            }\n            if (last && current.measure.chords[0] === 'x') {\n                current.measure.chords = [].concat(last.chords);\n                current.measure.idle = true;\n            }\n            if (signs.length) {\n                current.measure.signs = (current.measure.signs || [])\n                    .concat(signs);\n            }\n            if (token.comments.length) {\n                current.measure.comments = (current.measure.comments || [])\n                    .concat(token.comments.map(function (c) { return c.trim(); }));\n            }\n            return current;\n        }, { measure: null, signs: null, measures: [] });\n        if (parsed.measure.chords.length) {\n            parsed.measures.push(parsed.measure);\n        }\n        return parsed.measures;\n    };\n    RealParser.parse = function (raw) {\n        var text = raw;\n        var arr = [], headers = [], comments = [];\n        var i;\n        text = text.trim();\n        // text = text.trimRight();\n        while (text) {\n            var found = false;\n            for (i = 0; i < RealParser.regExps.length; i++) {\n                var match = RealParser.regExps[i].exec(text);\n                if (match) {\n                    found = true;\n                    if (match.length <= 2) {\n                        var replacement = match[0];\n                        var repl = RealParser.replacements[replacement];\n                        arr = arr.concat(repl ? repl : [replacement]);\n                        text = text.substr(replacement.length);\n                    }\n                    else { // a chord\n                        arr.push(match);\n                        text = text.substr(match[0].length);\n                    }\n                    break;\n                }\n            }\n            if (!found) {\n                // ignore the comma separator\n                if (text[0] !== ',')\n                    arr.push(text[0]);\n                text = text.substr(1);\n            }\n        }\n        //\t\tconsole.log(arr);\n        // pass 2: extract prefixes, suffixes, annotations and comments\n        var out = [];\n        var obj = RealParser.newToken(out);\n        for (i = 0; i < arr.length; i++) {\n            var token = arr[i];\n            if (token instanceof Array) {\n                obj.chord = RealParser.parseChord(token);\n                token = \" \";\n            }\n            switch (token[0]) {\n                case ',':\n                    token = null;\n                    break; // separator\n                case 'S': // segno\n                case 'T': // time measurement\n                case 'Q': // coda\n                case 'N': // repeat\n                case 'U': // END\n                case 's': // small\n                case 'l': // normal\n                case 'f': // fermata\n                case '*':\n                    obj.annots.push(token);\n                    token = null;\n                    break;\n                case 'Y':\n                    obj.spacer++;\n                    token = null;\n                    break;\n                case 'r':\n                case 'x':\n                case 'W':\n                    obj.chord = new iRealChord(token, \"\", null, null);\n                    break;\n                case '<':\n                    token = token.substr(1, token.length - 2);\n                    token = token.replace(/XyQ/g, \"   \"); // weird; needs to be done\n                    obj.comments.push(token);\n                    token = null;\n                    break;\n                default:\n            }\n            if (token) {\n                if (\"]}Z\".indexOf(arr[i + 1]) >= 0)\n                    obj.bars += arr[++i];\n                if (\"{[|\".indexOf(token) >= 0) {\n                    obj.bars += token;\n                    token = null;\n                }\n            }\n            if (token && i < arr.length - 1) {\n                obj.token = token;\n                obj = RealParser.newToken(out);\n            }\n        }\n        return out;\n    };\n    RealParser.parseChord = function (match) {\n        var note = match[1] || \" \";\n        var modifiers = match[2] || \"\";\n        var comment = match[3] || \"\";\n        if (comment)\n            modifiers += comment.substr(1, comment.length - 2).replace(\"XyQ\", \"   \");\n        var over = match[4] || \"\";\n        if (over[0] === '/')\n            over = over.substr(1);\n        var alternate = match[5] || null;\n        if (alternate) {\n            match = RealParser.chordRegex.exec(alternate.substr(1, alternate.length - 2));\n            if (!match)\n                alternate = null;\n            else\n                alternate = this.parseChord(match);\n        }\n        // empty cell?\n        if (note === \" \" && !alternate && !over)\n            return null;\n        if (over) {\n            var offset = (over[1] === '#' || over[1] === 'b') ? 2 : 1;\n            over = new iRealChord(over.substr(0, offset), over.substr(offset), null, null);\n        }\n        else\n            over = null;\n        return new iRealChord(note, modifiers, over, alternate);\n    };\n    RealParser.newToken = function (arr) {\n        var obj = new iRealToken;\n        arr.push(obj);\n        return obj;\n    };\n    /**\n     * The RegExp for a complete chord. The match array contains:\n     * 1 - the base note\n     * 2 - the modifiers (+-ohd0123456789 and su for sus)\n     * 3 - any comments (may be e.g. add, sub, or private stuff)\n     * 4 - the \"over\" part starting with a slash\n     * 5 - the top chord as (chord)\n     * @type RegExp\n     */\n    RealParser.chordRegex = /^([ A-GW][b#]?)((?:sus|[\\+\\-\\^\\dhob#])*)(\\*.+?\\*)*(\\/[A-G][#b]?)?(\\(.*?\\))?/;\n    RealParser.regExps = [\n        /^\\*[a-zA-Z]/,\n        /^T\\d\\d/,\n        /^N./,\n        /^<.*?>/,\n        /^ \\(.*?\\)/,\n        RealParser.chordRegex,\n        /^LZ/,\n        /^XyQ/,\n        /^Kcl/ // repeat last bar\n    ];\n    RealParser.replacements = {\n        \"LZ\": [\" \", \"|\"],\n        \"XyQ\": [\" \", \" \", \" \"],\n        \"Kcl\": [\"|\", \"x\", \" \"]\n    };\n    return RealParser;\n}());\nexports.RealParser = RealParser;\nvar iRealChord = /** @class */ (function () {\n    function iRealChord(note, modifiers, over, alternate) {\n        this.note = note;\n        this.modifiers = modifiers;\n        this.over = over;\n        this.alternate = alternate;\n    }\n    return iRealChord;\n}());\nvar iRealToken = /** @class */ (function () {\n    function iRealToken() {\n        this.annots = [];\n        this.comments = [];\n        this.bars = \"\";\n        this.spacer = 0;\n        this.chord = null;\n    }\n    return iRealToken;\n}());\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Instrument_1 = require(\"./Instrument\");\nvar MidiOut = /** @class */ (function (_super) {\n    __extends(MidiOut, _super);\n    function MidiOut(props) {\n        var _this = _super.call(this, props) || this;\n        _this.gain = 0.9;\n        _this.output = 'Scarlett 6i6 USB';\n        _this.gain = props.gain || _this.gain;\n        if (!navigator['requestMIDIAccess']) {\n            console.warn('This browser does not support WebMIDI!');\n            return _this;\n        }\n        navigator['requestMIDIAccess']().then(function (midi) { return _this.midiInit(midi); }, _this.midiFail);\n        return _this;\n    }\n    MidiOut.prototype.midiInit = function (midi) {\n        var _this = this;\n        console.log('midi init', midi);\n        console.log(midi.outputs.size, 'outputs');\n        console.log(midi.inputs.size, 'inputs');\n        this.midi = midi;\n        midi.outputs.forEach(function (output) {\n            console.log('ouput', output);\n        });\n        midi.inputs.forEach(function (input) {\n            console.log('input', input);\n            input.onmidimessage = _this.getMidiMessage;\n        });\n        this.onTrigger = function (_a) {\n            var on = _a.on, off = _a.off;\n            on.forEach(function (_a) {\n                var midi = _a.midi, gain = _a.gain, deadline = _a.deadline;\n                _this.noteOn(midi, Math.round(gain * 127), deadline);\n            });\n            off.forEach(function (event) {\n                _this.noteOff(event.midi, Math.round(event.gain * 127));\n            });\n        };\n    };\n    MidiOut.prototype.midiFail = function () {\n        console.warn('could not get midi access!');\n    };\n    MidiOut.prototype.getMidiMessage = function (message) {\n        console.log('midi data', message.data, 'message', message);\n    };\n    MidiOut.prototype.send = function (message, deadline) {\n        var _this = this;\n        if (!this.midi) {\n            console.warn('tried to play keys but midi was not ready');\n            return;\n        }\n        console.log('send', message, deadline);\n        this.midi.outputs.forEach(function (output) {\n            if (true || output.name === _this.output) {\n                output.send(message);\n            }\n        });\n    };\n    MidiOut.prototype.noteOn = function (key, velocity, deadline) {\n        if (velocity === void 0) { velocity = 127; }\n        if (deadline === void 0) { deadline = 0; }\n        this.send([144, key, 0x7f], deadline); //velocity\n    };\n    MidiOut.prototype.noteOff = function (key, velocity, deadline) {\n        if (velocity === void 0) { velocity = 127; }\n        if (deadline === void 0) { deadline = 0; }\n        this.send([144, key, 0], deadline); //velocity\n    };\n    MidiOut.prototype.playKeys = function (keys, settings) {\n        if (settings === void 0) { settings = {}; }\n        /* if (!this.midi) {\n            console.warn('tried to play keys but midi was not ready');\n            return;\n        }\n        this.midi.outputs.forEach(output => {\n            console.log(keys, 'send to', output);\n            keys.forEach(key => {\n                output.send([144, key, 9]);\n            })\n        });\n    } */\n    };\n    return MidiOut;\n}(Instrument_1.Instrument));\nexports.MidiOut = MidiOut;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"../util/util\");\nvar Musician_1 = require(\"./Musician\");\nvar swing_1 = require(\"../grooves/swing\");\nvar Permutator = /** @class */ (function (_super) {\n    __extends(Permutator, _super);\n    function Permutator(instrument) {\n        var _this = _super.call(this, instrument) || this;\n        _this.defaults = { groove: swing_1.swing };\n        _this.playedChords = [];\n        return _this;\n    }\n    Permutator.prototype.play = function (_a) {\n        var _this = this;\n        var measures = _a.measures, pulse = _a.pulse, settings = _a.settings;\n        var groove = settings.groove || this.defaults.groove;\n        var pattern = groove['solo'] || (function (m) {\n            return m.measure.map(function (c) { return [1, 1, 1, 1]; });\n        }); // dont changes anything\n        measures = measures\n            .map(function (measure) { return pattern({ measures: measures, measure: measure, settings: settings, pulse: pulse }).slice(0, Math.floor(settings.cycle)); })\n            .map(function (pattern, i) { return util_1.resolveChords(pattern, measures, [i]); });\n        pulse.tickArray(measures, function (tick) {\n            _this.playPermutations(tick, measures, pulse);\n        }, settings.deadline);\n    };\n    Permutator.prototype.playPermutations = function (_a, measures, pulse) {\n        var value = _a.value, cycle = _a.cycle, path = _a.path, deadline = _a.deadline, interval = _a.interval;\n        var chord = value.chord;\n        if (chord === 'N.C.') {\n            return;\n        }\n        if (chord === 'x') {\n            chord = this.playedChords[this.playedChords.length - 1];\n        }\n        if (!chord || chord === '0') {\n            this.playedChords.push('');\n            return;\n        }\n        this.playedChords.push(chord);\n        // digital patterns\n        var notes = util_1.renderDigitalPattern(chord);\n        var note = util_1.randomElement(notes) + '5';\n        // all scale notes with different chances\n        /* const notes = getPatternInChord([1, 2, 3, 4, 5, 6, 7], chord);\n        const note = randomElement(notes, [4, 3, 6, 1, 3, 4, 6]) + '5'; */\n        /* console.log('beat (starting from zero)', path[1]); */\n        var duration = value.fraction * pulse.getMeasureLength();\n        /* deadline += randomDelay(10); */\n        this.instrument.playNotes([note], { deadline: deadline, interval: interval, gain: 1, duration: duration, pulse: pulse });\n    };\n    return Permutator;\n}(Musician_1.Musician));\nexports.default = Permutator;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Band_1 = __importDefault(require(\"./Band\"));\nexports.Band = Band_1.default;\nvar Pianist_1 = __importDefault(require(\"./musicians/Pianist\"));\nexports.Pianist = Pianist_1.default;\nvar Drummer_1 = __importDefault(require(\"./musicians/Drummer\"));\nexports.Drummer = Drummer_1.default;\nvar Bassist_1 = __importDefault(require(\"./musicians/Bassist\"));\nexports.Bassist = Bassist_1.default;\nvar Instrument_1 = require(\"./instruments/Instrument\");\nexports.Instrument = Instrument_1.Instrument;\nvar Musician_1 = require(\"./musicians/Musician\");\nexports.Musician = Musician_1.Musician;\nvar Synthesizer_1 = require(\"./instruments/Synthesizer\");\nexports.Synthesizer = Synthesizer_1.Synthesizer;\nvar Sampler_1 = require(\"./instruments/Sampler\");\nexports.Sampler = Sampler_1.Sampler;\nvar PlasticDrums_1 = require(\"./instruments/PlasticDrums\");\nexports.PlasticDrums = PlasticDrums_1.PlasticDrums;\nvar Trio_1 = require(\"./Trio\");\nexports.Trio = Trio_1.Trio;\nvar util = __importStar(require(\"./util/util\"));\nexports.util = util;\nvar Pulse_1 = require(\"./Pulse\");\nexports.Pulse = Pulse_1.Pulse;\nvar RealParser_1 = require(\"./sheet/RealParser\");\nexports.RealParser = RealParser_1.RealParser;\nvar MidiOut_1 = require(\"./instruments/MidiOut\");\nexports.MidiOut = MidiOut_1.MidiOut;\nvar Permutator_1 = __importDefault(require(\"./musicians/Permutator\"));\nexports.Permutator = Permutator_1.default;\nvar Voicing_1 = require(\"./harmony/Voicing\");\nexports.Voicing = Voicing_1.Voicing;\nvar Permutation_1 = require(\"./util/Permutation\");\nexports.Permutation = Permutation_1.Permutation;\n","import { Note } from 'tonal';\nimport { Chord } from 'tonal';\nimport { Interval } from 'tonal';\nimport { Distance } from 'tonal';\nimport { isPitchClass } from '../util/util';\n\nexport declare type intervalDirection = 'up' | 'down';\nexport declare type step = string | number;\n\nexport class Harmony {\n    // mapping for ireal chords to tonal symbols, see getTonalChord\n    static irealToTonal = {\n        \"^7\": \"M7\",\n        \"7\": \"7\",\n        \"-7\": \"m7\",\n        \"h7\": \"m7b5\",\n        \"7#9\": \"7#9\",\n        \"7b9\": \"7b9\",\n        \"^7#5\": \"M7#5\",\n        \"\": \"\",\n        \"6\": \"6\",\n        \"9\": \"9\",\n        \"-6\": \"m6\",\n        \"o7\": \"o7\",\n        \"h\": \"m7b5\",\n        \"-^7\": \"mM7\",\n        \"o\": \"o\",\n        \"^9\": \"M9\",\n        \"7#11\": \"7#11\",\n        \"7#5\": \"7#5\",\n        \"-\": \"m\",\n        \"7sus\": \"7sus\",\n        \"69\": \"M69\",\n        \"7b13\": \"7b13\",\n        \"^\": \"M\",\n        \"+\": \"+\",\n        \"7b9b5\": \"7b5b9\",\n        \"-9\": \"m9\",\n        \"9sus\": \"9sus\",\n        \"7b9sus\": \"7b9sus\",\n        \"7b9#5\": \"7#5b9\",\n        \"13\": \"13\",\n        \"^7#11\": \"M7#11\",\n        \"-7b5\": \"m7b5\",\n        \"^13\": \"M13\",\n        \"7#9b5\": \"7b5#9\",\n        \"-11\": \"m11\",\n        \"11\": \"11\",\n        \"7b5\": \"7b5\",\n        \"9#5\": \"9#5\",\n        \"13b9\": \"13b9\",\n        \"9#11\": \"9#11\",\n        \"13#11\": \"13#11\",\n        \"-b6\": \"mb6\",\n        \"7#9#5\": \"7#5#9\",\n        \"-69\": \"m69\",\n        \"13sus\": \"13sus\",\n        \"^9#11\": \"M9#11\",\n        \"7b9#9\": \"7b9#9\",\n        \"sus\": \"sus\",\n        \"7#9#11\": \"7#9#11\",\n        \"7b9b13\": \"7b9b13\",\n        \"7b9#11\": \"7b9#11\",\n        \"13#9\": \"13#9\",\n        \"9b5\": \"9b5\",\n        \"-^9\": \"mM9\",\n        \"2\": \"Madd9\",\n        \"-#5\": \"m#5\",\n        \"7+\": \"7#5\",\n        \"7sus4\": \"7sus\", // own addition\n        \"M69\": \"M69\", // own addition\n        // \"5\": \"5\",\n        // \"7b13sus\": \"7b13sus\",\n    };\n    static pitchRegex = /^([A-G^][b|#]?)/;\n\n    static isBlack(note) {\n        return Note.props(note)['acc'] !== '';\n    }\n\n    static hasSamePitch(noteA, noteB, ignoreOctave = false) {\n        if (ignoreOctave || isPitchClass(noteA) || isPitchClass(noteB)) {\n            return Note.props(noteA).chroma === Note.props(noteB).chroma;\n        }\n        return Note.midi(noteA) === Note.midi(noteB);\n    }\n\n    static getTonalChord(chord: string) {\n        if (!chord) {\n            return null;\n        }\n        const root = Harmony.getBassNote(chord, true) || '';\n        let symbol = chord.replace(root, '');\n        symbol = symbol.split('/')[0]; // ignore slash\n        // check if already a proper tonal chord\n        if (!!Object.keys(Harmony.irealToTonal).find(i => Harmony.irealToTonal[i] === symbol)) {\n            return root + symbol;\n        }\n        symbol = Harmony.irealToTonal[symbol];\n        if (symbol === undefined) {\n            return null;\n        }\n        return root + symbol;\n    }\n\n    static getBassNote(chord: string, ignoreSlash = false) {\n        if (!chord) {\n            return null;\n        }\n        if (!ignoreSlash && chord.includes('/')) {\n            return chord.split('/')[1];\n        }\n        const match = chord.match(/^([A-G][b|#]?)/);\n        if (!match || !match.length) {\n            return '';\n        }\n        return match[0];\n    }\n\n    static transposeChord(chord, interval) {\n        if (!chord) {\n            return chord;\n        }\n        const tokens = Chord.tokenize(Harmony.getTonalChord(chord));\n        let root = Distance.transpose(tokens[0], interval);\n        root = Note.simplify(root);\n        return root + tokens[1];\n    }\n\n    static getMidi(note, offset = 0) {\n        return Note.midi(note) - offset;\n    }\n\n\n    static intervalComplement(interval) {\n        const fix = {\n            '8P': '1P',\n            '8d': '1A',\n            '8A': '1d',\n            '1A': '8d',\n            '1d': '8A',\n        }\n        const fixIndex = Object.keys(fix).find(key => interval.match(key));\n        if (fixIndex) {\n            return fix[fixIndex];\n        }\n\n        return Interval.invert(interval);\n    }\n\n    static invertInterval(interval) {\n        if (!interval) {\n            return null;\n        }\n        const positive = interval.replace('-', '');\n        const complement = Harmony.intervalComplement(positive);\n        const isNegative = interval.length > positive.length;\n        return (isNegative ? '' : '-') + complement;\n    }\n\n    /** Transforms interval into one octave (octave+ get octaved down) */\n    static fixInterval(interval = '', simplify = false) {\n        let fix: { [key: string]: string } = {\n            '0A': '1P',\n            '-0A': '1P',\n            /*  */\n        }\n        if (simplify) {\n            fix = {\n                ...fix,\n                '8P': '1P',\n                '-8P': '1P',\n                /* '-1A': '-2m',\n                '1A': '2m',\n                '8d': '7M',\n                '-8d': '-7M', */\n            }\n            interval = Interval.simplify(interval);\n        }\n        if (Object.keys(fix).includes(interval)) {\n            return fix[interval];\n        }\n        return interval;\n    }\n\n    /** inverts the interval if it does not go to the desired direction */\n    static forceDirection(interval, direction: intervalDirection, noUnison = false) {\n        const semitones = Interval.semitones(interval);\n        if ((direction === 'up' && semitones < 0) ||\n            (direction === 'down' && semitones > 0)) {\n            return Harmony.invertInterval(interval);\n        }\n        if (interval === '1P' && noUnison) {\n            return (direction === 'down' ? '-' : '') + '8P';\n        }\n        return interval;\n    }\n\n    // use Interval.ic?\n    static minInterval(interval, direction?: intervalDirection, noUnison?) {\n        interval = Harmony.fixInterval(interval, true);\n        if (direction) {\n            return Harmony.forceDirection(interval, direction, noUnison)\n        }\n        let inversion = Harmony.invertInterval(interval);\n        if (Math.abs(Interval.semitones(inversion)) < Math.abs(Interval.semitones(interval))) {\n            interval = inversion;\n        }\n        return interval;\n    }\n\n    // returns array of intervals that lead the voices of chord A to chordB\n    static minIntervals(chordA, chordB) {\n        return chordA.map((n, i) => Harmony.minInterval(Distance.interval(n, chordB[i])));\n    }\n\n    static mapMinInterval(direction?: intervalDirection) {\n        return (interval) => Harmony.minInterval(interval, direction);\n    }\n\n    // sort function\n    static sortMinInterval(preferredDirection: intervalDirection = 'up', accessor = (i => i)) {\n        return (a, b) => {\n            const diff = Math.abs(Interval.semitones(accessor(a))) - Math.abs(Interval.semitones(accessor(b)));\n            if (diff === 0) {\n                return preferredDirection === 'up' ? -1 : 1;\n            }\n            return diff;\n        }\n    }\n\n    /** Returns the note with the least distance to \"from\" */\n    static getNearestNote(from, to, direction?: intervalDirection) {\n        let interval = Harmony.minInterval(Distance.interval(Note.pc(from), Note.pc(to)), direction);\n        return Distance.transpose(from, interval) + '';\n    }\n\n    /** Returns the note with the least distance to \"from\". TODO: add range */\n    static getNearestTargets(from, targets, preferredDirection: intervalDirection = 'down', flip = false) {\n        let intervals = targets\n            .map((target) => Distance.interval(Note.pc(from), target))\n            .map(Harmony.mapMinInterval(preferredDirection))\n            .sort(Harmony.sortMinInterval(preferredDirection))\n        /* if (flip) {\n            intervals = intervals.reverse();\n        } */\n        return intervals.map(i => Distance.transpose(from, i));\n    }\n\n    static intervalMatrix(from, to) {\n        return to.map(note => from\n            .map(n => {\n                return Distance.interval(n, note)\n            })\n            .map(d => Harmony.minInterval(d))\n            /* .map(i => i.slice(0, 2) === '--' ? i.slice(1) : i) */\n        )\n    }\n\n}","import { Pulse } from \"../Pulse\";\nimport { Harmony } from '../harmony/Harmony';\n\nexport interface NoteEvent {\n    note: string;\n    midi?: number;\n    gain?: number;\n    off?: number;\n    deadline?: number;\n}\n\nexport class Instrument {\n    midiOffset = 0;\n    onTrigger: (events: { on: NoteEvent[], off: NoteEvent[], active: NoteEvent[] }) => any;\n    ready: Promise<any>;\n    gain = 1;\n\n    activeEvents = [];\n    context: any;\n    mix: any;\n    constructor({ context, gain, mix, onTrigger, midiOffset }: any = {}) {\n        this.onTrigger = onTrigger;\n        this.midiOffset = midiOffset || this.midiOffset;\n        this.gain = gain || this.gain;\n        this.init({ context, mix });\n    }\n\n    init({ context, mix }) {\n        if (!context && (!mix || !mix.context)) {\n            console.warn(`you should pass a context or a mix (gainNode) to a new Instrument. \n            You can also Call init with {context,mix} to setup the Instrument later`);\n            return;\n        }\n        this.context = context || mix.context;\n        this.mix = mix || this.context.destination;\n    }\n\n    playNotes(notes: string[], settings: any = {}) {\n        const deadline = (settings.deadline || this.context.currentTime);\n        settings = Object.assign({\n            duration: 2000,\n            gain: 1,\n        }, settings, { deadline });\n        if (settings.interval) {\n            // call recursively with single notes at interval\n            return notes.map((note, index) => {\n                this.playNotes([note], Object.assign({}, settings, {\n                    interval: 0,\n                    deadline: deadline + index * settings.interval\n                }))\n            });\n        }\n        const midi = notes.map(note => Harmony.getMidi(note, this.midiOffset));\n        const noteOff = settings.deadline + settings.duration / 1000;\n\n        const notesOn = notes.map((note, index) => ({\n            note,\n            midi: midi[index],\n            gain: settings.gain,\n            noteOff,\n            deadline: settings.deadline\n        }));\n\n        if (settings.pulse && this.onTrigger) {\n            settings.pulse.clock.callbackAtTime((deadline) => {\n                this.activeEvents = this.activeEvents.concat(notesOn);\n                this.onTrigger({ on: notesOn, off: [], active: this.activeEvents });\n            }, settings.deadline);\n        }\n        if (settings.duration && settings.pulse) {\n            settings.pulse.clock.callbackAtTime((deadline) => {\n                // find out which notes need to be deactivated\n                const notesOff = notes\n                    .filter(note => !this.activeEvents\n                        .find(event => {\n                            const keep = note === event.note && event.noteOff > deadline;\n                            if (keep) {\n                                console.log('keep', note);\n                            }\n                            return keep;\n                        })).map(note => this.activeEvents.find(e => e.note === note));\n\n                this.activeEvents = this.activeEvents\n                    .filter(e => !notesOff.includes(e));\n\n                if (this.onTrigger) {\n                    this.onTrigger({ on: [], off: notesOff, active: this.activeEvents });\n                }\n            }, noteOff);\n        }\n        return this.playKeys(midi, settings);\n    }\n\n    playKeys(keys: number[], settings?) {\n        // TODO: fire callbacks after keys.map((key,i)=>i*settings.interval)?\n    }\n}","import { Instrument } from './Instrument';\nimport { Note } from 'tonal';\nimport { adsr } from '../util/util';\n\nexport class Synthesizer extends Instrument {\n    duration = 200;\n    type = 'sine';\n    gain = 0.9;\n    attack = .05;\n    decay = .05;\n    sustain = .4;\n    release = .1;\n\n    constructor(props: any) {\n        super(props);\n        this.duration = props.duration || this.duration;\n        this.type = props.type || this.type;\n        this.gain = props.gain || this.gain;\n    }\n\n    getVoice(type = 'sine', gain = 0, key) {\n        const frequency = Note.freq(key);\n        const oscNode = this.context.createOscillator();\n        oscNode.type = type;\n        const gainNode = this.context.createGain();\n        oscNode.connect(gainNode);\n        gainNode.gain.value = typeof gain === 'number' ? gain : 0.8;\n        gainNode.connect(this.mix);\n        oscNode.frequency.value = frequency;\n        return { oscNode, gainNode, key, frequency };\n    }\n\n    lowestGain(a, b) {\n        return a.gain.gain.value < b.gain.gain.value ? -1 : 0;\n    }\n\n    startKeys(keys: number[], settings: any = {}) {\n\n    }\n\n    playKeys(keys: number[], settings: any = {}) {\n        super.playKeys(keys, settings); // fires callback   \n        //const time = this.context.currentTime + settings.deadline / 1000;\n        const time = settings.deadline || this.context.currentTime;\n        const interval = settings.interval || 0;\n        return keys.map((key, i) => {\n            const delay = i * interval;\n            const [endless, attack, decay, sustain, release, duration, gain] =\n                [\n                    settings.endless,\n                    settings.attack || this.attack,\n                    settings.decay || this.decay,\n                    settings.sustain || this.sustain,\n                    settings.release || this.release,\n                    (settings.duration || this.duration) / 1000,\n                    (settings.gain || 1) * this.gain\n                ]\n            const voice = this.getVoice(this.type, 0, key);\n            adsr({ attack, decay, sustain, release, gain, duration, endless }, time + delay, voice.gainNode.gain);\n            voice.oscNode.start(settings.deadline + delay);\n            return voice;\n        });\n    }\n\n    stopVoice(voice, settings: any = {}) {\n        if (!voice) {\n            return;\n        }\n        const time = settings.deadline || this.context.currentTime;\n        voice.gainNode.gain.setTargetAtTime(0, time, settings.release || this.release);\n        //voice.oscNode.stop()\n    }\n\n    stopVoices(voices, settings) {\n        voices.forEach(voice => {\n            this.stopVoice(voice, settings);\n        });\n    }\n}","import * as Chord from 'tonal-chord';\nimport * as Scale from 'tonal-scale';\n\nexport const chords = [\n    {\n        symbol: 'm',\n        long: 'minor',\n        short: '-',\n        groups: ['Basic', 'Triads']\n    },\n    {\n        symbol: 'M',\n        long: 'major',\n        short: '',\n        groups: ['Basic', 'Triads']\n    },\n    {\n        symbol: 'o',\n        groups: ['Basic', 'Symmetric', 'Triads'],\n        long: 'Vermindert'\n        /* short: 'o' */\n    },\n    {\n        symbol: 'M#5', // = Mb6\n        groups: ['Advanced', 'Symmetric', 'Triads'],\n        short: '#5'\n    },\n    {\n        symbol: 'Msus4',\n        groups: ['Advanced', 'Symmetric'],\n        short: 'sus4'\n    },\n    {\n        symbol: 'Msus2',\n        groups: ['Advanced', 'Symmetric'],\n        short: 'sus2'\n    },\n    // 5 4 64 m#5 Mb5  7no5  \n    {\n        symbol: '7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Dominantsept'\n    },\n    {\n        symbol: '7#11',\n        groups: ['Advanced', 'Diatonic', 'Modes'],\n        long: 'Dominant #11'\n    },\n    {\n        symbol: 'M6',\n        groups: ['Advanced'],\n        long: 'major 6',\n        short: '6'\n    },\n    {\n        symbol: 'o7',\n        groups: ['Advanced', 'Symmetric', 'Diatonic'], // HM 7 chord\n        long: 'Vermindert 7',\n    },\n    {\n        symbol: 'm7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'minor 7',\n        short: '-7'\n    },\n    {\n        symbol: 'oM7',\n        groups: ['Expert'],\n        long: 'diminished major 7',\n        short: 'o7'\n    },\n    {\n        symbol: 'm7b5',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Halbvermindert',\n        short: '-7b5'\n    },\n    {\n        symbol: '7#5',\n        groups: ['Advanced', 'Symmetric'],\n        long: 'Dominantsept #5'\n    },\n    {\n        symbol: 'Maj7',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n        long: 'Major 7',\n        short: '7'\n    },\n    {\n        symbol: 'mMaj7',\n        short: '-7',\n        groups: ['Advanced', 'Diatonic']\n    },\n    {\n        symbol: 'M7#5',\n        groups: ['Advanced', 'Diatonic'],\n        short: '7#5'\n    },\n    {\n        symbol: '7sus4',\n        groups: ['Advanced'],\n    },\n    {\n        symbol: '9',\n        groups: ['Advanced'],\n    },\n    {\n        symbol: 'M9',\n        groups: ['Advanced'],\n        short: '9'\n    },\n    {\n        symbol: 'M69',\n        groups: ['Advanced'],\n        short: '69'\n    }\n    /*\n7b13 M7b5 m7#5 9no5  M7b6 7b5 Madd9 mb6b9 mb6M7 madd4 sus24 madd9 Maddb9 +add#9 M7sus4 7#5sus4 M#5add9 M7#5sus4\n11 m9 m6 9#5 7b9 7#9 M69 9b5 m69 mM9 7b6 m9b5 m9#5 7#11 M7b9 9b13 o7M7 M9b5 11b9 M9#5 7add6 M6#11 M7#11 7#5#9 13no5 9sus4 7#5b9 M9sus4 7sus4b9 m7add11 mMaj7b6 M9#5sus4\n13 m11 M13 9#11 13#9 13b5 13b9 m11b5 7b9#9 mM9b6 M9#11 9#5#11 7#9b13 7b9b13 13sus4 m11A 5 7#9#11 7b9#11 M69#11 7#11b13 M7#9#11 M7add13 7#5b9#11 7sus4b9b13\nm13 13#11 M13#11 13b9#11 9#11b13 13#9#11 7b9b13#11 7#9#11b13\n    */\n];\n\nexport const scales = [\n    {\n        symbol: 'major pentatonic',\n        groups: ['Basic', 'Pentatonic'],\n    },\n    {\n        symbol: 'minor pentatonic',\n        groups: ['Basic', 'Pentatonic'],\n    },\n    {\n        symbol: 'minor blues',\n        groups: ['Basic'],\n    },\n    // gregorian modes\n    {\n        symbol: 'major',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'dorian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'phrygian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'lydian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'mixolydian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'aeolian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'locrian',\n        groups: ['Basic', 'Diatonic', 'Modes'],\n    },\n    {\n        symbol: 'whole tone',\n        groups: ['Advanced', 'Symmetric']\n    },\n    {\n        symbol: 'diminished',\n        groups: ['Advanced', 'Symmetric']\n    },\n    //HTGT ?\n    {\n        symbol: 'augmented',\n        groups: ['Advanced', 'Symmetric']\n    },\n    {\n        symbol: 'chromatic',\n        groups: ['Expert', 'Symmetric']\n    },\n    // harmonic minor modes\n    {\n        symbol: 'harmonic minor', // HM 1\n        groups: ['Advanced', 'Diatonic']\n    },\n    // HM 2 locrian #6 !\n    {\n        symbol: 'ionian augmented', // HM 3\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'dorian #4', // HM 4\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'spanish', // HM 5\n        groups: ['Advanced', 'Diatonic']\n    },\n    // HM 6 lydian #9\n    // HM 7 ???\n\n    // melodic minor modes\n    {\n        symbol: 'melodic minor', // MM 1\n        groups: ['Advanced', 'Diatonic']\n    },\n    {\n        symbol: 'melodic minor second mode', // MM 2\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'lydian augmented', // MM 3\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'lydian dominant', // MM 4\n        groups: ['Advanced', 'Diatonic'],\n        long: 'mixolydian #11'\n    },\n    {\n        symbol: 'melodic minor fifth mode', // MM 5\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'locrian #2', // MM 6\n        groups: ['Expert', 'Diatonic']\n    },\n    {\n        symbol: 'altered', // MM 7\n        groups: ['Advanced', 'Diatonic']\n    },\n    //non european\n    {\n        symbol: 'kumoijoshi',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'iwato',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'pelog',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    // hyojo?\n    {\n        symbol: 'egyptian',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'in-sen',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'scriabin',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'ritusen',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'hirajoshi',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'malkos raga',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    {\n        symbol: 'vietnamese 1',\n        groups: ['Exotic', 'Pentatonic']\n    },\n    /* {\n        symbol: 'vietnamese 2',\n        groups: ['Exotic', 'Pentatonic'] // = minor pentatonic\n    }, */\n    {\n        symbol: 'lydian pentatonic', // = China (Sikora S. 61)\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'mixolydian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'ionian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'locrian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'flat six pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'minor six pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'minor #7M pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'lydian #5P pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'whole tone pentatonic',\n        groups: ['Pentatonic', 'Symmetric']\n    },\n    {\n        symbol: 'flat three pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'super locrian pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'major flat two pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'lydian dominant pentatonic',\n        groups: ['Pentatonic']\n    },\n    {\n        symbol: 'neopolitan major pentatonic',\n        groups: ['Pentatonic']\n    }\n\n    /*            \n    mystery #1 piongio    prometheus major blues minor hexatonic six tone symmetric prometheus neopolitan\n     persian  spanish  oriental flamenco balinese   todi raga enigmatic lydian #9 neopolitan locrian #2  lydian minor  locrian major  romanian minor harmonic major hungarian major hungarian minor lydian dominant   neopolitan minor neopolitan major lydian diminished leading whole tone augmented heptatonic double harmonic major double harmonic lydian melodic minor fifth mode melodic minor second mode\n    bebop kafi raga  purvi raga ichikosucho bebop minor minor bebop bebop major bebop locrian bebop dominant spanish heptatonic minor six diminished\n    composite blues\n    */\n];\n\nexport const symbols = { chords, scales };\n\nexport const levels = ['Basic', 'Advanced', 'Expert'];\n\nexport function groupFilter(group) {\n    return (item) => {\n        const level = Math.max(item.groups.filter(group => levels.indexOf(group) !== -1)\n            .map(group => levels.indexOf(group) + 1));\n        const groups = level > 0 ? Array.from(new Set(levels.slice(level).concat(item.groups))) : item.groups;\n        return groups.indexOf(group) !== -1;\n    };\n}\n\nexport function scaleNames(group = 'Basic') {\n    if (!group || group === 'All') {\n        return Scale.names();\n    }\n    return scales.filter(groupFilter(group))\n        .map(scale => scale.symbol);\n}\nexport function chordNames(group = 'Basic') {\n    if (!group || group === 'All') {\n        return Chord.names();\n    }\n    return chords.filter(groupFilter(group))\n        .map(scale => scale.symbol);\n}\n\nexport function groupNames() {\n    return Array.from(new Set(levels.concat(scales.concat(chords)\n        .map(item => item.groups)\n        .reduce((groups, current) => groups.concat(current))))).concat(['All']);\n}\n\nexport function symbolName(type, symbol, long) {\n    const pool = symbols[type + 's'];\n    const match = pool.find(item => item.symbol === symbol);\n    if (!match) {\n        return symbol;\n    }\n    /* return symbol; */\n    return (long ? match.long : match.short) || symbol;\n}\n\nexport function scaleName(symbol, long = false) {\n    return symbolName('scale', symbol, long);\n}\n\nexport function chordName(symbol, long = false) {\n    return symbolName('chord', symbol, long);\n}\n\nexport function randomItem(array) {\n    return array[Math.floor(Math.random() * array.length)];\n}\n\nexport function randomScale(group) {\n    return randomItem(scaleNames(group));\n}\n\nexport function randomChord(group) {\n    return randomItem(chordNames(group));\n}","import { Chord, Distance, Interval, Note, PcSet, Scale } from 'tonal';\nimport { Synthesizer } from '../instruments/Synthesizer';\nimport { scaleNames } from '../symbols';\nimport { Harmony, step, intervalDirection } from '../harmony/Harmony';\n\nconst steps = {\n    '1P': ['1', '8'],\n    '2m': ['b9', 'b2'],\n    '2M': ['9', '2',],\n    '2A': ['#9', '#2'],\n    '3m': ['b3'],\n    '3M': ['3'],\n    '4P': ['11', '4'],\n    '4A': ['#11', '#4'],\n    '5d': ['b5'],\n    '5P': ['5'],\n    '5A': ['#5'],\n    '6m': ['b13', 'b6'],\n    '6M': ['13', '6'],\n    '7m': ['b7'],\n    '7M': ['7', '^7', 'maj7']\n};\n\n/*\nLower Interval Limits (just guidelines):\n2m: E3-F3\n2M: Eb3-F3\n3m: C3-Eb3\n3M: Bb2-D3\n4P: Bb2-Eb3\n5D: B2-F3\n5P: Bb1-F2\n6m: F2-Db3\n6M: F2-D3\n7m: F2-Eb3\n7m: F2-E3\n8P: -\n\nmore rough: top note should be D3 or higher.\ntaken from https://www.youtube.com/watch?v=iW6YeDJklhQ\n*/\n\nexport function randomNumber(n) {\n    return Math.floor(Math.random() * n)\n}\n\nexport function arraySum(array) {\n    return array.reduce((s, i) => s + i, 0);\n}\n\nexport function randomElement(array, weighted?) {\n    if (!weighted) {\n        return array[randomNumber(array.length)];\n    }\n    const r = randomNumber(arraySum(weighted)) + 1;\n    const total = weighted\n        .reduce((abs, w, i) => abs.concat(w + (abs.length ? abs[i - 1] : 0)), []);\n    return array[total.indexOf(total.find((s, i) => s >= r))];\n}\n\nexport function shuffleArray(a) {\n    for (let i = a.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [a[i], a[j]] = [a[j], a[i]];\n    }\n    return a;\n}\n\n/** OLD SHEET / RHYTHM STUFF */\n\n/** Travels path along measures */\nexport function getPath(path, measures, traveled = []) {\n    if (!Array.isArray(measures[path[0]]) || path.length === 1) {\n        return measures[Math.min(path[0], measures.length - 1)];\n    }\n    return this.getPath(path.slice(1), measures[path[0]], traveled.concat(path[0]));\n}\n\nexport function getDuration(divisions, noteLength = 1, measureLength = 1) {\n    return noteLength * divisions.reduce((f, d) => f / d, 1000) * measureLength; // fraction of one\n}\n\nexport function resolveChords(pattern, measures, path, divisions = []) {\n    if (Array.isArray(pattern)) {\n        // division: array of children lengths down the path (to calculate fraction)\n        divisions = [].concat(divisions, [pattern.length]);\n        return pattern.map((p, i) => this.resolveChords(p, measures, path.concat([i]), divisions));\n    }\n    if (pattern === 0) {\n        return 0;\n    }\n    const fraction = getDuration(divisions, pattern);\n    if (fraction === 0) {\n        console.warn('fraction is 0', pattern);\n    }\n    if (fraction === NaN) {\n        console.warn('fraction NaN', divisions, pattern);\n    }\n    return { chord: this.getPath(path, measures), pattern, path, divisions, fraction };\n}\n\nexport function hasOff(pattern, division = 3) {\n    return Array.isArray(pattern) && pattern.length === division && pattern[division - 1] !== 0;\n}\n\n// replaces offs on last beat with next chord + erases next one\nexport function offbeatReducer(settings) {\n    // TODO: find out why some offbeats sound sketchy\n    return (measures, bar, index) => {\n        const last = index > 0 ? measures[index - 1] : null;\n        if (last && this.hasOff(last[settings.cycle - 1], settings.division)) {\n            last[settings.cycle - 1][settings.division - 1] = bar[0];\n            bar[0] = 0;\n        }\n        return measures.concat([bar]);\n    };\n}\n\n\nexport function randomSynth(mix, allowed = ['sine', 'triangle', 'square', 'sawtooth'], settings = {}) {\n    const gains = {\n        sine: 0.9,\n        triangle: 0.8,\n        square: 0.2,\n        sawtooth: 0.3\n    }\n    const wave = randomElement(allowed);\n    return new Synthesizer(Object.assign({ gain: gains[wave], type: wave, mix }, settings));\n}\n\nexport interface ADSRParams {\n    attack?: number,\n    decay?: number,\n    sustain?: number,\n    release?: number,\n    gain?: number,\n    duration?: number,\n    endless?: boolean\n}\n\nexport function adsr({ attack, decay, sustain, release, gain, duration, endless }: ADSRParams, time, param) {\n    // console.log('adsr', attack, decay, sustain, release, gain, duration, time);\n    param.linearRampToValueAtTime(gain, time + attack);\n    param.setTargetAtTime(sustain * gain, time + Math.min(attack + decay, duration), decay);\n    if (!endless) {\n        param.setTargetAtTime(0, time + Math.max(duration - attack - decay, attack + decay, duration), release);\n    }\n}\n\nexport function randomDelay(maxMs) {\n    return Math.random() * maxMs * 2 / 1000;\n}\n\nexport function isInRange(note, range) {\n    return Distance.semitones(note, range[0]) <= 0 && Distance.semitones(note, range[1]) >= 0;\n}\n\nexport function transposeNotes(notes, interval) {\n    return notes.map(note => Distance.transpose(note, interval));\n}\n\nexport function transposeToRange(notes, range, times = 0) {\n    if (times > 10) {\n        return notes;\n    }\n    if (notes.find(note => Distance.semitones(note, range[0]) > 0)) {\n        notes = notes.map(note => Distance.transpose(note, '8P'));\n        console.log('tp up');\n        return transposeToRange(notes, range, ++times);\n    }\n    if (notes.find(note => Distance.semitones(note, range[1]) < 0)) {\n        console.log('tp down');\n        notes = notes.map(note => Distance.transpose(note, '-8P'));\n        return transposeToRange(notes, range, ++times);\n    }\n    return notes;\n}\n\nexport function getAverageMidi(notes, offset?) {\n    return notes.reduce((sum, note) => sum + Harmony.getMidi(note, offset), 0) / notes.length;\n}\n\nexport function getDistancesToRangeEnds(notes: string[], range: string[]) {\n    if (notes.length > 2) {\n        notes = [notes[0], notes[notes.length - 1]];\n    }\n    const midi = notes.map(n => Harmony.getMidi(n));\n    const rangeMidi = range.map(n => Harmony.getMidi(n));\n    return [midi[0] - rangeMidi[0], rangeMidi[1] - midi[1]];\n}\n\nexport function getRangePosition(note: string | number, range) {\n    note = Harmony.getMidi(note);\n    range = range.map(n => Harmony.getMidi(n));\n    const semitones = [note - range[0], range[1] - range[0]];\n    return semitones[0] / semitones[1];\n}\n\nexport function getRangeDirection(note, range, defaultDirection: intervalDirection = 'down', border = 0): { direction: intervalDirection, force: boolean } {\n    const position = getRangePosition(note, range);\n    if (position <= border) {\n        return { direction: 'up', force: true }\n    } if (position >= (1 - border)) {\n        return { direction: 'down', force: true }\n    }\n    return {\n        direction: defaultDirection, force: false\n    }\n}\n\n// accepts both strings or numbers where negative means minor, \n// returns unified step string that can be turned into an interval\nexport function getStep(step: step) {\n    if (typeof step === 'number' && step < 0) {\n        step = 'b' + (step * -1);\n    }\n    return step + ''; // to string\n}\n\nexport function getIntervalFromStep(step: step) {\n    step = getStep(step);\n    const interval = Object.keys(steps)\n        .find(i => steps[i].includes(step));\n    if (!interval) {\n        // console.warn(`step ${step} has no defined inteval`);\n    }\n    return interval;\n}\n\nexport function getStepsFromDegree(degree) {\n    return\n}\n\nexport function getStepsInChord(notes: string[], chord: string, min = false) {\n    const root = Chord.tokenize(Harmony.getTonalChord(chord))[0];\n    return notes.map(note => {\n        let interval = Distance.interval(root, Note.pc(note));\n        return getStepFromInterval(interval, min);\n    });\n}\nexport function getStepInChord(note, chord, min = false) {\n    return getStepFromInterval(\n        Distance.interval(\n            Chord.tokenize(Harmony.getTonalChord(chord))[0],\n            Note.pc(note), min)\n    );\n}\n\nexport function getChordScales(chord, group = 'Diatonic') {\n    const tokens = Chord.tokenize(Harmony.getTonalChord(chord));\n    /* const isSuperset = PcSet.isSupersetOf(Chord.intervals(tokens[1])); */\n    return scaleNames(group).filter(name =>\n        /* isSuperset(Scale.intervals(name)) */\n        PcSet.isSupersetOf(Chord.intervals(tokens[1]), Scale.intervals(name))\n    );\n}\n\nexport function pickChordScale(chord, group = 'Diatonic') {\n    const scales = getChordScales(chord);\n    if (!scales.length) {\n        console.warn(`cannot pick chord scale: no scales found for chord ${chord} in group ${group}`);\n        return;\n    }\n    return scales[0];\n}\n\n\nexport function findDegree(degreeOrStep: number | step, intervalsOrSteps: string[]) {\n    const intervals = intervalsOrSteps.map(i => isInterval(i) ? i : getIntervalFromStep(i));\n    if (typeof degreeOrStep === 'number') { // is degree\n        const degree = Math.abs(degreeOrStep);\n        return intervals.find(i => {\n            i = Harmony.minInterval(i, 'up');\n            if (!steps[i]) {\n                console.error('interval', i, 'is not valid', intervals);\n            }\n            return !!(steps[i].find(step => getDegreeFromStep(step) === degree));\n        });\n    }\n    // is step\n    const step = getStep(degreeOrStep);\n    return intervals.find(i => i.includes(step) ||\n        i === getIntervalFromStep(step));\n}\n\nexport function hasDegree(degree, intervals) {\n    return !!findDegree(degree, intervals);\n}\n\nexport function hasAllDegrees(degrees, intervals) {\n    return degrees.reduce((res, d) => res && hasDegree(d, intervals), true);\n}\n\nexport function getScaleDegree(degree, scale) {\n    return findDegree(degree, Scale.intervals(scale));\n}\n\n\nexport function getScalePattern(pattern, scale) {\n    return pattern.map(degree => getScaleDegree(degree, scale));\n}\n\nexport function renderIntervals(intervals, root) {\n    return intervals.map(i => Distance.transpose(root, i));\n}\n\nexport function renderSteps(steps, root) {\n    return renderIntervals(steps.map(step => getIntervalFromStep(step)), root);\n}\n\nexport function permutateIntervals(intervals, pattern) {\n    return pattern.map(d => findDegree(d, intervals));\n}\n\nexport function getStepFromInterval(interval, min = false) {\n    const step = steps[interval] || [];\n    if (min) {\n        return step[1] || step[0] || 0;\n    }\n    return step[0] || 0;\n}\n\nexport function getDegreeFromInterval(interval = '-1', simplify = false) {\n    const fixed = Harmony.fixInterval(interval + '', simplify) || '';\n    const match = fixed.match(/[-]?([1-9])+/);\n    if (!match) {\n        return 0;\n    }\n    return Math.abs(parseInt(match[0], 10));\n}\n\nexport function getDegreeFromStep(step: step) {\n    step = getStep(step);\n    const match = step.match(/([1-9])+/);\n    if (!match || !match.length) {\n        console.log('no valid step', step);\n        return 0;\n    }\n    return parseInt(match[0], 10);\n}\n\nexport function getDegreeInChord(degree, chord) {\n    chord = Harmony.getTonalChord(chord);\n    const intervals = Chord.intervals(chord);\n    const tokens = Chord.tokenize(chord);\n    return Distance.transpose(tokens[0], findDegree(degree, intervals));\n}\n\nexport function getPatternInChord(pattern, chord) {\n    chord = Harmony.getTonalChord(chord);\n    const intervals = Chord.intervals(chord);\n    const tokens = Chord.tokenize(chord);\n    let permutation;\n    if (hasAllDegrees(pattern, intervals)) {\n        permutation = permutateIntervals(intervals, pattern);\n    } else {\n        // not all degrees of the pattern are in the chord > get scale\n        const scale = pickChordScale(chord);\n        permutation = permutateIntervals(Scale.intervals(scale), pattern);\n    }\n    if (tokens[0]) {\n        return renderIntervals(permutation, tokens[0]);\n    }\n    return permutation;\n}\n\n// TODO: other way around: find fixed interval pattern in a scale\n// TODO: motives aka start pattern from same note in different scale\n// TODO: motives aka start pattern from different note in same scale\n// TODO: motives aka start pattern from different note in different scale\n\nexport function getDigitalPattern(chord) {\n    chord = Harmony.getTonalChord(chord);\n    const intervals = Chord.intervals(chord);\n    if (intervals.includes('3m')) {\n        return [1, 3, 4, 5];\n    } else if (intervals.includes('3M')) {\n        return [1, 2, 3, 5];\n    } else {\n        return [1, 1, 1, 1];\n    }\n}\n\nexport function renderDigitalPattern(chord) {\n    return getPatternInChord(getDigitalPattern(chord), chord);\n}\n\nexport function getGuideTones(chord) {\n    chord = Harmony.getTonalChord(chord);\n    return getPatternInChord([3, 7], chord);\n}\n\n\nexport function isFirstInPath(path, index) {\n    return path.slice(index)\n        .reduce((sum, value) => sum + value, 0) === 0;\n}\n\nexport function isBarStart(path) {\n    return isFirstInPath(path, 1);\n}\n\nexport function isFormStart(path) {\n    return isFirstInPath(path, 0);\n}\n\nexport function isOffbeat(path) {\n    return path[2] !== 0;\n}\n\n\nexport function otherDirection(direction, defaultDirection?) {\n    if (direction === 'up') {\n        return 'down';\n    } else if (direction === 'down') {\n        return 'up'\n    }\n    return defaultDirection;\n}\n\n\n\nexport function totalDiff(diff) {\n    const total = diff.reduce((weight, diff) => {\n        weight.added += diff.added ? diff.count : 0;\n        weight.removed += diff.added ? diff.count : 0;\n        weight.kept += (!diff.added && !diff.removed) ? diff.count : 0;\n        return weight;\n    }, { added: 0, removed: 0, kept: 0, balance: 0 });\n    total.balance = total.added - total.removed;\n    total.changes = total.added + total.removed;\n    return total;\n}\n\n/** Reorders the given notes to contain the given step as close as possible */\nexport function sortByDegree(notes, degree) {\n    degree = Math.max(degree, (degree + 8) % 8)\n    /* const semitones = Interval.semitones(interval); */\n    const diffDegrees = (a, b) => Math.abs(getDegreeFromInterval(Distance.interval(a, b) + '') - degree);\n    /* const diffTones = (a, b) => Math.abs(Distance.interval(a, b) - semitones); */\n    notes = notes.slice(1).reduce((chain, note) => {\n        const closest = notes\n            .filter(n => !chain.includes(n))\n            .sort((a, b) => diffDegrees(chain[0], a) < diffDegrees(chain[0], b) ? -1 : 1);\n        chain.unshift(closest[0]);\n        return chain;\n    }, [notes[0]]).reverse();\n\n    return notes;\n}\n\n/** Returns the given notes with octaves either moving bottom up or top down */\nexport function renderAbsoluteNotes(notes, octave = 3, direction: intervalDirection = 'up') {\n    return notes.reduce((absolute, current, index, notes) => {\n        if (index === 0) {\n            return [current + octave];\n        }\n        let interval = Distance.interval(notes[index - 1], current);\n        interval = Harmony.minInterval(interval, direction);\n        if (interval === '1P') {\n            interval = direction === 'down' ? '-8P' : '8P';\n        }\n        absolute.push(Distance.transpose(absolute[index - 1], interval + ''));\n        return absolute;\n    }, []);\n}\n\nexport function getIntervals(notes) {\n    return notes.reduce((intervals, note, index, notes) => {\n        if (index === 0) {\n            return [];\n        }\n        intervals.push(Distance.interval(notes[index - 1], note));\n        return intervals;\n    }, []);\n}\n\nexport function isInterval(interval) {\n    return typeof Interval.semitones(interval) === 'number';\n}\n\nexport function smallestInterval(intervals) {\n    return intervals.reduce((min, current) => {\n        if (!min || Interval.semitones(current) < Interval.semitones(min)) {\n            return current;\n        }\n        return min;\n    });\n}\n\nexport function sortNotes(notes, direction: intervalDirection = 'up') {\n    return notes.sort((a, b) => Harmony.getMidi(a) - Harmony.getMidi(b));\n}\n\nexport function analyzeVoicing(notes, root?) {\n    if (!notes || notes.length < 2) {\n        throw new Error('Can only analyze Voicing with at least two notes');\n    }\n    notes = sortNotes(notes);\n    root = root || notes[0]; // TODO: get degrees\n    const intervals = getIntervals(notes);\n    const sortedIntervals = intervals.sort(Harmony.sortMinInterval());\n    return {\n        notes,\n        minInterval: sortedIntervals[0],\n        maxInterval: sortedIntervals[sortedIntervals.length - 1],\n        intervals,\n        spread: Distance.interval(notes[0], notes[notes.length - 1])\n    }\n}\n\n\nexport function semitoneDifference(intervals) {\n    return intervals.reduce((semitones, interval) => {\n        return semitones + Math.abs(Interval.semitones(interval))\n    }, 0);\n}\nexport function semitoneMovement(intervals) {\n    return intervals.reduce((semitones, interval) => {\n        return semitones + Interval.semitones(interval)\n    }, 0);\n}\n\nexport function longestChild(array: any[][]) {\n    return array.reduce((max, current) => (current.length > max.length ? current : max), array[0]);\n}\n\nexport function isPitchClass(note) {\n    return Note.pc(note) === note;\n}\n\n\nexport function mapTree(\n    tree,\n    modifier?,\n    simplify = false,\n    path = [],\n    siblings = [],\n    position = 0) {\n    // skip current tree if only one child\n    if (simplify && Array.isArray(tree) && tree.length === 1) {\n        return mapTree(\n            tree[0], modifier, simplify,\n            path, siblings, position\n        );\n    }\n\n    let fraction = siblings.reduce((f, d) => f / d, 1);\n    if (!Array.isArray(tree)) {\n        return modifier ? modifier(tree, { path, siblings, fraction, position }) : tree;\n    }\n    if (Array.isArray(tree)) {\n        siblings = siblings.concat([tree.length]);\n        fraction = fraction / tree.length;\n        return tree.map((subtree, index) =>\n            mapTree(\n                subtree, modifier, simplify,\n                path.concat([index]),\n                siblings,\n                position + index * fraction\n            )\n        )\n    }\n}\n\nexport function flattenTree(tree) {\n    const flat = []\n    mapTree(tree, (value, props) => flat.push(Object.assign(props, { value })));\n    return flat;\n}\n\nexport function expandTree(tree) {\n    // TODO\n}\n\n/* Returns true if the given intervals are all present in the chords interval structure\nIntervals can be appendend with \"?\" to indicate that those degrees could also be omitted \n(but when present they should match)\n*/\nexport function chordHasIntervals(chord, intervals) {\n    chord = Harmony.getTonalChord(chord);\n    const has = Chord.intervals(chord);\n    return intervals.reduce((match, current) => {\n        const isOptional = current.includes('?');\n        const isForbidden = current.includes('!');\n        if (isOptional) {\n            current = current.replace('?', '');\n            return (!hasDegree(getDegreeFromInterval(current), has) ||\n                has.includes(current)) && match;\n        }\n        if (isForbidden) {\n            current = current.replace('!', '');\n            return !hasDegree(getDegreeFromInterval(current), has);\n        }\n        return has.includes(current) && match;\n    }, true);\n}\n\nexport function isDominantChord(chord) {\n    return chordHasIntervals(chord, ['3M', '7m']) || chordHasIntervals(chord, ['!3', '4P', '7m']);\n}\nexport function isMajorChord(chord) {\n    return chordHasIntervals(chord, ['3M', '7M?']);\n}\nexport function isMinorChord(chord) {\n    return chordHasIntervals(chord, ['3m']);\n}\nexport function isMinorTonic(chord) {\n    return chordHasIntervals(chord, ['3m', '5P', '13M?', '7M?']);\n}\n\nexport function getChordType(chord) {\n    if (isDominantChord(chord)) {\n        return 'dominant';\n    }\n    if (isMajorChord(chord)) {\n        return 'major';\n    }\n    if (isMinorTonic(chord)) {\n        return 'minor-tonic';\n    }\n    if (isMinorChord(chord)) {\n        return 'minor';\n    }\n}\n\nexport function getChordNotes(chord, validate?) {\n    chord = Harmony.getTonalChord(chord);\n    const tokens = Chord.tokenize(chord);\n    const notes = Chord.notes(chord);\n    return notes.filter(note => {\n        const interval = Distance.interval(tokens[0], note);\n        return !validate || validate(note, {\n            root: tokens[0],\n            symbol: tokens[1],\n            interval,\n            step: getStepFromInterval(interval),\n            degree: getDegreeFromInterval(interval + '')\n        });\n    });\n}\n\nexport function validateWithoutRoot(note, { degree }) {\n    return degree !== 1;\n}\n\n// OLD...\nexport function getVoicing(chord, { voices, previousVoicing, omitRoot, quartal }: {\n    previousVoicing?: string[],\n    voices?: number,\n    omitRoot?: boolean,\n    quartal?: boolean\n} = {}) {\n    chord = Harmony.getTonalChord(chord);\n    const tokens = Chord.tokenize(chord);\n    let notes = Chord.notes(chord);\n    if (omitRoot) {\n        notes = notes.filter(n => n !== tokens[0]);\n    }\n    if (quartal) {\n    }\n    if (previousVoicing) {\n\n    }\n    return notes;\n}\n\nexport function semitoneDistance(noteA, noteB) {\n    return Interval.semitones(Distance.interval(noteA, noteB) + '');\n}\n\nexport function noteArray(range) {\n    const slots = Interval.semitones(Distance.interval(range[0], range[1]) + '');\n    return new Array(slots + 1)\n        .fill('')\n        .map((v, i) => Distance.transpose(range[0], Interval.fromSemitones(i)) + '')\n        .map(n => Note.simplify(n))\n}\n\n\nexport function factorial(n) {\n    let value = 1;\n    for (let i = 2; i <= n; ++i) {\n        value *= i;\n    }\n    return value;\n}\n\n\n\n// finds best combination following the given notes, based on minimal movement\n/* export function bestCombination(notes, combinations = []) {\n    return combinations.reduce((best, current) => {\n        const currentMovement = voicingDifference(notes, current);\n        const bestMovement = voicingDifference(notes, best);\n        if (Math.abs(currentMovement) < Math.abs(bestMovement)) {\n            return current;\n        }\n        return best;\n    });\n} */\n\n/* export function sortCombinationsByMovement(notes, combinations, direction: intervalDirection = 'up', min = true) {\n    const movements = combinations.map((combination) => ({\n        movement: voicingMovement(notes, combination, min),\n        combination\n    }));\n    let right = movements.filter(move => direction === 'up' ? move >= 0 : move <= 0);\n    if (!right.length) {\n        right = movements;\n    }\n    let sorted = right.sort((a, b) => a.movement - b.movement);\n    if (direction === 'down') {\n        sorted = sorted.reverse();\n    }\n    return sorted.map(movement => movement.combination);\n}\n */","import { randomElement } from \"../util/util\";\n\nconst off = () => randomElement([0, [0, 1]], [6, 1]);\nconst eightFour = () => randomElement(\n    [[1, 1], 1],\n    [2, 1]\n);\nconst eightOff = () => randomElement(\n    [[1, 1], [0, 1]],\n    [2, 1]\n);\nconst halfTriplet = () => randomElement(\n    [[2, 0], [[2, 0, 2], [0, 2, 0]]],\n    [2, 1]\n);\n\nconst one = (v = 1) => randomElement([0, v]);\n\nexport const bossa = {\n    name: 'Bossa',\n    tempo: 160,\n    chords: ({ measure, settings }) => {\n        return randomElement([\n            [1, [0, 1], 0, [0, 3]],\n            [one(), [0, 3], 0, [0, 1]],\n            [one(), [0, 1], [0, 3], 0],\n            [one(), [0, 3], [0, 1], 0]\n        ])\n    },\n    bass: () =>\n        [1, [0, 3], 0, randomElement([0, 1])],\n    rimshot: ({ measure, settings }) => {\n        return [0, .8, 0, 0]\n    },\n    ride: ({ measures, index }) => {\n        return randomElement([\n            [[one(.6), .9, [.4, .5], [0, .8]]],\n            [[0, .9, [.4, .5], [one(.6), .8]]],\n        ])\n    },\n    hihat: () => [0, .8, 0, 1],\n    solo: () => randomElement([\n        [eightFour(), eightFour(), eightFour(), eightFour()],\n        [eightFour(), 2, 0, eightFour()],\n        [0, 0, eightFour(), eightOff()],\n        [[1, 4], 0, eightFour(), eightFour()],\n        [4, 0, 0, 0],\n        [...halfTriplet(), ...halfTriplet()],\n        [eightOff(), eightOff(), eightOff(), eightOff()],\n    ])\n};","import { randomElement } from \"../util/util\";\nexport const funk = {\n    name: 'Funk',\n    tempo: 90,\n    chords: () => randomElement([\n        [[2, 0, 0, 1], 0, [0, .6], [0, 3.5, 0, 0]],\n        [[1, 0, 0, 5], 0, [0, .6], [1, .5, 0, 0]],\n        [[1, 0, 0, 5], 0, [0, .6], [.5, 0, 2, 0]],\n        [[1, 0, 0, 5], 0, [0, .6], [0, 2, 0, 1]],\n        [[3, 0, 0, 0], 0, 2, 0]\n    ]),\n    bass: () => randomElement(\n        [\n            [[2, 0, 0, 1], [0, 1], 1, [0, 1]],\n            [[2, 0, 0, 0], [0, 1, 0, 1], [0, 0, 1, 0], [0, 0, 0, 1]],\n        ]\n    ),\n    kick: (t) => [[[1, .7], 0, [0, 1], 0]],\n    snare: (t) => [0, 1, [0, .2, 0, 0], [1, 0, 0, .6]],\n    hihat: (t) => [[.5, .6], [.4, .7], [.3, .6], [.5, .7]]\n};","import { randomElement } from \"../util/util\";\n\nconst off = () => randomElement([0, [0, 0, 2]], [6, 1]);\nconst eightFour = () => randomElement(\n    [[1, 0, 1], 1, [0, 0, 1, 1]],\n    [4, 2, 1]\n);\nconst eightOff = () => randomElement(\n    [[1, 0, 1], [0, 0, 1]],\n    [4, 1]\n);\nconst halfTriplet = () => randomElement(\n    [\n        [2, 0],\n        [[2, 0, 2], [0, 2, 0]],\n        [1, 1, 1, 1]\n    ],\n    [2, 1, 1]\n);\n\n\nexport const swing = {\n    name: 'Swing',\n    tempo: 130,\n    chords: ({ measure, settings }) => {\n        const r = Math.random() > 0.5 ? .6 : 0;\n        const t = `${settings.cycle}/${measure.length}`;\n        if (t === '4/1') {\n            return randomElement([\n                [[1, 0], [0, 0, 7], 0, 0],\n                [1, [0, 0, 2], 0, off()],\n                [[0, 0, 1], 0, 2, 0],\n                [[0, 0, 4], 0, 1, 0],\n                [2, 0, 0, 0],\n                [3, 0, 0, 0],\n                [1, 0, r, off()],\n                [[0, 0, 2], 0, r, 0],\n                [1.5, [0, 0, 2], 0, off()],\n            ]);//, [2, 1, 1]\n        }\n        if (t === '4/2') {\n            return randomElement([\n                [[1, 0], [0, 0, 7], 0, 0],\n                [1, [0, 0, 3], 0, 0],\n                [1, 0, 2, 0],\n                [2, 0, 1, 0],\n                [1, 0, .7, off()],\n                [[1, 0, 0], 0, .7, off()],\n                [[4, 0, 0], [0, 0, 2.8], 0, off()],\n            ]);\n        }\n\n        if (t === '4/3') {\n            return randomElement([\n                [1, [0, 0, 2], [0, 0, 4], 0],\n                [1, [2, 0, 0], 2, 0],\n                [1, 1, 2, 0],\n                [[2, 0, 0], 1, 2, 0],\n                [2, 0, 1, 1]\n            ]);\n        }\n        if ('4/4') {\n            return randomElement([\n                [1, 1, 1, 1],\n                /* [[1, 0, 2], [0, 0, 2], 0, 1] */\n            ]);\n        }\n    },\n    bass: () => randomElement([\n        [1, 1, 1, 1]\n        /* [2, 0, 2, 0] */,\n    ]),\n    crash: ({ measures, index }) => {\n        const fill = index !== 0 && index % measures.length === 0;\n        if (fill) {\n            return [4, 0, 0, 0];\n        }\n        return [0, 0, 0, 0];\n    },\n    ride: ({ measures, index }) => {\n        return randomElement([\n            [.6, [.9, 0, 1], .6, [.9, 0, 1]],\n            [.6, [.4, 0, 1], .8, [0, 0, 1],],\n            [.6, .9, [.6, 0, 1], 1],\n            [.6, .9, .6, [.9, 0, 1]],\n        ], [3, 2, 1, 2])\n    },\n    hihat: () => [0, .8, 0, 1],\n    solo: () => randomElement([\n        [eightFour(), eightFour(), eightFour(), eightFour()],\n        [eightFour(), 2, 0, eightFour()],\n        [0, 0, eightFour(), eightFour()],\n        [[1, 0, 4], 0, eightFour(), eightFour()],\n        [3, 0, 0, eightFour()],\n        /* [0, 1, 2, 0], */\n        [...halfTriplet(), ...halfTriplet()],\n        [eightOff(), eightOff(), eightOff(), eightOff()],\n    ])\n    /* solo: () => [1, 1, 0, 1] */\n};","import { Measure, MeasureOrString } from './Measure';\nimport { Harmony } from '../harmony/Harmony';\nimport { randomElement } from '../util/util';\n\nexport type Measures = Array<MeasureOrString>;\n\nexport type Leadsheet = {\n    name?: string,\n    composer?: string,\n    style?: string,\n    bpm?: number,\n    repeats?: number,\n    key?: string,\n    measures?: Measures,\n    chords?: Measures,\n    melody?: Measures,\n    position?: number[]\n}\n\nexport type JumpSign = {\n    pair?: string,\n    move?: number,\n    fine?: boolean,\n    validator?: (state) => boolean,\n}\n\nexport type SheetState = {\n    measures?: [],\n    index?: number,\n    sheet?: Measures,\n    jumps?: { [key: number]: number },\n    visits?: { [key: number]: number },\n    nested?: boolean,\n    fallbackToZero?: boolean,\n    forms?: number;\n    firstTime?: boolean; // flips to false after first chorus is complete\n    lastTime?: boolean; // flips to true when last chorus starts\n}\n\nexport interface ItemWithPath {\n    path: number[],\n    value: string,\n}\n\nexport class Sheet {\n    static jumpSigns: { [sign: string]: JumpSign } = {\n        '}': { pair: '{', move: -1 },\n        'DC': {},\n        'DS': { pair: 'Segno', move: -1 },\n        'DS.Fine': { pair: 'Segno', move: -1 },\n        'DS.Coda': { pair: 'Segno', move: -1 },\n        'DC.Fine': {},\n        'DC.Coda': {},\n        'Fine': {\n            fine: true,\n            validator: (state) => Sheet.readyForFineOrCoda(state)\n        },\n        'ToCoda': {\n            pair: 'Coda', move: 1,\n            validator: (state) => Sheet.readyForFineOrCoda(state)\n        }\n    };\n\n    static render(sheet, options = {}, clear = true): Measures {\n        let state: SheetState = {\n            sheet,\n            measures: [],\n            forms: 1,\n            nested: true,\n            fallbackToZero: true,\n            firstTime: true,\n            ...options\n        };\n        state = {\n            ...state,\n            ...Sheet.newForm(state)\n        };\n\n        let runs = 0;\n        while (runs < 1000 && state.index < sheet.length) {\n            runs++;\n            state = Sheet.nextMeasure(state);\n        }\n        if (clear) {\n            return state.measures\n                .map(m => Measure.from(m))\n                .map(m => {\n                    delete m.house;\n                    delete m.signs;\n                    return m;\n                });\n        }\n        return state.measures;\n    }\n\n    static nextMeasure(state): SheetState {\n        state = {\n            ...state,\n            ...Sheet.nextSection(state)\n        } // moves to the right house (if any)\n        let { sheet, index, measures } = state;\n        state = {\n            ...state,\n            measures: measures.concat([{\n                ...Measure.from(sheet[index]),\n                index: index // add index for mapping\n            }]),\n            ...Sheet.nextIndex(state),\n        }\n        return Sheet.nextForm(state);\n    }\n\n    static nextIndex(state): SheetState {\n        let { sheet, index, jumps, nested, fallbackToZero, lastTime } = state;\n        if (!Sheet.shouldJump({ sheet, index, jumps, lastTime })) {\n            return {\n                index: index + 1\n            };\n        }\n        const braces = [Sheet.getJumpDestination({ sheet, index, fallbackToZero, nested }), index];\n        jumps = Sheet.wipeKeys(jumps, [braces[0], braces[1] - 1]); // wipes indices inside braces\n        return {\n            index: braces[0],\n            jumps: { // count jumps up\n                ...jumps,\n                [braces[1]]: (jumps[braces[1]] || 0) + 1\n            }\n        }\n    }\n\n    static newForm(state): SheetState {\n        return {\n            ...state,\n            index: 0,\n            jumps: {},\n            visits: {},\n            lastTime: state.forms === 1,\n        }\n    }\n\n    static nextForm(state, force = false): SheetState {\n        let { sheet, index, forms } = state;\n        if (force || (index >= sheet.length && forms > 1)) {\n            return Sheet.newForm({\n                ...state,\n                firstTime: false,\n                forms: forms - 1\n            });\n        }\n        return state;\n    }\n\n    // moves the index to the current house (if any)\n    static nextSection(state: SheetState): SheetState {\n        let { sheet, index, visits, firstTime, lastTime } = state;\n        // skip intro when not firstTime\n        if (!firstTime && Measure.from(sheet[index]).section === 'IN') {\n            return {\n                index: Sheet.getNextSectionIndex({ sheet, index }),\n            }\n        }\n        // skip coda when not last time\n        if (Measure.hasSign('Coda', sheet[index]) && !Sheet.readyForFineOrCoda(state, -1)) {\n            return Sheet.nextForm(state, true);\n        }\n        if (!Measure.hasHouse(sheet[index], 1)) {\n            return {};\n        }\n        let next = Sheet.getNextHouseIndex({ sheet, index, visits });\n        if (next === -1) {\n            next = index;\n            visits = {}; // reset visits\n        }\n        return {\n            visits: {\n                ...visits,\n                [next]: (visits[next] || 0) + 1\n            },\n            index: next\n        }\n    }\n    /** Starts at a given index, stops when the pair functions returned equally often */\n    static findPair(\n        sheet,\n        index: number,\n        pairs: Array<(measure?: Measure, options?: { sheet?: Measures, index?: number }) => boolean>,\n        move = 1,\n        stack = 0): number {\n        let match = -1; // start with no match\n        while (match === -1 && index >= 0 && index < sheet.length) {\n            if (pairs[0](sheet[index], { sheet, index })) { // same sign\n                stack++;\n            }\n            if (pairs[1](sheet[index], { sheet, index })) { // pair sign\n                stack--;\n            }\n            if (stack === 0) { // all pairs resolved > match!\n                match = index;\n            } else {\n                index += move;\n            }\n        }\n        return match;\n    }\n\n    static findMatch(\n        sheet,\n        index: number,\n        find: (measure?: Measure, options?: { sheet?: Measures, index?: number }) => boolean,\n        move = 1): number {\n        let match = -1; // start with no match\n        while (match === -1 && index >= 0 && index < sheet.length) {\n            if (find(sheet[index], { sheet, index })) {\n                match = index;\n            } else {\n                index += move;\n            }\n        }\n        return match;\n\n    }\n    // simple matching for brace start, ignores nested repeats\n    static getJumpDestination(state: SheetState): number {\n        let { sheet, index, fallbackToZero, nested } = state;\n        const sign = Measure.getJumpSign(sheet[index]);\n        // if fine > jump till end\n        if (sign.fine) { return sheet.length; }\n        // if no pair given => da capo\n        if (!sign.pair) { return 0; }\n        // if nested mode on and opening brace is searched, use getBracePair..\n        if (nested !== false && sign.pair === '{') {\n            return Sheet.getBracePair({ sheet, index, fallbackToZero });\n        }\n        const destination = Sheet.findMatch(sheet, index,\n            (m) => Measure.hasSign(sign.pair, m),\n            sign.move || -1); // default move back\n        if (fallbackToZero) {\n            // default to zero when searching repeat start (could be forgotten)\n            return destination === -1 ? 0 : destination;\n        }\n        return destination;\n    }\n\n    // returns the index of the repeat sign that pairs with the given index\n    static getBracePair(\n        { sheet, index, fallbackToZero }: { sheet: Measures, index: number, fallbackToZero?: boolean }\n    ): number {\n        if (fallbackToZero === undefined) {\n            fallbackToZero = true;\n        }\n        if (Measure.hasSign('{', sheet[index])) {\n            return Sheet.findPair(sheet, index,\n                [\n                    (m) => Measure.hasSign('{', m),\n                    (m) => Measure.hasSign('}', m),\n                ]\n                , 1);\n        } else if (Measure.hasSign('}', sheet[index])) {\n            const pair = Sheet.findPair(sheet, index,\n                [\n                    (m, state) => {\n                        // this logic could be infinitely complex, having many side effects and interpretations\n                        // the current behaviour is similar to musescore or ireal handling braces\n                        if (!Measure.hasSign('}', m)) {\n                            return false;\n                        }\n                        if (index === state.index) {\n                            return true;\n                        }\n                        const relatedHouse = Sheet.getRelatedHouse({ sheet, index: state.index });\n                        return relatedHouse === -1;\n                    },\n                    (m) => Measure.hasSign('{', m)\n                ]\n                , -1);\n            if (fallbackToZero) {\n                return pair === -1 ? 0 : pair; // default to zero when searching repeat start (could be forgotten)\n            }\n            return pair;\n        }\n        return -1;\n    }\n\n    // returns true if the house at the given index has not been visited enough times\n    static canVisitHouse({ sheet, index, visits }): boolean {\n        let houses = sheet[index].house;\n        if (houses === undefined) {\n            return false;\n        }\n        if (!Array.isArray(houses)) {\n            houses = [houses];\n        }\n        const visited = visits[index] || 0;\n        return visited < houses.length\n    }\n\n    // returns the next house that can be visited (from the given index)\n    static getNextHouseIndex({ sheet, index, visits }, move = 1): number {\n        return Sheet.findMatch(sheet, index,\n            (m, step) => Measure.hasHouse(m) && Sheet.canVisitHouse({ sheet, index: step.index, visits })\n            , move);\n    }\n\n    static getNextSectionIndex({ sheet, index }, move = 1): number {\n        return Sheet.findMatch(sheet, index + 1,\n            (m) => Measure.from(m).section !== undefined, 1);\n    }\n\n    // wipes all keys in the given range\n    static wipeKeys(numberMap, range): { [key: number]: number } {\n        const wiped = {};\n        Object.keys(numberMap)\n            .map(i => parseInt(i))\n            .filter(i => i < range[0] || i > range[1])\n            .forEach(i => wiped[i] = numberMap[i]);\n        return wiped;\n    }\n\n\n    static getRelatedHouse({ sheet, index }): number {\n        const latestHouse = Sheet.findPair(sheet, index,\n            [\n                (m, state) => index === state.index || Measure.hasSign('}', m),\n                (m) => Measure.hasHouse(m)\n            ], -1);\n        return latestHouse;\n    }\n\n    static isFirstHouse({ sheet, index }): boolean {\n        return Measure.hasHouse(sheet[index], 1);\n    }\n\n    static getAllowedJumps({ sheet, index }) {\n        if (!Measure.hasJumpSign(sheet[index])) {\n            return 0;\n        }\n        const measure = Measure.from(sheet[index]);\n        if (measure.times !== undefined) {\n            return measure.times;\n        }\n        return 1;\n    }\n\n    static readyForFineOrCoda({ sheet, index, jumps, lastTime }: SheetState, move = 1): boolean {\n        const signs = Object.keys(Sheet.jumpSigns)\n            .filter(s => s.includes('DC') || s.includes('DS'));\n        const backJump = Sheet.findMatch(sheet, index,\n            (m) => signs.reduce((match, sign) => match || Measure.hasSign(sign, m), false), move\n        );\n        if (backJump === -1) {\n            return lastTime; // last time\n        }\n        return jumps[backJump] > 0;\n    }\n\n\n    static shouldJump({ sheet, index, jumps, lastTime }: SheetState) {\n        if (!Measure.hasJumpSign(sheet[index])) {\n            return false;\n        }\n        const sign = Measure.getJumpSign(sheet[index]);\n        if (sign.validator && !sign.validator({ sheet, index, jumps, lastTime })) {\n            return false;\n        }\n        const allowedJumps = Sheet.getAllowedJumps({ sheet, index });\n        const timesJumped = jumps[index] || 0;\n        return timesJumped < allowedJumps;\n    }\n\n    static transpose(sheet: Leadsheet, interval) {\n        if (sheet.chords) {\n            sheet = {\n                ...sheet,\n                chords: sheet.chords\n                    .map(measure => Measure.from(measure).chords\n                        .map(chord => Harmony.transposeChord(chord, interval)))\n            }\n        }\n        if (sheet.melody) {\n            console.log('TODO: tranpose melody');\n        }\n        return sheet;\n    }\n\n\n    /** Flattens the given possibly nested tree array to an array containing all values in sequential order. \n     * If withPath is set to true, the values are turned to objects containing the nested path (ItemWithPath).\n     * You can then turn ItemWithPath[] back to the original nested array with Measure.expand. */\n    static flatten(tree: any[] | any, withPath = false, path: number[] = []): any[] | ItemWithPath[] {\n        if (!Array.isArray(tree)) { // is primitive value\n            if (withPath) {\n                return [{\n                    path: path,\n                    value: tree\n                }];\n            }\n            return [tree];\n        }\n        return tree.reduce(\n            (flat: (any | ItemWithPath)[], item: any[] | any, index: number): (any | ItemWithPath)[] =>\n                flat.concat(\n                    Sheet.flatten(item, withPath, path.concat([index]))\n                ), []);\n    }\n\n    /** Turns a flat ItemWithPath array to a (possibly) nested Array of its values. Reverts Measure.flatten (using withPath=true). */\n    static expand(items: ItemWithPath[]): any[] {\n        let lastSiblingIndex = -1;\n        return items.reduce((expanded, item, index) => {\n            if (item.path.length === 1) {\n                expanded[item.path[0]] = item.value;\n            } else if (item.path[0] > lastSiblingIndex) {\n                lastSiblingIndex = item.path[0];\n                const siblings = items\n                    .filter((i, j) => j >= index && i.path.length >= item.path.length)\n                    .map(i => ({ ...i, path: i.path.slice(1) }));\n                expanded[item.path[0]] = Sheet.expand(siblings)\n                /* expanded.push(Measure.expand(siblings)); */\n            }\n            return expanded;\n        }, []);\n    }\n\n    static pathOf(value, tree): number[] | undefined {\n        const flat = Sheet.flatten(tree, true);\n        const match = flat.find(v => v.value === value);\n        if (match) {\n            return match.path;\n        }\n    }\n\n    static getPath(tree, path, withPath = false, flat?: ItemWithPath[]): any | ItemWithPath {\n        if (typeof path === 'number') {\n            path = [path];\n        }\n        flat = flat || Sheet.flatten(tree, true);\n        const match = flat.find(v => {\n            const min = Math.min(path.length, v.path.length);\n            return v.path.slice(0, min).join(',') === path.slice(0, min).join(',')\n        });\n        if (withPath) {\n            return match;\n        }\n        return match ? match.value : undefined;\n    }\n\n    static nextItem(tree, path, move = 1, withPath = false, flat?: ItemWithPath[]): any | ItemWithPath {\n        flat = Sheet.flatten(tree, true);\n        const match = Sheet.getPath(tree, path, true, flat);\n        if (match) {\n            let index = (flat.indexOf(match) + move) % flat.length;\n            if (withPath) {\n                return flat[index];\n            }\n            return flat[index] ? flat[index].value : undefined;\n        }\n    }\n\n    static nextValue(tree, value, move = 1): any | undefined {\n        const flat = Sheet.flatten(tree, true);\n        const match = flat.find(v => v.value === value);\n        if (match) {\n            return Sheet.nextItem(tree, match.path, move, false, flat)\n        }\n    }\n\n    static nextPath(tree, path?, move = 1): any | undefined {\n        const flat = Sheet.flatten(tree, true);\n        if (!path) {\n            return flat[0] ? flat[0].path : undefined;\n        }\n        const match = Sheet.getPath(tree, path, true, flat);\n        if (match) {\n            const next = Sheet.nextItem(tree, match.path, move, true, flat);\n            return next ? next.path : undefined;\n        }\n    }\n\n    static randomItem(tree) {\n        const flat = Sheet.flatten(tree, true);\n        return randomElement(flat);\n    }\n\n    static stringify(measures: MeasureOrString[], property = 'chords'): string | any[] {\n        return measures.map(measure => (Measure.from(measure)[property]));\n    }\n}\n\n/*\nTODO:\n\nmore typings\nspecial sections:\nIN: only play the first time\nCODA: only play last time\n\ntest standards:\n- Alice in Wonderland (dc al 2nd ending)\n- All or Nothing at All (dc al coda)\n- Are you real (intro + coda)\n- Armageddon (intro)\n- The Bat (coda sign inside repeat): ireal plays coda directly first time..\n- Bennys Tune (intro+coda sign inside repeat): ireal plays coda directly first time..\n- Bess You Is My Woman (coda sign inside repeat): ireal plays coda directly first time..\n- Blessed Relief (nested repeats, with odd behaviour)\n- Blue in Green (coda)\n- Miles Ahead (coda)\n*/\n\n\n/*\n\n\n\n    static getPath(measures: Measures, path: number[] | number = 0, tickleDown = false, traveled = []) {\n        if (typeof path === 'number') {\n            path = [path]; // fix syntax sugar\n        }\n        if (!path.length && !tickleDown) {\n            return measures; // path end\n        } else if (!path.length) {\n            path = [0];\n        }\n        const next = measures[path[0]];\n        if (Array.isArray(next)) {\n            traveled.push[path[0]];\n            path.shift();\n            return Sheet.getPath(next, path, tickleDown, traveled)\n        }\n        if (typeof next === 'string') {\n            if (path.length > 1) {\n                console.warn('path ended too early');\n            }\n            return next;\n        }\n        if (!next) {\n\n        }\n        return next;\n    }\n\n    */","import { JumpSign, Sheet } from './Sheet';\n\nexport type MeasureOrString = Measure | string[] | string;\n\nexport interface Measure {\n    chords?: string[],\n    //voices?: string[][],\n    signs?: string[],\n    comments?: string[],\n    house?: number | number[],\n    times?: number,\n    section?: string,\n    idle?: true // bar is repeated\n};\n\nexport class Measure implements Measure {\n    static from(measure: MeasureOrString, property = 'chords'): Measure {\n        if (typeof measure === 'string') {\n            return {\n                [property]: [measure]\n            }\n        }\n        if (Array.isArray(measure)) {\n            return {\n                [property]: [].concat(measure)\n            }\n        }\n        return Object.assign({}, measure);\n        // return measure;\n    }\n\n    static hasSign(sign: string, measure: MeasureOrString): boolean {\n        measure = Measure.from(measure);\n        return !!measure.signs && measure.signs.includes(sign);\n    }\n\n    static hasHouse(measure: MeasureOrString, number?: number): boolean {\n        measure = Measure.from(measure);\n        let { house } = measure;\n        if (!house) {\n            return false;\n        } else if (number === undefined) {\n            return true;\n        }\n        if (!Array.isArray(house)) {\n            house = [house];\n        }\n        return house.includes(number);\n    }\n\n    static getJumpSign(measure): JumpSign {\n        const signs = (Measure.from(measure).signs || [])\n            .filter(s => Object.keys(Sheet.jumpSigns).includes(s));\n        if (signs.length > 1) {\n            console.warn('measure cannot contain more than one repeat sign', measure);\n        }\n        return Sheet.jumpSigns[signs[0]];\n    }\n\n    static hasJumpSign(measure: MeasureOrString): boolean {\n        return Object.keys(Sheet.jumpSigns)\n            .reduce((match, current) => match || Measure.hasSign(current, measure), false);\n    }\n}","import { Measure } from './Measure';\nimport { Measures } from './Sheet';\n\n// extension of https://github.com/daumling/ireal-renderer/blob/master/src/ireal-renderer.js\n\nexport class RealParser {\n    /**\n     * The RegExp for a complete chord. The match array contains:\n     * 1 - the base note\n     * 2 - the modifiers (+-ohd0123456789 and su for sus)\n     * 3 - any comments (may be e.g. add, sub, or private stuff)\n     * 4 - the \"over\" part starting with a slash\n     * 5 - the top chord as (chord)\n     * @type RegExp\n     */\n\n    static chordRegex = /^([ A-GW][b#]?)((?:sus|[\\+\\-\\^\\dhob#])*)(\\*.+?\\*)*(\\/[A-G][#b]?)?(\\(.*?\\))?/;\n\n    static regExps = [\n        /^\\*[a-zA-Z]/,\t\t\t\t\t\t\t// section\n        /^T\\d\\d/,\t\t\t\t\t\t\t\t// time measurement\n        /^N./,\t\t\t\t\t\t\t\t\t// repeat marker\n        /^<.*?>/,\t\t\t\t\t\t\t\t// comments\n        /^ \\(.*?\\)/,\t\t\t\t\t\t\t// blank and (note)\n        RealParser.chordRegex,\t\t\t\t// chords\n        /^LZ/,\t\t\t\t\t\t\t\t\t// 1 cell + right bar\n        /^XyQ/,\t\t\t\t\t\t\t\t\t// 3 empty cells\n        /^Kcl/\t\t\t\t\t\t\t\t\t// repeat last bar\n    ];\n\n    static replacements = {\n        \"LZ\": [\" \", \"|\"],\n        \"XyQ\": [\" \", \" \", \" \"],\n        \"Kcl\": [\"|\", \"x\", \" \"]\n    };\n\n    static getChord(iRealChord) {\n        return iRealChord.note + iRealChord.modifiers + (iRealChord.over ? '/' + this.getChord(iRealChord.over) : '');\n    }\n\n    static parseSheet(raw): Measures {\n        const tokens = RealParser.parse(raw);\n        return RealParser.getSheet(tokens);\n    }\n\n    static getSheet(tokens): Measures {\n        const parsed = tokens\n            .reduce((current, token, index, array) => {\n                const lastBarEnded = ['{', '|', '[', '||' /* 'Z',  *//* , ']' */]\n                    .includes(token.bars || token.token);\n                let signs = token.annots || [];\n                const repeatStart = (token.bars || token.token) === '{';\n                const repeatEnd = (token.bars || token.token) === '}';\n                if (repeatStart) {\n                    signs.push('{');\n                }\n                if (repeatEnd) {\n                    signs.push('}');\n                }\n                // current.measure ends\n                if (lastBarEnded) {\n                    if (current.measure) {\n                        // simplify measure if no signs\n                        /* if (Object.keys(current.measure).find(k=>k)) {\n                            current.measure = current.measure.chords;\n                        } */\n                        current.measures.push(current.measure);\n                    }\n                    current.measure = { chords: [] };\n                }\n\n                const sectionStart = signs.find(a => a.match(/^\\*[a-zA-Z]/));\n                if (sectionStart) {\n                    signs = signs.filter(s => s !== sectionStart);\n                    current.measure.section = sectionStart.replace('*', '');\n                }\n\n                const hasCodaSign = signs.includes('Q');\n                if (hasCodaSign) {\n                    signs = signs.filter(s => s !== 'Q');\n                    let codaSign = 'ToCoda';\n                    if (!!current.measures.find(m => Measure.hasSign('ToCoda', m))) {\n                        codaSign = 'Coda';\n                    }\n                    current.measure.signs = (current.measure.signs || []).concat([codaSign]);\n                }\n\n                const houseStart = signs.find(s => !!s.match(/^N./));\n                if (houseStart) {\n                    signs = signs.filter(s => s !== houseStart);\n                    current.measure.house = parseInt(houseStart.replace('N', ''));\n                }\n\n                const time = signs.find(a => a.match(/^T\\d\\d/));\n                if (time) {\n                    signs = signs.filter(s => s !== time);\n                    current.measure.time = time.replace('T', '');\n                }\n\n                if (token.chord) {\n                    current.measure.chords.push(this.getChord(token.chord));\n                } else if (token.token === 'n') {\n                    current.measure.chords.push(0);\n                }\n\n                const last = current.measures[current.measures.length - 1];\n                if (last && last.chords[0] === 'r') {\n                    last.chords = current.measures[current.measures.length - 3].chords;\n                    current.measure.chords = current.measures[current.measures.length - 2].chords;\n                }\n                if (last && current.measure.chords[0] === 'x') {\n                    current.measure.chords = [].concat(last.chords);\n                    current.measure.idle = true;\n                }\n\n                if (signs.length) {\n                    current.measure.signs = (current.measure.signs || [])\n                        .concat(signs);\n                }\n                if (token.comments.length) {\n                    current.measure.comments = (current.measure.comments || [])\n                        .concat(token.comments.map(c => c.trim()));\n                }\n                return current;\n            }, { measure: null, signs: null, measures: [] });\n        if (parsed.measure.chords.length) {\n            parsed.measures.push(parsed.measure);\n        }\n        return parsed.measures;\n    }\n\n\n    static parse(raw: string): any {\n        var text = raw;\n        var arr = [], headers = [], comments = [];\n        var i;\n        text = text.trim();\n        // text = text.trimRight();\n        while (text) {\n            var found = false;\n            for (i = 0; i < RealParser.regExps.length; i++) {\n                var match = RealParser.regExps[i].exec(text);\n\n                if (match) {\n                    found = true;\n                    if (match.length <= 2) {\n                        const replacement = match[0];\n                        var repl = RealParser.replacements[replacement];\n                        arr = arr.concat(repl ? repl : [replacement]);\n                        text = text.substr(replacement.length);\n                    }\n                    else { // a chord\n                        arr.push(match);\n                        text = text.substr(match[0].length);\n                    }\n                    break;\n                }\n            }\n            if (!found) {\n                // ignore the comma separator\n                if (text[0] !== ',')\n                    arr.push(text[0]);\n                text = text.substr(1);\n            }\n        }\n        //\t\tconsole.log(arr);\n        // pass 2: extract prefixes, suffixes, annotations and comments\n        var out = [];\n        var obj = RealParser.newToken(out);\n        for (i = 0; i < arr.length; i++) {\n            var token = arr[i];\n            if (token instanceof Array) {\n                obj.chord = RealParser.parseChord(token);\n                token = \" \";\n            }\n            switch (token[0]) {\n                case ',': token = null; break; // separator\n                case 'S':\t// segno\n                case 'T':\t// time measurement\n                case 'Q':\t// coda\n                case 'N':\t// repeat\n                case 'U':\t// END\n                case 's':\t// small\n                case 'l':\t// normal\n                case 'f':\t// fermata\n                case '*': obj.annots.push(token); token = null; break;\n                case 'Y': obj.spacer++; token = null; break;\n                case 'r':\n                case 'x':\n                case 'W':\n                    obj.chord = new iRealChord(token, \"\", null, null);\n                    break;\n                case '<':\n                    token = token.substr(1, token.length - 2);\n                    token = token.replace(/XyQ/g, \"   \");\t// weird; needs to be done\n                    obj.comments.push(token);\n                    token = null; break;\n                default:\n            }\n            if (token) {\n                if (\"]}Z\".indexOf(arr[i + 1]) >= 0)\n                    obj.bars += arr[++i];\n                if (\"{[|\".indexOf(token) >= 0) {\n                    obj.bars += token; token = null;\n                }\n            }\n            if (token && i < arr.length - 1) {\n                obj.token = token;\n                obj = RealParser.newToken(out);\n            }\n        }\n        return out;\n    }\n\n\n\n    static parseChord(match) {\n        var note = match[1] || \" \";\n        var modifiers = match[2] || \"\";\n        var comment = match[3] || \"\";\n        if (comment)\n            modifiers += comment.substr(1, comment.length - 2).replace(\"XyQ\", \"   \");\n        var over = match[4] || \"\";\n        if (over[0] === '/')\n            over = over.substr(1);\n        var alternate = match[5] || null;\n        if (alternate) {\n            match = RealParser.chordRegex.exec(alternate.substr(1, alternate.length - 2));\n            if (!match)\n                alternate = null;\n            else\n                alternate = this.parseChord(match);\n        }\n        // empty cell?\n        if (note === \" \" && !alternate && !over)\n            return null;\n        if (over) {\n            var offset = (over[1] === '#' || over[1] === 'b') ? 2 : 1;\n            over = new iRealChord(over.substr(0, offset), over.substr(offset), null, null);\n        }\n        else\n            over = null;\n        return new iRealChord(note, modifiers, over, alternate);\n    }\n\n    static newToken(arr) {\n        var obj = new iRealToken;\n        arr.push(obj);\n        return obj;\n    }\n\n}\n\nclass iRealChord {\n    note: any;\n    modifiers: any;\n    over: any;\n    alternate: any;\n    constructor(note, modifiers, over, alternate) {\n        this.note = note;\n        this.modifiers = modifiers;\n        this.over = over;\n        this.alternate = alternate;\n    }\n}\n\nclass iRealToken {\n    chord: any;\n    spacer: number;\n    bars: string;\n    comments: any[];\n    token: any;\n    annots: any[];\n    constructor() {\n        this.annots = [];\n        this.comments = [];\n        this.bars = \"\";\n        this.spacer = 0;\n        this.chord = null;\n    }\n}","import * as JsDiff from 'diff';\nimport { Measure } from './Measure';\nimport { Sheet } from './Sheet';\n\nexport class Snippet {\n    static controlSigns = [\n        {\n            name: 'DC',\n            short: 'DC',\n            end: true\n        },\n        {\n            name: 'DS',\n            short: 'DS',\n            end: true\n        },\n        {\n            name: 'Segno',\n            short: 'S',\n        },\n        {\n            name: 'DS.Fine',\n            short: 'DS',\n            end: true\n        },\n        {\n            name: 'DS.Coda',\n            short: 'DS',\n            end: true\n        },\n        {\n            name: 'DC.Fine',\n            short: 'DC',\n            end: true\n        },\n        {\n            name: 'DC.Coda',\n            short: 'DC',\n            end: true\n        },\n        {\n            name: 'Fine',\n            short: 'Fi',\n            end: true\n        },\n        {\n            name: 'ToCoda',\n            short: '2Q',\n            end: true\n        },\n        {\n            name: 'Coda',\n            short: 'Q'\n        },\n    ]\n\n    static render(snippet, options?) {\n        const parsed = Snippet.parse(snippet);\n        return Sheet.render(parsed, options, true);\n    }\n\n    static wrapPipes(string) {\n        return `|${string}|`.replace(/\\|+/g, '|');\n    }\n\n    static formatForDiff(snippet) {\n        return Snippet.minify(snippet)\n            .replace(/\\|/g, ' | ').trim();\n    }\n\n    static format(snippet, linebreaks = true) {\n        // replaces url chars back\n        let compact = Snippet.minify(snippet, false);\n        compact = Snippet.wrapPipes(compact);\n\n        if (linebreaks) {\n            compact = Snippet.parseBars(snippet).compact;\n        } else {\n            compact = compact.replace(/\\n/g, '|');\n        }\n        return compact\n            .replace(/\\|+/g, '|')\n            .replace(/\\|( +)\\|( +)/g, ' $1 $2') // remove spacer bar pipes\n            .replace(/\\|( +)\\|([1-9])/g, ' $1|$2')\n            .replace(/^\\s+|\\s+$/g, '') // remove spaces/line breaks from start/end\n    }\n\n    static parseBars(snippet) {\n        let compact = Snippet.minify(snippet, false);\n        compact = Snippet.wrapPipes(compact);\n        // insert spaces before first chord\n        let cells = compact.split('|').slice(1, -1);\n        cells = cells.map((bar, index) => {\n            if (!bar[0].match(/[1-9:]/)) {\n                bar = '  ' + bar;\n            } else if (bar[0] === ':') {\n                bar = ': ' + bar.slice(1);\n            }\n            return bar;\n        });\n        // find out indices of first houses\n        const houses = cells.reduce((offset, bar, index) => {\n            if (bar[0] === '1') {\n                offset.push(index);\n            }\n            return offset;\n        }, []);\n        // insert empty cells before additional houses\n        cells = cells.reduce((cells, bar, index) => {\n            if (bar[0].match(/[2-9]/)) {\n                const offset = houses.filter(h => h < index).reverse()[0];\n                cells = cells.concat(new Array(offset % 4).fill(''));\n            }\n            cells.push(bar);\n            return cells;\n        }, []);\n        // find out the maximal number of chars per column\n        const chars = cells.reduce((max, bar, index) => {\n            max[index % 4] = Math.max(bar.length, max[index % 4] || 0);\n            return max;\n        }, []);\n        // fill up each bar with spaces\n        compact = cells.map((bar, index) => {\n            let diff = chars[index % 4] - bar.length + 2;\n            if (diff > 0) {\n                bar += new Array(diff).fill(' ').join('');\n            }\n            // move double dots to end of bar\n            bar = bar.replace(/:(\\s+)$/, '$1:');\n            return bar;\n        }).join('|');\n\n        compact = Snippet.wrapPipes(compact);\n        // break string all 4 cells\n        let pipeIndex = -1;\n        compact = compact.split('').reduce((string, char, index) => {\n            if (char === '|') {\n                pipeIndex++;\n            }\n            if (char === '|' && pipeIndex % 4 === 0 && index > 0 && index < compact.length - 1) {\n                char = \"|\\n|\";\n                pipeIndex = 0;\n            }\n            return string + char;\n        }, '');\n        return { compact, cells, houses, chars };\n    }\n\n    static columnChars(snippet) {\n        const bars = snippet.split('|');\n        const chars = bars.reduce((max, bar, index) => {\n            max[index % 4] = Math.max(bar.length, max[index % 4] || 0);\n            return max;\n        }, []);\n    }\n\n    static getCellBounds(index, snippet) {\n        const { chars, cells } = Snippet.parseBars(snippet);\n        // get correct index with offset (dont count empty cells)\n        index = cells.map(((cell, index) => ({ cell, index })))\n            .filter(({ cell }) => cell !== '')[index].index;\n        index = index % cells.length;\n        const col = index % 4;\n        const row = Math.floor(index / 4);\n        const rowlength = chars.reduce((sum, current) => sum + current + 3, 0) + 2;\n        const rowLeft = rowlength * row;\n        const left = rowLeft + chars.slice(0, col).reduce((sum, current, i) => sum + current + 3, 0) + 1;\n        return [left, left + chars[col] + 2];\n    }\n\n    static minify(snippet, urlsafe = false) {\n        let compact = (`|${snippet}|`)\n            .replace(/\\n+/g, '|') // replace line breaks with pipes\n            .replace(/\\s+/g, ' ') // no repeated pipes\n            .replace(/\\s?\\|\\s?/g, '|') // no pipes with spaces\n            .replace(/\\s?\\:\\s?/g, ':') // no repeat with spaces\n            .replace(/\\|+/g, '|') // no repeated pipes\n        if (urlsafe) {\n            // replaces url unfriendly chars\n            compact = compact\n                .replace(/\\|+/g, 'I')\n                .replace(/\\s+/g, '_')\n                .replace(/:/g, 'R')\n                .replace(/\\^/g, 'M')\n                .replace(/\\#/g, 'Y')\n                .replace(/\\%/g, 'X')\n        } else {\n            // replaces url unfriendly chars\n            compact = compact\n                .replace(/\\I+/g, '|')\n                .replace(/\\_+/g, ' ')\n                .replace(/R/g, ':')\n                .replace(/M/g, '^')\n                .replace(/X/g, 'x')\n                .replace(/Y/g, '#')\n        }\n        return compact.slice(1, -1);\n    }\n\n    static getControlSigns(symbols = []) {\n        return symbols\n            .filter(s => typeof s === 'string') // control should not be nested!\n            .map(s => Snippet.controlSigns.find(c => [c.name, c.short]\n                .includes(s.replace('(', '').replace(')', ''))))\n            .filter(s => !!s);\n    }\n\n    static parse(snippet, simplify = true) {\n        const formatted = Snippet.format(snippet, false);\n        return formatted\n            .split('|') // split into measures\n            .map(measure => measure.split(' ')) // split measures by spaces\n            .map(measure => measure.filter(chord => !!chord)) // kill empty chords\n            .filter(measure => !measure || measure.length) // kill empty measures\n            .map(measure => ({ symbols: measure, signs: [] }))\n            // parse symbols to chords and signs\n            .map((measure: { symbols, signs, house, chords }) => {\n                // repeat start\n                if (measure.symbols[0][0] === ':') {\n                    if (measure.symbols[0].length === 1) {\n                        measure.symbols = measure.symbols.slice(1);\n                    }\n                    measure.signs.unshift('{');\n                }\n                const last = measure.symbols[measure.symbols.length - 1];\n                // repeat end\n                if (last[last.length - 1] === ':') {\n                    if (last.length === 1) {\n                        measure.symbols.pop();\n                    }\n                    measure.signs.push('}');\n                }\n                measure.symbols = measure.symbols.map(s => s.replace(/:/g, ''));\n                const house = measure.symbols.find(s => s.match(/^[1-9]$/));\n                if (house) {\n                    measure.house = parseInt(house);\n                }\n                measure.symbols = measure.symbols.filter(s => !s.match(/^[1-9]$/))\n\n                let controlSigns = Snippet.getControlSigns(measure.symbols);\n                if (controlSigns.length) {\n                    measure.signs = measure.signs.concat(controlSigns.map(sign => sign.name));\n                    measure.symbols = measure.symbols\n                        .filter(s => !controlSigns\n                            .find(c => [c.name, c.short].includes(s.replace(')', '').replace('(', ''))));\n                }\n\n                measure.chords = [].concat(measure.symbols);\n\n                delete measure.symbols;\n                return measure;\n            })\n            .map(measure => {\n                if (!simplify) {\n                    return measure;\n                }\n                if (measure.signs.length === 0) {\n                    delete measure.signs;\n                }\n                if (measure.chords.length === 0) {\n                    delete measure.chords;\n                }\n                return measure;\n            })\n            // kill empty measures\n            .filter(measure => Object.keys(measure).length > 0)\n            // simplify => measures with only chords will be arrays\n            .map(measure => {\n                if (!simplify) {\n                    return measure;\n                }\n                if (measure.chords && Object.keys(measure).length === 1) {\n                    return measure.chords.length === 1 ?\n                        measure.chords[0] : // simplify one chord measures\n                        measure.chords\n                }\n                return measure;\n            });\n    }\n\n    static nest(string) {\n        let nested = string.split('.')\n            .map(group => group.trim())\n            .map(group => group.split(' '))\n            .map(group => group.filter(chord => !!chord))  // kill empty chords\n            .filter(group => !group || group.length)\n            .map(group => group.length === 1 ? group[0] : group)\n        nested = nested.length === 1 ? nested[0] : nested;\n        return nested;\n    }\n\n    static parse2(snippet, simplify = true) {\n        const formatted = Snippet.format(snippet, false);\n        return formatted\n            .split('|') // split into measures\n            .filter(measure => measure && measure.length) // kill empty measures\n            .map(measure => ({ symbols: measure.trim(), signs: [] }))\n            // parse symbols to chords and signs\n            .map((measure: { symbols, signs, house, chords }) => {\n                // repeat start\n                if (measure.symbols[0] === ':') {\n                    measure.signs.unshift('{');\n                }\n                const last = measure.symbols[measure.symbols.length - 1];\n                // repeat end\n                if (last === ':') {\n                    measure.signs.push('}');\n                }\n                measure.symbols = measure.symbols.replace(/:/g, '');\n                const house = measure.symbols[0].match(/^[1-9]$/);\n                if (house) {\n                    measure.house = parseInt(house);\n                    measure.symbols = measure.symbols.slice(1);\n                }\n                measure.symbols = [].concat(Snippet.nest(measure.symbols));\n                let controlSigns = Snippet.getControlSigns(measure.symbols);\n                if (controlSigns.length) {\n                    measure.signs = measure.signs.concat(controlSigns.map(sign => sign.name));\n                    measure.symbols = measure.symbols\n                        .filter(s => !controlSigns\n                            .find(c => [c.name, c.short].includes(s.replace(')', '').replace('(', ''))));\n                }\n                measure.chords = measure.symbols;\n                delete measure.symbols;\n                return measure;\n            })\n            .map(measure => {\n                if (!simplify) {\n                    return measure;\n                }\n                if (measure.signs.length === 0) {\n                    delete measure.signs;\n                }\n                if (measure.chords.length === 0) {\n                    delete measure.chords;\n                }\n                return measure;\n            })\n            // kill empty measures\n            .filter(measure => Object.keys(measure).length > 0)\n            // simplify => measures with only chords will be arrays\n            .map(measure => {\n                if (!simplify) {\n                    return measure;\n                }\n                if (measure.chords && Object.keys(measure).length === 1) {\n                    return measure.chords.length === 1 ?\n                        measure.chords[0] : // simplify one chord measures\n                        measure.chords\n                }\n                return measure;\n            });\n    }\n\n    static testFormat(sheet) {\n        return sheet.map(m => Measure.from(m)).map(m => m.chords).join(' ');\n    }\n\n    static from(sheet, format = true) {\n        const snippet = sheet\n            .map(m => Measure.from(m))\n            .reduce((snippet, { signs, house, chords }) => {\n                const controlSigns = Snippet.getControlSigns(signs || []);\n                const start = controlSigns.filter(c => !c.end).map(c => '(' + c.short + ')').join(' ');\n                const end = controlSigns.filter(c => !!c.end).map(c => '(' + c.short + ')').join(' ');\n                const repeatStart = signs && signs.includes('{');\n                const repeatEnd = signs && signs.includes('}');\n                return snippet + `|${repeatStart ? ':' : ''}${house || ''} ${start ? start + ' ' : ''}${chords ? chords.join(' ') : ''}${end ? ' ' + end : ''}${repeatEnd ? ':' : ''}`;\n            }, '');\n        if (format) {\n            return Snippet.format(snippet);\n        }\n        return Snippet.minify(snippet);\n    }\n\n    static expand(snippet, options?) {\n        return Snippet.from(Snippet.render(snippet, options));\n    }\n\n    static diff(snippetA, snippetB) {\n        const diffFormat = [Snippet.formatForDiff(snippetA), Snippet.formatForDiff(snippetB)];\n        return JsDiff.diffWords(\n            diffFormat[0], diffFormat[1]\n        );\n    }\n}\n","\nimport k from './drummer/kick.wav';\nimport s from './drummer/snare.wav';\nimport h from './drummer/hihat.wav';\nimport r from './drummer/ride.wav';\nimport c from './drummer/crash.wav';\nimport rs from './drummer/rimshot.wav';\n\nexport const kick = k;\nexport const snare = s;\nexport const hihat = h;\nexport const ride = r;\nexport const crash = c;\nexport const rimshot = rs;\nexport const drumset = [kick, snare, hihat, ride, crash, rimshot];\nexport const drumSamples = { 'C1': kick, 'C2': snare, 'C3': hihat, 'C4': ride, 'C5': crash, 'C6': rimshot };","import C1 from \"./piano/C1.mp3\";\nimport Db1 from \"./piano/Db1.mp3\";\nimport D1 from \"./piano/D1.mp3\";\nimport Eb1 from \"./piano/Eb1.mp3\";\nimport E1 from \"./piano/E1.mp3\";\nimport F1 from \"./piano/F1.mp3\";\nimport Gb1 from \"./piano/Gb1.mp3\";\nimport G1 from \"./piano/G1.mp3\";\nimport Ab1 from \"./piano/Ab1.mp3\";\nimport A1 from \"./piano/A1.mp3\";\nimport Bb1 from \"./piano/Bb1.mp3\";\nimport B1 from \"./piano/B1.mp3\";\nimport C2 from \"./piano/C2.mp3\";\nimport Db2 from \"./piano/Db2.mp3\";\nimport D2 from \"./piano/D2.mp3\";\nimport Eb2 from \"./piano/Eb2.mp3\";\nimport E2 from \"./piano/E2.mp3\";\nimport F2 from \"./piano/F2.mp3\";\nimport Gb2 from \"./piano/Gb2.mp3\";\nimport G2 from \"./piano/G2.mp3\";\nimport Ab2 from \"./piano/Ab2.mp3\";\nimport A2 from \"./piano/A2.mp3\";\nimport Bb2 from \"./piano/Bb2.mp3\";\nimport B2 from \"./piano/B2.mp3\";\nimport C3 from \"./piano/C3.mp3\";\nimport Db3 from \"./piano/Db3.mp3\";\nimport D3 from \"./piano/D3.mp3\";\nimport Eb3 from \"./piano/Eb3.mp3\";\nimport E3 from \"./piano/E3.mp3\";\nimport F3 from \"./piano/F3.mp3\";\nimport Gb3 from \"./piano/Gb3.mp3\";\nimport G3 from \"./piano/G3.mp3\";\nimport Ab3 from \"./piano/Ab3.mp3\";\nimport A3 from \"./piano/A3.mp3\";\nimport Bb3 from \"./piano/Bb3.mp3\";\nimport B3 from \"./piano/B3.mp3\";\nimport C4 from \"./piano/C4.mp3\";\nimport Db4 from \"./piano/Db4.mp3\";\nimport D4 from \"./piano/D4.mp3\";\nimport Eb4 from \"./piano/Eb4.mp3\";\nimport E4 from \"./piano/E4.mp3\";\nimport F4 from \"./piano/F4.mp3\";\nimport Gb4 from \"./piano/Gb4.mp3\";\nimport G4 from \"./piano/G4.mp3\";\nimport Ab4 from \"./piano/Ab4.mp3\";\nimport A4 from \"./piano/A4.mp3\";\nimport Bb4 from \"./piano/Bb4.mp3\";\nimport B4 from \"./piano/B4.mp3\";\nimport C5 from \"./piano/C5.mp3\";\nimport Db5 from \"./piano/Db5.mp3\";\nimport D5 from \"./piano/D5.mp3\";\nimport Eb5 from \"./piano/Eb5.mp3\";\nimport E5 from \"./piano/E5.mp3\";\nimport F5 from \"./piano/F5.mp3\";\nimport Gb5 from \"./piano/Gb5.mp3\";\nimport G5 from \"./piano/G5.mp3\";\nimport Ab5 from \"./piano/Ab5.mp3\";\nimport A5 from \"./piano/A5.mp3\";\nimport Bb5 from \"./piano/Bb5.mp3\";\nimport B5 from \"./piano/B5.mp3\";\nimport C6 from \"./piano/C6.mp3\";\nimport Db6 from \"./piano/Db6.mp3\";\nimport D6 from \"./piano/D6.mp3\";\nimport Eb6 from \"./piano/Eb6.mp3\";\nimport E6 from \"./piano/E6.mp3\";\nimport F6 from \"./piano/F6.mp3\";\nimport Gb6 from \"./piano/Gb6.mp3\";\nimport G6 from \"./piano/G6.mp3\";\nimport Ab6 from \"./piano/Ab6.mp3\";\nimport A6 from \"./piano/A6.mp3\";\nimport Bb6 from \"./piano/Bb6.mp3\";\nimport B6 from \"./piano/B6.mp3\";\nimport C7 from \"./piano/C7.mp3\";\nimport Db7 from \"./piano/Db7.mp3\";\nimport D7 from \"./piano/D7.mp3\";\nimport Eb7 from \"./piano/Eb7.mp3\";\nimport E7 from \"./piano/E7.mp3\";\nimport F7 from \"./piano/F7.mp3\";\nimport Gb7 from \"./piano/Gb7.mp3\";\nimport G7 from \"./piano/G7.mp3\";\nimport Ab7 from \"./piano/Ab7.mp3\";\nimport A7 from \"./piano/A7.mp3\";\nimport Bb7 from \"./piano/Bb7.mp3\";\nimport B7 from \"./piano/B7.mp3\";\n\nexport const piano = [\n    C1,\n    Db1,\n    D1,\n    Eb1,\n    E1,\n    F1,\n    Gb1,\n    G1,\n    Ab1,\n    A1,\n    Bb1,\n    B1,\n    C2,\n    Db2,\n    D2,\n    Eb2,\n    E2,\n    F2,\n    Gb2,\n    G2,\n    Ab2,\n    A2,\n    Bb2,\n    B2,\n    C3,\n    Db3,\n    D3,\n    Eb3,\n    E3,\n    F3,\n    Gb3,\n    G3,\n    Ab3,\n    A3,\n    Bb3,\n    B3,\n    C4,\n    Db4,\n    D4,\n    Eb4,\n    E4,\n    F4,\n    Gb4,\n    G4,\n    Ab4,\n    A4,\n    Bb4,\n    B4,\n    C5,\n    Db5,\n    D5,\n    Eb5,\n    E5,\n    F5,\n    Gb5,\n    G5,\n    Ab5,\n    A5,\n    Bb5,\n    B5,\n    C6,\n    Db6,\n    D6,\n    Eb6,\n    E6,\n    F6,\n    Gb6,\n    G6,\n    Ab6,\n    A6,\n    Bb6,\n    B6,\n    C7,\n    Db7,\n    D7,\n    Eb7,\n    E7,\n    F7,\n    Gb7,\n    G7,\n    Ab7,\n    A7,\n    Bb7,\n    B7,\n];","import iRealReader from 'ireal-reader';\nimport { Trio, Sampler, util } from '../lib';\nimport { bossa } from '../src/grooves/bossa';\n// import { disco } from '../src/grooves/disco';\nimport { funk } from '../src/grooves/funk';\nimport { swing } from '../src/grooves/swing';\nimport { RealParser } from '../src/sheet/RealParser';\nimport { Snippet } from '../src/sheet/Snippet';\nimport link from '../songs/1350.json';\n/* import { harp } from './samples/harp'; */\nimport { drumset } from '../src/samples/drumset';\nimport { piano } from '../src/samples/piano';\nimport { Measure } from '../lib/sheet/Measure';\nimport { Sheet } from '../lib/sheet/Sheet';\nvar AudioContext = window.AudioContext // Default\n    || window.webkitAudioContext // Safari and old versions of Chrome\n    || false;\nif (!AudioContext) {\n    alert(\"Sorry, but the Web Audio API is not supported by your browser. Please, consider upgrading to the latest version or downloading Google Chrome or Mozilla Firefox\");\n}\nconst context = new AudioContext();\nconst playlist = new iRealReader(decodeURI(link));\n\n// bass = new Synthesizer({ duration: 400, gain: gains[w1], type: w1, mix });\nconst keyboard = new Sampler({ samples: piano, midiOffset: 24, gain: 1, context });\n// const keyboard = new WebAudioFont({ context, preset: 50, gain: .8 });\n// const bass = new WebAudioFont({ context, preset: 366 });\nconst bass = keyboard;\n// const harpInstrument = new Sampler({ samples: harp, midiOffset: 24, gain: 1, context });\nconst drums = new Sampler({ samples: drumset, context, gain: 0.5, duration: 6000 });\nconst band = new Trio({ context, piano: keyboard, bass/* : false */, drums, solo: false });\n\n\nwindow.onload = function () {\n    // buttons\n    const playJazz = document.getElementById('jazz');\n    const playFunk = document.getElementById('funk');\n    const playBossa = document.getElementById('bossa');\n    const playExact = document.getElementById('exact');\n    const stopButton = document.getElementById('stop');\n    const slower = document.getElementById('slower');\n    const faster = document.getElementById('faster');\n    const tempoInput = document.getElementById('tempoInput');\n    const next = document.getElementById('next');\n    const searchInput = document.getElementById('searchInput');\n    const playChords = document.getElementById('playChords');\n    const format = document.getElementById('format');\n    /* const transposeUp = document.getElementById('transposeUp');\n    const transposeDown = document.getElementById('transposeDown'); */\n    const toggleTraining = document.getElementById('startTraining');\n    const nextChord = document.getElementById('nextChord');\n    const playChordAgain = document.getElementById('playChordAgain');\n    const playBassOnly = document.getElementById('playBassOnly');\n    const randomChord = document.getElementById('randomChord');\n    const minify = document.getElementById('minify');\n    const standardTitle = document.getElementById('standardTitle');\n    const textarea = document.getElementById('chords');\n    const cheapSynths = document.getElementById('cheapsynths');\n    const usePiano = document.getElementById('usePiano');\n    let standard, sheet, latestGroove = swing, latestPath, latestChord, duration = 800, trainMode = false, guess = '';\n\n    let bpm = latestGroove.tempo || 120;\n    tempoInput.value = bpm;\n\n    function getStandard(playlist, query) {\n        let newStandard;\n        if (query) {\n            newStandard = util.randomElement(playlist.songs.filter(s => s.title.toLowerCase().includes(query.toLowerCase())));\n        } else {\n            newStandard = util.randomElement(playlist.songs);\n        }\n\n        if (newStandard) {\n            newStandard.music.measures = RealParser.parseSheet(newStandard.music.raw); // TODO: add Song that can be passed to comp\n            setPath(null);\n            latestChord = null;\n            return newStandard;\n        }\n    }\n\n    loadStandard();\n\n    next.addEventListener('click', () => {\n        loadStandard();\n        searchInput.value = '';\n    });\n\n    searchInput.addEventListener('keyup', () => {\n        const query = searchInput.value;\n        loadStandard(query);\n    });\n\n    function stop() {\n        if (band.pulse) {\n            band.pulse.stop();\n        }\n    }\n\n    function obfuscateChords(chords) {\n        const obfuscated = chords\n            /* .slice(0, 4) */\n            .map(m => Measure.from(m))\n            .map((m, i) => {\n                m.chords = m.chords.map((c, j) => {\n                    if (i === 0 && j === 0) {\n                        return c;\n                    }\n                    return c.replace(/([A-G1-9a-z#b\\-\\^+])/g, '?');\n                })\n                return m;\n            });\n        return Snippet.from(obfuscated, true);\n    }\n\n    function loadStandard(query) {\n        standard = getStandard(playlist, query) || standard;\n        sheet = {\n            composer: standard.composer,\n            title: standard.title,\n            chords: standard.music.measures\n        };\n        guess = '';\n        if (trainMode) {\n            guess = obfuscateChords(sheet.chords);\n            textarea.value = guess;\n        } else {\n            textarea.value = Snippet.from(sheet.chords, true);\n        }\n        setTitle(standard.composer + ' - ' + standard.title);\n        stop();\n    }\n\n    function setTitle(title) {\n        standardTitle.innerHTML = title;\n    }\n\n    function play(leadsheet = sheet, groove = latestGroove, resetBpm = false) {\n        if (band.pulse) {\n            band.pulse.stop();\n        }\n        latestGroove = groove;\n        textarea.value = Snippet.format(textarea.value);\n        const forms = 2;\n        const time = 4;\n        if (resetBpm) {\n            setTempo(groove.tempo || 100);\n        }\n        bpm = bpm || groove.tempo;\n        setTitle(sheet.composer + ' - ' + sheet.title);\n        band.comp(sheet, {\n            render: { forms },\n            metronome: false,\n            exact: !groove,\n            cycle: time,\n            bpm,\n            groove,\n            voicings: {\n                range: ['C3', 'C#5'], // allowed voice range\n                maxVoices: 4, // maximum number of voices per chord\n                maxDistance: 7,  // general max distance between single voices\n                minDistance: 1,  // general max distance between single voices\n                minBottomDistance: 3, // min semitones between the two bottom notes\n                minTopDistance: 2, // min semitones between the two top notes\n                noTopDrop: true,\n                noTopAdd: true,\n                // bottomDegrees: [1],\n                // topDegrees: [3, 7],\n                // omitNotes: ['Bb'],\n                // topNotes: ['B', 'C', 'C#'],\n                rangeBorders: [2, 1],\n                noBottomDrop: false,\n                noBottomAdd: true,\n                idleChance: 1,\n                logging: true\n            },\n            onMeasure: (measure) => {\n                setPath([measure.index, 0]);\n                selectCell(measure.index);\n            }\n        });\n    }\n    usePiano.addEventListener('click', () => {\n        stop();\n        band.pianist.instrument = keyboard;\n        band.bassist.instrument = bass;\n        /* band.soloist.instrument = util.randomSynth(band.mix, allowed); */\n        console.log('pianist:', band.pianist.instrument.type);\n        console.log('bassist:', band.bassist.instrument.type);\n        play();\n    });\n    cheapSynths.addEventListener('click', () => {\n        stop();\n        const allowed = ['triangle', 'square', 'sawtooth'];\n        band.pianist.instrument = util.randomSynth(band.mix, allowed);\n        band.bassist.instrument = util.randomSynth(band.mix, ['sine']);\n        /* band.soloist.instrument = util.randomSynth(band.mix, allowed); */\n        console.log('pianist:', band.pianist.instrument.type);\n        console.log('bassist:', band.bassist.instrument.type);\n        play()\n    });\n\n    playJazz.addEventListener('click', () => play(sheet, swing, true));\n    playFunk.addEventListener('click', () => play(sheet, funk, true));\n    playBossa.addEventListener('click', () => play(sheet, bossa, true));\n    playExact.addEventListener('click', () => play(sheet, false, true));\n\n    stopButton.addEventListener('click', () => {\n        stop();\n    });\n    function setTempo(tempo = bpm) {\n        bpm = tempo;\n        bpm = Math.max(30, bpm);\n        bpm = Math.min(300, bpm);\n        if (band.pulse) {\n            band.pulse.changeTempo(bpm);\n        }\n        tempoInput.value = bpm;\n    }\n    tempoInput.addEventListener('blur', () => {\n        setTempo(tempoInput.value);\n    })\n    slower.addEventListener('click', () => {\n        setTempo(bpm - 10);\n    });\n    faster.addEventListener('click', () => {\n        setTempo(bpm + 10);\n    });\n\n    textarea.addEventListener('click', () => {\n        if (band.pulse) {\n            band.pulse.stop();\n        }\n        if (trainMode) {\n            return;\n        }\n        sheet = {\n            title: 'Custom Changes',\n            composer: 'You',\n            chords: Snippet.parse2(textarea.value),\n        }\n        setTitle(sheet.composer + ' - ' + sheet.title);\n    });\n\n    textarea.addEventListener('blur', () => {\n        if (trainMode) {\n            guess = Snippet.format(textarea.value);\n            return;\n        }\n        sheet = Object.assign(sheet, {\n            chords: Snippet.parse2(textarea.value),\n        });\n    });\n\n    playChords.addEventListener('click', () => {\n        // the parseChords fn will transform the textarea string to a chord array\n        sheet = {\n            title: sheet.title,\n            composer: sheet.composer,\n            chords: trainMode ? sheet.chords : Snippet.parse2(textarea.value),\n        }\n        textarea.value = Snippet.format(textarea.value);\n        play();\n    });\n\n    function selectCell(n) {\n        const bounds = Snippet.getCellBounds(n, textarea.value);\n        textarea.focus();\n        textarea.setSelectionRange(bounds[0], bounds[1]);\n    }\n    let n = 0;\n    format.addEventListener('click', () => {\n        textarea.value = Snippet.format(textarea.value);\n        selectCell(n++);\n    });\n    minify.addEventListener('click', () => {\n        textarea.value = Snippet.minify(textarea.value, true);\n    });\n    /* function transpose(interval) {\n        const sheet = Snippet.parse2(textarea.value);\n        return Sheet.transpose(sheet, interval);\n    }\n    transposeUp.addEventListener('click', () => {\n        textarea.value = Snippet.minify(textarea.value, true);\n    });\n    transposeDown.addEventListener('click', () => {\n        textarea.value = Snippet.minify(textarea.value, true);\n    }); */\n    /* function transpose(interval) {\n        const sheet = Snippet.parse2(textarea.value);\n        return Sheet.transpose(sheet, interval);\n    } */\n\n    function setPath(path) {\n        latestPath = path;\n        playChordAgain.innerHTML = (latestPath || [0, 0]).join('/');\n    }\n\n    function playChord(path = 0, bassOnly = false) {\n        if (!band.pianist) {\n            console.warn('no pianist');\n        }\n        const chords = Sheet.stringify(sheet.chords);\n        const chord = Sheet.getPath(chords, path);\n        selectCell(path[0]);\n        if (!chord) {\n            console.warn('no chord');\n            return;\n        }\n        latestChord = chord;\n        setPath(path);\n        if (!bassOnly) {\n            band.pianist.playChord(latestChord, {\n                duration, voicingOptions: {\n                    maxVoices: 4,\n                    forceBestPick: false,\n                    logIdle: true\n                }\n            });\n        }\n        band.bassist.playBass({ value: { chord: latestChord }, path: [0, 0], duration });\n    }\n\n    toggleTraining.addEventListener('click', () => {\n        trainMode = !trainMode;\n        toggleTraining.innerHTML = trainMode ? 'show solution' : 'hide solution';\n        // TODO parse guess for missing chords => blame click :)\n        stop();\n        const solution = Snippet.from(sheet.chords);\n        guess = !guess ? obfuscateChords(sheet.chords) : Snippet.format(guess, true);\n\n        if (guess === solution) {\n            alert('ALLES RICHTIG!!!!');\n            toggleTraining.innerHTML = 'start';\n        } else if (guess && !trainMode) {\n            console.warn('noch nicht alles richtig');\n        }\n        if (trainMode) {\n            textarea.value = guess;\n        } else {\n            textarea.value = solution;\n        }\n    });\n\n    nextChord.addEventListener('click', () => {\n        stop();\n        const chords = Sheet.stringify(sheet.chords);\n        playChord(Sheet.nextPath(chords, latestPath));\n    });\n\n    prevChord.addEventListener('click', () => {\n        stop();\n        const chords = Sheet.stringify(sheet.chords);\n        playChord(Sheet.nextPath(chords, latestPath, -1));\n    });\n\n    playChordAgain.addEventListener('click', () => {\n        stop();\n        playChord(latestPath || [0, 0]);\n    });\n    playBassOnly.addEventListener('click', () => {\n        stop();\n        playChord(latestPath || [0, 0], true);\n    });\n\n    randomChord.addEventListener('click', () => {\n        const chords = Sheet.stringify(sheet.chords);\n        const item = Sheet.randomItem(chords);\n        playChord(item.path);\n    });\n}\n"]}